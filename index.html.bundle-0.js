BUNDLE=[],"undefined"!=typeof window&&("ontouchstart"in window||(window.Touch=null),document._montageTiming={},document._montageTiming.loadStartTime=Date.now(),window.addEventListener("DOMContentLoaded",function(){var e=1e3;document._montageStartBootstrappingTimeout=setTimeout(function(){document._montageStartBootstrappingTimeout=null;var e=document.documentElement;e.classList?e.classList.add("montage-app-bootstrapping"):e.className=e.className+" montage-app-bootstrapping",document._montageTiming.bootstrappingStartTime=Date.now()},e)})),function(e){"undefined"!=typeof require?e.call("undefined"!=typeof global?global:this,require,exports,module):e({},{},{})}(function(e,t){global=this,t.initMontage=function(){var e=t.getPlatform();e.bootstrap(function(n,r,i){var a=e.getParams(),s=e.getConfig(),l=i.resolve(n.getLocation(),a.montageLocation);s.makeLoader=function(e){return t.ReelLoader(e,n.makeLoader(e))},s.makeCompiler=function(e){return t.MetaCompiler(e,t.SerializationCompiler(e,t.TemplateCompiler(e,n.makeCompiler(e))))};var u=i.resolve(s.location,a["package"]||"."),c=a.applicationHash;if("object"==typeof BUNDLE){var h={},d=function(e){return h[e]=h[e]||r.defer()};global.bundleLoaded=function(e){d(e).resolve()};var p=r.defer();s.preloaded=p.promise;var f=r.resolve();BUNDLE.forEach(function(e){f=f.then(function(){return r.all(e.map(function(e){return o.load(e),d(e).promise}))})}),p.resolve(f.then(function(){delete BUNDLE,delete bundleLoaded}))}var m;if("remoteTrigger"in a){var v=r.defer();window.postMessage({type:"montageReady"},"*");var g=function(e){if(a.remoteTrigger===e.origin&&(e.source===window||e.source===window.parent))switch(e.data.type){case"montageInit":window.removeEventListener("message",g),v.resolve([e.data.location,e.data.injections]);break;case"isMontageReady":window.postMessage({type:"montageReady"},"*")}};window.addEventListener("message",g),m=v.promise.spread(function(e,t){var r=n.loadPackage({location:e,hash:c},s);return t&&(r=r.then(function(n){e=i.resolve(e,".");var r,a,o=t.packageDescriptions,s=t.packageDescriptionLocations,l=t.mappings,u=t.dependencies;if(o)for(a=o.length,r=0;a>r;r++)n.injectPackageDescription(o[r].location,o[r].description);if(s)for(a=s.length,r=0;a>r;r++)n.injectPackageDescriptionLocation(s[r].location,s[r].descriptionLocation);if(l)for(a=l.length,r=0;a>r;r++)n.injectMapping(l[r].dependency,l[r].name);if(u)for(a=u.length,r=0;a>r;r++)n.injectDependency(u[r].name,u[r].version);return n})),r})}else{if("autoPackage"in a)n.injectPackageDescription(u,{dependencies:{montage:"*"}},s);else if(".json"===u.slice(u.length-5)){var b=u;u=i.resolve(u,"."),n.injectPackageDescriptionLocation(u,b,s)}m=n.loadPackage({location:u,hash:c},s)}m.then(function(t){t.loadPackage({location:l,hash:a.montageHash}).then(function(e){var t;return t=a.promiseLocation?i.resolve(n.getLocation(),a.promiseLocation):i.resolve(l,"packages/mr/packages/q"),[e,e.loadPackage({location:t,hash:a.promiseHash})]}).spread(function(n,o){n.inject("core/mini-url",i),n.inject("core/promise",{Promise:r}),o.inject("q",r),s.lint=function(e){n.async("core/jshint").then(function(t){t.JSHINT(e.text)||(console.warn("JSHint Error: "+e.location),t.JSHINT.errors.forEach(function(e){e&&(console.warn("Problem at line "+e.line+" character "+e.character+": "+e.reason),e.evidence&&console.warn("    "+e.evidence))}))}).done()},global.require=t,global.montageRequire=n,e.initMontage(n,t,a)})}).done()})};var n=/((.*)\.reel)\/\2$/,r=function(e,t){return t};t.SerializationCompiler=function(e,t){return function(e){if(t(e),e.factory){var i=e.factory;return e.factory=function(e,t,a){i.call(this,e,t,a);for(var o in t){var s=t[o];if(s instanceof Object)if(s.hasOwnProperty("_montage_metadata")&&!s._montage_metadata.isInstance)s._montage_metadata.aliases.push(o),s._montage_metadata.objectName=o;else if(!Object.isSealed(s)){var l=a.id.replace(n,r);Object.defineProperty(s,"_montage_metadata",{value:{require:e,module:l,moduleId:l,property:o,objectName:o,aliases:[o],isInstance:!1}})}}},e}}};var i=/([^\/]+)\.reel$/;t.ReelLoader=function(e,t){return function(e,n){var r=i.exec(e);return r?(n.redirect=e+"/"+r[1],n):t(e,n)}};var a=/\.meta/;t.MetaCompiler=function(e,t){return function(e){var n=(e.location||"").match(a);return n?(e.exports=JSON.parse(e.text),e):t(e)}},t.TemplateCompiler=function(e,t){return function(e){if(e.location){var n=e.location.match(/(.*\/)?(?=[^\/]+\.html(?:\.load\.js)?$)/);return n?(e.dependencies=e.dependencies||[],e.exports={directory:n[1],content:e.text},Object.defineProperty(e.exports,"root",{get:function(){return"object"==typeof console&&console.warn("'root' property is deprecated on template modules.  Use 'directory' instead of root[1]"),n}}),e):(t(e),void 0)}}},t.getPlatform=function(){if("undefined"!=typeof window&&window&&window.document)return o;if("undefined"!=typeof process)return e("./node.js");throw Error("Platform not supported.")};var o={makeResolve:function(){var e=document.querySelector("head"),t=document.createElement("base"),n=document.createElement("a");return t.href="",function(r,i){var a=e.querySelector("base");if(a||(e.appendChild(t),a=t),r+="",!/^[\w\-]+:/.test(r))throw Error("Can't resolve from a relative location: "+JSON.stringify(r)+" "+JSON.stringify(i));var o=a.href;a.href=r,n.href=i;var s=n.href;return a.href=o,a===t&&e.removeChild(a),s}},load:function(e){var t=document.createElement("script");t.src=e,t.onload=function(){t.parentNode.removeChild(t)},document.getElementsByTagName("head")[0].appendChild(t)},getConfig:function(){return{location:""+window.location}},getParams:function(){var e,t,n,r,i,a,o;if(!this._params){this._params={};var s=document.getElementsByTagName("script");for(e=0;s.length>e;e++)if(r=s[e],i=!1,r.src&&(n=r.src.match(/^(.*)montage.js(?:[\?\.]|$)/i))&&(this._params.montageLocation=n[1],i=!0),r.hasAttribute("data-montage-location")&&(this._params.montageLocation=r.getAttribute("data-montage-location"),i=!0),i){if(r.dataset)for(o in r.dataset)this._params[o]=r.dataset[o];else if(r.attributes){var l=/-([a-z])/g,u=function(e,t){return t.toUpperCase()};for(t=0;r.attributes.length>t;t++)a=r.attributes[t],n=a.name.match(/^data-(.*)$/),n&&(this._params[n[1].replace(l,u)]=a.value)}r.parentNode.removeChild(r);break}}return this._params},bootstrap:function(e){function t(){document.removeEventListener("DOMContentLoaded",t,!0),s=!0,i()}function n(e){if(!v[e]&&m[e]){var t=v[e]={};v[e]=m[e](n,t)||t}return v[e]}function r(){u=n("mini-url"),l=n("promise"),a=n("require"),delete global.bootstrap,i()}function i(){s&&a&&e(a,l,u)}var a,s,l,u,c=this.getParams(),h=this.makeResolve();/interactive|complete/.test(document.readyState)?t():document.addEventListener("DOMContentLoaded",t,!0);var d={require:"packages/mr/require.js","require/browser":"packages/mr/browser.js",promise:"packages/mr/packages/q/q.js"};if("undefined"==typeof BUNDLE){var p=h(window.location,c.montageLocation);for(var f in d)o.load(h(p,d[f]))}var m={};global.bootstrap=function(e,t){m[e]=t,delete d[e];for(var e in d)return;delete global.bootstrap,r()},global.bootstrap("mini-url",function(e,t){t.resolve=h});var v={}},initMontage:function(e,t,n){var r=["core/core","core/event/event-manager","core/serialization/deserializer/montage-reviver","core/logger"],i=e("core/promise").Promise;return i.all(r.map(e.deepLoad)).then(function(){r.forEach(e);var a,o,s=e("core/core").Montage,l=e("core/event/event-manager").EventManager,u=e("core/serialization/deserializer/montage-reviver").MontageReviver,c=e("core/logger").logger;c("Promise stacktrace support",function(e){i.longStackSupport=!!e}),a=(new l).initWithWindow(window),"function"==typeof global.montageWillLoad&&global.montageWillLoad();var h,d,p=t.packageDescription.applicationPrototype;return p?(h=u.parseObjectLocationId(p),d=t.async(h.moduleId)):d=e.async("core/application"),d.then(function(e){var r=e[h?h.objectName:"Application"];o=new r,Object.defineProperty(window.document,"application",{get:s.deprecate(null,function(){return e.application},'document.application is deprecated, use require("montage/core/application").application instead.')}),a.application=o,o.eventManager=a,o._load(t,function(){n.module&&t.async(n.module).done(),"function"==typeof global.montageDidLoad&&global.montageDidLoad()})})}).done()}};"undefined"!=typeof window?global.__MONTAGE_LOADED__?console.warn("Montage already loaded!"):(global.__MONTAGE_LOADED__=!0,t.initMontage()):t.getPlatform()}),function(e){if("undefined"!=typeof bootstrap)"undefined"!=typeof window?bootstrap("require",function(t,n){var r=t("promise"),i=t("mini-url");e(n,r,i),t("require/browser")}):bootstrap("require",function(t,n){var r=t("promise").Promise,i=t("mini-url");e(n,r,i)});else{if("undefined"==typeof process)throw Error("Can't support require on this platform");var t=require("q"),n=require("url");e(exports,t,n),require("./node")}}(function(e,t,n){function r(t,r){if(r=r||{},"string"==typeof t&&(t={location:t}),t.main&&(t.location=r.mainPackageLocation),t.name&&r.registry&&r.registry[t.name]&&(t.location=r.registry[t.name]),!t.location&&r.packagesDirectory&&t.name&&(t.location=n.resolve(r.packagesDirectory,t.name+"/")),!t.location)return t;if(/\/$/.test(t.location)||(t.location+="/"),!e.isAbsolute(t.location)){if(!r.location)throw Error("Dependency locations must be fully qualified: "+JSON.stringify(t));t.location=n.resolve(r.location,t.location)}return t.name&&(r.registry[t.name]=t.location),t}function i(t,i,a){/\/$/.test(t)||(t+="/");var o=Object.create(a);o.name=i.name,o.location=t||e.getLocation(),o.packageDescription=i,o.useScriptInjection=i.useScriptInjection,void 0!==i.production&&(o.production=i.production);var l=o.modules=o.modules||{},u=o.registry;void 0===o.name||u[o.name]||(u[o.name]=o.location);var c=i.overlay||{};(o.overlays||e.overlays).forEach(function(e){if(c[e]){var t=c[e];for(var n in t)i[n]=t[n]}}),delete i.overlay,i.directories=i.directories||{},i.directories.lib=void 0===i.directories.lib?"./":i.directories.lib;var h=i.directories.lib;o.lib=n.resolve(t,"./"+h);var d=i.directories.packages||"node_modules";d=n.resolve(t,d+"/"),o.packagesDirectory=d,void 0!==i.main&&(l[""]={id:"",redirect:s(i.main),location:o.location},i.name!==l[""].redirect&&(l[i.name]={id:i.name,redirect:"",location:n.resolve(t,i.name)}));var p=i.redirects;void 0!==p&&Object.keys(p).forEach(function(e){l[e]={id:e,redirect:p[e],location:n.resolve(t,e)}});var f=i.mappings||{};return[i.dependencies,o.production?null:i.devDependencies].forEach(function(e){e&&Object.keys(e).forEach(function(t){f[t]||(f[t]={name:t,version:e[t]})})}),Object.keys(f).forEach(function(e){f[e]=r(f[e],o,e)}),o.mappings=f,o}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(e,t){e+="";var n=e.split("/"),r=[];if(n.length&&"."===n[0]||".."===n[0]){var i=t.split("/");i.pop(),n.unshift.apply(n,i)}for(var a=0,o=n.length;o>a;a++){var s=n[a];""===s||"."===s||(".."===s?r.length&&r.pop():r.push(s))}return r.join("/")}if(!this)throw Error("Require does not work in strict mode.");e.makeRequire=function(i){function u(e){var t=e.toLowerCase();return a(v,t)||(v[t]={id:e,display:(i.name||i.location)+"#"+e,require:m}),v[t]}function c(e,t){var r=u(e);r.exports=t,r.location=n.resolve(i.location,e),r.directory=n.resolve(r.location,"./"),r.injected=!0,delete r.redirect,delete r.mappingRedirect}function h(e,n,r){var i=u(e);return r=r||{},a(r,e)?void 0:(r[e]=!0,g(e,n).then(function(){return t.all(i.dependencies.map(function(t){t=o(t,e);var n=u(t),i=n.dependees=n.dependees||{};return i[e]=!0,h(t,e,r)}))},function(e){i.error=e}))}function d(e,t){var r=u(e);if(r.id!==e)throw Error("Can't require module "+JSON.stringify(r.id)+" by alternate spelling "+JSON.stringify(e));if(r.error){var i=Error("Can't require module "+JSON.stringify(r.id)+" via "+JSON.stringify(t)+" because "+r.error.message);throw i.cause=r.error,i}if(void 0!==r.redirect)return d(r.redirect,t);if(void 0!==r.mappingRedirect)return r.mappingRequire(r.mappingRedirect,t);if(void 0!==r.exports)return r.exports;if(void 0===r.factory)throw Error("Can't require module "+JSON.stringify(e)+" via "+JSON.stringify(t));r.directory=n.resolve(r.location,"./"),r.exports={};var a=r.factory.call(void 0,f(e),r.exports,r);return void 0!==a&&(r.exports=a),r.exports}function p(e,t,n){var r=i.location;if(t.location===r)return e;var o=!!n;if(n=n||{},a(n,r))return null;n[r]=!0;for(var s in i.mappings){var l=i.mappings[s];if(r=l.location,i.hasPackage(r)){var u=i.getPackage(r),c=u.identify(e,t,n);if(null!==c)return""===c?s:s+"/"+c}}if(o)return null;throw Error("Can't identify "+e+" from "+t.location)}function f(t){var n=function(e){var n=o(e,t);return d(n,t)};return n.async=function(e){var r=o(e,t);return u(e),h(r,t).then(function(){return n(r)})},n.resolve=function(e){return s(o(e,t))},n.getModule=u,n.getModuleDescriptor=u,n.load=g,n.deepLoad=h,n.loadPackage=function(t,n){return n?e.loadPackage(t,n):i.loadPackage(t,i)},n.hasPackage=function(e){return i.hasPackage(e)},n.getPackage=function(e){return i.getPackage(e)},n.isMainPackage=function(){return n.location===i.mainPackageLocation},n.injectPackageDescription=function(t,n){e.injectPackageDescription(t,n,i)},n.injectPackageDescriptionLocation=function(t,n){e.injectPackageDescriptionLocation(t,n,i)},n.injectMapping=function(e,t){e=r(e,i,t),t=t||e.name,i.mappings[t]=e},n.injectDependency=function(e){n.injectMapping({name:e},e)},n.identify=p,n.inject=c,i.exposedConfigs.forEach(function(e){n[e]=i[e]}),n.config=i,n.read=i.read,n}var m;i=i||{},i.location=n.resolve(i.location||e.getLocation(),"./"),i.lib=n.resolve(i.location,i.lib||"./"),i.paths=i.paths||[i.lib],i.mappings=i.mappings||{},i.exposedConfigs=i.exposedConfigs||e.exposedConfigs,i.makeLoader=i.makeLoader||e.makeLoader,i.load=i.load||i.makeLoader(i),i.makeCompiler=i.makeCompiler||e.makeCompiler,i.compile=i.compile||i.makeCompiler(i),i.parseDependencies=i.parseDependencies||e.parseDependencies,i.read=i.read||e.read;var v=i.modules=i.modules||{},g=l(function(e){var n=u(e);return t.fcall(function(){return void 0===n.factory&&void 0===n.exports&&void 0===n.redirect?t.fcall(i.load,e,n):void 0}).then(function(){i.compile(n);var e=n.dependencies=n.dependencies||[];void 0!==n.redirect&&e.push(n.redirect),void 0!==n.extraDependencies&&Array.prototype.push.apply(n.dependencies,n.extraDependencies)})});return m=f("")},e.injectPackageDescription=function(e,n,r){var i=r.descriptions=r.descriptions||{};i[e]=t.resolve(n)},e.injectPackageDescriptionLocation=function(e,t,n){var r=n.descriptionLocations=n.descriptionLocations||{};r[e]=t},e.loadPackageDescription=function(t,r){var i=t.location,a=r.descriptions=r.descriptions||{};if(void 0===a[i]){var o,s=r.descriptionLocations=r.descriptionLocations||{};o=s[i]?s[i]:n.resolve(i,"package.json"),a[i]=(r.read||e.read)(o).then(function(e){try{return JSON.parse(e)}catch(t){throw t.message=t.message+" in "+JSON.stringify(o),t}})}return a[i]},e.loadPackage=function(t,n){if(t=r(t,n),!t.location)throw Error("Can't find dependency: "+JSON.stringify(t));var a=t.location;n=Object.create(n||null);var o=n.loadingPackages=n.loadingPackages||{},s=n.packages={};n.registry=n.registry||Object.create(null),n.mainPackageLocation=a,n.hasPackage=function(e){if(e=r(e,n),!e.location)return!1;var t=e.location;return!!s[t]},n.getPackage=function(e){if(e=r(e,n),!e.location)throw Error("Can't find dependency: "+JSON.stringify(e)+" from "+n.location);var t=e.location;if(!s[t])throw o[t]?Error("Dependency has not finished loading: "+JSON.stringify(e)):Error("Dependency was not loaded: "+JSON.stringify(e));return s[t]},n.loadPackage=function(t,a){if(t=r(t,a),!t.location)throw Error("Can't find dependency: "+JSON.stringify(t)+" from "+n.location);var l=t.location;return o[l]||(o[l]=e.loadPackageDescription(t,n).then(function(t){var r=i(l,t,n),a=e.makeRequire(r);return s[l]=a,a})),o[l]};var l=n.loadPackage(t);return l.location=a,l.async=function(e,t){return l.then(function(n){return n.async(e,t)})},l},e.resolve=o,e.base=function(e){return(e+"").replace(/(.+?)\/+$/,"$1").match(/([^\/]+$|^\/$|^$)/)[1]},e.isAbsolute=function(e){return/^[\w\-]+:/.test(e)},e.parseDependencies=function(e){var t={};return(e+"").replace(/(?:^|[^\w\$_.])require\s*\(\s*["']([^"']*)["']\s*\)/g,function(e,n){t[n]=!0}),Object.keys(t)},e.DependenciesCompiler=function(t,n){return function(r){return r.dependencies||void 0===r.text||(r.dependencies=t.parseDependencies(r.text)),n(r),r&&!r.dependencies&&(r.dependencies=r.text||r.factory?e.parseDependencies(r.text||r.factory):[]),r}},e.ShebangCompiler=function(e,t){return function(e){e.text&&(e.text=e.text.replace(/^#!/,"//#!")),t(e)}},e.LintCompiler=function(e,n){return function(r){try{n(r)}catch(i){throw e.lint&&t.nextTick(function(){e.lint(r)}),i}}},e.exposedConfigs=["paths","mappings","location","packageDescription","packages","modules"],e.makeCompiler=function(t){return e.JsonCompiler(t,e.ShebangCompiler(t,e.DependenciesCompiler(t,e.LintCompiler(t,e.Compiler(t)))))},e.JsonCompiler=function(e,t){return function(e){var n=(e.location||"").match(/\.json$/);return n?(e.exports=JSON.parse(e.text),e):t(e)}},e.MappingsLoader=function(t,n){return t.mappings=t.mappings||{},t.name=t.name,function(r,i){var a=t.mappings,o=Object.keys(a),s=o.length;if(e.isAbsolute(r))return n(r,i);void 0!==t.name&&0===r.indexOf(t.name)&&"/"===r.charAt(t.name.length)&&console.warn("Package reflexive module ignored:",r);var l,u;for(l=0;s>l;l++)if(u=o[l],r===u||0===r.indexOf(u)&&"/"===r.charAt(u.length)){var c=a[u],h=r.slice(u.length+1);return t.loadPackage(c,t).then(function(e){return i.mappingRedirect=h,i.mappingRequire=e,e.deepLoad(h,t.location)})}return n(r,i)}},e.ExtensionsLoader=function(t,n){var r=t.extensions||["js"],i=r.reduceRight(function(e,t){return function(r,i){return n(r+"."+t,i).fail(function(t){if(/^Can't find /.test(t.message))return e(r,i);throw t})}},function(e){throw Error("Can't find "+JSON.stringify(e)+" with extensions "+JSON.stringify(r)+" in package at "+JSON.stringify(t.location))});return function(t,r){return-1!==e.base(t).indexOf(".")?n(t,r):i(t,r)}},e.PathsLoader=function(t,r){var i=t.paths.reduceRight(function(e,t){return function(i,a){var o=n.resolve(t,i);return r(o,a).fail(function(t){if(/^Can't find /.test(t.message))return e(i,a);throw t})}},function(e){throw Error("Can't find "+JSON.stringify(e)+" from paths "+JSON.stringify(t.paths)+" in package at "+JSON.stringify(t.location))});return function(t,n){return e.isAbsolute(t)?r(t,n):i(t,n)}},e.MemoizedLoader=function(e,t){var n=e.cache=e.cache||{};return l(t,n)};var s=function(e){var t=/^(.*)\.js$/.exec(e);return t&&(e=t[1]),e},l=function(e,n){return n=n||{},function(r,i){return a(n,r)||(n[r]=t.fcall(e,r,i)),n[r]}}}),bootstrap("require/browser",function(e){function t(e){return 200===e.status||0===e.status&&e.responseText}var n=e("require"),r=e("promise"),i=e("mini-url"),a="GET",o="application/javascript",s="file:",l=void 0!==l?l:window;n.getLocation=function(){return i.resolve(window.location,".")},n.overlays=["window","browser","montage"],n.read=function(e){function n(){t(u)?c.resolve(u.responseText):l()}function l(){c.reject(Error("Can't XHR "+JSON.stringify(e)))}if(0===i.resolve(window.location,e).indexOf(s))throw Error("XHR does not function for file: protocol");var u=new XMLHttpRequest,c=r.defer();try{u.open(a,e,!0),u.overrideMimeType&&u.overrideMimeType(o),u.onreadystatechange=function(){4===u.readyState&&n()},u.onload=u.load=n,u.onerror=u.error=l}catch(h){c.reject(h.message,h)}return u.send(),c.promise};var u=eval;l.navigator&&l.navigator.userAgent.indexOf("Firefox")>=0&&(u=Function("_","return eval(_)"));var c="__FILE__",h="__",d="(function ",p="(require, exports, module) {",f="//*/\n})\n//@ sourceURL=";n.Compiler=function(e){return function(t){if(t.factory||void 0===t.text)return t;if(e.useScriptInjection)throw Error("Can't use eval.");var n=c+t.location.replace(/\.\w+$|\W/g,h);try{t.factory=u(d+n+p+t.text+f+t.location)}catch(r){throw r.message=r.message+" in "+t.location,r}t.factory.displayName=n}},n.XhrLoader=function(e){return function(t,n){return e.read(t).then(function(e){n.type="javascript",n.text=e,n.location=t})}};var m={},v=function(e,t){return m[e]=m[e]||{},m[e][t]=m[e][t]||r.defer(),m[e][t]},g=function(e,t,r){r&&r.isPending()?r.then(function(){t.isPending()&&n.loadScript(e)}).done():t.isPending()&&n.loadScript(e)};montageDefine=function(e,t,n){v(e,t).resolve(n)},n.loadScript=function(e){var t=document.createElement("script");t.onload=function(){t.parentNode.removeChild(t)},t.onerror=function(){t.parentNode.removeChild(t)},t.src=e,t.defer=!0,document.getElementsByTagName("head")[0].appendChild(t)},n.ScriptLoader=function(e){var t=e.packageDescription.hash;return function(n,a){return r.fcall(function(){if(m[t]&&m[t][a.id])return m[t][a.id].promise;/\.js$/.test(n)?n=n.replace(/\.js/,".load.js"):n+=".load.js";var r=v(t,a.id).promise;return g(n,r,e.preloaded),r}).then(function(e){delete m[t][a.id];for(var r in e)a[r]=e[r];a.location=n,a.directory=i.resolve(n,".")})}};var b=n.loadPackageDescription;n.loadPackageDescription=function(e,t){if(e.hash){var n=v(e.hash,"package.json").promise,r=i.resolve(e.location,"package.json.load.js");return g(r,n,t.preloaded),n.get("exports")}return b(e,t)},n.makeLoader=function(e){var t;return t=e.useScriptInjection?n.ScriptLoader:n.XhrLoader,n.MappingsLoader(e,n.ExtensionsLoader(e,n.PathsLoader(e,n.MemoizedLoader(e,t(e)))))}}),function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()}(function(){"use strict";function e(e){return function(){return K.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===rt(e)||e instanceof H}function r(e,t){if(W&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(at)){for(var n=[],r=t;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(e.stack);var a=n.join("\n"+at+"\n");e.stack=i(a)}}function i(e){for(var t=e.split("\n"),n=[],r=0;t.length>r;++r){var i=t[r];s(i)||a(i)||!i||n.push(i)}return n.join("\n")}function a(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function o(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function s(e){var t=o(e);if(!t)return!1;var n=t[0],r=t[1];return n===V&&r>=Y&&ct>=r}function l(){if(W)try{throw Error()}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],r=o(n);if(!r)return;return V=r[0],r[1]}}function u(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",Error("").stack),e.apply(e,arguments)}}function c(e){return g(e)?e:b(e)?k(e):P(e)}function h(){function e(e){t=e,a.source=e,Z(n,function(t,n){X(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],i=et(h.prototype),a=et(f.prototype);if(a.promiseDispatch=function(e,i,a){var o=J(arguments);n?(n.push(o),"when"===i&&a[1]&&r.push(a[1])):X(function(){t.promiseDispatch.apply(t,o)})},a.valueOf=u(function(){if(n)return a;var e=v(t);return g(e)&&(t=e),e},"valueOf","inspect"),a.inspect=function(){return t?t.inspect():{state:"pending"}},c.longStackSupport&&W)try{throw Error()}catch(o){a.stack=o.stack.substring(o.stack.indexOf("\n")+1)}return i.promise=a,i.resolve=function(n){t||e(c(n))},i.fulfill=function(n){t||e(P(n))},i.reject=function(n){t||e(T(n))},i.notify=function(e){t||Z(r,function(t,n){X(function(){n(e)})},void 0)},i}function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=h();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function p(e){return d(function(t,n){for(var r=0,i=e.length;i>r;r++)c(e[r]).then(t,n)})}function f(e,t,n){void 0===t&&(t=function(e){return T(Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=et(f.prototype);if(r.promiseDispatch=function(n,i,a){var o;try{o=e[i]?e[i].apply(r,a):t.call(r,i,a)}catch(s){o=T(s)}n&&n(o)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=u(function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value})}return r}function m(e,t,n,r){return c(e).then(t,n,r)}function v(e){if(g(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function g(e){return t(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function b(e){return t(e)&&"function"==typeof e.then}function _(e){return g(e)&&"pending"===e.inspect().state}function y(e){return!g(e)||"fulfilled"===e.inspect().state}function w(e){return g(e)&&"rejected"===e.inspect().state}function E(){lt||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",ot),lt=!0}function C(){for(var e=0;ot.length>e;e++){var t=ot[e];console.warn("Unhandled rejection reason:",t)}}function x(){ot.length=0,st.length=0,lt=!1,ut||(ut=!0,"undefined"!=typeof process&&process.on&&process.on("exit",C))}function O(e,t){ut&&(st.push(e),t&&void 0!==t.stack?ot.push(t.stack):ot.push("(no stack) "+t),E())}function S(e){if(ut){var t=$(st,e);-1!==t&&(st.splice(t,1),ot.splice(t,1))}}function T(e){var t=f({when:function(t){return t&&S(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return O(t,e),t}function P(e){return f({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return nt(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function k(e){var t=h();return X(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function D(e){return f({isDef:function(){}},function(t,n){return I(e,t,n)},function(){return c(e).inspect()})}function M(e,t,n){return c(e).spread(t,n)}function L(e){return function(){function t(e,t){var o;if(it){try{o=r[e](t)}catch(s){return T(s)}return o.done?o.value:m(o.value,i,a)}try{o=r[e](t)}catch(s){return n(s)?s.value:T(s)}return m(o,i,a)}var r=e.apply(this,arguments),i=t.bind(t,"next"),a=t.bind(t,"throw");return i()}}function j(e){c.done(c.async(e)())}function A(e){throw new H(e)}function R(e){return function(){return M([this,z(arguments)],function(t,n){return e.apply(t,n)})}}function I(e,t,n){return c(e).dispatch(t,n)}function z(e){return m(e,function(e){var t=0,n=h();return Z(e,function(r,i,a){var o;g(i)&&"fulfilled"===(o=i.inspect()).state?e[a]=o.value:(++t,m(i,function(r){e[a]=r,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:a,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function B(e){return m(e,function(e){return e=Q(e,c),m(z(Q(e,function(e){return m(e,G,G)})),function(){return e})})}function N(e){return c(e).allSettled()}function F(e,t){return c(e).then(void 0,void 0,t)}function q(e,t){return c(e).nodeify(t)}var W=!1;try{throw Error()}catch(U){W=!!U.stack}var V,H,Y=l(),G=function(){},X=function(){function e(){for(;t.next;){t=t.next;var n=t.task;t.task=void 0;var i=t.domain;i&&(t.domain=void 0,i.enter());try{n()}catch(o){if(a)throw i&&i.exit(),setTimeout(e,0),i&&i.enter(),o;setTimeout(function(){throw o},0)}i&&i.exit()}r=!1}var t={task:void 0,next:null},n=t,r=!1,i=void 0,a=!1;if(X=function(e){n=n.next={task:e,domain:a&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)a=!0,i=function(){process.nextTick(e)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var o=new MessageChannel;o.port1.onmessage=function(){i=s,o.port1.onmessage=e,e()};var s=function(){o.port2.postMessage(0)};i=function(){setTimeout(e,0),s()}}else i=function(){setTimeout(e,0)};return X}(),K=Function.call,J=e(Array.prototype.slice),Z=e(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(t=e(t,this[n],n));return t}),$=e(Array.prototype.indexOf||function(e){for(var t=0;this.length>t;t++)if(this[t]===e)return t;return-1}),Q=e(Array.prototype.map||function(e,t){var n=this,r=[];return Z(n,function(i,a,o){r.push(e.call(t,a,o,n))},void 0),r}),et=Object.create||function(e){function t(){}return t.prototype=e,new t},tt=e(Object.prototype.hasOwnProperty),nt=Object.keys||function(e){var t=[];for(var n in e)tt(e,n)&&t.push(n);return t},rt=e(Object.prototype.toString);H="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var it;try{Function("(function* (){ yield 1; })"),it=!0}catch(U){it=!1}var at="From previous event:";c.resolve=c,c.nextTick=X,c.longStackSupport=!1,c.defer=h,h.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(J(arguments,1)):e.resolve(n)}},c.promise=d,c.passByCopy=function(e){return e},f.prototype.passByCopy=function(){return this},c.join=function(e,t){return c(e).join(t)},f.prototype.join=function(e){return c([this,e]).spread(function(e,t){if(e===t)return e;throw Error("Can't join: not the same: "+e+" "+t)})},c.race=p,f.prototype.race=function(){return this.then(c.race)},c.makePromise=f,f.prototype.toString=function(){return"[object Promise]"},f.prototype.then=function(e,t,n){function i(t){try{return"function"==typeof e?e(t):t}catch(n){return T(n)}}function a(e){if("function"==typeof t){r(e,s);try{return t(e)}catch(n){return T(n)}}return T(e)}function o(e){return"function"==typeof n?n(e):e}var s=this,l=h(),u=!1;return X(function(){s.promiseDispatch(function(e){u||(u=!0,l.resolve(i(e)))},"when",[function(e){u||(u=!0,l.resolve(a(e)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=o(e)}catch(r){if(n=!0,!c.onerror)throw r;c.onerror(r)}n||l.notify(t)}]),l.promise},c.when=m,f.prototype.thenResolve=function(e){return this.then(function(){return e})},c.thenResolve=function(e,t){return c(e).thenResolve(t)},f.prototype.thenReject=function(e){return this.then(function(){throw e})},c.thenReject=function(e,t){return c(e).thenReject(t)},c.nearer=v,c.isPromise=g,c.isPromiseAlike=b,c.isPending=_,f.prototype.isPending=function(){return"pending"===this.inspect().state},c.isFulfilled=y,f.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},c.isRejected=w,f.prototype.isRejected=function(){return"rejected"===this.inspect().state};var ot=[],st=[],lt=!1,ut=!0;c.resetUnhandledRejections=x,c.getUnhandledReasons=function(){return ot.slice()},c.stopUnhandledRejectionTracking=function(){x(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",C),ut=!1},x(),c.reject=T,c.fulfill=P,c.master=D,c.spread=M,f.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},c.async=L,c.spawn=j,c["return"]=A,c.promised=R,c.dispatch=I,f.prototype.dispatch=function(e,t){var n=this,r=h();return X(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},c.get=function(e,t){return c(e).dispatch("get",[t])},f.prototype.get=function(e){return this.dispatch("get",[e])},c.set=function(e,t,n){return c(e).dispatch("set",[t,n])},f.prototype.set=function(e,t){return this.dispatch("set",[e,t])},c.del=c["delete"]=function(e,t){return c(e).dispatch("delete",[t])},f.prototype.del=f.prototype["delete"]=function(e){return this.dispatch("delete",[e])},c.mapply=c.post=function(e,t,n){return c(e).dispatch("post",[t,n])},f.prototype.mapply=f.prototype.post=function(e,t){return this.dispatch("post",[e,t])},c.send=c.mcall=c.invoke=function(e,t){return c(e).dispatch("post",[t,J(arguments,2)])},f.prototype.send=f.prototype.mcall=f.prototype.invoke=function(e){return this.dispatch("post",[e,J(arguments,1)])
},c.fapply=function(e,t){return c(e).dispatch("apply",[void 0,t])},f.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},c["try"]=c.fcall=function(e){return c(e).dispatch("apply",[void 0,J(arguments,1)])},f.prototype.fcall=function(){return this.dispatch("apply",[void 0,J(arguments)])},c.fbind=function(e){var t=c(e),n=J(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(J(arguments))])}},f.prototype.fbind=function(){var e=this,t=J(arguments);return function(){return e.dispatch("apply",[this,t.concat(J(arguments))])}},c.keys=function(e){return c(e).dispatch("keys",[])},f.prototype.keys=function(){return this.dispatch("keys",[])},c.all=z,f.prototype.all=function(){return z(this)},c.allResolved=u(B,"allResolved","allSettled"),f.prototype.allResolved=function(){return B(this)},c.allSettled=N,f.prototype.allSettled=function(){return this.then(function(e){return z(Q(e,function(e){function t(){return e.inspect()}return e=c(e),e.then(t,t)}))})},c.fail=c["catch"]=function(e,t){return c(e).then(void 0,t)},f.prototype.fail=f.prototype["catch"]=function(e){return this.then(void 0,e)},c.progress=F,f.prototype.progress=function(e){return this.then(void 0,void 0,e)},c.fin=c["finally"]=function(e,t){return c(e)["finally"](t)},f.prototype.fin=f.prototype["finally"]=function(e){return e=c(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},c.done=function(e,t,n,r){return c(e).done(t,n,r)},f.prototype.done=function(e,t,n){var i=function(e){X(function(){if(r(e,a),!c.onerror)throw e;c.onerror(e)})},a=e||t||n?this.then(e,t,n):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),a.then(void 0,i)},c.timeout=function(e,t,n){return c(e).timeout(t,n)},f.prototype.timeout=function(e,t){var n=h(),r=setTimeout(function(){n.reject(Error(t||"Timed out after "+e+" ms"))},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},c.delay=function(e,t){return void 0===t&&(t=e,e=void 0),c(e).delay(t)},f.prototype.delay=function(e){return this.then(function(t){var n=h();return setTimeout(function(){n.resolve(t)},e),n.promise})},c.nfapply=function(e,t){return c(e).nfapply(t)},f.prototype.nfapply=function(e){var t=h(),n=J(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},c.nfcall=function(e){var t=J(arguments,1);return c(e).nfapply(t)},f.prototype.nfcall=function(){var e=J(arguments),t=h();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},c.nfbind=c.denodeify=function(e){var t=J(arguments,1);return function(){var n=t.concat(J(arguments)),r=h();return n.push(r.makeNodeResolver()),c(e).fapply(n).fail(r.reject),r.promise}},f.prototype.nfbind=f.prototype.denodeify=function(){var e=J(arguments);return e.unshift(this),c.denodeify.apply(void 0,e)},c.nbind=function(e,t){var n=J(arguments,2);return function(){function r(){return e.apply(t,arguments)}var i=n.concat(J(arguments)),a=h();return i.push(a.makeNodeResolver()),c(r).fapply(i).fail(a.reject),a.promise}},f.prototype.nbind=function(){var e=J(arguments,0);return e.unshift(this),c.nbind.apply(void 0,e)},c.nmapply=c.npost=function(e,t,n){return c(e).npost(t,n)},f.prototype.nmapply=f.prototype.npost=function(e,t){var n=J(t||[]),r=h();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},c.nsend=c.nmcall=c.ninvoke=function(e,t){var n=J(arguments,2),r=h();return n.push(r.makeNodeResolver()),c(e).dispatch("post",[t,n]).fail(r.reject),r.promise},f.prototype.nsend=f.prototype.nmcall=f.prototype.ninvoke=function(e){var t=J(arguments,1),n=h();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},c.nodeify=q,f.prototype.nodeify=function(e){return e?(this.then(function(t){X(function(){e(null,t)})},function(t){X(function(){e(t)})}),void 0):this};var ct=l();return c}),montageDefine("a3c0bdf","package.json",{exports:{name:"montagejs.org",version:"0.0.0","private":!0,dependencies:{montage:"0.13.9",digit:"0.4.0"},devDependencies:{mop:"~0.13.0"},directories:{lib:"./"},hash:"a3c0bdf",mappings:{montage:{name:"montage",hash:"d407295",location:"packages/montage@d407295/"},digit:{name:"digit",hash:"f177794",location:"packages/digit@f177794/"}},production:!0,useScriptInjection:!0}}),montageDefine("d407295","package.json",{exports:{name:"montage",version:"0.13.9",description:"A UI Framework",repository:{type:"git",url:"https://github.com/montagejs/montage.git"},main:"core/core",dependencies:{collections:"~0.2.1",frb:"~0.2.15",mousse:"~0.1.2",htmlparser2:"~3.0.5"},devDependencies:{"montage-testing":"~0.2.0",mr:"~0.13.0",q:"0.9.6","q-io":"~1.7.2",jshint:"~2.0.1"},scripts:{test:"node test/node/node-spec.js",jsdoc:"node ../montagejs.org/build/jsdoc/jsdoc.js -out $PWD/builds/jsdoc/ montage@npm-link"},exclude:["etc","lab","node.js","test","tools"],readmeFilename:"README.md",bugs:{url:"https://github.com/montagejs/montage/issues"},homepage:"https://github.com/montagejs/montage",_id:"montage@0.13.9",dist:{shasum:"986863036f07d19e65f7cae3167c067db93a7c23"},_from:"montage@0.13.9",_resolved:"https://registry.npmjs.org/montage/-/montage-0.13.9.tgz",mappings:{mr:{name:"mr",hash:"5354c1a",location:"../mr@5354c1a/"},q:{name:"q",hash:"af41415",location:"../q@af41415/"},collections:{name:"collections",hash:"fdadc45",location:"../collections@fdadc45/"},frb:{name:"frb",hash:"eabe77a",location:"../frb@eabe77a/"},mousse:{name:"mousse",hash:"dba904f",location:"../mousse@dba904f/"},htmlparser2:{name:"htmlparser2",hash:"e15e80f",location:"../htmlparser2@e15e80f/"}},directories:{lib:"./"},hash:"d407295",production:!0,useScriptInjection:!0}}),montageDefine("fdadc45","package.json",{exports:{name:"collections",version:"0.2.2",description:"data structures with idiomatic JavaScript collection interfaces",homepage:"http://github.com/montagejs/collections",author:{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal"},keywords:["collections","data structures","observable","list","set","map","splay"],bugs:{url:"http://github.com/montagejs/collections/issues"},licenses:[{type:"MIT",url:"https://raw.github.com/montagejs/collections/master/LICENSE.md"}],repository:{type:"git",url:"http://github.com/montagejs/collections.git"},dependencies:{"weak-map":"1.0.0"},devDependencies:{"jasmine-node":"*",istanbul:"*",opener:"*"},scripts:{test:"jasmine-node spec",cover:"istanbul cover node_modules/jasmine-node/bin/jasmine-node spec && istanbul report html && opener coverage/index.html"},readmeFilename:"README.md",_id:"collections@0.2.2",_from:"collections@~0.2.1",directories:{lib:"./"},hash:"fdadc45",mappings:{"weak-map":{name:"weak-map",hash:"1af4c9e",location:"../weak-map@1af4c9e/"}},production:!0,useScriptInjection:!0}}),montageDefine("dba904f","package.json",{exports:{name:"mousse",version:"0.1.5",description:"Deserialization of JavaScript objects",keywords:["deserialization","serialization"],author:{name:"António Afonso",email:"antonio.afonso@gmail.com",url:"http://github.com/aadsm/"},contributors:[{name:"António Afonso",email:"antonio.afonso@gmail.com",url:"http://github.com/aadsm/"}],bugs:{url:"http://github.com/montagejs/mousse/issues"},licenses:[{type:"BSD",url:"http://github.com/montagejs/mousse/raw/master/LICENSE.md"}],repository:{type:"git",url:"http://github.com/montagejs/mousse.git"},main:"mousse",dependencies:{q:"~0.9.6",collections:"~0.1.21"},devDependencies:{"jasmine-node":"~1.9.1"},scripts:{test:"./node_modules/.bin/jasmine-node spec"},readmeFilename:"README.md",homepage:"https://github.com/montagejs/mousse",_id:"mousse@0.1.5",_from:"mousse@~0.1.2",directories:{lib:"./"},hash:"dba904f",mappings:{q:{name:"q",hash:"af41415",location:"../q@af41415/"},collections:{name:"collections",hash:"fdadc45",location:"../collections@fdadc45/"}},production:!0,useScriptInjection:!0}}),montageDefine("1af4c9e","package.json",{exports:{name:"weak-map",version:"1.0.0",main:"weak-map.js",_id:"weak-map@1.0.0",_from:"weak-map@1.0.0",scripts:{},directories:{lib:"./"},hash:"1af4c9e",mappings:{},production:!0,useScriptInjection:!0}}),montageDefine("af41415","package.json",{exports:{name:"q",version:"0.9.7",description:"A library for promises (CommonJS/Promises/A,B,D)",homepage:"https://github.com/kriskowal/q",author:"Kris Kowal <kris@cixar.com> (https://github.com/kriskowal)",keywords:["q","promise","promises","promises-a","promises-aplus","deferred","future","async","flow control","fluent","browser","node"],contributors:["Kris Kowal <kris@cixar.com> (https://github.com/kriskowal)","Irakli Gozalishvili <rfobic@gmail.com> (http://jeditoolkit.com)","Domenic Denicola <domenic@domenicdenicola.com> (http://domenicdenicola.com)"],bugs:{mail:"kris@cixar.com",url:"http://github.com/kriskowal/q/issues"},license:{type:"MIT",url:"http://github.com/kriskowal/q/raw/master/LICENSE"},main:"q.js",repository:{type:"git",url:"git://github.com/kriskowal/q.git"},engines:{node:">=0.6.0",teleport:">=0.2.0"},dependencies:{},devDependencies:{jshint:"~2.1.9",cover:"*","jasmine-node":"1.11.0",opener:"*","promises-aplus-tests":"1.x",grunt:"~0.4.1","grunt-cli":"~0.1.9","grunt-contrib-uglify":"~0.2.2",matcha:"~0.2.0"},scripts:{test:"jasmine-node spec && promises-aplus-tests spec/aplus-adapter","test-browser":"opener spec/q-spec.html",benchmark:"matcha",lint:"jshint q.js",cover:"cover run node_modules/jasmine-node/bin/jasmine-node spec && cover report html && opener cover_html/index.html",minify:"grunt",prepublish:"grunt"},directories:{test:"./spec",lib:"./"},hash:"af41415",mappings:{},production:!0,useScriptInjection:!0}}),montageDefine("eabe77a","package.json",{exports:{name:"frb",version:"0.2.16",description:"Functional reactive bindings",keywords:["functional","reactive","bindings","observe","change"],author:{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal/"},contributors:[{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal/"}],bugs:{url:"http://github.com/kriskowal/frb/issues"},licenses:[{type:"MIT",url:"http://github.com/kriskowal/frb/raw/master/LICENSE.md"}],repository:{type:"git",url:"http://github.com/kriskowal/frb.git"},main:"bindings",dependencies:{collections:"~0.2.2"},devDependencies:{"jasmine-node":"1.x.x",pegjs:"git://github.com/dmajda/pegjs.git"},scripts:{test:"jasmine-node spec","build-parser":"pegjs --allowed-start-rules expression,sheet grammar.pegjs"},readmeFilename:"README.md",homepage:"https://github.com/kriskowal/frb",_id:"frb@0.2.16",_from:"frb@~0.2.15",directories:{lib:"./"},hash:"eabe77a",mappings:{collections:{name:"collections",hash:"fdadc45",location:"../collections@fdadc45/"}},production:!0,useScriptInjection:!0}}),montageDefine("f177794","package.json",{exports:{name:"digit",version:"0.4.0",repository:{type:"git",url:"https://github.com/montagejs/digit.git"},dependencies:{montage:"~0.13.8",matte:"~0.1.4"},devDependencies:{"montage-testing":"~0.2.0"},exclude:["overview.html","overview","run-tests.html","test"],readmeFilename:"README.md",description:"![digit](overview/assets/images/icon.png)",bugs:{url:"https://github.com/montagejs/digit/issues"},homepage:"https://github.com/montagejs/digit",_id:"digit@0.4.0",dist:{shasum:"0a66e5a8c82db7621cd311d2b9d05aaabdfe860a"},_from:"digit@0.4.0",_resolved:"https://registry.npmjs.org/digit/-/digit-0.4.0.tgz",directories:{lib:"./"},hash:"f177794",mappings:{montage:{name:"montage",hash:"d407295",location:"../montage@d407295/"},matte:{name:"matte",hash:"81833cd",location:"../matte@81833cd/"}},production:!0,useScriptInjection:!0}}),montageDefine("a3c0bdf","index.html",{text:'<div data-montage-id=features></div>\n<script src=packages/montage@d407295/montage.js></script>\n<script type=text/montage-serialization>{"features":{"prototype":"ui/features.reel","properties":{"element":{"#":"features"}}}}</script>'}),montageDefine("a3c0bdf","ui/features.reel/features",{dependencies:["montage","montage/ui/component"],factory:function(e,t){var n=e("montage").Montage,r=e("montage/ui/component").Component;t.Features=n.create(r,{hasTemplate:{value:!0},convert:{value:function(e){return""+Number(Math.round(e))}},revert:{value:function(e){return""+Number(Math.round(e))}}})}}),montageDefine("a3c0bdf","ui/features.reel/features.html",{text:'<!DOCTYPE html>\n<html>\n<head>\n    <title></title>\n    <link rel=stylesheet href=features.css>\n    <script type=text/montage-serialization>{"owner":{"prototype":"ui/features.reel","properties":{"element":{"#":"component"}}},"number":{"prototype":"digit/ui/number-field.reel","properties":{"element":{"#":"number"},"min":0,"max":100,"step":1},"bindings":{"value":{"<->":"@slider.value"}}},"slider":{"prototype":"digit/ui/slider.reel","properties":{"element":{"#":"slider"},"min":0,"max":100,"step":1,"value":50}},"numberValue":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"numberValue"}},"bindings":{"value":{"<-":"@number.value","converter":{"@":"owner"}}}},"rangeValue":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"rangeValue"}},"bindings":{"value":{"<-":"@number.value","converter":{"@":"owner"}}}}}</script>\n\n</head>\n<body>\n\n    <div data-montage-id=component class=features data-montage-skin=light>\n        <ul>\n            <li>\n                <input type=number data-montage-id=number value=50>\n            </li>\n            <li class=arrow>↕</li>\n            <li>\n                <input type=range data-montage-id=slider value=50>\n            </li>\n        </ul>\n\n        <div class="block markup">\n<pre>\n&lt;input data-montage-id="<span class=hl-number>number</span>" type="number" value="<span data-montage-id=numberValue class=hl-value>0</span>"&gt;\n&lt;input data-montage-id="<span class=hl-range>slider</span>" type="range" value="<span data-montage-id=rangeValue class=hl-value>0</span>"&gt;\n</pre>\n        </div>\n\n        <div class="block serialization">\n<pre>\n"number": {\n    "prototype": "digit/ui/number-field.reel",\n    "properties": { "element": {"#": "<span class=hl-number>number</span>"} }\n},\n"slider": {\n    "prototype": "digit/ui/slider.reel",\n    "properties": { "element": {"#": "<span class=hl-range>slider</span>"} },\n    <span class=hl-bindings>"bindings": { "value": {"&lt;-&gt;": "@number.value"} }</span>\n}\n</pre>\n        </div>\n    </div>\n\n</body>\n</html>'}),montageDefine("d407295","core/core",{dependencies:["collections/shim","core/shim/object","core/shim/array","core/shim/string","core/extras/object","core/extras/date","core/extras/element","core/extras/function","core/extras/regexp","core/extras/string","core/uuid","collections/listen/property-changes","core/bindings","core/paths","core/serialization/bindings","core/promise"],factory:function(e,t){function n(e,t){var a=i+t+r;return e.hasOwnProperty(a)?e[a]:Object.defineProperty(e,a,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(n(Object.getPrototypeOf(e),t))})[a]}e("collections/shim"),e("core/shim/object"),e("core/shim/array"),e("core/shim/string"),e("core/extras/object"),e("core/extras/date"),e("core/extras/element"),e("core/extras/function"),e("core/extras/regexp"),e("core/extras/string");var r="AttributeProperties",i="_",a="__proto__",o="value",s="enumerable",l="distinct",u="serializable",c=Array.prototype,h=Object.prototype,d=!0,p=t.Montage=function p(){};p.deprecate=function(e,t,n,r){var i=function(){var i=Error.stackTraceLimit;return Error.stackTraceLimit=2,"undefined"!=typeof console&&"function"==typeof console.warn&&(r?console.warn(n+" is deprecated, use "+r+" instead.",Error("").stack):console.warn(n,Error("").stack)),Error.stackTraceLimit=i,t.apply(e?e:this,arguments)};return i.deprecatedFunction=t,i},p.callDeprecatedFunction=function(e,t,n,r){var i,a,o=Error.stackTraceLimit;return Error.stackTraceLimit=2,"undefined"!=typeof console&&"function"==typeof console.warn&&(i=p.getInfoForObject(e).objectName,r?console.warn(n+" is deprecated, use "+r+" instead.",i):console.warn(n,i)),Error.stackTraceLimit=o,a=c.slice.call(arguments,4),t.apply(e?e:this,a)};var f={}.__proto__===Object.prototype,m={_montage_metadata:1,__state__:1},v=Object.getOwnPropertyNames(Function);if(Object.defineProperty(p,"specialize",{value:function(e,t){var n,r,i,a,o,s,l,u=this,c=void 0===this.specialize;if(e=e||Object.empty,t=t||Object.empty,n=e.constructor&&e.constructor.value?e.constructor.value:e.didCreate&&e.didCreate.value?p.deprecate(null,e.didCreate.value,"didCreate","constructor"):function(){return u.apply(this,arguments)||this},f)n.__proto__=u;else{i=Object.getOwnPropertyNames(u);for(var s=0;i.length>s;s++)a=i[s],m.hasOwnProperty(a)||(o=Object.getOwnPropertyDescriptor(n,a),(!o||o.configurable)&&p.defineProperty(n,a,Object.getOwnPropertyDescriptor(u,a)));n.__constructorProto__=u,p.defineProperty(n,"isPrototypeOf",{value:function(e){for(;null!==e;){if(Object.getPrototypeOf(e)===this)return!0;e=Object.getPrototypeOf(e)}return!1},enumerable:!1})}if(r=Object.create(this.prototype),c){for(i=Object.getOwnPropertyNames(p),s=0;i.length>s;s++)a=i[s],o=Object.getOwnPropertyDescriptor(n,a),(!o||o.configurable)&&p.defineProperty(n,a,Object.getOwnPropertyDescriptor(p,a));for(i=Object.getOwnPropertyNames(p.prototype),s=0;i.length>s;s++)a=i[s],o=Object.getOwnPropertyDescriptor(n,a),(!o||o.configurable)&&p.defineProperty(r,a,Object.getOwnPropertyDescriptor(p.prototype,a))}if(p.defineProperties(r,e),d){l=function(e,t,n){function r(){return this===t&&console.warn("Deprecated - "+p.getInfoForObject(t).objectName+"."+n+" should be moved to constructorProperties"),e.apply(this,arguments)}return r.deprecatedFunction=e,r};for(a in e)v.has(a)?delete e[a]:(o=e[a],o.value&&"function"==typeof o.value&&!o.value.__isConstructor__?o.value=l(o.value,n,a):(o.get&&(o.get=l(o.get,n,a)),o.set&&(o.set=l(o.set,n,a))));p.defineProperties(n,e),p.defineProperty(n,"create",{value:function(){return new n},enumerable:!1}),r.hasOwnProperty("didCreate")||p.defineProperty(r,"didCreate",{value:n,enumerable:!1}),n.hasOwnProperty("didCreate")||p.defineProperty(n,"didCreate",{value:n,enumerable:!1})}return p.defineProperties(n,t),p.defineProperty(n,"__isConstructor__",{value:!0,enumerable:!1}),n.prototype=r,p.defineProperty(r,"constructor",{value:n,enumerable:!1}),n},writable:!0,configurable:!0,enumerable:!1}),!f){var g=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return"function"==typeof e&&e.__constructorProto__?e.__constructorProto__:g.apply(Object,arguments)}}Object.defineProperty(p,"create",{configurable:!0,value:function(e,t){if(void 0!==e&&"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null, not '"+e+"'");if(e=void 0===e?this:e,"function"==typeof e)return t?e.specialize(t):new e;var n=Object.create(e);return t&&p.defineProperties(n,t),n}});var b=[u];b.forEach(function(e){Object.defineProperty(Object.prototype,i+e+r,{enumerable:!1,configurable:!1,writable:!0,value:{}})}),Object.defineProperty(p,"defineProperty",{value:function(e,t,r){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object must be an object, not '"+e+"'");var d=o in r;if(l in r&&!d)throw"Cannot use distinct attribute on non-value property '"+t+"'";if(a in r)r.__proto__=d?"function"==typeof r.value?w:y:_;else{var p;p=d?"function"==typeof r.value?w:y:_;for(var f in p)f in r||(r[f]=p[f])}return r.hasOwnProperty(s)||t.charAt(0)!==i||(r.enumerable=!1),r.hasOwnProperty(u)||(r.enumerable?r.get&&!r.set?r.serializable=!1:r.writable===!1&&(r.serializable=!1):r.serializable=!1),u in r&&(n(e,u)[t]=r.serializable),r.distinct!==!0||"object"!=typeof r.value?Object.defineProperty(e,t,r):(function(e,t,n,r){var i=function(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})};n.constructor===Object&&Object.getPrototypeOf(n)===h?0!==Object.keys(n).length?Object.defineProperty(r,e,{configurable:!0,get:function(){var e=this[t];if(!e){var r;e={};for(r in n)e[r]=n[r];this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}return e},set:function(e){this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}}):Object.defineProperty(r,e,{configurable:!0,get:function(){var e=this[t];return e||(e={},this.hasOwnProperty(t)?this[t]=e:i(this,t,e)),e},set:function(e){this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}}):(n.__proto__||Object.getPrototypeOf(n))===c?0!==n.length?Object.defineProperty(r,e,{configurable:!0,get:function(){var e=this[t];if(!e){var r,a;for(e=[],r=0;void 0!==(a=n[r]);r++)e[r]=a;this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}return e},set:function(e){this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}}):Object.defineProperty(r,e,{configurable:!0,get:function(){var e=this[t];return e||(e=[],this.hasOwnProperty(t)?this[t]=e:i(this,t,e)),e},set:function(e){this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}}):n.constructor.prototype===Object.getPrototypeOf(n)?Object.defineProperty(r,e,{configurable:!0,get:function(){var e=this[t];if(!e){var r;e=new n.constructor;for(r in n)e[r]=n[r];this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}return e},set:function(e){this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}}):Object.defineProperty(r,e,{configurable:!0,get:function(){var e=this[t];return e||(e=Object.create(n.__proto__||Object.getPrototypeOf(n)),this.hasOwnProperty(t)?this[t]=e:i(this,t,e)),e},set:function(e){this.hasOwnProperty(t)?this[t]=e:i(this,t,e)}})}(t,i+t,r.value,e),void 0)}}),Object.defineProperty(p,"defineProperties",{value:function(e,t){if("object"!=typeof t||null===t)throw new TypeError("Properties must be an object, not '"+t+"'");for(var n in t)"_bindingDescriptors"!==n&&this.defineProperty(e,n,t[n]);return e}});var _={enumerable:!0,configurable:!0,serializable:!0},y={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},w={writable:!0,enumerable:!1,configurable:!0,serializable:!1};p.defineProperty(p,"didCreate",{value:Function.noop});var E=function(e,t){for(var n,r,i,a,o,s,l,u;void 0===l&&null!==e;){for(n=Object.getOwnPropertyNames(e),a=0,o=n.length,a;o>a;a++)if(r=n[a],i=Object.getOwnPropertyDescriptor(e,r),null!=(s=i.value)){if(s===t||s.deprecatedFunction&&s.deprecatedFunction===t){u=Object.getPropertyDescriptor(Object.getPrototypeOf(e),r),l=u?u.value:null;break}}else if(null!=(s=i.get)){if(s===t||s.deprecatedFunction&&s.deprecatedFunction===t){u=Object.getPropertyDescriptor(Object.getPrototypeOf(e),r),l=u?u.get:null;break}}else if(null!=(s=i.set)&&(s===t||s.deprecatedFunction&&s.deprecatedFunction===t)){u=Object.getPropertyDescriptor(Object.getPrototypeOf(e),r),l=u?u.set:null;break}e=Object.getPrototypeOf(e)}return l},C=function(){var e=E(this,C.caller);return"function"==typeof e?E(this,C.caller).bind(this):Function.noop};p.defineProperty(p,"super",{get:C}),p.defineProperty(p.prototype,"super",{get:C}),p.defineProperty(p,"getSerializablePropertyNames",{value:function(e){var t=[],n=e._serializableAttributeProperties;if(n)for(var r in n)n[r]&&t.push(r);return t}}),p.defineProperty(p,"getPropertyAttribute",{value:function(e,t,n){var a=i+n+r,o=e[a];return o?o[t]:void 0}}),p.defineProperty(p,"getPropertyAttributes",{value:function(e,t){var n={},a=i+t+r,o=e[a];if(o){for(var s in o)n[s]=o[s];return n}}});var x={isInstance:{value:!0}},O={objectName:{value:"Function"},isInstance:{value:!0}};p.defineProperty(p,"getInfoForObject",{value:function(e){var t,n;if(T.call(e,"_montage_metadata"))return e._montage_metadata;if(t=e._montage_metadata||e.constructor&&e.constructor._montage_metadata||null,n=e.constructor===Function?O:x,e===Object.prototype)return Object.create(t,n);try{return Object.defineProperty(e,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(t,n)})._montage_metadata}catch(r){return e._montage_metadata=Object.create(t,n)}}});var S=e("core/uuid");"undefined"!=typeof window&&(window.uuid=S.generate());var T=Object.prototype.hasOwnProperty,P=function(){var e=S.generate(),t=p.getInfoForObject(this);try{null!==t&&t.isInstance===!1?(this._uuid=e,Object.defineProperty(this,"uuid",{get:function(){return this.hasOwnProperty("uuid")?this._uuid:P.call(this)}})):(t.isInstance&&Object.defineProperty(this,"uuid",{configurable:!0,enumerable:!1,writable:!1,value:e}),!(this instanceof Element)&&t.isInstance&&o in(Object.getOwnPropertyDescriptor(this,"uuid")||{})&&a in this||(this._uuid=e))}catch(n){this._uuid=e}return e},k=function k(){return T.call(this,"_uuid")?this._uuid:P.call(this)};Object.defineProperty(Object.prototype,"_uuid",{enumerable:!1,value:null,writable:!0}),Object.defineProperty(Object.prototype,"uuid",{configurable:!0,get:k,set:function(){}}),p.defineProperty(p,"identifier",{value:null,serializable:!0}),p.defineProperty(p.prototype,"identifier",{value:null,serializable:!0}),p.defineProperty(p.prototype,"equals",{value:function(e){return e?this===e||this.uuid===e.uuid:!1}}),p.defineProperty(p,"equals",{value:p.prototype.equals}),p.defineProperty(p.prototype,"callDelegateMethod",{value:function(e){var t,n,r=this.delegate;return"string"==typeof this.identifier&&(t=this.identifier+e.toCapitalized(),r&&"function"==typeof(n=r[t]))?(c.shift.call(arguments),n.apply(r,arguments)):r&&"function"==typeof(n=r[e])?(c.shift.call(arguments),n.apply(r,arguments)):void 0}});var D=e("collections/listen/property-changes");Object.addEach(p,D.prototype),Object.addEach(p.prototype,D.prototype),e("core/bindings"),e("core/paths"),e("core/serialization/bindings"),t._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=p.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_blueprintModuleId")||!t._blueprintModuleId){e=p.getInfoForObject(t);var n=e.moduleId,r=n.lastIndexOf("/"),i=n.lastIndexOf(".");r=-1===r?0:r+1,i=-1===i?n.length:i,i=r>i?n.length:i,p.defineProperty(t,"_blueprintModuleId",{enumerable:!1,value:n.slice(0,i)+".meta"})}return t._blueprintModuleId}},t._blueprintDescriptor={serializable:!1,enumerable:!1,get:function(){var n=p.getInfoForObject(this),r=n&&!n.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(r,"_blueprint")||!r._blueprint){var i=r.blueprintModuleId;if(""===i)throw new TypeError("Blueprint moduleId undefined for the module '"+JSON.stringify(r)+"'");t._blueprintDescriptor.BlueprintModulePromise||(t._blueprintDescriptor.BlueprintModulePromise=e.async("core/meta/module-blueprint").get("ModuleBlueprint")),p.defineProperty(r,"_blueprint",{enumerable:!1,value:t._blueprintDescriptor.BlueprintModulePromise.then(function(e){var t=p.getInfoForObject(r);return e.getBlueprintWithModuleId(i,t.require).fail(function(t){if(-1!==t.message.indexOf("Can't XHR"))return e.createDefaultBlueprintForObject(r).then(function(e){return e});throw t})})})}return r._blueprint},set:function(t){var n,r=p.getInfoForObject(this),i=r&&!r.isInstance?this:this.constructor;if(null===t)n=null;else{if("function"==typeof t.then)throw new TypeError("Object blueprint should not be a promise");t.blueprintInstanceModule=i.blueprintModule,n=e("core/promise").Promise.resolve(t)}p.defineProperty(i,"_blueprint",{enumerable:!1,value:n})}}}}),montageDefine("d407295","core/event/event-manager",{dependencies:["montage","core/uuid","core/event/mutable-event","core/serialization"],factory:function(e,t){var n,r=e("montage").Montage,i=e("core/uuid"),a=e("core/event/mutable-event").MutableEvent,o=e("core/serialization").Serializer,s=e("core/serialization").Deserializer;if("undefined"!=typeof window){void 0===window.Touch&&"ontouchstart"in window&&(window.Touch=function(){},function(){var e;document.addEventListener("touchstart",e=function(t){window.Touch=t.touches[0].constructor,document.nativeRemoveEventListener?document.nativeRemoveEventListener("touchstart",e,!0):document.removeEventListener("touchstart",e,!0),n&&n.isStoringPointerEvents&&(n.isStoringPointerEvents=!1,n.isStoringPointerEvents=!0)},!0)}()),r.specialize({type:{value:null},listener:{value:null},capture:{value:null}}),o.defineSerializationUnit("listeners",function(e,t){var r,i,a,o=n,s=t.uuid,l=[];for(var u in o.registeredEventListeners)if(r=o.registeredEventListeners[u],i=r&&r[s])for(var c in i.listeners)a=i.listeners[c],l.push({type:u,listener:e.addObjectReference(a.listener),capture:a.capture});return l.length>0?l:void 0}),s.defineDeserializationUnit("listeners",function(e,t,n){for(var r,i=0;r=n[i];i++)t.addEventListener(r.type,r.listener,r.capture)});var l=Event.NONE,u=Event.CAPTURING_PHASE,c=Event.AT_TARGET,h=Event.BUBBLING_PHASE,d="function";t.EventManager=r.specialize({eventDefinitions:{value:{abort:{bubbles:!1,cancelable:!1},beforeunload:{bubbles:!1},blur:{bubbles:!1,cancelable:!1},change:{bubbles:!0,cancelable:!1},click:{bubbles:!0,cancelable:!0},close:{bubbles:!1,cancelable:!1},compositionend:{bubbles:!0,cancelable:!1},compositionstart:{bubbles:!0,cancelable:!0},compositionupdate:{bubbles:!0,cancelable:!1},contextmenu:{bubbles:!0,cancelable:!0},copy:{bubbles:!0,cancelable:!0},cut:{bubbles:!0,cancelable:!0},dblclick:{bubbles:!0,cancelable:!1},DOMActivate:{bubbles:!0,cancelable:!0,deprecated:!0},DOMMouseScroll:{bubbles:!0},drag:{bubbles:!0,cancelable:!0},dragend:{bubbles:!0,cancelable:!1},dragenter:{bubbles:!0,cancelable:!0},dragleave:{bubbles:!0,cancelable:!1},dragover:{bubbles:!0,cancelable:!0},dragstart:{bubbles:!0,cancelable:!0},drop:{bubbles:!0,cancelable:!0},error:{bubbles:function(e){return!(XMLHttpRequest.prototype.isPrototypeOf(e)||e.tagName&&"VIDEO"===e.tagName.toUpperCase()||e.tagName&&"AUDIO"===e.tagName.toUpperCase())},cancelable:!1},focus:{bubbles:!1,cancelable:!1},focusin:{bubbles:!0,cancelable:!1},focusout:{bubbles:!0,cancelable:!1},input:{bubbles:!0,cancelable:!1},keydown:{bubbles:!0,cancelable:!1},keypress:{bubbles:!0,cancelable:!1},keyup:{bubbles:!0,cancelable:!1},load:{bubbles:!1,cancelable:!1},loadend:{bubbles:!1,cancelable:!1},loadstart:{bubbles:!1,cancelable:!1},message:{bubbles:!1,cancelable:!1},mousedown:{bubbles:!0,cancelable:!0},mouseenter:{bubbles:!1,cancelable:!1},mouseleave:{bubbles:!1,cancelable:!1},mousemove:{bubbles:!0,cancelable:!0},mouseout:{bubbles:!0,cancelable:!0},mouseover:{bubbles:!0,cancelable:!0},mouseup:{bubbles:!0,cancelable:!0},mousewheel:{bubbles:!0},orientationchange:{bubbles:!1},paste:{bubbles:!0,cancelable:!0},progress:{bubbles:!1,cancelable:!1},reset:{bubbles:!0,cancelable:!1},resize:{bubbles:!1,cancelable:!1},scroll:{bubbles:function(e){return!!e.defaultView},cancelable:!1},select:{bubbles:!0,cancelable:!1},submit:{bubbles:!0,cancelable:!0},touchcancel:{bubbles:!0,cancelable:!1},touchend:{bubbles:!0,cancelable:!0},touchmove:{bubbles:!0,cancelable:!0},touchstart:{bubbles:!0,cancelable:!0},unload:{bubbles:!1,cancelable:!1},wheel:{bubbles:!0,cancelable:!0}}},_DOMPasteboardElement:{value:null,enumerable:!1},_delegate:{value:null,enumerable:!1},delegate:{enumerable:!1,get:function(){return this._delegate},set:function(e){this._delegate=e}},_application:{value:null,enumerable:!1},application:{enumerable:!1,get:function(){return this._application},set:function(e){this._application=e}},_registeredWindows:{value:null,enumerable:!1},_windowsAwaitingFinalRegistration:{value:{},enumerable:!1},initWithWindow:{enumerable:!1,value:function(e){if(this._registeredWindows)throw"EventManager has already been initialized";return this.registerWindow(e),this}},registerWindow:{enumerable:!1,value:function(e){if(e.defaultEventManager&&e.defaultEventManager!==this)throw"EventManager cannot register a window already registered to another EventManager";if(this._registeredWindows&&this._registeredWindows.indexOf(e)>=0)throw"EventManager cannot register a window more than once";if(this._registeredWindows||(this._registeredWindows=[]),e.uuid&&0!==e.uuid.length||(e.uuid=i.generate()),this._windowsAwaitingFinalRegistration[e.uuid]!==e){if(e.Element.prototype.nativeAddEventListener=e.Element.prototype.addEventListener,Object.defineProperty(e,"nativeAddEventListener",{configurable:!0,value:e.addEventListener}),Object.getPrototypeOf(e.document).nativeAddEventListener=e.document.addEventListener,e.XMLHttpRequest.prototype.nativeAddEventListener=e.XMLHttpRequest.prototype.addEventListener,e.Worker&&(e.Worker.prototype.nativeAddEventListener=e.Worker.prototype.addEventListener),e.MediaController&&(e.MediaController.prototype.nativeAddEventListener=e.MediaController.prototype.addEventListener),e.Element.prototype.nativeRemoveEventListener=e.Element.prototype.removeEventListener,Object.defineProperty(e,"nativeRemoveEventListener",{configurable:!0,value:e.removeEventListener}),Object.getPrototypeOf(e.document).nativeRemoveEventListener=e.document.removeEventListener,e.XMLHttpRequest.prototype.nativeRemoveEventListener=e.XMLHttpRequest.prototype.removeEventListener,e.Worker&&(e.Worker.prototype.nativeRemoveEventListener=e.Worker.prototype.removeEventListener),e.MediaController&&(e.MediaController.prototype.nativeRemoveEventListener=e.MediaController.prototype.removeEventListener),Object.defineProperty(e,"addEventListener",{configurable:!0,value:e.XMLHttpRequest.prototype.addEventListener=e.Element.prototype.addEventListener=Object.getPrototypeOf(e.document).addEventListener=function(t,n,r){return e.defaultEventManager.registerEventListener(this,t,n,!!r)
}}),e.Worker&&(e.Worker.prototype.addEventListener=e.addEventListener),e.MediaController&&(e.MediaController.prototype.addEventListener=e.addEventListener),Object.defineProperty(e,"removeEventListener",{configurable:!0,value:e.XMLHttpRequest.prototype.removeEventListener=e.Element.prototype.removeEventListener=Object.getPrototypeOf(e.document).removeEventListener=function(t,n,r){return e.defaultEventManager.unregisterEventListener(this,t,n,!!r)}}),e.Worker&&(e.Worker.prototype.removeEventListener=e.removeEventListener),e.MediaController&&(e.MediaController.prototype.removeEventListener=e.removeEventListener),e.HTMLDivElement.prototype.addEventListener!==e.Element.prototype.nativeAddEventListener&&e.HTMLElement&&"addEventListener"in e.HTMLElement.prototype&&e.Components&&e.Components.interfaces){var a,o;for(a in Components.interfaces)a.match(/^nsIDOMHTML\w*Element$/)&&(a=a.replace(/^nsIDOM/,""),(a=window[a])&&(o=a.prototype,o.nativeAddEventListener=o.addEventListener,o.addEventListener=e.Element.prototype.addEventListener,o.nativeRemoveEventListener=o.removeEventListener,o.removeEventListener=e.Element.prototype.removeEventListener))}r.defineProperty(e.Element.prototype,"eventHandlerUUID",{value:void 0,enumerable:!1}),r.defineProperty(e.Element.prototype,"component",{get:function(){return n._elementEventHandlerByUUID[this.eventHandlerUUID]},enumerable:!1}),n=e.defaultEventManager=t.defaultEventManager=this,this._registeredWindows.push(e),this._windowsAwaitingFinalRegistration[e.uuid]=e,/loaded|complete|interactive/.test(e.document.readyState)?this._finalizeWindowRegistration(e):e.document.addEventListener("DOMContentLoaded",this,!0)}}},_finalizeWindowRegistration:{enumerable:!1,value:function(e){if(this._windowsAwaitingFinalRegistration[e.uuid]!==e)throw"EventManager wasn't expecting to register this window";delete this._windowsAwaitingFinalRegistration[e.uuid],this._listenToWindow(e)}},unregisterWindow:{enumerable:!1,value:function(e){if(0>this._registeredWindows.indexOf(e))throw"EventManager cannot unregister an unregistered window";if(this._registeredWindows=this._registeredWindows.filter(function(t){return e!==t}),delete e.defaultEventManager,e.Element.prototype.addEventListener=e.Element.prototype.nativeAddEventListener,Object.defineProperty(e,"addEventListener",{configurable:!0,value:e.nativeAddEventListener}),Object.getPrototypeOf(e.document).addEventListener=e.document.nativeAddEventListener,e.XMLHttpRequest.prototype.addEventListener=e.XMLHttpRequest.prototype.nativeAddEventListener,e.Worker&&(e.Worker.prototype.addEventListener=e.Worker.prototype.nativeAddEventListener),e.Element.prototype.removeEventListener=e.Element.prototype.nativeRemoveEventListener,Object.defineProperty(e,"removeEventListener",{configurable:!0,value:e.nativeRemoveEventListener}),Object.getPrototypeOf(e.document).removeEventListener=e.document.nativeRemoveEventListener,e.XMLHttpRequest.prototype.removeEventListener=e.XMLHttpRequest.prototype.nativeRemoveEventListener,e.Worker&&(e.Worker.prototype.removeEventListener=e.Worker.prototype.nativeRemoveEventListener),e.HTMLDivElement.prototype.nativeAddEventListener!==e.Element.prototype.addEventListener&&e.HTMLElement&&"addEventListener"in e.HTMLElement.prototype&&e.Components&&e.Components.interfaces){var t,n;for(t in Components.interfaces)t.match(/^nsIDOMHTML\w*Element$/)&&(t=t.replace(/^nsIDOM/,""),(t=window[t])&&(n=t.prototype,n.addEventListener=n.nativeAddEventListener,delete n.nativeAddEventListener,n.removeEventListener=n.nativeRemoveEventListener,delete n.nativeRemoveEventListener))}delete e.Element.prototype.nativeAddEventListener,delete e.nativeAddEventListener,delete Object.getPrototypeOf(e.document).nativeAddEventListener,delete e.XMLHttpRequest.prototype.nativeAddEventListener,e.Worker&&delete e.Worker.prototype.nativeAddEventListener,delete e.Element.prototype.nativeRemoveEventListener,delete e.nativeRemoveEventListener,delete Object.getPrototypeOf(e.document).nativeRemoveEventListener,delete e.XMLHttpRequest.prototype.nativeRemoveEventListener,e.Worker&&delete e.Worker.prototype.nativeRemoveEventListener,delete e.Element.prototype.eventHandlerUUID,delete e.Element.prototype.component,this._stopListeningToWindow(e)}},unregisterWindows:{enumerable:!1,value:function(){this._registeredWindows.forEach(this.unregisterWindow)}},registeredEventListeners:{enumerable:!1,value:{}},registeredEventListenersForEventType_:{value:function(e){var t,n,r,i,a=this.registeredEventListeners[e];if(!a)return null;i={};for(t in a){n=a[t].listeners;for(r in n)i[r]=n[r]}return i}},registeredEventListenersForEventType_onTarget_:{enumerable:!1,value:function(e,t,n){var r,i;return r=t===n?n.eventManager.registeredEventListeners[e]:this.registeredEventListeners[e],r?(i=r[t.uuid],i?i.listeners:null):null}},registeredEventListenersOnTarget_:{value:function(e){var t,n,r=[];for(t in this.registeredEventListeners)n=this.registeredEventListeners[t],e.uuid in n&&r.push(n);return r}},registerEventListener:{enumerable:!1,value:function(e,t,n,r){var i,a,o,s=this.registeredEventListeners[t],l=!1,u=!1;if(void 0===e.uuid)throw Error("EventManager cannot observe a target without a uuid: "+(e.outerHTML||e));return s?((i=s[e.uuid])||(i=s[e.uuid]={target:e,listeners:{}},l=!0),a=i.listeners[n.uuid],o=r?"capture":"bubble",a?(a[o]=!0,u=!0):(a={listener:n,capture:r,bubble:!r},i.listeners[n.uuid]=a,u=!0)):(s=this.registeredEventListeners[t]={},s[e.uuid]={target:e,listeners:{}},s[e.uuid].listeners[n.uuid]={listener:n,capture:r,bubble:!r},l=!0,u=!0),l&&"function"==typeof e.nativeAddEventListener&&this._observeTarget_forEventType_(e,t),u}},unregisterEventListener:{enumerable:!1,value:function(e,t,n,r){var i,a,o,s,l,u=this.registeredEventListeners[t];if(u&&(i=u[e.uuid])){if(a=i.listeners[n.uuid],!a){for(s in i.listeners)if(l=i.listeners[s].listener,l.originalListener&&l.originalListener.uuid===n.uuid){a=i.listeners[s],n=l;break}if(!a)return}o=r?"capture":"bubble",a[o]=!1,a.bubble||a.capture||(delete i.listeners[n.uuid],0===Object.keys(i.listeners).length&&(delete u[e.uuid],0===Object.keys(u).length&&(delete this.registeredEventListeners[t],this._stopObservingTarget_forEventType_(e,t))))}}},actualDOMTargetForEventTypeOnTarget:{value:function(e,t){if(t.nativeAddEventListener){if(t.defaultView)return t;var n,r=this.eventDefinitions[e];return r?(n=typeof r.bubbles===d?r.bubbles(t):r.bubbles,n?t.screen?t.document:t.ownerDocument:t):t}return null}},_observedTarget_byEventType_:{value:{}},_observeTarget_forEventType_:{enumerable:!1,value:function(e,t){var n;!(n=this.actualDOMTargetForEventTypeOnTarget(t,e))||this._observedTarget_byEventType_[t]&&this._observedTarget_byEventType_[t][n.uuid]||(this._observedTarget_byEventType_[t]||(this._observedTarget_byEventType_[t]={}),this._observedTarget_byEventType_[t][n.uuid]=this,n.nativeAddEventListener(t,this,!0))}},_stopObservingTarget_forEventType_:{enumerable:!1,value:function(e,t){var n;n=this.actualDOMTargetForEventTypeOnTarget(t,e),n&&(delete this._observedTarget_byEventType_[t][n.uuid],n.nativeRemoveEventListener(t,this,!0))}},_activationHandler:{enumerable:!0,value:null},_listenToWindow:{enumerable:!1,value:function(e){if(!this._activationHandler){var t=this;this._activationHandler=function(e){var n,r=e.type;if("focus"===r||"mousedown"===r||"touchstart"===r)if(e.changedTouches){n=e.changedTouches.length;for(var i=0;n>i;i++)t._prepareComponentsForActivation(e.changedTouches[i].target)}else t._prepareComponentsForActivation(e.target)}}if(e.Touch?e.document.nativeAddEventListener("touchstart",this._activationHandler,!0):e.document.nativeAddEventListener("mousedown",this._activationHandler,!0),e.document.nativeAddEventListener("focus",this._activationHandler,!0),this.application){var n,r=this.registeredEventListenersOnTarget_(this.application);for(n in r)this._observeTarget_forEventType_(e,n)}}},_stopListeningToWindow:{enumerable:!1,value:function(e){var t,n=this.registeredEventListenersOnTarget_(this.application),r=this.registeredEventListenersOnTarget_(e);for(t in n)this._stopObservingTarget_forEventType_(e,t);for(t in r)this._stopObservingTarget_forEventType_(e,t)}},reset:{enumerable:!1,value:function(){var e,t,n,r;for(e in this.registeredEventListeners){t=this.registeredEventListeners[e];for(n in t.targets)r=t.targets[n],this._stopObservingTarget_forEventType_(r.target,e)}this.registeredEventListeners={},this._claimedPointers={}}},unload:{enumerable:!1,value:function(){this._stopListening()}},methodNameForBubblePhaseOfEventType:{enumerable:!1,value:function(e){return function(t,n){var r=n?t+"+"+n:t;return e[r]||(e[r]="handle"+(n?n.toCapitalized():"")+t.toCapitalized())}}({})},_methodNameForCapturePhaseByEventType_:{value:{}},methodNameForCapturePhaseOfEventType:{enumerable:!1,value:function(e){return function(t,n){var r=n?t+"+"+n:t;return e[r]||(e[r]="capture"+(n?n.toCapitalized():"")+t.toCapitalized())}}({})},_claimedPointers:{enumerable:!1,distinct:!0,value:{}},componentClaimingPointer:{value:function(e){return this._claimedPointers[e]}},isPointerClaimedByComponent:{value:function(e,t){if(!t)throw"Must specify a valid component to see if it claims the specified pointer, '"+t+"' is not valid.";return this._claimedPointers[e]===t}},claimPointer:{value:function(e,t){if(!e&&0!==e)throw"Must specify a valid pointer to claim, '"+e+"' is not valid.";if(!t)throw"Must specify a valid component to claim a pointer, '"+t+"' is not valid.";var n=this._claimedPointers[e];return n===t?!0:n?n.surrenderPointer(e,t)?(this._claimedPointers[e]=t,!0):!1:(this._claimedPointers[e]=t,!0)}},forfeitPointer:{value:function(e,t){if(t!==this._claimedPointers[e])throw"Not allowed to forfeit pointer '"+e+"' claimed by another component";delete this._claimedPointers[e]}},forfeitAllPointers:{value:function(e){var t,n;for(t in this._claimedPointers)n=this._claimedPointers[t],e===n&&delete this._claimedPointers[t]}},_isStoringPointerEvents:{enumerable:!1,value:!1},isStoringPointerEvents:{enumerable:!0,get:function(){return this._isStoringPointerEvents},set:function(e){e===!0?this._isStoringPointerEvents||(this._isStoringPointerEvents=!0,window.Touch&&Object.defineProperty(Touch.prototype,"velocity",{get:function(){return n.pointerMotion(this.identifier).velocity},set:function(){}})):(this._isStoringPointerEvents=!1,this._pointerStorage.memory={},this._isMouseDragging=!1)}},_isStoringMouseEventsWhileDraggingOnly:{enumerable:!1,value:!0},isStoringMouseEventsWhileDraggingOnly:{enumerable:!0,get:function(){return this._isStoringMouseEventsWhileDraggingOnly},set:function(e){this._isStoringMouseEventsWhileDraggingOnly=e===!0?!0:!1}},_isMouseDragging:{enumerable:!1,value:!1},_pointerStorage:{enumerable:!1,value:{memory:{},add:function(e,t){this.memory[e]||(this.memory[e]={data:Array(32),size:0,pos:0}),this.memory[e].data[this.memory[e].pos]=t,this.memory[e].size<this.memory[e].data.length&&this.memory[e].size++,this.memory[e].pos=(this.memory[e].pos+1)%this.memory[e].data.length},remove:function(e){delete this.memory[e]},clear:function(e){this.memory[e]&&(this.memory[e].size=0)},getMemory:function(e){return this.memory[e]},isStored:function(e){return this.memory[e]&&this.memory[e].size>0},storeEvent:function(e){var t;switch(e.type){case"mousedown":n._isMouseDragging=!0;case"mousemove":n._isStoringMouseEventsWhileDraggingOnly?n._isMouseDragging&&(this.add("mouse",{clientX:e.clientX,clientY:e.clientY,timeStamp:e.timeStamp}),Object.defineProperty(e,"velocity",{get:function(){return n.pointerMotion("mouse").velocity},set:function(){}})):(this.add("mouse",{clientX:e.clientX,clientY:e.clientY,timeStamp:e.timeStamp}),Object.defineProperty(e,"velocity",{get:function(){return n.pointerMotion("mouse").velocity},set:function(){}}));break;case"mouseup":this.add("mouse",{clientX:e.clientX,clientY:e.clientY,timeStamp:e.timeStamp}),Object.defineProperty(e,"velocity",{get:function(){return n.pointerMotion("mouse").velocity},set:function(){}});break;case"touchstart":case"touchmove":for(t=0;e.touches.length>t;t++)this.add(e.touches[t].identifier,{clientX:e.touches[t].clientX,clientY:e.touches[t].clientY,timeStamp:e.timeStamp});break;case"touchend":for(t=0;e.changedTouches.length>t;t++)this.add(e.changedTouches[t].identifier,{clientX:e.changedTouches[t].clientX,clientY:e.changedTouches[t].clientY,timeStamp:e.timeStamp})}},removeEvent:function(e){var t;switch(e.type){case"mouseup":n._isMouseDragging=!1,n._isStoringMouseEventsWhileDraggingOnly&&this.clear("mouse");break;case"touchend":for(t=0;e.changedTouches.length>t;t++)this.remove(e.changedTouches[t].identifier)}}}},_getPointerVelocityData:{enumerable:!1,value:function(e){var t,r,i,a,o,s,l,u,c,h=0,d=!0,p={x:[],y:[],time:[]};for(t=n._pointerStorage.getMemory(e),r=t.data.length,i=t.data[(t.pos-1+r)%r],a=o=s=i.timeStamp,l=i.clientX,u=i.clientY;d&&o>a-350&&t.size>h;)i=t.data[(t.pos-h-1+r)%r],o=i.timeStamp,c=l*l+u*u,c>2&&50>=s-o?(p.x.push(i.clientX),p.y.push(i.clientY),p.time.push(o),s=o,l=i.clientX,u=i.clientY,h++):d=!1;return p}},_fitPointerCurve:{enumerable:!1,value:function(e,t){var n,r,i,a,o,s,l,u,c,h,d,p,f,m,v,g,b,_,y,w,E,C,x,O,S,T,P,k,D,M,L,j,A,R,I,z,B,N,F=1e-4,q=t.length;do{for(d=0,p=0,f=0,m=0,v=0,g=0,_=0,y=0,w=0,E=0,C=0,x=0,S=0,T=0,P=0,k=0,D=0,M=0,j=0,A=0,R=0,I=0,z=0,B=0,h=0;q>h;h++)o=t[h],s=o.t,u=s*s,c=u*s,l=o.v,b=F*(6*(u-s)-c+2),O=6*F*(c-2*u+s),L=6*F*(u-c),N=2*F*c,g+=b*b,x+=O*O,M+=L*L,B+=N*N,d+=l*b,_+=l*O,S+=l*L,j+=l*N,f-=b,w-=O,P-=L,R-=N,p-=b*s,y-=O*s,T-=L*s,A-=N*s,m-=b*u,E-=O*u,k-=L*u,I-=N*u,v-=b*c,C-=O*c,D-=L*c,z-=N*c;F*=2}while(0===g||0===x||0===M||0===B);for(s=F/g,d*=s,p*=3*s,f*=s,m*=3*s,v*=s,s=F/x,_*=s,y*=3*s,w*=s,E*=3*s,C*=s,s=F/M,S*=s,T*=3*s,P*=s,k*=3*s,D*=s,s=F/B,j*=s,A*=3*s,R*=s,I*=3*s,z*=s,g=e[0],x=e[1],M=e[2],B=e[3],n=3*(x-M)+B-g,r=g+M-2*x,i=x-g,a=g,h=0;20>h;h++)s=d+a*f+i*p+r*m+n*v,g+=s,a+=s,n-=s,r+=s,i-=s,s=_+a*w+i*y+r*E+n*C,x+=s,n+=3*s,r-=s+s,i+=s,s=S+a*P+i*T+r*k+n*D,M+=s,n-=3*s,r+=s,s=j+a*R+i*A+r*I+n*z,B+=s,n+=s;e[0]=g,e[1]=x,e[2]=M,e[3]=B}},_pointerBezierValue:{enumerable:!1,value:function(e,t){var n=1-e;return n*n*n*t[0]+3*n*n*e*t[1]+3*n*e*e*t[2]+e*e*e*t[3]}},_calculatePointerVelocity:{enumerable:!1,value:function(e,t){var n,r,i=e.length,a=e[0],o=e[0],s=0;for(r=1;i>r;r++)a>e[r]&&(a=e[r],s=r);if(n=o-a){if(i>5){var l,u,c,h=[];for(r=0;i>r;r++)h[r]={v:t[r],t:(e[r]-a)/n};return l=h[s].v,u=h[0].v,c=[l,(2*l+u)/3,(l+2*u)/3,u],this._fitPointerCurve(c,h),5e3*(this._pointerBezierValue(.8,c)-this._pointerBezierValue(.6,c))/n}return i>1?1e3*(t[0]-t[s])/n:0}return 0}},pointerMotion:{value:function(e){if(n._pointerStorage.isStored(e)){var t={};return Object.defineProperties(t,{_data:{enumerable:!1,writable:!0,value:null},_x:{enumerable:!1,writable:!0,value:null},_y:{enumerable:!1,writable:!0,value:null},_speed:{enumerable:!1,writable:!0,value:null},_angle:{enumerable:!1,writable:!0,value:null},x:{get:function(){return null===this._x&&(null===this._data&&(this._data=n._getPointerVelocityData(e)),this._x=n._calculatePointerVelocity(this._data.time,this._data.x)),this._x},set:function(){}},y:{get:function(){return null===this._y&&(null===this._data&&(this._data=n._getPointerVelocityData(e)),this._y=n._calculatePointerVelocity(this._data.time,this._data.y)),this._y},set:function(){}},speed:{get:function(){return null===this._speed&&(this._speed=Math.sqrt(this.x*this.x+this.y*this.y)),this._speed},set:function(){}},angle:{get:function(){return null===this._angle&&(this._angle=Math.atan2(this.y,this.x)),this._angle},set:function(){}}}),{velocity:t}}return void 0}},monitorDOMModificationInEventHandling:{value:!1},domModificationEventHandler:{value:r.specialize({handleEvent:{value:function(){throw"DOM Modified"}},captureDOMSubtreeModified:{value:function(){throw"DOMSubtreeModified"}},captureDOMAttrModified:{value:function(){throw"DOMAttrModified"}},captureDOMCharacterDataModified:{value:function(){throw"DOMCharacterDataModified"}}})},handleEvent:{enumerable:!1,value:function(e){this.monitorDOMModificationInEventHandling&&(document.body.addEventListener("DOMSubtreeModified",this.domModificationEventHandler,!0),document.body.addEventListener("DOMAttrModified",this.domModificationEventHandler,!0),document.body.addEventListener("DOMCharacterDataModified",this.domModificationEventHandler,!0));var t,n,r,i,o,s,p,f,m,v,g,b,_,y,w=e.type,E=e.bubbles;for("DOMContentLoaded"===w&&(t=e.target.defaultView,t&&this._windowsAwaitingFinalRegistration[t.uuid]&&(this._finalizeWindowRegistration(t),e.target.removeEventListener("DOMContentLoaded",this,!0))),y="boolean"!=typeof e.propagationStopped?a.fromEvent(e):e,m=Element.isElement(y.target)||y.target instanceof Document||y.target instanceof Window?this._eventPathForDomTarget(y.target):this._eventPathForTarget(y.target),b=y.target.identifier?this.methodNameForCapturePhaseOfEventType(w,y.target.identifier):null,_=y.target.identifier?this.methodNameForBubblePhaseOfEventType(w,y.target.identifier):null,v=this.methodNameForCapturePhaseOfEventType(w),g=this.methodNameForBubblePhaseOfEventType(w),this.delegate&&typeof this.delegate.willDistributeEvent===d&&this.delegate.willDistributeEvent(y),this._isStoringPointerEvents&&this._pointerStorage.storeEvent(y),y.eventPhase=u,n=m.length-1;!y.propagationStopped&&(r=m[n]);n--)if(y.currentTarget=r,i=this.registeredEventListenersForEventType_onTarget_(w,r))for(p=Object.keys(i),o=0;i&&!y.immediatePropagationStopped&&(s=i[p[o]]);o++)s.capture&&(f=s.listener,b&&typeof f[b]===d?f[b](y):typeof f[v]===d?f[v](y):typeof f.handleEvent===d?f.handleEvent(y):typeof f!==d||f.__isConstructor__||f.call(r,y));if(!y.propagationStopped&&(y.eventPhase=c,y.currentTarget=r=y.target,i=this.registeredEventListenersForEventType_onTarget_(w,r)))for(p=Object.keys(i),o=0;i&&!y.immediatePropagationStopped&&(s=i[p[o]]);o++)f=s.listener,s.capture&&(b&&typeof f[b]===d?f[b](y):typeof f[v]===d?f[v](y):typeof f.handleEvent===d?f.handleEvent(y):typeof f===d&&f.call(r,y)),s.bubble&&(_&&typeof f[_]===d?f[_](y):typeof f[g]===d?f[g](y):typeof f.handleEvent===d?f.handleEvent(y):typeof f===d&&f.call(r,y));for(y.eventPhase=h,n=0;E&&!y.propagationStopped&&(r=m[n]);n++)if(y.currentTarget=r,i=this.registeredEventListenersForEventType_onTarget_(w,r))for(p=Object.keys(i),o=0;i&&!y.immediatePropagationStopped&&(s=i[p[o]]);o++)s.bubble&&(f=s.listener,_&&typeof f[_]===d?f[_](y):typeof f[g]===d?f[g](y):typeof f.handleEvent===d?f.handleEvent(y):typeof f===d&&f.call(r,y));y.eventPhase=l,y.currentTarget=null,this._isStoringPointerEvents&&this._pointerStorage.removeEvent(e),this.monitorDOMModificationInEventHandling&&(document.body.removeEventListener("DOMSubtreeModified",this.domModificationEventHandler,!0),document.body.removeEventListener("DOMAttrModified",this.domModificationEventHandler,!0),document.body.removeEventListener("DOMCharacterDataModified",this.domModificationEventHandler,!0))}},_prepareComponentsForActivation:{value:function(e){var t,n,r=e,i=r&&r.defaultView?r.defaultView:window,a=i.document?i.document:document,o=!1,s=null;do switch(r&&(n=this.eventHandlerForElement(r),n&&(o||(o=!0,s=this._findActiveTarget(n)),n._preparedForActivationEvents||(n._prepareForActivationEvents(),n._preparedForActivationEvents=!0))),t=r,r){case i:r=null;break;case a:r=i;break;case a.documentElement:r=a;break;default:r=r.parentNode}while(r&&t!==r);this.activeTarget=s}},_findActiveTarget:{value:function(e){for(var t=null,n={};!t&&e&&!(e.uuid in n);)n[e.uuid]=e,e.acceptsActiveTarget?t=e:e=e.nextTarget;return t}},_eventPathForTarget:{enumerable:!1,value:function(e){if(!e)return[];var t=e,n=this.application,r=[],i={};i[e.uuid]=e;do t.uuid in i||(r.push(t),i[t.uuid]=t),t=t.nextTarget,(!t||t.uuid in i)&&(t=n),t&&t.uuid in i&&(t=null);while(t);return r}},_eventPathForDomTarget:{enumerable:!1,value:function(e){if(!e)return[];var t,n=e,r=n&&n.defaultView?n.defaultView:window,i=r.document?r.document:document,a=this.application,o=[];do switch(n!==e&&o.push(n),t=n,n){case a:n=n.parentApplication,n&&(a=n);break;case r:n=a;break;case i:n=r;break;case i.documentElement:n=i;break;default:n=n.parentNode,n||(n=a)}while(n&&t!==n);return o}},_elementEventHandlerByUUID:{enumerable:!1,value:{}},registerEventHandlerForElement:{enumerable:!1,value:function(e,t){var n=this.eventHandlerForElement(t);n&&this.unregisterEventHandlerForElement(t),this._elementEventHandlerByUUID[t.eventHandlerUUID=e.uuid]=e}},unregisterEventHandlerForElement:{enumerable:!1,value:function(e){delete this._elementEventHandlerByUUID[e.eventHandlerUUID],delete e.eventHandlerUUID}},eventHandlerForElement:{enumerable:!1,value:function(e){return this._elementEventHandlerByUUID[e.eventHandlerUUID]}},_activeTarget:{value:null},activeTarget:{get:function(){return this._activeTarget||this.application},set:function(e){e||(e=this.application),e===this._activeTarget||this.activeTarget&&!this.activeTarget.surrendersActiveTarget(e)||(e.willBecomeActiveTarget(this.activeTarget),this._activeTarget=e,e.didBecomeActiveTarget())}}})}}}),montageDefine("d407295","core/serialization/deserializer/montage-reviver",{dependencies:["core/core","mousse/deserialization/reviver","./properties-deserializer","./self-deserializer","./unit-deserializer","core/module-reference","core/promise"],factory:function(e,t){var n=e("core/core").Montage,r=e("mousse/deserialization/reviver").Reviver,i=e("./properties-deserializer").PropertiesDeserializer,a=e("./self-deserializer").SelfDeserializer,o=e("./unit-deserializer").UnitDeserializer,s=e("core/module-reference").ModuleReference,l=e("core/promise").Promise,u=n.specialize({_require:{value:null},_objectRequires:{value:null},init:{value:function(e,t){if("function"!=typeof e)throw Error("Function 'require' missing.");if("string"!=typeof e.location)throw Error("Function 'require' location is missing");if("object"!=typeof t&&void 0!==t)throw Error("Parameter 'objectRequires' should be an object.");return this._require=e,this._objectRequires=t,this}},getExports:{value:function(e,t){var n;for(t=e.resolve(t),n=e.getModuleDescriptor(t);void 0!==n.redirect;)n=e.getModuleDescriptor(n.redirect);return void 0!==n.mappingRedirect?this.getExports(n.mappingRequire,n.mappingRedirect):n.exports}},getModule:{value:function(e,t){var n,r,i=this._objectRequires;return n=i&&t in i?i[t]:this._require,r=this.getExports(n,e),r||(r=n.async(e)),r}}}),c=t.MontageReviver=n.specialize.call(r,{moduleLoader:{value:null},init:{value:function(e,t){return this.moduleLoader=(new u).init(e,t),this}},getTypeOf:{value:function(e){if(null!==e&&"object"==typeof e&&1===Object.keys(e).length){if("#"in e)return"Element";if("%"in e)return"Module"}return r.prototype.getTypeOf.call(this,e)}},reviveElement:{value:function(e,t,n){var r=e["#"],i=t.getElementById(r);return i?(n&&t.setObjectLabel(i,n),i):l.reject(Error("Element with id '"+r+"' was not found."))}},reviveModule:{value:function(e,t){var n=e["%"],r=t.getRequire();n=r.resolve(n);var i=r.getModuleDescriptor(n);return(new s).initWithIdAndRequire(i.id,i.require)}},reviveCustomObject:{value:function(e,t,n){return this.reviveMontageObject(e,t,n)}},reviveMontageObject:{value:function(e,t,n){var r,i,a,o=this,s=e.prototype||e.object;return s&&(i=c.parseObjectLocationId(s),r=this.moduleLoader.getModule(i.moduleId,n),a=i.objectName),l.isPromise(r)?r.then(function(r){return o.instantiateMontageObject(e,r,a,t,n)},function(t){throw t.stack&&console.error(t.stack),Error('Error deserializing "'+n+'" when loading module "'+i.moduleId+"' from '"+e.prototype+"'")}):this.instantiateMontageObject(e,r,a,t,n)}},instantiateMontageObject:{value:function(e,t,n,r,i){var a,o,s=this;return a=this.getMontageObject(e,t,n,r,i),r.setObjectLabel(a,i),a.isDeserializing=!0,o=this.reviveObjectLiteral(e,r),l.isPromise(o)?o.then(function(e){return s.deserializeMontageObject(e,a,r,i)}):this.deserializeMontageObject(o,a,r,i)}},deserializeMontageObject:{value:function(e,t,n,r){var i;return"function"==typeof t.deserializeSelf?this.deserializeCustomMontageObject(t,e,n,r):(n.setUnitsToDeserialize(t,e,c._unitNames),i=this.deserializeMontageObjectProperties(t,e.properties,n),l.isPromise(i)?i.then(function(){return t}):t)}},deserializeMontageObjectProperties:{value:function(e,t,n){var r;if("function"==typeof e.deserializeProperties){var a=(new i).initWithReviverAndObjects(this,n);r=e.deserializeProperties(a)}else for(var o in t)e[o]=t[o];return r}},deserializeCustomMontageObject:{value:function(e,t,n,r){var i,o=(new a).initWithObjectAndObjectDescriptorAndContextAndUnitNames(e,t,n,c._unitNames);return i=e.deserializeSelf(o),l.isPromise(i)?i.then(function(e){return n.setObjectLabel(e,r),e}):void 0!==i?(n.setObjectLabel(i,r),i):e}},getMontageObject:{value:function(e,t,n,r,i){var a;if(r.hasUserObject(i))return r.getUserObject(i);if("prototype"in e){if(!(n in t))throw Error('Error deserializing "'+i+'": object named "'+n+'"'+' was not found in "'+e.prototype+'".'+" Available objects are: "+Object.keys(t)+".");return a=Object.create(t[n].prototype),a.isDeserializing=!0,"function"==typeof a.didCreate?a.didCreate():"function"==typeof a.constructor&&a.constructor(),a}if("object"in e){if(!(n in t))throw Error('Error deserializing "'+i+'": object named "'+a+"' was not found given '"+e.object+"'");return t[n]}throw Error("Error deserializing "+JSON.stringify(e)+', might need "prototype" or "object" on label '+JSON.stringify(i))}},didReviveObjects:{value:function(e,t){var n,r=this;return n=this._deserializeUnits(t),l.isPromise(n)?n.then(function(){r._invokeDeserializedFromSerialization(e,t)}):(this._invokeDeserializedFromSerialization(e,t),void 0)}},_invokeDeserializedFromSerialization:{value:function(e,t){var n;for(var r in e)n=e[r],null!=n&&delete n.isDeserializing,t.hasUserObject(r)||n&&"function"==typeof n.deserializedFromSerialization&&n.deserializedFromSerialization(r)}},_deserializeUnits:{value:function(e){for(var t,n,r,i=e.getUnitsToDeserialize(),a=c._unitRevivers,s=0;r=i[s];s++){t=r.unitNames;for(var l,u=0;l=t[u];u++)l in r.objectDesc&&(n=(new o).initWithContext(e),a[l](n,r.object,r.objectDesc[l]))}}}},{_unitRevivers:{value:Object.create(null)},_unitNames:{value:[]},_findObjectNameRegExp:{value:/([^\/]+?)(\.reel)?$/},_toCamelCaseRegExp:{value:/(?:^|-)([^-])/g},_replaceToCamelCase:{value:function(e,t){return t.toUpperCase()}},_locationDescCache:{value:Object.create(null)},parseObjectLocationId:{value:function(e){var t,n,r,i,a=this._locationDescCache;return e in a?t=a[e]:(n=e.indexOf("["),n>0?(r=e.substr(0,n),i=e.slice(n+1,-1)):(r=e,this._findObjectNameRegExp.test(e),i=RegExp.$1.replace(this._toCamelCaseRegExp,this._replaceToCamelCase)),t={moduleId:r,objectName:i},a[e]=t),t}},defineUnitReviver:{value:function(e,t){this._unitRevivers[e]=t,this._unitNames.push(e)}},getTypeOf:{value:function(e){return this.prototype.getTypeOf.call(this,e)}}});void 0!==t&&(t.MontageReviver=c)}}),montageDefine("d407295","core/logger",{dependencies:["montage"],factory:function(e,t){var n,r,i,a,o,s,l,u,c,h=e("montage").Montage;r=t.loggers={},s=function(){var e,t=s.caller.caller;return e=t.name,""===e&&(e="anonymous"),e},l=function(e){if(e.getHours){var t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return(1===t.length?"0"+t:t)+":"+(1===n.length?"0"+n:n)+":"+(1===r.length?"0"+r:r)+"."+e.getMilliseconds()}},o=function(){},i=function(){console.log(arguments)},a=function(){var e=arguments[0],t=e._montage_metadata;new Date,t?([].shift.call(arguments),[].unshift.call(arguments,t.objectName+"."+s(e)+"()"),this.buffered?this.buffer.push(arguments):console.debug.apply(console,arguments)):this.buffered?this.buffer.push(arguments):console.debug.apply(console,arguments)},n=t.Logger=h.specialize({constructor:{value:function n(){this.super()}},init:{value:function(e,t,n){if(this.name=e,this._onStateChange=t,this._storeState=!n,this._storeState&&c){var r=c.getItem("_montage_logger_"+e);r&&(this.isDebug="true"===r)}return t&&this._onStateChange("true"===r),this.isError=!0,this}},name:{value:null},buffer:{value:[],distinct:!0},buffered:{value:!1},flush:{value:function(){var e,t,n=this.buffer;for(t=0;e=n[t];t++)console.debug.apply(console,e);this.buffer.length=0}},isDebug:{get:function(){return this.debug!==o},set:function(e){this.debug=e?a:o}},isError:{get:function(){return this.error!==o},set:function(e){this.error=e?a:o}},debug:{value:o},error:{value:o},toTimeString:{value:l},_storeState:{value:null},_onStateChange:{value:null}}),t.logger=function(e,t,i){var a;return null==(a=r[e])&&(a=(new n).init(e,t,i),h.defineProperty(r,e,{value:a})),a},u=h.specialize({constructor:{value:function u(){this.super()}},init:{value:function(){return document.nativeAddEventListener?(document.nativeAddEventListener("keyup",this,!1),document.nativeAddEventListener("keydown",this,!1)):(document.addEventListener("keyup",this,!1),document.addEventListener("keydown",this,!1)),this}},inspectorElement:{value:null},m_dontRemove:{value:null},titleHeader:{value:null},shown:{value:!1},isCtrl:{value:!1},isAlt:{value:!1},keyup:{value:function(e){17==e.which&&(this.isCtrl=!1),18==e.which&&(this.isAlt=!1)}},keydown:{value:function(e){return 17==e.which&&(this.isCtrl=!0),18==e.which&&(this.isAlt=!0),76==e.which&&this.isCtrl===!0&&this.isAlt===!0?(this.shown?this.hideInspector():this.showInspector(),!1):void 0}},change:{value:function(e){var t=e.target.checked,n=e.target.value,i=r[n];i.isDebug=t,i._onStateChange&&i._onStateChange(t),i._storeState&&c&&c.setItem("_montage_logger_"+n,t)}},mouseup:{value:function(){this.hideInspector()}},showInspector:{value:function(){if(!this.inspectorElement){var e,t,n,i,a,o,s,l,u,h,d,p=0;for(this.m_dontRemove=document.getElementsByTagName("body")[0],this.inspectorElement=document.createElement("div"),this.inspectorElement.id="_montage_logger_inspector",t=document.createElement("div"),this.inspectorElement.appendChild(t),i=document.createElement("div"),t.appendChild(i),n=document.createElement("h1"),n.className="_montage_logger_inspector-title",n.textContent="Logger Inspector",this.titleHeader=n,i.appendChild(n),u=Object.keys(r),p=0;e=r[u[p]];p++)a=document.createElement("label"),o=document.createElement("input"),d=document.createElement("span"),a.className="_montage_logger_inspector-content",d.textContent=e.name,a.appendChild(o),a.appendChild(d),o.value=e.name,o.type="checkbox",o.checked=!!e.isDebug,l="_montage_logger_"+e.name,e._storeState&&c&&(s=c.getItem(l),null==s&&c.setItem(l,e.isDebug)),i.appendChild(a);h=document.createElement("style");var f="#_montage_logger_inspector {";f+="    border: 1px solid rgba(15,15,15,0.4);",f+="    position: fixed;",f+="    right: 25px;",f+="    top: 25px;",f+="    -webkit-border-radius: 5px;",f+="    color: #dddddd;",f+='    font: 10px "Lucida Grande","Lucida Sans", sans;',f+="    background:-webkit-gradient(linear, left top, left bottom, from(rgba(15,15,15,0.75)), to(rgba(15,15,15,0.95)) );",f+="    -webkit-box-shadow: 0 0 15px rgba(0,0,0,.3);",f+="    width: 250px;",f+="}",f+="#_montage_logger_inspector div {",f+="    -webkit-border-radius: 5px;",f+="    background: -webkit-gradient(radial, 100 -60, 0, 125 -50, 125, from(rgba(255,255,255,0.00)), to(rgba(0,0,0,.2)), color-stop(1, rgba(0,0,0,.2)));",f+="}",f+="#_montage_logger_inspector div div {",f+="    background: -webkit-gradient(linear, left top, left bottom, from(rgba(255,255,255,0.2)), to(rgba(0,0,0,.1)), color-stop(0.33, rgba(255,255,255,.01)), color-stop(0.33, rgba(50,50,50,1)) );",f+="    padding: 7px 10px;",f+="    -webkit-border-radius: 3px;",f+="    overflow-x: hidden;",f+="}",f+="._montage_logger_inspector-title {",f+="    color: rgba(255,255,255,0.9);",f+="    font-size: 13px;",f+="    margin: 0 0 11px 0;",f+="    padding: 0 0 0 5px;",f+="}",f+="._montage_logger_inspector-content {",f+="    padding: 0 0 0 20px;",f+="    margin: 0;",f+="    display: block;",f+="}",h.textContent=f,document.head.appendChild(h)}this.shown=!0,this.m_dontRemove.appendChild(this.inspectorElement),this.titleHeader.nativeAddEventListener("mouseup",this,!1),this.inspectorElement.nativeAddEventListener("change",this,!1)}},hideInspector:{value:function(){document.getElementById("_montage_logger_inspector")&&(this.shown=!1,this.m_dontRemove.removeChild(this.inspectorElement),this.titleHeader.nativeRemoveEventListener("mouseup",this,!1),this.inspectorElement.nativeRemoveEventListener("change",this,!1))
}},handleEvent:{enumerable:!1,value:function(e){this[e.type]&&this[e.type](e)}}});var d=function(){(new u).init()};"undefined"!=typeof window&&(c=window.localStorage,window.loggers=r,window.localStorage&&d())}}),montageDefine("d407295","core/shim/object",{dependencies:[],factory:function(){Object.create||(Object._creator=function e(){this.__proto__=e.prototype},Object.create=function(e){return this._creator.prototype=e||Object.prototype,new this._creator},Object.getPrototypeOf=function(e){return e.__proto__}),Object.isSealed||Object.defineProperty(Object,"isSealed",{value:function(){return!1},writable:!0,configurable:!0}),Object.seal||Object.defineProperty(Object,"seal",{value:function(e){return e},writable:!0,configurable:!0})}}),montageDefine("d407295","core/shim/array",{dependencies:[],factory:function(){Array.isArray||Object.defineProperty(Array,"isArray",{value:function(e){return"[object Array]"===Object.prototype.toString.call(e)},writable:!0,configurable:!0})}}),montageDefine("d407295","core/shim/string",{dependencies:[],factory:function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e){return this.length>=e.length&&this.slice(0,e.length)===e},writable:!0,configurable:!0}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(e){return this.length>=e.length&&this.slice(this.length-e.length,this.length)===e},writable:!0,configurable:!0})}}),montageDefine("d407295","core/extras/object",{dependencies:["core/core","collections/weak-map","frb"],factory:function(e){e("core/core"),e("collections/weak-map"),Object.defineProperty(Object,"getPropertyDescriptor",{value:function(e,t){var n,r=e;do n=Object.getOwnPropertyDescriptor(r,t);while(!n&&(r=r.__proto__||Object.getPrototypeOf(r)));return n},writable:!0,configurable:!0}),Object.defineProperty(Object,"getPrototypeAndDescriptorDefiningProperty",{value:function(e,t){var n,r=e;if(t){do n=Object.getOwnPropertyDescriptor(r,t);while(!n&&(r=r.__proto__||Object.getPrototypeOf(r)));return{prototype:r,propertyDescriptor:n}}},writable:!0,configurable:!0}),Object.defineProperty(Object.prototype,"clear",{value:function(){for(var e=Object.keys(this),t=e.length;t;)t--,delete this[e[t]];return this},writable:!0,configurable:!0}),Object.defineProperty(Object,"defineBinding",{value:function(t,n,r){var i=Error.stackTraceLimit;Error.stackTraceLimit=2,console.warn("Object.defineBinding deprecated.  See the comment below this warning for migration instructions.",Error("deprecated").stack),Error.stackTraceLimit=i;var a=e("frb");r.source=r.boundObject,r.oneway?r["<-"]=r.boundObjectPropertyPath:r["<->"]=r.boundObjectPropertyPath,r.boundValueMutator&&(r.convert=r.boundValueMutator),a.defineBinding(t,n,r)}}),Object.defineProperty(Object,"deleteBinding",{value:function(t,n){var r=e("frb");r.cancelBinding(t,n)}})}}),montageDefine("d407295","core/extras/date",{dependencies:[],factory:function(){Object.defineProperty(Date.prototype,"clone",{value:function(){return new Date(this)},writable:!0,configurable:!0})}}),montageDefine("d407295","core/extras/element",{dependencies:[],factory:function(){Element&&!Element.isElement&&Object.defineProperty(Element,"isElement",{value:function(e){return!(!e||1!==e.nodeType)},writable:!0,configurable:!0})}}),montageDefine("d407295","core/extras/function",{dependencies:["./object"],factory:function(e){e("./object"),Object.defineProperty(Function,"identity",{value:function(e){return e},writable:!0,configurable:!0}),Object.defineProperty(Function,"noop",{value:function(){},writable:!0,configurable:!0}),Object.defineProperty(Function,"by",{value:function(e,t){t=t||Object.compare,e=e||Function.identity;var n=function(n,r){return t(e(n),e(r))};return n.compare=t,n.by=e,n},writable:!0,configurable:!0})}}),montageDefine("d407295","core/extras/regexp",{dependencies:[],factory:function(){if(!RegExp.isRegExp){var e=Object.prototype.toString;Object.defineProperty(RegExp,"isRegExp",{value:function(t){return"[object RegExp]"===e.call(t)},writable:!0,configurable:!0})}}}),montageDefine("d407295","core/extras/string",{dependencies:[],factory:function(){Object.defineProperty(String.prototype,"equals",{value:function(e){return this.valueOf()===Object.getValueOf(e)},writable:!0,configurable:!0}),Object.defineProperty(String.prototype,"contains",{value:function(e){return-1!==this.indexOf(e)},writable:!0,configurable:!0}),Object.defineProperty(String.prototype,"toCapitalized",{value:function(){return this.charAt(0).toUpperCase()+this.slice(1)},writable:!0,configurable:!0}),Object.defineProperty(String.prototype,"addEventListener",{value:Function.noop,writable:!0,configurable:!0})}}),montageDefine("d407295","core/uuid",{dependencies:[],factory:function(e,t){function n(){var e,t=r,n=i;return n[0]=t[15&(e=4294967296*Math.random())],n[1]=t[15&(e>>>=4)],n[2]=t[15&(e>>>=4)],n[3]=t[15&(e>>>=4)],n[4]=t[15&(e>>>=4)],n[5]=t[15&(e>>>=4)],n[6]=t[15&(e>>>=4)],n[7]=t[15&(e>>>=4)],n[9]=t[15&(e=4294967296*Math.random())],n[10]=t[15&(e>>>=4)],n[11]=t[15&(e>>>=4)],n[12]=t[15&(e>>>=4)],n[15]=t[15&(e>>>=4)],n[16]=t[15&(e>>>=4)],n[17]=t[15&(e>>>=4)],n[19]=t[8|3&(e=4294967296*Math.random())],n[20]=t[15&(e>>>=4)],n[21]=t[15&(e>>>=4)],n[22]=t[15&(e>>>=4)],n[24]=t[15&(e>>>=4)],n[25]=t[15&(e>>>=4)],n[26]=t[15&(e>>>=4)],n[27]=t[15&(e>>>=4)],n[28]=t[15&(e=4294967296*Math.random())],n[29]=t[15&(e>>>=4)],n[30]=t[15&(e>>>=4)],n[31]=t[15&(e>>>=4)],n[32]=t[15&(e>>>=4)],n[33]=t[15&(e>>>=4)],n[34]=t[15&(e>>>=4)],n[35]=t[15&(e>>>=4)],n.join("")}var r="0123456789ABCDEF".split(""),i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("");t.Uuid=Object.create(Object.prototype,{generate:{enumerable:!1,value:n}}),t.generate=n}}),montageDefine("d407295","core/bindings",{dependencies:["core/core","frb"],factory:function(e,t){var n=e("core/core").Montage,r=t.Bindings=e("frb"),i={defineBinding:{value:function(e,t,n){return r.defineBinding(this,e,t,n)}},defineBindings:{value:function(e,t){return r.defineBindings(this,e,t)}},cancelBinding:{value:function(e){return r.cancelBinding(this,e)}},cancelBindings:{value:function(){return r.cancelBindings(this)}},getBinding:{value:function(e){return r.getBinding(this,e)}},getBindings:{value:function(){return r.getBindings(this)}}};n.defineProperties(n,i),n.defineProperties(n.prototype,i)}}),montageDefine("d407295","core/paths",{dependencies:["core/core","collections/weak-map","collections/map","frb/parse","frb/evaluate","frb/assign","frb/observe","frb/bind","frb/compile-observer","frb/scope","frb/observers"],factory:function(e){var t=e("core/core").Montage,n=e("collections/weak-map"),r=e("collections/map"),i=e("frb/parse"),a=e("frb/evaluate"),o=e("frb/assign");e("frb/observe"),e("frb/bind");var s=e("frb/compile-observer"),l=e("frb/scope"),u=e("frb/observers"),c=u.autoCancelPrevious,h=new n,d={getPath:{value:function(e,t,n,r){return a(e,this,t||this,n,r)}},setPath:{value:function(e,t,n,r,i){return o(this,e,t,n||this,r,i)}},observePath:{value:function(e,t){var n=i(e),r=s(n);return r(c(t),new l(this))}},addRangeAtPathChangeListener:{value:function(e,t,n){function r(e,r,i){if(t[n])t[n](e,r,i);else{if(!t.call)throw Error("Can't dispatch range change to "+t);t.call(null,e,r,i)}}n=n||"handleRangeChange";var i=[];return this.addPathChangeListener(e,function(e){return e=e||[],r(e.slice(),i.slice(),0),i=e,e.addRangeChangeListener(r)})}},getPathChangeDescriptors:{value:function(){return h.has(this)||h.set(this,{}),h.get(this)}},getPathChangeDescriptor:{value:function(e,n,i){var a=t.getPathChangeDescriptors.call(this);return Object.owns(a,e)||(a[e]={willChangeListeners:new r,changeListeners:new r}),a=a[e],a=i?a.willChangeListeners:a.changeListeners,a.has(n)||a.set(n,{path:e,handler:n,beforeChange:i,cancel:Function.noop}),a.get(n)}},addPathChangeListener:{value:function(e,n,r,a){var o=this;n=n||Function.noop;var u=t.getPathChangeDescriptor.call(this,e,n,a);u.cancel();var h,d,p,f=i(e);if(n===Function.noop)p=function(t){if(d)throw Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(e));d=!0,h=t};else if(r)p=function(t){return n[r].call(n,t,e,o)};else if(n.handlePathChange)p=function(t){return n.handlePathChange.call(n,t,e,o)};else{if("function"!=typeof n)throw Error("Can't recognize handler type: "+n+". Must be function or delegate implementing handlePathChange.");p=function(t){return n.call(o,t,e,o)}}var m=s(f),v=m(c(p),new l(this));return u.cancel=v,d?h:v}},removePathChangeListener:{value:function(e,n,r){n=n||Function.noop;var i=t.getPathChangeDescriptors.call(this),a=r?"willChangeListeners":"changeListeners";if(!Object.owns(i,e))throw Error("Can't find "+a+" for "+JSON.stringify(e));var o=i[e],s=o[a];if(!s.has(n))throw Error("Can't find "+a+" for "+JSON.stringify(e));var l=s.get(n);l.cancel(),s["delete"](n),0===o.willChangeListeners.length&&0===o.changeListeners.length&&delete i[e];for(var u in i)return;h["delete"](this)}},addBeforePathChangeListener:{value:function(e,n,r){return t.addPathChangeListener.call(this,e,n,r,!0)}},removeBeforePathChangeListener:{value:function(e,n){return t.removePathChangeListener.call(this,e,n,!0)}}};t.defineProperties(t,d),t.defineProperties(t.prototype,d)}}),montageDefine("d407295","core/serialization/bindings",{dependencies:["frb","frb/parse","frb/stringify","frb/expand","frb/scope","core/serialization"],factory:function(e){var t=e("frb"),n=(e("frb/parse"),e("frb/stringify")),r=e("frb/expand"),i=e("frb/scope"),a=e("core/serialization").Serializer,o=e("core/serialization").Deserializer;a.defineSerializationUnit("bindings",function(e,a){var o,s=t.getBindings(a),l={};for(var u in s){var c=s[u],h={};if(!("serializable"in c)||c.serializable){var d=c.sourcePath,p=c.sourceSyntax;if(c.source!==a){var f=e.getObjectLabel(c.source),m=new i({type:"component",label:f});m.components=e,p=r(p,m)}var m=new i;m.components=e,d=n(p,m),c.twoWay?h["<->"]=d:h["<-"]=d,c.converter?h.converter=c.converter:(h.convert=c.convert,h.revert=c.revert),c.trace&&(h.trace=!0),l[u]=h,o=!0}}return o?l:void 0}),o.defineDeserializationUnit("bindings",function(e,n,r){for(var i in r){var a=r[i];if("object"!=typeof a)throw Error("Binding descriptor must be an object, not "+typeof a);"boundObject"in a?(a.source=e.getObjectByLabel(a.boundObject),a.oneway?a["<-"]=a.boundPropertyPath:a["<->"]=a.boundPropertyPath,delete a.boundObject,delete a.boundObjectPropertyPath,delete a.oneway):a["<<->"]&&(console.warn("WARNING: <<-> in bindings is deprectated, use <-> only, please update now."),a["<->"]=a["<<->"],delete a["<<->"])}t.defineBindings(n,r,{components:e})})}}),montageDefine("d407295","core/serialization/deserializer/properties-deserializer",{dependencies:["core/core","core/promise"],factory:function(e,t){var n=e("core/core").Montage;e("core/promise").Promise;var r=n.specialize({_object:{value:null},_objectDescriptor:{value:null},_context:{value:null},initWithObjectAndObjectDescriptorAndContext:{value:function(e,t,n){return this._object=e,this._objectDescriptor=t,this._context=n,this}},get:{value:function(e){return this._objectDescriptor.properties?this._objectDescriptor.properties[e]:void 0}},deserializeProperties:{value:function(e){var t,r=this._object,i=this._objectDescriptor.properties;if(i){e||(e=n.getSerializablePropertyNames(r));for(var a=0,o=e.length;o>a;a++)t=e[a],r[t]=i[t]}}},getObjectByLabel:{value:function(e){this._context.getObject(e)}}});t.PropertiesDeserializer=r}}),montageDefine("d407295","core/serialization/deserializer/self-deserializer",{dependencies:["core/core","core/promise"],factory:function(e,t){var n=e("core/core").Montage;e("core/promise").Promise;var r=n.specialize({_object:{value:null},_objectDescriptor:{value:null},_context:{value:null},_unitNames:{value:null},_objectUnitNames:{value:null},create:{value:function(){return new this}},initWithObjectAndObjectDescriptorAndContextAndUnitNames:{value:function(e,t,n,r){return this._object=e,this._objectDescriptor=t,this._context=n,this._unitNames=r,this}},getProperty:{value:function(e){return this._objectDescriptor.properties?this._objectDescriptor.properties[e]:void 0}},getType:{value:function(){return"prototype"in this._objectDescriptor?"prototype":"object"in this._objectDescriptor?"object":void 0}},getTypeValue:{value:function(){return this._objectDescriptor.prototype||this._objectDescriptor.object}},getObjectByLabel:{value:function(e){this._context.getObject(e)}},deserializeProperties:{value:function(e){var t,r=this._object,i=this._objectDescriptor.properties;if(i){e||(e=n.getSerializablePropertyNames(r));for(var a=0,o=e.length;o>a;a++)t=e[a],r[t]=i[t]}}},deserializeUnit:{value:function(e){var t=this._objectUnitNames;t?-1===t.indexOf(e)&&t.push(e):(t=this._objectUnitNames=[e],this._context.setUnitsToDeserialize(this._object,this._objectDescriptor,t))}},deserializeUnits:{value:function(){var e=this._objectUnitNames;if(e)for(var t,n=0;t=e[n];n++)-1===e.indexOf(t)&&e.push(t);else e=this._objectUnitNames=this._unitNames,this._context.setUnitsToDeserialize(this._object,this._objectDescriptor,e)}}});t.SelfDeserializer=r}}),montageDefine("d407295","core/serialization/deserializer/unit-deserializer",{dependencies:["core/core","core/promise"],factory:function(e,t){var n=e("core/core").Montage,r=e("core/promise").Promise,i=n.specialize({_context:{value:null},create:{value:function(){return new this}},initWithContext:{value:function(e){return this._context=e,this}},getObjectByLabel:{value:function(e){var t=this._context.getObject(e);return r.isPromise(t)?void 0:t}}});t.UnitDeserializer=i}}),montageDefine("d407295","core/module-reference",{dependencies:["montage"],factory:function(e,t){var n=e("montage").Montage;t.ModuleReference=n.specialize({constructor:{value:function(){return this.super()}},initWithIdAndRequire:{value:function(e,t){if(!e||!t)throw Error("Module ID and require required");return this.id=e,this.require=t,this}},id:{value:null},require:{value:null},_exports:{value:null},exports:{get:function(){return this._exports?this._exports:this._exports=this.require.async(this.id)}},resolve:{value:function(e){return e.identify(this.id,this.require)}},isModuleReference:{writable:!1,configurable:!1,value:!0}})}}),montageDefine("d407295","core/event/mutable-event",{dependencies:["montage"],factory:function(e,t){var n=e("montage").Montage;if("undefined"!=typeof window){var r={},i=function(e,t){var r="_"+t;n.defineProperty(e,r,{value:void 0}),n.defineProperty(e,t,{get:function(e,t){return function(){return this.hasOwnProperty(t)?this[t]:this._event?this._event[e]:void 0}}(t,r),set:function(e){return function(t){this[e]=t}}(r)})};t.MutableEvent=n.specialize({_initPrototypeWithEvent:{value:function(e){var t;for(t in e)this[t]||i(this,t);return i(this,"replayed"),this}},_initWithEvent:{value:function(e){return this._event=e,this}},preventDefault:{value:function(){this._event.preventDefault()}},stopImmediatePropagation:{value:function(){this._event.stopImmediatePropagation(),this.propagationStopped=!0,this.immediatePropagationStopped=!0}},propagationStopped:{value:!1},immediatePropagationStopped:{value:!1},mutable:{value:!0},target:{value:null},stopPropagation:{value:function(){this._event.stopPropagation(),this.propagationStopped=!0}},stop:{value:function(){this.preventDefault(),this.stopPropagation()}}},{fromEvent:{value:function(e){var n,i=e.type,a=r[i];return a||(a=function(){},a.prototype=(new t.MutableEvent)._initPrototypeWithEvent(e),r[i]=a),n=new a,n._initWithEvent(e),n}},fromType:{value:function(e,t,n,r){var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t,n,r),this.fromEvent(i)}}})}}}),montageDefine("d407295","core/serialization",{dependencies:["./serialization/serializer/montage-serializer","./serialization/deserializer/montage-deserializer"],factory:function(e,t){var n=e("./serialization/serializer/montage-serializer").MontageSerializer,r=e("./serialization/serializer/montage-serializer").serialize,i=e("./serialization/deserializer/montage-deserializer").MontageDeserializer,a=e("./serialization/deserializer/montage-deserializer").deserialize;t.Serializer=n,t.serialize=r,t.Deserializer=i,t.deserialize=a}}),montageDefine("d407295","core/serialization/serializer/montage-serializer",{dependencies:["core/core","mousse/serialization/malker","mousse/serialization/serializer","./montage-builder","./montage-labeler","./montage-visitor","core/logger"],factory:function(e,t){var n=e("core/core").Montage,r=e("mousse/serialization/malker").Malker,i=e("mousse/serialization/serializer").Serializer,a=e("./montage-builder").MontageBuilder,o=e("./montage-labeler").MontageLabeler,s=e("./montage-visitor").MontageVisitor;e("core/logger").logger("montage-serializer");var l=n.specialize.call(i,{_require:{value:null},_visitor:{value:null},_units:{value:Object.create(null)},_findObjectNameRegExp:{value:/([^\/]+?)(\.reel)?$/},_toCamelCaseRegExp:{value:/(?:^|-)([^-])/g},_replaceToCamelCase:{value:function(e,t){return t.toUpperCase()}},constructor:{value:function l(){}},initWithRequire:{value:function(e){return this._require=e,this._builder=new a,this._labeler=new o,this._visitor=(new s).initWithBuilderAndLabelerAndRequireAndUnits(this._builder,this._labeler,this._require,this._units),this._malker=new r(this._visitor),this}},getExternalObjects:{value:function(){return this._visitor.getExternalObjects()}},getExternalElements:{value:function(){return this._visitor.getExternalElements()}},defineSerializationUnit:{value:function(e,t){this.constructor.defineSerializationUnit.call(this,e,t)}}},{defineSerializationUnit:{value:function(e,t){this._units[e]=t}},getDefaultObjectNameForModuleId:{value:function(e){return this._findObjectNameRegExp.test(e),RegExp.$1.replace(this._toCamelCaseRegExp,this._replaceToCamelCase)}}});t.MontageSerializer=l,t.serialize=function(e,t){return(new l).initWithRequire(t).serializeObject(e)}}}),montageDefine("d407295","core/serialization/deserializer/montage-deserializer",{dependencies:["core/core","mousse/deserialization/interpreter","mousse/deserialization/deserializer","./montage-interpreter","./montage-reviver","core/promise","core/jshint","core/logger"],factory:function(e,t){var n=e("core/core").Montage;e("mousse/deserialization/interpreter").Interpreter;var r=e("mousse/deserialization/deserializer").Deserializer,i=e("./montage-interpreter").MontageInterpreter,a=e("./montage-reviver").MontageReviver,o=e("core/promise").Promise,s=e("core/jshint").JSHINT;e("core/logger").logger("montage-deserializer");var l=n.specialize.call(r,{_interpreter:{value:null},_serializationString:{value:null},_serialization:{value:null},init:{value:function(e,t,n){if(!this.isSerializationStringValid(e))throw Error(this._formatSerializationSyntaxError(e));return r.call(this,e),this._origin,this._serialization=null,this._interpreter=(new i).init(t,n),this}},serialization:{get:function(){var e=this._serialization;return e||(e=JSON.parse(this._serializationString),this._serialization=e),e}},deserialize:{value:function(e,t){var n;try{n=JSON.parse(this._serializationString)}catch(r){return o.reject(r)}return this._interpreter.instantiate(n,e,t)}},preloadModules:{value:function(){var e=JSON.parse(this._serializationString);return this._interpreter.preloadModules(e)}},getExternalObjectLabels:{value:function(){var e=this.serialization,t=[];for(var n in e)0===Object.keys(e[n]).length&&t.push(n);return t}},isSerializationStringValid:{value:function(e){try{return JSON.parse(e),!0}catch(t){return!1}}},_formatSerializationSyntaxError:{value:function(e){var t,n,r,i,a,o="   ",l=this._origin;if(s(e))t="Syntax error in the serialization but not able to find it!\n"+e;else{n=s.errors[0],r=e.split("\n"),i=(o+r.length).length,a=n.line-1;for(var u=0,c=r.length;c>u;u++)r[u]=Array(i-(u+1+"").length+1).join(u===a?">":" ")+(u+1)+" "+r[u];t="Syntax error at line "+n.line+(l?" from "+l:"")+":\n"+n.evidence+"\n"+n.reason+"\n"+r.join("\n")}return t}}},{defineDeserializationUnit:{value:function(e,t){a.defineUnitReviver(e,t)}}});t.MontageDeserializer=l,t.deserialize=function(e,t){return(new l).init(e,t).deserializeObject()}}}),montageDefine("d407295","core/serialization/serializer/montage-builder",{dependencies:["montage","mousse/serialization/builder","./montage-ast"],factory:function(e,t){var n=e("montage").Montage,r=e("mousse/serialization/builder").Builder,i=e("./montage-ast"),a=n.specialize.call(r,{constructor:{value:function a(){r.call(this)}},createElementReference:{value:function(e){return(new i.ElementReference).initWithRootAndId(this._root,e)}},createModuleReference:{value:function(e){return(new i.ModuleReference).initWithRootAndModuleId(this._root,e)}}});t.MontageBuilder=a}}),montageDefine("d407295","core/serialization/serializer/montage-labeler",{dependencies:["montage","mousse/serialization/labeler"],factory:function(e,t){var n=e("montage").Montage,r=e("mousse/serialization/labeler").Labeler;t.MontageLabeler=n.specialize.call(r,{_labelRegexp:{value:/^[a-zA-Z_$][0-9a-zA-Z_$]*$/},constructor:{value:function(){r.call(this)}},getObjectName:{value:function(e){var t,i=e.identifier;return i&&this._labelRegexp.test(i)?t=e.identifier:"getInfoForObject"in e||"getInfoForObject"in e.constructor?(t=n.getInfoForObject(e).objectName,t=t.toLowerCase()):t=r.prototype.getObjectName.call(this,e),t}}})}}),montageDefine("d407295","core/serialization/serializer/montage-visitor",{dependencies:["montage","./montage-serializer","./properties-serializer","./self-serializer","./unit-serializer","mousse/serialization/visitor"],factory:function(e,t){var n=e("montage").Montage,r=e("./montage-serializer"),i=e("./properties-serializer").PropertiesSerializer,a=e("./self-serializer").SelfSerializer,o=e("./unit-serializer").UnitSerializer,s=e("mousse/serialization/visitor").Visitor,l=n.specialize.call(s,{_MONTAGE_ID_ATTRIBUTE:{value:"data-montage-id"},_require:{value:null},_units:{value:null},_elements:{value:null},constructor:{value:function l(){}},initWithBuilderAndLabelerAndRequireAndUnits:{value:function(e,t,n,r){return s.call(this,e,t),this._require=n,this._units=r,this._elements=[],this}},getTypeOf:{value:function(e){return e.isModuleReference?"Module":"getInfoForObject"in e||"getInfoForObject"in e.constructor?"MontageObject":e.thisIsAReferenceCreatedByMontageSerializer?"MontageReference":"undefined"!=typeof Element&&Element.isElement(e)?"Element":void 0}},visitMontageReference:{value:function(e,t,n){this.builder.top.setProperty(n,t.reference)}},visitElement:{value:function(e,t,n){var r,i;if(i=t.getAttribute(this._MONTAGE_ID_ATTRIBUTE),!i)throw Error("Not possible to serialize a DOM element with no "+this._MONTAGE_ID_ATTRIBUTE+" assigned: "+t.outerHTML);r=this.builder.createElementReference(i),this.storeValue(r,t,n),this._elements.push(t)}},visitModule:{value:function(e,t,n){var r,i;try{i=t.resolve(this._require)}catch(a){throw Error("Not possible to serialize module reference "+t.id+" from package "+t.require.location+" inside package "+this._require.location)}r=this.builder.createModuleReference(i),this.storeValue(r,t,n)}},visitMontageObject:{value:function(e,t,n){this.isObjectSerialized(t)?this.serializeReferenceToMontageObject(e,t,n):this.handleMontageObject(e,t,n)}},handleMontageObject:{value:function(e,t,n){var r,i=this.builder.createCustomObject();this.setObjectSerialization(t,i),r=this.serializeMontageObject(e,t,i),r?this.serializeSubstituteObject(e,t,n,i,r):(i.setLabel(this.labeler.getObjectLabel(t)),this.builder.top.setProperty(n,i))}},serializeReferenceToMontageObject:{value:function(e,t,n){var r=this.labeler.getObjectLabel(t),i=this.builder.createObjectReference(r);this.builder.top.setProperty(n,i)}},serializeSubstituteObject:{value:function(e,t,n,r,i){var a,o,s,l;a=this.labeler.getObjectLabel(t),this.labeler.isUserDefinedLabel(a)?(o=this.labeler.getObjectLabel(i),this.labeler.setObjectLabel(i,a),this.builder.relabelReferences(o,a),l=this.getObjectSerialization(i),l&&(l.setLabel(a),this.labeler.isUserDefinedLabel(o)&&this.builder.createObjectReference(a).setLabel(o)),e.visit(i,n)):(e.visit(i,n),s=this.labeler.getObjectLabel(i),this.labeler.setObjectLabel(t,s),this.builder.relabelReferences(a,s))}},serializeMontageObject:{value:function(e,t,n){var r,i,o=this.builder.createObjectLiteral();return this.setObjectType(t,n),n.setProperty("properties",o),this.builder.push(n),"function"==typeof t.serializeSelf?(r=(new a).initWithMalkerAndVisitorAndObject(e,this,t,n),i=t.serializeSelf(r)):(this.setObjectProperties(e,t),this.setObjectCustomUnits(e,t)),this.builder.pop(),0===o.getPropertyNames().length&&n.clearProperty("properties"),i}},setObjectType:{value:function(e,t){var r=n.getInfoForObject(e).isInstance,i=this.getObjectLocationId(e),a=this.builder.createString(i);r?t.setProperty("prototype",a):t.setProperty("object",a)}},getObjectModuleId:{value:function(e){var t=n.getInfoForObject(e);return this._require.identify(t.moduleId,t.require)}},getObjectLocationId:{value:function(e){var t,i=this.getObjectModuleId(e),a=n.getInfoForObject(e),o=a.objectName;return t=r.MontageSerializer.getDefaultObjectNameForModuleId(i),t===o?i:i+"["+o+"]"}},setObjectProperties:{value:function(e,t){var n,r;r=this.builder.top.getProperty("properties"),this.builder.push(r),"function"==typeof t.serializeProperties?(n=(new i).initWithMalkerAndVisitorAndObject(e,this,t),t.serializeProperties(n)):this.setSerializableObjectProperties(e,t),this.builder.pop()}},setSerializableObjectProperties:{value:function(e,t){for(var r,i,a=n.getSerializablePropertyNames(t),o=a.length,s=0;o>s;s++)i=a[s],r=n.getPropertyAttribute(t,i,"serializable"),this.setProperty(e,i,t[i],r)}},hackIsReferenceAllowedForValue:{value:function(e){return"object"==typeof e&&null!=e&&!("undefined"!=typeof Element&&Element.isElement(e))}},setProperty:{value:function(e,t,n,r){var i;if("reference"===r&&this.hackIsReferenceAllowedForValue(n)){i=this.labeler.getObjectLabel(n);var a=this.builder.createObjectReference(i);this.builder.top.setProperty(t,a)}else e.visit(n,t)}},setObjectCustomUnits:{value:function(e,t){for(var n in this._units)this.setObjectCustomUnit(e,t,n)}},setObjectCustomUnit:{value:function(e,t,n){var r,i,a=this._units[n];a&&(i=(new o).initWithMalkerAndVisitorAndObject(e,this,t),r=a(i,t),null!=r&&e.visit(r,n))}},getExternalObjects:{value:function(){for(var e,t={},n=this.builder.getExternalReferences(),r=0;e=n[r];r++)t[e]=this.labeler.getObjectByLabel(e);return t}},getExternalElements:{value:function(){return this._elements}}});t.MontageVisitor=l}}),montageDefine("d407295","core/serialization/deserializer/montage-interpreter",{dependencies:["core/core","mousse/deserialization/interpreter","mousse/deserialization/context","./montage-reviver","core/promise"],factory:function(e,t){var n=e("core/core").Montage,r=e("mousse/deserialization/interpreter").Interpreter,i=e("mousse/deserialization/context").Context,a=e("./montage-reviver").MontageReviver,o=e("core/promise").Promise,s=n.specialize.call(r,{_require:{value:null},_reviver:{value:null},init:{value:function(e,t){if("function"!=typeof e)throw Error("Function 'require' missing.");return this._reviver=(new a).init(e,t),this._require=e,this}},instantiate:{value:function(e,t,n){var r;return r=(new l).init(e,this._reviver,t,n,this._require),r.getObjects()}},preloadModules:{value:function(e){var t,n,r,i,s=this._reviver,l=s.moduleLoader,u=[];for(var c in e)t=e[c],n=t.prototype||t.object,n&&(r=a.parseObjectLocationId(n),i=l.getModule(r.moduleId,c),o.isPromise(i)&&u.push(i));return u.length>0?o.all(u):void 0}}}),l=n.specialize.call(i,{_ELEMENT_ID_ATTRIBUTE:{value:"data-montage-id"},_unitsToDeserialize:{value:null},_element:{value:null},_require:{value:null},constructor:{value:function(){this._unitsToDeserialize=[]}},init:{value:function(e,t,n,r,a){return i.call(this,e,t,n),this._element=r,this._require=a,this}},getRequire:{value:function(){return this._require}},getElement:{value:function(){return this._element}},getElementById:{value:function(e){var t="*["+this._ELEMENT_ID_ATTRIBUTE+'="'+e+'"]';return this._element.querySelector(t)}},setUnitsToDeserialize:{value:function(e,t,n){this._unitsToDeserialize.push({object:e,objectDesc:t,unitNames:n})}},getUnitsToDeserialize:{value:function(){return this._unitsToDeserialize}}});t.MontageInterpreter=s,t.MontageContext=l}}),montageDefine("d407295","core/jshint",{dependencies:[],factory:function(e,t){var n=function(e){var t,n=function(){return t||(t=e(n)),t.apply(this,arguments)};return n}(function(e){"use strict";function t(){}function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function r(e,t){var r;for(r in t)n(t,r)&&(e[r]=t[r])}function i(){dt.couch&&r(pt,Tt),dt.rhino&&r(pt,It),dt.prototypejs&&r(pt,Rt),dt.node&&r(pt,At),dt.devel&&r(pt,Pt),dt.dojo&&r(pt,kt),dt.browser&&r(pt,St),dt.jquery&&r(pt,Lt),dt.mootools&&r(pt,jt),dt.wsh&&r(pt,Nt),dt.globalstrict&&dt.strict!==!1&&(dt.strict=!0)}function a(e,t,n){var r=Math.floor(100*(t/ot.length));throw{name:"JSHintError",line:t,character:n,message:e+" ("+r+"% scanned)."}}function o(t,n,r,i,o,s){var l,u,c;return n=n||ct,"(end)"===n.id&&(n=wt),u=n.line||0,l=n.from||0,c={id:"(error)",raw:t,evidence:ot[u-1]||"",line:u,character:l,a:r,b:i,c:o,d:s},c.reason=t.supplant(c),e.errors.push(c),dt.passfail&&a("Stopping. ",u,l),Ct+=1,Ct>=dt.maxerr&&a("Too many errors.",u,l),c}function s(e,t,n,r,i,a,s){return o(e,{line:t,from:n},r,i,a,s)}function l(e,t,n,r,i,s){var l=o(e,t,n,r,i,s);a("Stopping, unable to continue.",l.line,l.character)}function u(e,t,n,r,i,a,o){return l(e,{line:t,from:n},r,i,a,o)}function c(e,t){"hasOwnProperty"===e&&o("'hasOwnProperty' is a really bad name."),n(Q,e)&&!Q["(global)"]&&(Q[e]===!0?dt.latedef&&o("'{a}' was used before it was defined.",ct,e):dt.shadow||o("'{a}' is already defined.",ct,e)),Q[e]=t,Q["(global)"]?(tt[e]=Q,n(nt,e)&&(dt.latedef&&o("'{a}' was used before it was defined.",ct,e),delete nt[e])):vt[e]=Q}function h(){var e,t,n,r,a,o=ct.value;switch(o){case"*/":l("Unbegun comment.");break;case"/*members":case"/*member":o="/*members",ut||(ut={}),t=ut;break;case"/*jshint":case"/*jslint":t=dt,n=Ot;break;case"/*global":t=pt;break;default:l("What?")}r=Xt.token();e:for(;;){for(;;){if("special"===r.type&&"*/"===r.value)break e;if("(endline)"!==r.id&&","!==r.id)break;r=Xt.token()}"(string)"!==r.type&&"(identifier)"!==r.type&&"/*members"!==o&&l("Bad option.",r),a=Xt.token(),":"===a.id?(a=Xt.token(),t===ut&&l("Expected '{a}' and instead saw '{b}'.",r,"*/",":"),"indent"!==r.value||"/*jshint"!==o&&"/*jslint"!==o?"maxerr"!==r.value||"/*jshint"!==o&&"/*jslint"!==o?"maxlen"!==r.value||"/*jshint"!==o&&"/*jslint"!==o?"true"===a.value?t[r.value]=!0:"false"===a.value?t[r.value]=!1:l("Bad option value.",a):(e=+a.value,("number"!=typeof e||!isFinite(e)||0>=e||Math.floor(e)!==e)&&l("Expected a small integer and instead saw '{a}'.",a,a.value),t.maxlen=e):(e=+a.value,("number"!=typeof e||!isFinite(e)||0>=e||Math.floor(e)!==e)&&l("Expected a small integer and instead saw '{a}'.",a,a.value),t.maxerr=e):(e=+a.value,("number"!=typeof e||!isFinite(e)||0>=e||Math.floor(e)!==e)&&l("Expected a small integer and instead saw '{a}'.",a,a.value),t.white=!0,t.indent=e),r=Xt.token()):(("/*jshint"===o||"/*jslint"===o)&&l("Missing option value.",r),t[r.value]=!1,r=a)}n&&i()}function d(e){for(var t,n=e||0,r=0;n>=r;)t=st[r],t||(t=st[r]=Xt.token()),r+=1;return t}function p(e,t){switch(wt.id){case"(number)":"."===ct.id&&o("A dot following a number can be confused with a decimal point.",wt);break;case"-":("-"===ct.id||"--"===ct.id)&&o("Confusing minusses.");break;case"+":("+"===ct.id||"++"===ct.id)&&o("Confusing plusses.")}for(("(string)"===wt.type||wt.identifier)&&($=wt.value),e&&ct.id!==e&&(t?"(end)"===ct.id?o("Unmatched '{a}'.",t,t.id):o("Expected '{a}' to match '{b}' from line {c} and instead saw '{d}'.",ct,e,t.id,t.line,ct.value):("(identifier)"!==ct.type||ct.value!==e)&&o("Expected '{a}' and instead saw '{b}'.",ct,e,ct.value)),mt=wt,wt=ct;;){if(ct=st.shift()||Xt.token(),"(end)"===ct.id||"(error)"===ct.id)return;if("special"===ct.type)h();else if("(endline)"!==ct.id)break
}}function f(e,t){var n,r=!1;if("(end)"===ct.id&&l("Unexpected early end of program.",wt),p(),t&&($="anonymous",Q["(verb)"]=wt.value),t===!0&&wt.fud)n=wt.fud();else{if(wt.nud)n=wt.nud();else{if("(number)"===ct.type&&"."===wt.id)return o("A leading decimal point can be confused with a dot: '.{a}'.",wt,ct.value),p(),wt;l("Expected an identifier and instead saw '{a}'.",wt,wt.id)}for(;ct.lbp>e;)r="Array"==wt.value,p(),r&&"("==wt.id&&")"==ct.id&&o("Use the array literal notation [].",wt),wt.led?n=wt.led(n):l("Expected an operator and instead saw '{a}'.",wt,wt.id)}return n}function m(e,t){e=e||wt,t=t||ct,dt.white&&e.character!==t.from&&e.line===t.line&&o("Unexpected space after '{a}'.",t,e.value)}function v(e,t){e=e||wt,t=t||ct,!dt.white||e.character===t.from&&e.line===t.line||o("Unexpected space before '{a}'.",t,t.value)}function g(e,t){e=e||wt,t=t||ct,dt.white&&!e.comment&&e.line===t.line&&m(e,t)}function b(e,t){dt.white&&(e=e||wt,t=t||ct,e.line===t.line&&e.character===t.from&&o("Missing space after '{a}'.",ct,e.value))}function _(e,t){e=e||wt,t=t||ct,dt.laxbreak||e.line===t.line?dt.white&&(e=e||wt,t=t||ct,e.character===t.from&&o("Missing space after '{a}'.",ct,e.value)):o("Bad line breaking before '{a}'.",t,t.id)}function y(e){var t;dt.white&&"(end)"!==ct.id&&(t=it+(e||0),ct.from!==t&&o("Expected '{a}' to have an indentation at {b} instead at {c}.",ct,ct.value,t,ct.from))}function w(e){e=e||wt,e.line!==ct.line&&o("Line breaking error '{a}'.",e,e.value)}function E(){wt.line!==ct.line?dt.laxbreak||o("Bad line breaking before '{a}'.",wt,ct.id):wt.character!==ct.from&&dt.white&&o("Unexpected space after '{a}'.",ct,wt.value),p(","),b(wt,ct)}function C(e,t){var n=Bt[e];return n&&"object"==typeof n||(Bt[e]=n={id:e,lbp:t,value:e}),n}function x(e){return C(e,0)}function O(e,t){var n=x(e);return n.identifier=n.reserved=!0,n.fud=t,n}function S(e,t){var n=O(e,t);return n.block=!0,n}function T(e){var t=e.id.charAt(0);return(t>="a"&&"z">=t||t>="A"&&"Z">=t)&&(e.identifier=e.reserved=!0),e}function P(e,t){var n=C(e,150);return T(n),n.nud="function"==typeof t?t:function(){return this.right=f(150),this.arity="unary",("++"===this.id||"--"===this.id)&&(dt.plusplus?o("Unexpected use of '{a}'.",this,this.id):this.right.identifier&&!this.right.reserved||"."===this.right.id||"["===this.right.id||o("Bad operand.",this)),this},n}function k(e,t){var n=x(e);return n.type=e,n.nud=t,n}function D(e,t){var n=k(e,t);return n.identifier=n.reserved=!0,n}function M(e,t){return D(e,function(){return"function"==typeof t&&t(this),this})}function L(e,t,n,r){var i=C(e,n);return T(i),i.led=function(e){return r||(_(mt,wt),b(wt,ct)),"function"==typeof t?t(e,this):(this.left=e,this.right=f(n),this)},i}function j(e,t){var n=C(e,100);return n.led=function(e){_(mt,wt),b(wt,ct);var n=f(100);return e&&"NaN"===e.id||n&&"NaN"===n.id?o("Use the isNaN function to compare with NaN.",this):t&&t.apply(this,[e,n]),"!"===e.id&&o("Confusing use of '{a}'.",e,"!"),"!"===n.id&&o("Confusing use of '{a}'.",e,"!"),this.left=e,this.right=n,this},n}function A(e){return e&&("(number)"===e.type&&0===+e.value||"(string)"===e.type&&""===e.value||"null"===e.type&&!dt.eqnull||"true"===e.type||"false"===e.type||"undefined"===e.type)}function R(e){return C(e,20).exps=!0,L(e,function(e,t){if(t.left=e,pt[e.value]===!1&&vt[e.value]["(global)"]===!0?o("Read only.",e):e["function"]&&o("'{a}' is a function.",e,e.value),e){if("."===e.id||"["===e.id)return e.left&&"arguments"!==e.left.value||o("Bad assignment.",t),t.right=f(19),t;if(e.identifier&&!e.reserved)return"exception"===Q[e.value]&&o("Do not assign to the exception parameter.",e),t.right=f(19),t;e===Bt["function"]&&o("Expected an identifier in an assignment and instead saw a function invocation.",wt)}l("Bad assignment.",t)},20)}function I(e,t,n){var r=C(e,n);return T(r),r.led="function"==typeof t?t:function(e){return dt.bitwise&&o("Unexpected use of '{a}'.",this,this.id),this.left=e,this.right=f(n),this},r}function z(e){return C(e,20).exps=!0,L(e,function(e,t){return dt.bitwise&&o("Unexpected use of '{a}'.",t,t.id),b(mt,wt),b(wt,ct),e?"."===e.id||"["===e.id||e.identifier&&!e.reserved?(f(19),t):(e===Bt["function"]&&o("Expected an identifier in an assignment, and instead saw a function invocation.",wt),t):(l("Bad assignment.",t),void 0)},20)}function B(e){var t=C(e,150);return t.led=function(e){return dt.plusplus?o("Unexpected use of '{a}'.",this,this.id):e.identifier&&!e.reserved||"."===e.id||"["===e.id||o("Bad operand.",this),this.left=e,this},t}function N(e){return ct.identifier?(p(),wt.reserved&&!dt.es5&&(e&&"undefined"==wt.value||o("Expected an identifier and instead saw '{a}' (a reserved word).",wt,wt.id)),wt.value):void 0}function F(e){var t=N(e);return t?t:("function"===wt.id&&"("===ct.id?o("Missing name in function declaration."):l("Expected an identifier and instead saw '{a}'.",ct,ct.value),void 0)}function q(e){var t,n=0;if(";"===ct.id&&!ht)for(;;){if(t=d(n),t.reach)return;if("(endline)"!==t.id){if("function"===t.id){o("Inner functions should be listed at the top of the outer function.",t);break}o("Unreachable '{a}' after '{b}'.",t,t.value,e);break}n+=1}}function W(e){var t,n=it,r=vt,i=ct;return";"===i.id?(o("Unnecessary semicolon.",i),p(";"),void 0):(i.identifier&&!i.reserved&&":"===d().id&&(p(),p(":"),vt=Object.create(r),c(i.value,"label"),ct.labelled||o("Label '{a}' on {b} statement.",ct,i.value,ct.value),Yt.test(i.value+":")&&o("Label '{a}' looks like a javascript url.",i,i.value),ct.label=i.value,i=ct),e||y(),t=f(0,!0),i.block||(dt.expr||t&&t.exps?dt.nonew&&"("===t.id&&"new"===t.left.id&&o("Do not use 'new' for side effects."):o("Expected an assignment or function call and instead saw an expression.",wt),";"!==ct.id?dt.asi||dt.lastsemic&&"}"==ct.id&&ct.line==wt.line||s("Missing semicolon.",wt.line,wt.from+wt.value.length):(m(wt,ct),p(";"),b(wt,ct))),it=n,vt=r,t)}function U(){return"use strict"===ct.value?(_t&&o('Unnecessary "use strict".'),p(),p(";"),_t=!0,dt.newcap=!0,dt.undef=!0,!0):!1}function V(){for(var e=[];!ct.reach&&"(end)"!==ct.id;)";"===ct.id?(o("Unnecessary semicolon."),p(";")):e.push(W());return e}function H(e,t){var n,r,i=rt,a=it,s=_t,u=vt;if(rt=e,vt=Object.create(vt),b(wt,ct),r=ct,"{"===ct.id){if(p("{"),"}"!==ct.id||wt.line!==ct.line){for(it+=dt.indent;!e&&ct.from>it;)it+=dt.indent;e||U()||s||!dt.strict||!Q["(context)"]["(global)"]||o('Missing "use strict" statement.'),n=V(),_t=s,it-=dt.indent,y()}p("}",r),it=a}else e?((!t||dt.curly)&&o("Expected '{a}' and instead saw '{b}'.",ct,"{",ct.value),ht=!0,n=[W()],ht=!1):l("Expected '{a}' and instead saw '{b}'.",ct,"{",ct.value);return Q["(verb)"]=null,vt=u,rt=i,!e||!dt.noempty||n&&0!==n.length||o("Empty block."),n}function Y(e){ut&&"boolean"!=typeof ut[e]&&o("Unexpected /*member '{a}'.",wt,e),"number"==typeof lt[e]?lt[e]+=1:lt[e]=1}function G(e){var t=e.value,n=e.line,r=nt[t];"function"==typeof r&&(r=!1),r?r[r.length-1]!==n&&r.push(n):(r=[n],nt[t]=r)}function X(){var e=N(!0);return e||("(string)"===ct.id?(e=ct.value,p()):"(number)"===ct.id&&(e=""+ct.value,p())),e}function K(){var e,t=ct,n=[];if(p("("),g(),")"===ct.id)return p(")"),g(mt,wt),void 0;for(;;){if(e=F(!0),n.push(e),c(e,"parameter"),","!==ct.id)return p(")",t),g(mt,wt),n;E()}}function J(e,t){var n,r=dt,i=vt;return dt=Object.create(dt),vt=Object.create(vt),Q={"(name)":e||'"'+$+'"',"(line)":ct.line,"(context)":Q,"(breakage)":0,"(loopage)":0,"(scope)":vt,"(statement)":t},n=Q,wt.funct=Q,et.push(Q),e&&c(e,"function"),Q["(params)"]=K(),H(!1),vt=i,dt=r,Q["(last)"]=wt.line,Q=Q["(context)"],n}function Z(){function e(){var e={},t=ct;if(p("{"),"}"!==ct.id)for(;;){if("(end)"===ct.id)l("Missing '}' to match '{' from line {a}.",ct,t.line);else{if("}"===ct.id){o("Unexpected comma.",wt);break}","===ct.id?l("Unexpected comma.",ct):"(string)"!==ct.id&&o("Expected a string and instead saw {a}.",ct,ct.value)}if(e[ct.value]===!0?o("Duplicate key '{a}'.",ct,ct.value):"__proto__"===ct.value?o("Stupid key '{a}'.",ct,ct.value):e[ct.value]=!0,p(),p(":"),Z(),","!==ct.id)break;p(",")}p("}")}function t(){var e=ct;if(p("["),"]"!==ct.id)for(;;){if("(end)"===ct.id)l("Missing ']' to match '[' from line {a}.",ct,e.line);else{if("]"===ct.id){o("Unexpected comma.",wt);break}","===ct.id&&l("Unexpected comma.",ct)}if(Z(),","!==ct.id)break;p(",")}p("]")}switch(ct.id){case"{":e();break;case"[":t();break;case"true":case"false":case"null":case"(number)":case"(string)":p();break;case"-":p("-"),wt.character!==ct.from&&o("Unexpected space after '-'.",wt),m(wt,ct),p("(number)");break;default:l("Expected a JSON value.",ct)}}var $,Q,et,tt,nt,rt,it,at,ot,st,lt,ut,ct,ht,dt,pt,ft,mt,vt,gt,bt,_t,yt,wt,Et,Ct,xt={"<":!0,"<=":!0,"==":!0,"===":!0,"!==":!0,"!=":!0,">":!0,">=":!0,"+":!0,"-":!0,"*":!0,"/":!0,"%":!0},Ot={asi:!0,bitwise:!0,boss:!0,browser:!0,couch:!0,curly:!0,debug:!0,devel:!0,dojo:!0,eqeqeq:!0,eqnull:!0,es5:!0,evil:!0,expr:!0,forin:!0,globalstrict:!0,immed:!0,jquery:!0,latedef:!0,laxbreak:!0,loopfunc:!0,mootools:!0,newcap:!0,noarg:!0,node:!0,noempty:!0,nonew:!0,nomen:!0,onevar:!0,passfail:!0,plusplus:!0,prototypejs:!0,regexdash:!0,regexp:!0,rhino:!0,undef:!0,scripturl:!0,shadow:!0,strict:!0,sub:!0,supernew:!0,trailing:!0,white:!0,wsh:!0},St={ArrayBuffer:!1,ArrayBufferView:!1,addEventListener:!1,applicationCache:!1,blur:!1,clearInterval:!1,clearTimeout:!1,close:!1,closed:!1,DataView:!1,defaultStatus:!1,document:!1,event:!1,FileReader:!1,Float32Array:!1,Float64Array:!1,focus:!1,frames:!1,getComputedStyle:!1,HTMLElement:!1,history:!1,Int16Array:!1,Int32Array:!1,Int8Array:!1,Image:!1,length:!1,localStorage:!1,location:!1,moveBy:!1,moveTo:!1,name:!1,navigator:!1,onbeforeunload:!0,onblur:!0,onerror:!0,onfocus:!0,onload:!0,onresize:!0,onunload:!0,open:!1,openDatabase:!1,opener:!1,Option:!1,parent:!1,print:!1,removeEventListener:!1,resizeBy:!1,resizeTo:!1,screen:!1,scroll:!1,scrollBy:!1,scrollTo:!1,setInterval:!1,setTimeout:!1,status:!1,top:!1,Uint16Array:!1,Uint32Array:!1,Uint8Array:!1,WebSocket:!1,window:!1,Worker:!1,XMLHttpRequest:!1,XPathEvaluator:!1,XPathException:!1,XPathExpression:!1,XPathNamespace:!1,XPathNSResolver:!1,XPathResult:!1},Tt={require:!1,respond:!1,getRow:!1,emit:!1,send:!1,start:!1,sum:!1,log:!1,exports:!1,module:!1},Pt={alert:!1,confirm:!1,console:!1,Debug:!1,opera:!1,prompt:!1},kt={dojo:!1,dijit:!1,dojox:!1,define:!1,require:!1},Dt={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"/":"\\/","\\":"\\\\"},Mt=["closure","exception","global","label","outer","unused","var"],Lt={$:!1,jQuery:!1},jt={$:!1,$$:!1,Assets:!1,Browser:!1,Chain:!1,Class:!1,Color:!1,Cookie:!1,Core:!1,Document:!1,DomReady:!1,DOMReady:!1,Drag:!1,Element:!1,Elements:!1,Event:!1,Events:!1,Fx:!1,Group:!1,Hash:!1,HtmlTable:!1,Iframe:!1,IframeShim:!1,InputValidator:!1,instanceOf:!1,Keyboard:!1,Locale:!1,Mask:!1,MooTools:!1,Native:!1,Options:!1,OverText:!1,Request:!1,Scroller:!1,Slick:!1,Slider:!1,Sortables:!1,Spinner:!1,Swiff:!1,Tips:!1,Type:!1,typeOf:!1,URI:!1,Window:!1},At={__filename:!1,__dirname:!1,exports:!1,Buffer:!1,GLOBAL:!1,global:!1,module:!1,process:!1,require:!1},Rt={$:!1,$$:!1,$A:!1,$F:!1,$H:!1,$R:!1,$break:!1,$continue:!1,$w:!1,Abstract:!1,Ajax:!1,Class:!1,Enumerable:!1,Element:!1,Event:!1,Field:!1,Form:!1,Hash:!1,Insertion:!1,ObjectRange:!1,PeriodicalExecuter:!1,Position:!1,Prototype:!1,Selector:!1,Template:!1,Toggle:!1,Try:!1,Autocompleter:!1,Builder:!1,Control:!1,Draggable:!1,Draggables:!1,Droppables:!1,Effect:!1,Sortable:!1,SortableObserver:!1,Sound:!1,Scriptaculous:!1},It={defineClass:!1,deserialize:!1,gc:!1,help:!1,load:!1,loadClass:!1,print:!1,quit:!1,readFile:!1,readUrl:!1,runCommand:!1,seal:!1,serialize:!1,spawn:!1,sync:!1,toint32:!1,version:!1},zt={Array:!1,Boolean:!1,Date:!1,decodeURI:!1,decodeURIComponent:!1,encodeURI:!1,encodeURIComponent:!1,Error:!1,eval:!1,EvalError:!1,Function:!1,hasOwnProperty:!1,isFinite:!1,isNaN:!1,JSON:!1,Math:!1,Number:!1,Object:!1,parseInt:!1,parseFloat:!1,RangeError:!1,ReferenceError:!1,RegExp:!1,String:!1,SyntaxError:!1,TypeError:!1,URIError:!1},Bt={},Nt={ActiveXObject:!0,Enumerator:!0,GetObject:!0,ScriptEngine:!0,ScriptEngineBuildVersion:!0,ScriptEngineMajorVersion:!0,ScriptEngineMinorVersion:!0,VBArray:!0,WSH:!0,WScript:!0},Ft=/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/,qt=/^\s*([(){}\[.,:;'"~\?\]#@]|==?=?|\/(\*(jshint|jslint|members?|global)?|=|\/)?|\*[\/=]?|\+(?:=|\++)?|-(?:=|-+)?|%=?|&[&=]?|\|[|=]?|>>?>?=?|<([\/=!]|\!(\[|--)?|<=?)?|\^=?|\!=?=?|[a-zA-Z_$][a-zA-Z0-9_$]*|[0-9]+([xX][0-9a-fA-F]+|\.[0-9]*)?([eE][+\-]?[0-9]+)?)/,Wt=/[\u0000-\u001f&<"\/\\\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/,Ut=/[\u0000-\u001f&<"\/\\\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,Vt=/\*\/|\/\*/,Ht=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/,Yt=/^(?:javascript|jscript|ecmascript|vbscript|mocha|livescript)\s*:/i,Gt=/^\s*\/\*\s*falls\sthrough\s*\*\/\s*$/;"function"!=typeof Array.isArray&&(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.apply(e)}),"function"!=typeof Object.create&&(Object.create=function(e){return t.prototype=e,new t}),"function"!=typeof Object.keys&&(Object.keys=function(e){var t,r=[];for(t in e)n(e,t)&&r.push(t);return r}),"function"!=typeof String.prototype.entityify&&(String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),"function"!=typeof String.prototype.isAlpha&&(String.prototype.isAlpha=function(){return this>="a"&&"z￿">=this||this>="A"&&"Z￿">=this}),"function"!=typeof String.prototype.isDigit&&(String.prototype.isDigit=function(){return this>="0"&&"9">=this}),"function"!=typeof String.prototype.supplant&&(String.prototype.supplant=function(e){return this.replace(/\{([^{}]*)\}/g,function(t,n){var r=e[n];return"string"==typeof r||"number"==typeof r?r:t})}),"function"!=typeof String.prototype.name&&(String.prototype.name=function(){return Ht.test(this)?this:Wt.test(this)?'"'+this.replace(Ut,function(e){var t=Dt[e];return t?t:"\\u"+("0000"+e.charCodeAt().toString(16)).slice(-4)})+'"':'"'+this+'"'});var Xt=function Xt(){function e(){var e,t;return a>=ot.length?!1:(r=1,o=ot[a],a+=1,e=o.search(/ \t/),e>=0&&s("Mixed spaces and tabs.",a,e+1),o=o.replace(/\t/g,yt),e=o.search(Ft),e>=0&&s("Unsafe character.",a,e),dt.maxlen&&dt.maxlen<o.length&&s("Line too long.",a,o.length),t=o.search(/\s+$/),dt.trailing&&~t&&!~o.search(/^\s+$/)&&s("Trailing whitespace.",a,t),!0)}function t(e,t){var o,l;return l="(color)"===e||"(range)"===e?{type:e}:"(punctuator)"===e||"(identifier)"===e&&n(Bt,t)?Bt[t]||Bt["(error)"]:Bt[e],l=Object.create(l),("(string)"===e||"(range)"===e)&&!dt.scripturl&&Yt.test(t)&&s("Script URL.",a,i),"(identifier)"===e&&(l.identifier=!0,"__iterator__"===t||"__proto__"===t?u("Reserved name '{a}'.",a,i,t):!dt.nomen||"_"!==t.charAt(0)&&"_"!==t.charAt(t.length-1)||s("Unexpected {a} in '{b}'.",a,i,"dangling '_'",t)),l.value=t,l.line=a,l.character=r,l.from=i,o=l.id,"(endline)"!==o&&(ft=o&&("(,=:[!&|?{};".indexOf(o.charAt(o.length-1))>=0||"return"===o)),l}var r,i,a,o;return{init:function(t){ot="string"==typeof t?t.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n"):t,ot[0]&&"#!"==ot[0].substr(0,2)&&(ot[0]=""),a=0,e(),i=1},range:function(e,n){var l,c="";for(i=r,o.charAt(0)!==e&&u("Expected '{a}' and instead saw '{b}'.",a,r,e,o.charAt(0));;){switch(o=o.slice(1),r+=1,l=o.charAt(0)){case"":u("Missing '{a}'.",a,r,l);break;case n:return o=o.slice(1),r+=1,t("(range)",c);case"\\":s("Unexpected '{a}'.",a,r,l)}c+=l}},token:function(){function n(e){var t,n=e.exec(o);return n?(g=n[0].length,t=n[1],h=t.charAt(0),o=o.substr(g),i=r+g-t.length,r+=g,t):void 0}function l(n){function l(e){var t=parseInt(o.substr(h+1,e),16);h+=e,t>=32&&126>=t&&34!==t&&92!==t&&39!==t&&s("Unnecessary escapement.",a,r),r+=e,c=String.fromCharCode(t)}var c,h,d="";for(at&&'"'!==n&&s("Strings must use doublequote.",a,r),h=0;;){for(;h>=o.length;)h=0,e()||u("Unclosed string.",a,i);if(c=o.charAt(h),c===n)return r+=1,o=o.substr(h+1),t("(string)",d,n);if(" ">c){if("\n"===c||"\r"===c)break;s("Control character in string: {a}.",a,r+h,o.slice(0,h))}else if("\\"===c)switch(h+=1,r+=1,c=o.charAt(h)){case"\\":case'"':case"/":break;case"'":at&&s("Avoid \\'.",a,r);break;case"b":c="\b";break;case"f":c="\f";break;case"n":c="\n";break;case"r":c="\r";break;case"t":c="	";break;case"u":l(4);break;case"v":at&&s("Avoid \\v.",a,r),c="";break;case"x":at&&s("Avoid \\x-.",a,r),l(2);break;default:s("Bad escapement.",a,r)}d+=c,r+=1,h+=1}}for(var c,h,d,p,f,m,v,g,b,_,y;;){if(!o)return t(e()?"(endline)":"(end)","");if(y=n(qt)){if(h.isAlpha()||"_"===h||"$"===h)return t("(identifier)",y);if(h.isDigit())return isFinite(Number(y))||s("Bad number '{a}'.",a,r,y),o.substr(0,1).isAlpha()&&s("Missing space after '{a}'.",a,r,y),"0"===h&&(p=y.substr(1,1),p.isDigit()?"."!==wt.id&&s("Don't use extra leading zeros '{a}'.",a,r,y):!at||"x"!==p&&"X"!==p||s("Avoid 0x-. '{a}'.",a,r,y)),"."===y.substr(y.length-1)&&s("A trailing decimal point can be confused with a dot '{a}'.",a,r,y),t("(number)",y);switch(y){case'"':case"'":return l(y);case"//":gt&&s("Unexpected comment.",a,r),o="",wt.comment=!0;break;case"/*":for(gt&&s("Unexpected comment.",a,r);v=o.search(Vt),!(v>=0);)e()||u("Unclosed comment.",a,r);r+=v+2,"/"===o.substr(v,1)&&u("Nested comment.",a,r),o=o.substr(v+2),wt.comment=!0;break;case"/*members":case"/*member":case"/*jshint":case"/*jslint":case"/*global":case"*/":return{value:y,type:"special",line:a,character:r,from:i};case"":break;case"/":if("/="===wt.id&&u("A regular expression literal can be confused with '/='.",a,i),ft){for(f=0,d=0,g=0;;){switch(c=!0,h=o.charAt(g),g+=1,h){case"":return u("Unclosed regular expression.",a,i),void 0;case"/":for(f>0&&s("Unescaped '{a}'.",a,i+g,"/"),h=o.substr(0,g-1),_={g:!0,i:!0,m:!0};_[o.charAt(g)]===!0;)_[o.charAt(g)]=!1,g+=1;return r+=g,o=o.substr(g),_=o.charAt(0),("/"===_||"*"===_)&&u("Confusing regular expression.",a,i),t("(regexp)",h);case"\\":h=o.charAt(g)," ">h?s("Unexpected control character in regular expression.",a,i+g):"<"===h&&s("Unexpected escaped character '{a}' in regular expression.",a,i+g,h),g+=1;break;case"(":if(f+=1,c=!1,"?"===o.charAt(g))switch(g+=1,o.charAt(g)){case":":case"=":case"!":g+=1;break;default:s("Expected '{a}' and instead saw '{b}'.",a,i+g,":",o.charAt(g))}else d+=1;break;case"|":c=!1;break;case")":0===f?s("Unescaped '{a}'.",a,i+g,")"):f-=1;break;case" ":for(_=1;" "===o.charAt(g);)g+=1,_+=1;_>1&&s("Spaces are hard to count. Use {{a}}.",a,i+g,_);break;case"[":h=o.charAt(g),"^"===h&&(g+=1,dt.regexp?s("Insecure '{a}'.",a,i+g,h):"]"===o.charAt(g)&&u("Unescaped '{a}'.",a,i+g,"^")),_=!1,"]"===h&&(s("Empty class.",a,i+g-1),_=!0);e:do switch(h=o.charAt(g),g+=1,h){case"[":case"^":s("Unescaped '{a}'.",a,i+g,h),_=!0;break;case"-":_?_=!1:(s("Unescaped '{a}'.",a,i+g,"-"),_=!0);break;case"]":_||dt.regexdash||s("Unescaped '{a}'.",a,i+g-1,"-");break e;case"\\":h=o.charAt(g)," ">h?s("Unexpected control character in regular expression.",a,i+g):"<"===h&&s("Unexpected escaped character '{a}' in regular expression.",a,i+g,h),g+=1,_=!0;break;case"/":s("Unescaped '{a}'.",a,i+g-1,"/"),_=!0;break;case"<":_=!0;break;default:_=!0}while(h);break;case".":dt.regexp&&s("Insecure '{a}'.",a,i+g,h);break;case"]":case"?":case"{":case"}":case"+":case"*":s("Unescaped '{a}'.",a,i+g,h)}if(c)switch(o.charAt(g)){case"?":case"+":case"*":g+=1,"?"===o.charAt(g)&&(g+=1);break;case"{":for(g+=1,h=o.charAt(g),("0">h||h>"9")&&s("Expected a number and instead saw '{a}'.",a,i+g,h),g+=1,b=+h;h=o.charAt(g),!("0">h||h>"9");)g+=1,b=+h+10*b;if(m=b,","===h&&(g+=1,m=1/0,h=o.charAt(g),h>="0"&&"9">=h))for(g+=1,m=+h;h=o.charAt(g),!("0">h||h>"9");)g+=1,m=+h+10*m;"}"!==o.charAt(g)?s("Expected '{a}' and instead saw '{b}'.",a,i+g,"}",h):g+=1,"?"===o.charAt(g)&&(g+=1),b>m&&s("'{a}' should not be greater than '{b}'.",a,i+g,b,m)}}return h=o.substr(0,g-1),r+=g,o=o.substr(g),t("(regexp)",h)}return t("(punctuator)",y);case"#":return t("(punctuator)",y);default:return t("(punctuator)",y)}}else{for(y="",h="";o&&"!">o;)o=o.substr(1);o&&u("Unexpected '{a}'.",a,r,o.substr(0,1))}}}}}();k("(number)",function(){return this}),k("(string)",function(){return this}),Bt["(identifier)"]={type:"(identifier)",lbp:0,identifier:!0,nud:function(){var e,t=this.value,n=vt[t];if("function"==typeof n?n=void 0:"boolean"==typeof n&&(e=Q,Q=et[0],c(t,"var"),n=Q,Q=e),Q===n)switch(Q[t]){case"unused":Q[t]="var";break;case"unction":Q[t]="function",this["function"]=!0;break;case"function":this["function"]=!0;break;case"label":o("'{a}' is a statement label.",wt,t)}else if(Q["(global)"])"typeof"!=$&&"delete"!=$&&dt.undef&&"boolean"!=typeof pt[t]&&o("'{a}' is not defined.",wt,t),G(wt);else switch(Q[t]){case"closure":case"function":case"var":case"unused":o("'{a}' used out of scope.",wt,t);break;case"label":o("'{a}' is a statement label.",wt,t);break;case"outer":case"global":break;default:if(n===!0)Q[t]=!0;else if(null===n)o("'{a}' is not allowed.",wt,t),G(wt);else if("object"!=typeof n)"typeof"!=$&&"delete"!=$&&dt.undef?o("'{a}' is not defined.",wt,t):Q[t]=!0,G(wt);else switch(n[t]){case"function":case"unction":this["function"]=!0,n[t]="closure",Q[t]=n["(global)"]?"global":"outer";break;case"var":case"unused":n[t]="closure",Q[t]=n["(global)"]?"global":"outer";break;case"closure":case"parameter":Q[t]=n["(global)"]?"global":"outer";break;case"label":o("'{a}' is a statement label.",wt,t)}}return this},led:function(){l("Expected an operator and instead saw '{a}'.",ct,ct.value)}},k("(regexp)",function(){return this}),x("(endline)"),x("(begin)"),x("(end)").reach=!0,x("</").reach=!0,x("<!"),x("<!--"),x("-->"),x("(error)").reach=!0,x("}").reach=!0,x(")"),x("]"),x('"').reach=!0,x("'").reach=!0,x(";"),x(":").reach=!0,x(","),x("#"),x("@"),D("else"),D("case").reach=!0,D("catch"),D("default").reach=!0,D("finally"),M("arguments",function(e){_t&&Q["(global)"]&&o("Strict violation.",e)}),M("eval"),M("false"),M("Infinity"),M("NaN"),M("null"),M("this",function(e){_t&&(Q["(statement)"]&&Q["(name)"].charAt(0)>"Z"||Q["(global)"])&&o("Strict violation.",e)}),M("true"),M("undefined"),R("=","assign",20),R("+=","assignadd",20),R("-=","assignsub",20),R("*=","assignmult",20),R("/=","assigndiv",20).nud=function(){l("A regular expression literal can be confused with '/='.")},R("%=","assignmod",20),z("&=","assignbitand",20),z("|=","assignbitor",20),z("^=","assignbitxor",20),z("<<=","assignshiftleft",20),z(">>=","assignshiftright",20),z(">>>=","assignshiftrightunsigned",20),L("?",function(e,t){return t.left=e,t.right=f(10),p(":"),t["else"]=f(10),t},30),L("||","or",40),L("&&","and",50),I("|","bitor",70),I("^","bitxor",80),I("&","bitand",90),j("==",function(e,t){var n=dt.eqnull&&("null"==e.value||"null"==t.value);return!n&&dt.eqeqeq?o("Expected '{a}' and instead saw '{b}'.",this,"===","=="):A(e)?o("Use '{a}' to compare with '{b}'.",this,"===",e.value):A(t)&&o("Use '{a}' to compare with '{b}'.",this,"===",t.value),this}),j("==="),j("!=",function(e,t){return dt.eqeqeq?o("Expected '{a}' and instead saw '{b}'.",this,"!==","!="):A(e)?o("Use '{a}' to compare with '{b}'.",this,"!==",e.value):A(t)&&o("Use '{a}' to compare with '{b}'.",this,"!==",t.value),this}),j("!=="),j("<"),j(">"),j("<="),j(">="),I("<<","shiftleft",120),I(">>","shiftright",120),I(">>>","shiftrightunsigned",120),L("in","in",120),L("instanceof","instanceof",120),L("+",function(e,t){var n=f(130);return e&&n&&"(string)"===e.id&&"(string)"===n.id?(e.value+=n.value,e.character=n.character,!dt.scripturl&&Yt.test(e.value)&&o("JavaScript URL.",e),e):(t.left=e,t.right=n,t)},130),P("+","num"),P("+++",function(){return o("Confusing pluses."),this.right=f(150),this.arity="unary",this}),L("+++",function(e){return o("Confusing pluses."),this.left=e,this.right=f(130),this},130),L("-","sub",130),P("-","neg"),P("---",function(){return o("Confusing minuses."),this.right=f(150),this.arity="unary",this}),L("---",function(e){return o("Confusing minuses."),this.left=e,this.right=f(130),this},130),L("*","mult",140),L("/","div",140),L("%","mod",140),B("++","postinc"),P("++","preinc"),Bt["++"].exps=!0,B("--","postdec"),P("--","predec"),Bt["--"].exps=!0,P("delete",function(){var e=f(0);return(!e||"."!==e.id&&"["!==e.id)&&o("Variables should not be deleted."),this.first=e,this}).exps=!0,P("~",function(){return dt.bitwise&&o("Unexpected '{a}'.",this,"~"),f(150),this}),P("!",function(){return this.right=f(150),this.arity="unary",xt[this.right.id]===!0&&o("Confusing use of '{a}'.",this,"!"),this}),P("typeof","typeof"),P("new",function(){var e,t=f(155);if(t&&"function"!==t.id)if(t.identifier)switch(t["new"]=!0,t.value){case"Object":o("Use the object literal notation {}.",wt);break;case"Number":case"String":case"Boolean":case"Math":case"JSON":o("Do not use {a} as a constructor.",wt,t.value);break;case"Function":dt.evil||o("The Function constructor is eval.");break;case"Date":case"RegExp":break;default:"function"!==t.id&&(e=t.value.substr(0,1),dt.newcap&&("A">e||e>"Z")&&o("A constructor name should start with an uppercase letter.",wt))}else"."!==t.id&&"["!==t.id&&"("!==t.id&&o("Bad constructor.",wt);else dt.supernew||o("Weird construction. Delete 'new'.",this);return m(wt,ct),"("===ct.id||dt.supernew||o("Missing '()' invoking a constructor."),this.first=t,this}),Bt["new"].exps=!0,P("void").exps=!0,L(".",function(e,t){m(mt,wt),v();var n=F();return"string"==typeof n&&Y(n),t.left=e,t.right=n,dt.noarg&&e&&"arguments"===e.value&&("callee"===n||"caller"===n)?o("Avoid arguments.{a}.",e,n):dt.evil||!e||"document"!==e.value||"write"!==n&&"writeln"!==n||o("document.write can be a form of eval.",e),dt.evil||"eval"!==n&&"execScript"!==n||o("eval is evil."),t},160,!0),L("(",function(e,t){"}"!==mt.id&&")"!==mt.id&&v(mt,wt),g(),dt.immed&&!e.immed&&"function"===e.id&&o("Wrap an immediate function invocation in parentheses to assist the reader in understanding that the expression is the result of a function, and not the function itself.");var n=0,r=[];if(e&&"(identifier)"===e.type&&e.value.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/)&&"Number"!==e.value&&"String"!==e.value&&"Boolean"!==e.value&&"Date"!==e.value&&("Math"===e.value?o("Math is not a function.",e):dt.newcap&&o("Missing 'new' prefix when invoking a constructor.",e)),")"!==ct.id)for(;r[r.length]=f(10),n+=1,","===ct.id;)E();return p(")"),g(mt,wt),"object"==typeof e&&("parseInt"===e.value&&1===n&&o("Missing radix parameter.",e),dt.evil||("eval"===e.value||"Function"===e.value||"execScript"===e.value?o("eval is evil.",e):!r[0]||"(string)"!==r[0].id||"setTimeout"!==e.value&&"setInterval"!==e.value||o("Implied eval is evil. Pass a function instead of a string.",e)),e.identifier||"."===e.id||"["===e.id||"("===e.id||"&&"===e.id||"||"===e.id||"?"===e.id||o("Bad invocation.",e)),t.left=e,t},155,!0).exps=!0,P("(",function(){g(),"function"===ct.id&&(ct.immed=!0);var e=f(0);return p(")",this),g(mt,wt),dt.immed&&"function"===e.id&&("("===ct.id?o("Move the invocation into the parens that contain the function.",ct):o("Do not wrap function literals in parens unless they are to be immediately invoked.",this)),e}),L("[",function(e,t){v(mt,wt),g();var n,r=f(0);return r&&"(string)"===r.type&&(dt.evil||"eval"!==r.value&&"execScript"!==r.value||o("eval is evil.",t),Y(r.value),!dt.sub&&Ht.test(r.value)&&(n=Bt[r.value],n&&n.reserved||o("['{a}'] is better written in dot notation.",r,r.value))),p("]",t),g(mt,wt),t.left=e,t.right=r,t},160,!0),P("[",function(){var e=wt.line!==ct.line;for(this.first=[],e&&(it+=dt.indent,ct.from===it+dt.indent&&(it+=dt.indent));"(end)"!==ct.id;){for(;","===ct.id;)o("Extra comma."),p(",");if("]"===ct.id)break;if(e&&wt.line!==ct.line&&y(),this.first.push(f(10)),","!==ct.id)break;if(E(),"]"===ct.id&&!dt.es5){o("Extra comma.",wt);break}}return e&&(it-=dt.indent,y()),p("]",this),this},160),function(e){e.nud=function(){var e,t,n,r,i,a,s={};for(e=wt.line!==ct.line,e&&(it+=dt.indent,ct.from===it+dt.indent&&(it+=dt.indent));"}"!==ct.id;){if(e&&y(),"get"===ct.value&&":"!==d().id)p("get"),dt.es5||l("get/set are ES5 features."),n=X(),n||l("Missing property name."),a=ct,m(wt,ct),t=J(),!dt.loopfunc&&Q["(loopage)"]&&o("Don't make functions within a loop.",a),i=t["(params)"],i&&o("Unexpected parameter '{a}' in get {b} function.",a,i[0],n),m(wt,ct),p(","),y(),p("set"),r=X(),n!==r&&l("Expected {a} and instead saw {b}.",wt,n,r),a=ct,m(wt,ct),t=J(),i=t["(params)"],i&&1===i.length&&"value"===i[0]||o("Expected (value) in set {a} function.",a,n);else{if(n=X(),"string"!=typeof n)break;p(":"),b(wt,ct),f(10)}if(s[n]===!0&&o("Duplicate member '{a}'.",ct,n),s[n]=!0,Y(n),","!==ct.id)break;E(),","===ct.id?o("Extra comma.",wt):"}"!==ct.id||dt.es5||o("Extra comma.",wt)}return e&&(it-=dt.indent,y()),p("}",this),this},e.fud=function(){l("Expected to see a statement and instead saw a block.",wt)}}(x("{"));var Kt=O("var",function(e){var t,n,r;for(Q["(onevar)"]&&dt.onevar?o("Too many var statements."):Q["(global)"]||(Q["(onevar)"]=!0),this.first=[];b(wt,ct),t=F(),Q["(global)"]&&pt[t]===!1&&o("Redefinition of '{a}'.",wt,t),c(t,"unused"),!e&&(n=wt,this.first.push(wt),"="===ct.id&&(b(wt,ct),p("="),b(wt,ct),"undefined"===ct.id&&o("It is not necessary to initialize '{a}' to 'undefined'.",wt,t),"="===d(0).id&&ct.identifier&&l("Variable {a} was not declared correctly.",ct,ct.value),r=f(0),n.first=r),","===ct.id);)E();return this});Kt.exps=!0,S("function",function(){rt&&o("Function declarations should not be placed in blocks. Use a function expression or move the statement to the top of the outer function.",wt);var e=F();return m(wt,ct),c(e,"unction"),J(e,!0),"("===ct.id&&ct.line===wt.line&&l("Function declarations are not invocable. Wrap the whole function invocation in parens."),this}),P("function",function(){var e=N();return e?m(wt,ct):b(wt,ct),J(e),!dt.loopfunc&&Q["(loopage)"]&&o("Don't make functions within a loop."),this}),S("if",function(){var e=ct;return p("("),b(this,e),g(),f(20),"="===ct.id&&(dt.boss||o("Expected a conditional expression and instead saw an assignment."),p("="),f(20)),p(")",e),g(mt,wt),H(!0,!0),"else"===ct.id&&(b(wt,ct),p("else"),"if"===ct.id||"switch"===ct.id?W(!0):H(!0,!0)),this}),S("try",function(){var e,t,n;return H(!1),"catch"===ct.id&&(p("catch"),b(wt,ct),p("("),n=vt,vt=Object.create(n),t=ct.value,"(identifier)"!==ct.type?o("Expected an identifier and instead saw '{a}'.",ct,t):c(t,"exception"),p(),p(")"),H(!1),e=!0,vt=n),"finally"===ct.id?(p("finally"),H(!1),void 0):(e||l("Expected '{a}' and instead saw '{b}'.",ct,"catch",ct.value),this)}),S("while",function(){var e=ct;return Q["(breakage)"]+=1,Q["(loopage)"]+=1,p("("),b(this,e),g(),f(20),"="===ct.id&&(dt.boss||o("Expected a conditional expression and instead saw an assignment."),p("="),f(20)),p(")",e),g(mt,wt),H(!0,!0),Q["(breakage)"]-=1,Q["(loopage)"]-=1,this}).labelled=!0,D("with"),S("switch",function(){var e=ct,t=!1;for(Q["(breakage)"]+=1,p("("),b(this,e),g(),this.condition=f(20),p(")",e),g(mt,wt),b(wt,ct),e=ct,p("{"),b(wt,ct),it+=dt.indent,this.cases=[];;)switch(ct.id){case"case":switch(Q["(verb)"]){case"break":case"case":case"continue":case"return":case"switch":case"throw":break;default:Gt.test(ot[ct.line-2])||o("Expected a 'break' statement before 'case'.",wt)}y(-dt.indent),p("case"),this.cases.push(f(20)),t=!0,p(":"),Q["(verb)"]="case";break;case"default":switch(Q["(verb)"]){case"break":case"continue":case"return":case"throw":break;default:Gt.test(ot[ct.line-2])||o("Expected a 'break' statement before 'default'.",wt)}y(-dt.indent),p("default"),t=!0,p(":");break;case"}":return it-=dt.indent,y(),p("}",e),(1===this.cases.length||"true"===this.condition.id||"false"===this.condition.id)&&o("This 'switch' should be an 'if'.",this),Q["(breakage)"]-=1,Q["(verb)"]=void 0,void 0;case"(end)":return l("Missing '{a}'.",ct,"}"),void 0;default:if(t)switch(wt.id){case",":return l("Each value should have its own case label."),void 0;case":":V();break;default:l("Missing ':' on a case clause.",wt)}else l("Expected '{a}' and instead saw '{b}'.",ct,"case",ct.value)
}}).labelled=!0,O("debugger",function(){return dt.debug||o("All 'debugger' statements should be removed."),this}).exps=!0,function(){var e=O("do",function(){Q["(breakage)"]+=1,Q["(loopage)"]+=1,this.first=H(!0),p("while");var e=ct;return b(wt,e),p("("),g(),f(20),"="===ct.id&&(dt.boss||o("Expected a conditional expression and instead saw an assignment."),p("="),f(20)),p(")",e),g(mt,wt),Q["(breakage)"]-=1,Q["(loopage)"]-=1,this});e.labelled=!0,e.exps=!0}(),S("for",function(){var e,t=ct;if(Q["(breakage)"]+=1,Q["(loopage)"]+=1,p("("),b(this,t),g(),"in"===d("var"===ct.id?1:0).id){if("var"===ct.id)p("var"),Kt.fud.call(Kt,!0);else{switch(Q[ct.value]){case"unused":Q[ct.value]="var";break;case"var":break;default:o("Bad for in variable '{a}'.",ct,ct.value)}p()}return p("in"),f(20),p(")",t),e=H(!0,!0),dt.forin&&(e.length>1||"object"!=typeof e[0]||"if"!==e[0].value)&&o("The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype.",this),Q["(breakage)"]-=1,Q["(loopage)"]-=1,this}if(";"!==ct.id)if("var"===ct.id)p("var"),Kt.fud.call(Kt);else for(;f(0,"for"),","===ct.id;)E();if(w(wt),p(";"),";"!==ct.id&&(f(20),"="===ct.id&&(dt.boss||o("Expected a conditional expression and instead saw an assignment."),p("="),f(20))),w(wt),p(";"),";"===ct.id&&l("Expected '{a}' and instead saw '{b}'.",ct,")",";"),")"!==ct.id)for(;f(0,"for"),","===ct.id;)E();return p(")",t),g(mt,wt),H(!0,!0),Q["(breakage)"]-=1,Q["(loopage)"]-=1,this}).labelled=!0,O("break",function(){var e=ct.value;return 0===Q["(breakage)"]&&o("Unexpected '{a}'.",ct,this.value),w(this),";"!==ct.id&&wt.line===ct.line&&("label"!==Q[e]?o("'{a}' is not a statement label.",ct,e):vt[e]!==Q&&o("'{a}' is out of scope.",ct,e),this.first=ct,p()),q("break"),this}).exps=!0,O("continue",function(){var e=ct.value;return 0===Q["(breakage)"]&&o("Unexpected '{a}'.",ct,this.value),w(this),";"!==ct.id?wt.line===ct.line&&("label"!==Q[e]?o("'{a}' is not a statement label.",ct,e):vt[e]!==Q&&o("'{a}' is out of scope.",ct,e),this.first=ct,p()):Q["(loopage)"]||o("Unexpected '{a}'.",ct,this.value),q("continue"),this}).exps=!0,O("return",function(){return w(this),"(regexp)"===ct.id&&o("Wrap the /regexp/ literal in parens to disambiguate the slash operator."),";"===ct.id||ct.reach||(b(wt,ct),this.first=f(20)),q("return"),this}).exps=!0,O("throw",function(){return w(this),b(wt,ct),this.first=f(20),q("throw"),this}).exps=!0,D("class"),D("const"),D("enum"),D("export"),D("extends"),D("import"),D("super"),D("let"),D("yield"),D("implements"),D("interface"),D("package"),D("private"),D("protected"),D("public"),D("static");var Jt=function(t,n,a){var s,l,u;if(e.errors=[],pt=Object.create(zt),r(pt,a||{}),n){if(s=n.predef)if(Array.isArray(s))for(l=0;s.length>l;l+=1)pt[s[l]]=!0;else if("object"==typeof s)for(u=Object.keys(s),l=0;u.length>l;l+=1)pt[u[l]]=!!s[u];dt=n}else dt={};for(dt.indent=dt.indent||4,dt.maxerr=dt.maxerr||50,yt="",l=0;dt.indent>l;l+=1)yt+=" ";it=1,tt=Object.create(pt),vt=tt,Q={"(global)":!0,"(name)":"(global)","(scope)":vt,"(breakage)":0,"(loopage)":0},et=[Q],Et=[],gt=!1,bt=null,lt={},ut=null,nt={},rt=!1,st=[],at=!1,Ct=0,Xt.init(t),ft=!0,_t=!1,mt=wt=ct=Bt["(begin)"],i();try{switch(p(),ct.id){case"{":case"[":dt.laxbreak=!0,at=!0,Z();break;default:"use strict"===ct.value&&(dt.globalstrict||o('Use the function form of "use strict".'),U()),V("lib")}p("(end)")}catch(c){c&&e.errors.push({reason:c.message,line:c.line||ct.line,character:c.character||ct.from},null)}return 0===e.errors.length};return e.data=function(){var t,r,i,a,o,s,l,u={functions:[]},c=[],h=[],d=[];e.errors.length&&(u.errors=e.errors),at&&(u.json=!0);for(s in nt)n(nt,s)&&c.push({name:s,line:nt[s]});for(c.length>0&&(u.implieds=c),Et.length>0&&(u.urls=Et),r=Object.keys(vt),r.length>0&&(u.globals=r),a=1;et.length>a;a+=1){for(i=et[a],t={},o=0;Mt.length>o;o+=1)t[Mt[o]]=[];for(s in i)n(i,s)&&"("!==s.charAt(0)&&(l=i[s],"unction"===l&&(l="unused"),Array.isArray(t[l])&&(t[l].push(s),"unused"===l&&d.push({name:s,line:i["(line)"],"function":i["(name)"]})));for(o=0;Mt.length>o;o+=1)0===t[Mt[o]].length&&delete t[Mt[o]];t.name=i["(name)"],t.param=i["(params)"],t.line=i["(line)"],t.last=i["(last)"],u.functions.push(t)}d.length>0&&(u.unused=d),h=[];for(s in lt)if("number"==typeof lt[s]){u.member=lt;break}return u},e.report=function(t){function n(e,t){var n,r,i;if(t){for(m.push("<div><i>"+e+"</i> "),t=t.sort(),r=0;t.length>r;r+=1)t[r]!==i&&(i=t[r],m.push((n?", ":"")+i),n=!0);m.push("</div>")}}var r,i,a,o,s,l,u,c,h,d=e.data(),p=[],f="",m=[];if(d.errors||d.implieds||d.unused){if(a=!0,m.push("<div id=errors><i>Error:</i>"),d.errors)for(s=0;d.errors.length>s;s+=1)r=d.errors[s],r&&(i=r.evidence||"",m.push("<p>Problem"+(isFinite(r.line)?" at line "+r.line+" character "+r.character:"")+": "+r.reason.entityify()+"</p><p class=evidence>"+(i&&(i.length>80?i.slice(0,77)+"...":i).entityify())+"</p>"));if(d.implieds){for(h=[],s=0;d.implieds.length>s;s+=1)h[s]="<code>"+d.implieds[s].name+"</code>&nbsp;<i>"+d.implieds[s].line+"</i>";m.push("<p><i>Implied global:</i> "+h.join(", ")+"</p>")}if(d.unused){for(h=[],s=0;d.unused.length>s;s+=1)h[s]="<code><u>"+d.unused[s].name+"</u></code>&nbsp;<i>"+d.unused[s].line+"</i> <code>"+d.unused[s]["function"]+"</code>";m.push("<p><i>Unused variable:</i> "+h.join(", ")+"</p>")}d.json&&m.push("<p>JSON: bad.</p>"),m.push("</div>")}if(!t){for(m.push("<br><div id=functions>"),d.urls&&n("URLs<br>",d.urls,"<br>"),d.json&&!a?m.push("<p>JSON: good.</p>"):d.globals?m.push("<div><i>Global</i> "+d.globals.sort().join(", ")+"</div>"):m.push("<div><i>No new global variables introduced.</i></div>"),s=0;d.functions.length>s;s+=1)o=d.functions[s],m.push("<br><div class=function><i>"+o.line+"-"+o.last+"</i> "+(o.name||"")+"("+(o.param?o.param.join(", "):"")+")</div>"),n("<big><b>Unused</b></big>",o.unused),n("Closure",o.closure),n("Variable",o["var"]),n("Exception",o.exception),n("Outer",o.outer),n("Global",o.global),n("Label",o.label);if(d.member){if(p=Object.keys(d.member),p.length){for(p=p.sort(),f="<br><pre id=members>/*members ",u=10,s=0;p.length>s;s+=1)l=p[s],c=l.name(),u+c.length>72&&(m.push(f+"<br>"),f="    ",u=1),u+=c.length+2,1===d.member[l]&&(c="<i>"+c+"</i>"),p.length-1>s&&(c+=", "),f+=c;m.push(f+"<br>*/</pre>")}m.push("</div>")}}return m.join("")},e.jshint=Jt,e.edition="2011-04-16",Jt});"object"==typeof t&&(t.JSHINT=n),"undefined"!=typeof bootstrap&&bootstrap("core/jshint",function(e,t){"use strict";t.JSHINT=n})}}),montageDefine("d407295","core/serialization/serializer/montage-ast",{dependencies:["montage","mousse/serialization/ast"],factory:function(e,t){var n=e("montage").Montage,r=e("mousse/serialization/ast").Value,i=n.specialize.call(r,{constructor:{value:function i(){}},initWithRootAndId:{value:function(e,t){return r.call(this,e,t),this}},_getSerializationValue:{value:function(){return{"#":this.value}}}}),a=n.specialize.call(r,{constructor:{value:function a(){}},initWithRootAndModuleId:{value:function(e,t){return r.call(this,e,t),this}},_getSerializationValue:{value:function(){return{"%":this.value}}}});t.ElementReference=i,t.ModuleReference=a}}),montageDefine("d407295","core/serialization/serializer/properties-serializer",{dependencies:["montage"],factory:function(e,t){var n=e("montage").Montage,r=n.specialize.call(Object,{_malker:{value:null},_visitor:{value:null},_object:{value:null},constructor:{value:function r(){}},initWithMalkerAndVisitorAndObject:{value:function(e,t,n){return this._malker=e,this._visitor=t,this._object=n,this}},addObject:{value:function(e){return"object"==typeof e?(this._malker.visit(e),e):void 0}},addObjectReference:{value:function(e){var t=this._visitor.builder,n=this._visitor.labeler,r=n.getObjectLabel(e),a=Object.create(i);return a.reference=t.createReference(r),a}},set:{value:function(e,t,n){this._visitor.setProperty(this._malker,e,t,n)}},setAll:{value:function(){this._visitor.setSerializableObjectProperties(this._malker,this._object)}}}),i={thisIsAReferenceCreatedByMontageSerializer:!0,reference:null};t.PropertiesSerializer=r}}),montageDefine("d407295","core/serialization/serializer/self-serializer",{dependencies:["montage"],factory:function(e,t){var n=e("montage").Montage,r=n.specialize.call(Object,{_malker:{value:null},_visitor:{value:null},_object:{value:null},constructor:{value:function r(){}},initWithMalkerAndVisitorAndObject:{value:function(e,t,n){return this._malker=e,this._visitor=t,this._object=n,this}},getObjectLabel:{value:function(e){return this._visitor.labeler.getObjectLabel(e)}},addObject:{value:function(e){return"object"==typeof e?(this._malker.visit(e),e):void 0}},addObjectReference:{value:function(e){var t=this._visitor.builder,n=this._visitor.labeler,r=n.getObjectLabel(e);return{thisIsAReferenceCreatedByMontageSerializer:!0,reference:t.createObjectReference(r)}}},setProperty:{value:function(e,t,n){var r,i=this._visitor.builder;r=i.top.getProperty("properties"),i.push(r),this._visitor.setProperty(this._malker,e,t,n),i.pop()}},setAllProperties:{value:function(){var e,t=this._visitor.builder;e=t.top.getProperty("properties"),t.push(e),this._visitor.setSerializableObjectProperties(this._malker,this._object),t.pop()}},setUnit:{value:function(e){this._visitor.setObjectCustomUnit(this._malker,this._object,e)}},setAllUnits:{value:function(){this._visitor.setObjectCustomUnits(this._malker,this._object)}}});t.SelfSerializer=r}}),montageDefine("d407295","core/serialization/serializer/unit-serializer",{dependencies:["montage"],factory:function(e,t){function n(e,t,n){this._visitor=e,this._malker=t,this._object=n}var r=e("montage").Montage,n=r.specialize.call(Object,{_malker:{value:null},_visitor:{value:null},_object:{value:null},constructor:{value:function n(){}},initWithMalkerAndVisitorAndObject:{value:function(e,t,n){return this._malker=e,this._visitor=t,this._object=n,this}},getObjectLabel:{value:function(e){return this.addObjectReference(e),this._visitor.labeler.getObjectLabel(e)}},addObject:{value:function(e){return"object"==typeof e?(this._malker.visit(e),e):void 0}},addObjectReference:{value:function(e){var t=this._visitor.builder,n=this._visitor.labeler,r=n.getObjectLabel(e);return{thisIsAReferenceCreatedByMontageSerializer:!0,reference:t.createObjectReference(r)}}}});t.UnitSerializer=n}}),montageDefine("d407295","ui/component",{dependencies:["montage","core/target","core/bindings","core/template","core/document-resources","core/gate","core/promise","core/logger","core/event/event-manager","collections/set","core/application"],factory:function(e,t){var n=e("montage").Montage,r=e("core/target").Target,i=e("core/bindings").Bindings,a=e("core/template").Template,o=e("core/document-resources").DocumentResources,s=e("core/gate").Gate,l=e("core/promise").Promise,u=e("core/logger").logger("component"),c=e("core/logger").logger("Drawing performance"),h=e("core/logger").logger("drawing"),d=e("core/event/event-manager").defaultEventManager,p=e("collections/set"),f=t.Component=r.specialize({DOM_ARG_ATTRIBUTE:{value:"data-arg"},constructor:{value:function f(){this.super(),this._isComponentExpanded=!1,this._isTemplateLoaded=!1,this._isTemplateInstantiated=!1,this._isComponentTreeLoaded=!1}},delegate:{value:null},templateObjects:{serializable:!1,value:null},_nextTarget:{value:null},nextTarget:{get:function(){return this._nextTarget||this.parentComponent},set:function(e){this._nextTarget=e}},_ownerDocumentPart:{value:null},_templateDocumentPart:{value:null},_domArguments:{value:null},_dispatchActionEvent:{value:function(){this.dispatchEvent(this.createActionEvent())},enumerable:!1},createActionEvent:{value:function(){var e=document.createEvent("CustomEvent");return e.initCustomEvent("action",!0,!0,null),e}},canDrawGate:{get:function(){return this._canDrawGate||(this._canDrawGate=(new s).initWithDelegate(this),this._canDrawGate.setField("componentTreeLoaded",!1)),this._canDrawGate},enumerable:!1},_blockDrawGate:{value:null},blockDrawGate:{enumerable:!1,get:function(){return this._blockDrawGate||(this._blockDrawGate=(new s).initWithDelegate(this),this._blockDrawGate.setField("element",!1),this._blockDrawGate.setField("drawRequested",!1)),this._blockDrawGate}},_firstDraw:{enumerable:!1,value:!0},_completedFirstDraw:{enumerable:!1,value:!1},originalElement:{value:null},_element:{enumerable:!1,value:null},element:{get:function(){return this._element},set:function(e){if(null==e)return console.warn("Tried to set element of ",this," to ",e),void 0;if(this.isDeserializing)this.eventManager.registerEventHandlerForElement(this,e),this._isTemplateInstantiated?this._templateElement||(this._templateElement=e):(this._element=e,!this.blockDrawGate.value&&this._element&&this.blockDrawGate.setField("element",!0));else{if(!this._firstDraw)return console.error("Cannot change element of ",this," after it has been set"),void 0;this.eventManager.registerEventHandlerForElement(this,e),this._element=e,!this.blockDrawGate.value&&this._element&&this.blockDrawGate.setField("element",!0)}this._initializeClassListFromElement(e)}},getElementId:{value:function(){var e=this._element;return e?e.getAttribute("data-montage-id"):void 0}},_initDomArguments:{value:function(){var e,t,n,r={},i=this.element;e=i.querySelectorAll("*["+this.DOM_ARG_ATTRIBUTE+"]");e:for(var a,o=0;a=e[o];o++){for(n=a;(n=n.parentNode)!==i;)if(n.component)continue e;this._findAndDetachComponents(a),a.parentNode.removeChild(a),t=a.getAttribute(this.DOM_ARG_ATTRIBUTE),a.removeAttribute(this.DOM_ARG_ATTRIBUTE),r[t]=a}this._domArguments=r}},getDomArgumentNames:{value:function(){return Object.keys(this._domArguments)}},extractDomArgument:{value:function(e){var t;return t=this._domArguments[e],delete this._domArguments[e],t}},_getDomArgument:{value:function(e,t){var n,r,i,a,o;n=e.querySelectorAll("*["+this.DOM_ARG_ATTRIBUTE+"='"+t+"']");e:for(var s,l=0;s=n[l];l++){for(r=s;(r=r.parentNode)!==e;)if(i=this._template.getElementId(r),i&&(a=this._template.getSerialization(),o=a.getSerializationLabelsWithElements(i),o.length>0))continue e;return s}}},getTemplateParameterArgument:{value:function(e,t){var n,r,i;return n=e.getElementById(this.getElementId()),"*"===t?(r=e.document.createRange(),r.selectNodeContents(n),i=r.cloneContents()):(i=this._getDomArgument(n,t).cloneNode(!0),i.removeAttribute(this.DOM_ARG_ATTRIBUTE)),i}},setElementWithParentComponent:{value:function(e,t){this._alternateParentComponent=t,this.element!==e&&(this.element=e)}},application:{enumerable:!1,get:function(){return e("core/application").application}},eventManager:{enumerable:!1,get:function(){return d}},rootComponent:{enumerable:!1,get:function(){return v}},elementControllerFromEvent:{enumerable:!1,value:function(e,t){return t}},_alternateParentComponent:{value:null},__parentComponent:{value:null},_parentComponent:{set:function(e){this.__parentComponent=e,this.dispatchOwnPropertyChange("parentComponent",e)},get:function(){return this.__parentComponent}},parentComponent:{enumerable:!1,get:function(){return this._parentComponent}},findParentComponent:{value:function(){var e,t=this.element,n=this.eventManager;if(t){for(;null!=(e=t.parentNode)&&null==n.eventHandlerForElement(e);)t=e;return e?n.eventHandlerForElement(e):this._alternateParentComponent}}},querySelectorComponent:{value:function(e){if("string"!=typeof e)throw"querySelectorComponent: Selector needs to be a string.";var t=e.match(/^\s*(?:@([^>\s]+))?(?:\s*(>)?\s*@([^>\s]+)(.*))?$/);if(!t)throw'querySelectorComponent: Syntax error "'+e+'"';var r,i,a,o=this.childComponents,s=t[1],l=(t[2]||" ",t[3]),u=t[4];if(s)for(u=l?"@"+l+u:"",i=0,a;a=o[i];i++){if(s===n.getInfoForObject(a).label)return u?a.querySelectorComponent(u):a;if(r=a.querySelectorComponent(e))return r}else for(i=0,a;a=o[i];i++)if(l===n.getInfoForObject(a).label)return u?a.querySelectorComponent(u):a;return null}},querySelectorAllComponent:{value:function(e,t){if("string"!=typeof e)throw"querySelectorComponent: Selector needs to be a string.";var r=e.match(/^\s*(?:@([^>\s]+))?(?:\s*(>)?\s*@([^>\s]+)(.*))?$/);if(!r)throw'querySelectorComponent: Syntax error "'+e+'"';var i,a,o=this.childComponents,s=r[1],l=(r[2]||" ",r[3]),u=r[4],c=[];if(s)for(u=l?"@"+l+u:"",i=0,a;a=o[i];i++)s!==n.getInfoForObject(a).label||t&&t!==a.ownerComponent?c=c.concat(a.querySelectorAllComponent(e,t)):u?c=c.concat(a.querySelectorAllComponent(u)):c.push(a);else for(i=0,a;a=o[i];i++)l!==n.getInfoForObject(a).label||t&&t!==a.ownerComponent||(u?c=c.concat(a.querySelectorAllComponent(u,t)):c.push(a));return c}},template:{enumerable:!1,value:null},hasTemplate:{enumerable:!1,value:!0},_templateModuleId:{serializable:!1,value:null},_template:{value:null},_treeLevel:{value:0},_addChildComponent:{value:function(e){return this.addChildComponent(e)}},addChildComponent:{value:function(e){-1===this.childComponents.indexOf(e)&&(this.childComponents.push(e),e._prepareForEnterDocument(),e._parentComponent=this,e.needsDraw&&e._addToParentsDrawList())}},attachToParentComponent:{value:function(){this.detachFromParentComponent(),this._parentComponent=null;var e,t,n=this.findParentComponent();if(n){e=n.childComponents;for(var r=0;t=e[r];r++){var i=t.findParentComponent();i===this&&(n.removeChildComponent(t),i.addChildComponent(t))}n.addChildComponent(this)}}},detachFromParentComponent:{value:function(){var e=this.parentComponent;e&&e.removeChildComponent(this)}},removeChildComponent:{value:function(e){var t=this.childComponents,n=t.indexOf(e);n>-1&&(e._exitDocument(),t.splice(n,1),e._parentComponent=null,e._alternateParentComponent=null,e._addedToDrawList&&(e._addedToDrawList=!1,n=this._drawList.indexOf(e),this._drawList.splice(n,1)),this.rootComponent.removeFromCannotDrawList(e))}},childComponents:{enumerable:!1,distinct:!0,value:[]},_needsEnterDocument:{value:!1},_inDocument:{value:!1},__exitDocument:{value:function(){this._inDocument&&"function"==typeof this.exitDocument&&(this.exitDocument(),this._inDocument=!1)}},_exitDocument:{value:function(){var e;this._needsEnterDocument?this._needsEnterDocument=!1:(e=function(t){for(var n,r=t.childComponents,i=0;n=r[i];i++)n._isComponentExpanded&&e(n);t._inDocument&&t.__exitDocument()},e(this))}},exitDocument:{value:function(){this.isActiveTarget&&(d.activeTarget=this.nextTarget)}},_prepareForEnterDocument:{value:function(){this._firstDraw?this._needsEnterDocument=!0:(this.needsDraw=!0,this.traverseComponentTree(function(e){return e._needsEnterDocument?!1:(e._needsEnterDocument=!0,e.needsDraw=!0,void 0)}))}},ownerComponent:{enumerable:!1,value:null},components:{enumerable:!1,value:{}},_isComponentExpanded:{enumerable:!1,value:null},_isTemplateLoaded:{enumerable:!1,value:null},_isTemplateInstantiated:{enumerable:!1,value:null},cleanupDeletedComponentTree:{value:function(e){e&&i.cancelBindings(this),this.needsDraw=!1,this.traverseComponentTree(function(t){e&&i.cancelBindings(t),t.needsDraw=!1})}},_newDomContent:{enumerable:!1,value:null},domContent:{serializable:!1,get:function(){return this._element?Array.prototype.slice.call(this._element.childNodes,0):null},set:function(e){var t,n,r,i=[];for(this._newDomContent=e,this.needsDraw=!0,null===this._newDomContent&&(this._shouldClearDomContentOnNextDraw=!0),"function"==typeof this.contentWillChange&&this.contentWillChange(e),t=this.childComponents,n=0,r;r=t[n];n++)r.detachFromParentComponent();if(e instanceof Element)this._findAndDetachComponents(e,i);else if(e&&e[0])for(n=0;e.length>n;n++)this._findAndDetachComponents(e[n],i);for(n=0,r;r=i[n];n++)this.addChildComponent(r)}},_shouldClearDomContentOnNextDraw:{value:!1},_findAndDetachComponents:{value:function(e,t){var n,r=e.component;if(t||(t=[]),r)r.detachFromParentComponent(),t.push(r);else{n=e.children||e.childNodes;for(var i,a=0;i=n[a];a++)this._findAndDetachComponents(i,t)}return t}},clonesChildComponents:{writable:!1,value:!1},_innerTemplate:{value:null},innerTemplate:{serializable:!1,get:function(){var e,t,n,r,i,a,o,s=this._innerTemplate;if(!s&&(e=this._ownerDocumentPart)){t=e.template,n=this.getElementId(),s=t.createTemplateFromElementContents(n),r=s.getSerialization(),i=r.getExternalObjectLabels(),a=e.objects,o=Object.create(null);for(var l,u=0;l=i[u];u++)o[l]=a[l];s.setInstances(o),this._innerTemplate=s}return s},set:function(e){this._innerTemplate=e}},canDraw:{value:function(){return this._canDraw}},_canDraw:{get:function(){return!this._canDrawGate||this._canDrawGate.value},set:function(e){v.componentCanDraw(this,e)},enumerable:!1},_prepareCanDraw:{enumerable:!1,value:function(){this._isComponentTreeLoaded||this.loadComponentTree().done()}},_isComponentTreeLoaded:{value:null},shouldLoadComponentTree:{value:!0},_loadComponentTreeDeferred:{value:null},loadComponentTree:{value:function(){var e=this,t=this.canDrawGate,n=this._loadComponentTreeDeferred;return n||(n=l.defer(),this._loadComponentTreeDeferred=n,t.setField("componentTreeLoaded",!1),(this.needsDraw||this.hasTemplate)&&(this._canDraw=!1),this.expandComponent().then(function(){if(e.hasTemplate||e.shouldLoadComponentTree){for(var t,n=[],r=e.childComponents,i=0;t=r[i];i++)n.push(t.loadComponentTree());return l.all(n)}}).then(function(){e._isComponentTreeLoaded=!0,e._needsEnterDocument&&(e.needsDraw=!0),t.setField("componentTreeLoaded",!0),n.resolve()},n.reject).done()),n.promise}},traverseComponentTree:{value:function(e,t){function n(){var n,i,a=r.childComponents;if(e&&e(r)===!1)return t&&t(),void 0;if(0===(i=a.length))return t&&t(),void 0;for(var o=function(){0===--i&&t&&t()},s=0;n=a[s];s++)n.traverseComponentTree(e,o)}var r=this;this._isComponentExpanded?n():t&&t()}},_expandComponentDeferred:{value:null},expandComponent:{value:function(){var e=this,t=this._expandComponentDeferred;return t||(t=l.defer(),this._expandComponentDeferred=t,this.hasTemplate?this._instantiateTemplate().then(function(){e._isComponentExpanded=!0,e._addTemplateStyles(),e.needsDraw=!0,t.resolve()},t.reject):(this._isComponentExpanded=!0,t.resolve())),t.promise}},_templateObjectDescriptor:{value:{enumerable:!0,configurable:!0}},_setupTemplateObjects:{value:function(e){var t=this._templateObjectDescriptor,n=Object.create(null);for(var r in e){var i=e[r];"object"==typeof i&&null!=i&&(f.prototype.isPrototypeOf(i)&&i!==this&&i.parentComponent!==this?(t.get=this._makeTemplateObjectGetter(this,r,i),Object.defineProperty(n,r,t)):n[r]=i)}this.templateObjects=n}},_makeTemplateObjectGetter:{value:function(e,t,n){var r,i,a,o="@"+t;return function(){if(r)return e.querySelectorAllComponent(o,e);if(i=e.querySelectorAllComponent(o,e),1===i.length)for(a=i[0];a=a.parentComponent;){if(a===e)return Object.defineProperty(this,t,{value:i[0]}),i[0];if(a.clonesChildComponents)break}else if(0===i.length)return n;return r=!0,i}}},_instantiateTemplate:{value:function(){var e=this;return this._loadTemplate().then(function(t){if(!e._element)return console.error("Cannot instantiate template without an element.",e),l.reject(Error("Cannot instantiate template without an element.",e));var n=e.templateObjects,r=e._element.ownerDocument;return n||(n=Object.create(null)),n.owner=e,e._isTemplateInstantiated=!0,t.instantiateWithInstances(n,r).then(function(t){e._templateDocumentPart=t,t.fragment=null}).fail(function(e){var n=e.stack||e;throw console.error("Error in",t.getBaseUrl()+":",n),e})})}},_templateDidLoad:{value:function(e){this._setupTemplateObjects(e.objects)}},_loadTemplatePromise:{value:null},_loadTemplate:{value:function(){var e,t=this,r=this._loadTemplatePromise;return r||(e=n.getInfoForObject(this),r=this._loadTemplatePromise=a.getTemplateWithModuleId(this.templateModuleId,e.require).then(function(e){return t._template=e,t._isTemplateLoaded=!0,e})),r}},templateModuleId:{get:function(){return this._templateModuleId||this._getDefaultTemplateModuleId()}},_getDefaultTemplateModuleId:{value:function(){var e,t,r,i;return i=n.getInfoForObject(this),r=i.moduleId,t=r.lastIndexOf("/"),e=r+"/"+r.slice(-1===t?0:t+1,-5)+".html"}},deserializedFromSerialization:{value:function(){this.attachToParentComponent()}},_deserializedFromTemplate:{value:function(e,t,r){n.getInfoForObject(this).label=t,this._ownerDocumentPart=r,this.hasOwnProperty("identifier")||(this.identifier=t),this.ownerComponent||(this.ownerComponent=f.prototype.isPrototypeOf(e)?e:this.rootComponent),this._needsDrawInDeserialization&&(this.needsDraw=!0)}},blueprintModuleId:{serializable:!1,enumerable:!1,get:function(){var e=n.getInfoForObject(this),t=e&&!e.isInstance?this:Object.getPrototypeOf(this);if(!Object.getOwnPropertyDescriptor(t,"_blueprintModuleId")||!t._blueprintModuleId){e=n.getInfoForObject(t);var r=e.moduleId,i=r.lastIndexOf("/"),a=r.lastIndexOf(".");i=-1===i?0:i+1,a=-1===a?r.length:a,a=i>a?r.length:a;var o;o=r.length>a&&".reel"===r.slice(a,r.length)?r+"/"+r.slice(i,a)+".meta":r.slice(0,a)+".meta",n.defineProperty(t,"_blueprintModuleId",{value:o})}return t._blueprintModuleId}},blueprint:e("montage")._blueprintDescriptor,gateDidBecomeTrue:{value:function(e){e===this._canDrawGate?this._canDraw=!0:e===this._blockDrawGate&&(v.componentBlockDraw(this),this._prepareCanDraw())},enumerable:!1},_canDrawGate:{enumerable:!1,value:null},_preparedForActivationEvents:{enumerable:!1,value:!1},_drawIfNeeded:{enumerable:!1,value:function(e){var t,r,i,a,o=this._firstDraw;if(this._treeLevel=e,o&&(this.originalElement=this.element),this.needsDraw&&v.addToDrawCycle(this),o&&this.prepareForDraw&&n.callDeprecatedFunction(this,this.prepareForDraw,"prepareForDraw","enterDocument(firstTime)"),this._needsEnterDocument&&(this._needsEnterDocument=!1,this._inDocument=!0,"function"==typeof this.enterDocument&&this.enterDocument(o),this._enterDocument(o)),o&&(this.originalElement=null),h.isDebug&&h.debug(this,"drawList: "+(this._drawList||[]).length+" of "+this.childComponents.length),null!==this._drawList&&this._drawList.length>0)for(r=this._drawList,this._drawList=[],a=r.length,i=0;a>i;i++)t=r[i],h.isDebug&&h.debug("Parent Component "+(null!=this.element?this.element.id:"")+" drawList length: "+r.length),t._addedToDrawList=!1,h.isDebug&&h.debug(this,"childComponent: "+t.element+"; canDraw: "+t.canDraw()),t.canDraw()&&t._drawIfNeeded(e+1)}},_updateComponentDom:{value:function(){var e,t,n;if(this._firstDraw){for(this._prepareForDraw(),t=this.composerList.length,n=0;t>n;n++)e=this.composerList[n],e.lazyLoad||e._load();this._firstDraw=!1}(null!==this._newDomContent||this._shouldClearDomContentOnNextDraw)&&(h.isDebug&&u.debug("Component content changed: component ",this._montage_metadata.objectName,this.identifier," newDomContent",this._newDomContent),this._performDomContentChanges())}},_replaceElementWithTemplate:{enumerable:!1,value:function(){var e,t,n,r,i=this.element,a=this._templateElement,o=this.element.attributes;for(n=0;r=o[n];n++)e=r.nodeName,t="id"===e||"data-montage-id"===e?r.nodeValue:(a.getAttribute(e)||"")+("style"===e?"; ":" ")+r.nodeValue,a.setAttribute(e,t);this._initializeClassListFromElement(a),i.parentNode?i.parentNode.replaceChild(a,i):console.warn("Warning: Trying to replace element ",i," which has no parentNode"),this.eventManager.unregisterEventHandlerForElement(i),this.eventManager.registerEventHandlerForElement(this,a),this._element=a,this._templateElement=null,this._newDomContent&&(this._newDomContent=null,this._shouldClearDomContentOnNextDraw=!1)}},_addTemplateStyles:{value:function(){var e,t,n,r=this._templateDocumentPart;if(r){e=r.template.getResources(),n=this.element.ownerDocument,t=e.createStylesForDocument(n);for(var i,a=0;i=t[a];a++)this.rootComponent.addStylesheet(i)}}},_prepareForDraw:{value:function(){u.isDebug&&u.debug(this,"_templateElement: "+this._templateElement),this._initDomArguments(),this._templateElement&&(this._bindTemplateParametersToArguments(),this._replaceElementWithTemplate())},enumerable:!1},_bindTemplateParametersToArguments:{value:function(){var e,t,n,r,i,a,o,s,l=this._templateDocumentPart.parameters;if(t=this._domArguments,this._template.hasParameters()||1!==t.length){if(r=this._validateTemplateArguments(t,l))throw r;for(var u in l){e=l[u],n=t[u],"*"===u?(o=this._element.ownerDocument.createRange(),o.selectNodeContents(this._element),i=o.extractContents()):i=n,a=this._findAndDetachComponents(i),e.parentNode.replaceChild(i,e);for(var c=0;s=a[c];c++)s.attachToParentComponent()}}}},_validateTemplateArguments:{value:function(e,t){var n,r,i=Object.keys(t);if(0!==i.length)if(null==e){if(i.length>0)return Error("No arguments provided for "+this.templateModuleId+". Arguments needed: "+i+".")}else if("*"in t){if(n=Object.keys(e),n.length>0)return Error('Arguments "'+n+'" were given to component but no named parameters '+"are defined in "+this.templateModuleId)}else{for(r in t)if(!(r in e))return Error('"'+r+'" argument not '+"given in "+this.templateModuleId);for(r in e)if("*"!==r&&!(r in t))return Error('"'+r+'" parameter does '+"not exist in "+this.templateModuleId)}}},prepareForActivationEvents:{enumerable:!1,value:null},_prepareForActivationEvents:{value:function(){var e,t=this.composerList.length;for(t=0;this.composerList.length>t;t++)e=this.composerList[t],e.lazyLoad&&e._load();"function"==typeof this.prepareForActivationEvents&&this.prepareForActivationEvents()}},_performDomContentChanges:{value:function(){var e,t=this._newDomContent,n=this._element.childNodes[0];if(t||this._shouldClearDomContentOnNextDraw){if(e=this._element,e.innerHTML="",Element.isElement(t))e.appendChild(t);else if(null!=t)for(var r,i=0;r=t[i];i++)e.appendChild(r);this._newDomContent=null,"function"==typeof this.contentDidChange&&this.contentDidChange(this._element.childNodes[0],n),this._shouldClearDomContentOnNextDraw=!1}}},prepareForDraw:{enumerable:!1,value:null},draw:{enumerable:!1,value:function(){}},willDraw:{enumerable:!1,value:null},didDraw:{enumerable:!1,value:function(){}},_addedToDrawList:{value:!1},_addToParentsDrawList:{enumerable:!1,value:function(){if(!this._addedToDrawList){var e=this.parentComponent;e?(e._addToDrawList(this),h.isDebug&&h.debug("drawList -- childComponent",this._montage_metadata.objectName," added to ",e._montage_metadata.objectName)):h.isDebug&&h.debug(this,"parentComponent is null")}}},_needsDraw:{value:!1},_needsDrawInDeserialization:{value:!1},needsDraw:{enumerable:!1,get:function(){return!!this._needsDraw},set:function(e){return this.isDeserializing?(this._needsDrawInDeserialization=!0,void 0):(this._needsDraw!==e&&(h.isDebug&&h.debug("NEEDS DRAW TOGGLED "+e+" FOR "+this._montage_metadata.objectName),this._needsDraw=!!e,e&&(this.canDrawGate.value?this._addToParentsDrawList():this.blockDrawGate.setField("drawRequested",!0))),void 0)}},_drawList:{value:null},__addToDrawList:{enumerable:!1,value:function(e){null===this._drawList?(this._drawList=[e],e._addedToDrawList=!0):-1===this._drawList.indexOf(e)&&(this._drawList.push(e),e._addedToDrawList=!0)}},_addToDrawList:{enumerable:!1,value:function(e){this.__addToDrawList(e),this._addToParentsDrawList()}},_templateElement:{enumerable:!1,value:null},surrenderPointer:{value:function(){return!0}},composerList:{value:[],distinct:!0,serializable:!1},addComposer:{value:function(e){this.addComposerForElement(e,e.element)}},addComposerForElement:{value:function(e,t){e.component=this,e.element=t,this.composerList.push(e),this._firstDraw||(e.lazyLoad?this._preparedForActivationEvents&&e._load():e._load())}},scheduleComposer:{value:function(e){this.rootComponent.addToComposerList(e)}},removeComposer:{value:function(e){var t,n;for(n=this.composerList.length,t=0;n>t;t++)if(this.composerList[t].uuid===e.uuid){this.composerList[t].unload(),this.composerList.splice(t,1);break}}},clearAllComposers:{value:function(){var e,t,n=this.composerList;for(t=n.length,e=0;t>e;e++)n[e].unload();n.splice(0,t)}},localizer:{value:null},_waitForLocalizerMessages:{value:!1},waitForLocalizerMessages:{enumerable:!1,get:function(){return this._waitForLocalizerMessages},set:function(e){if(this._waitForLocalizerMessages!==e)if(e!==!0||this.localizer.messages)this._waitForLocalizerMessages=!1,this.canDrawGate.setField("messages",!0);else{if(!this.localizer)throw"Cannot wait for messages on localizer if it is not set";this._waitForLocalizerMessages=!0;
var t=this;u.debug(this,"waiting for messages from localizer"),this.canDrawGate.setField("messages",!1),this.localizer.messagesPromise.then(function(){u.isDebug&&u.debug(t,"got messages from localizer"),t.canDrawGate.setField("messages",!0)})}}},_elementAttributeValues:{value:null},_elementAttributeDescriptors:{value:null},_getElementAttributeDescriptor:{value:function(e){for(var t,n=this;n&&n._elementAttributeDescriptors&&!(t=n._elementAttributeDescriptors[e]);)n=Object.getPrototypeOf(n);return t}},defineAttribute:{value:function(e,t){t=t||{};var r="_"+e,i={configurable:void 0===t.configurable?!0:t.configurable,enumerable:void 0===t.enumerable?!0:t.enumerable,set:function(e,t){return function(n){var r=this._getElementAttributeDescriptor(e,this);r&&"boolean"===r.dataType&&(n=n||""===n?!0:!1),void 0!==n&&this[t]!==n&&(this[t]=n,null===this._elementAttributeValues&&(this._elementAttributeValues={}),this._elementAttributeValues[e]=n,this.needsDraw=!0)}}(e,r),get:function(e,t){return function(){return this[t]}}(e,r)};n.defineProperty(this.prototype,r,{value:null}),n.defineProperty(this.prototype,e,i)}},addAttributes:{value:function(e){var t,n,r;this.prototype._elementAttributeDescriptors=e;for(n in e)e.hasOwnProperty(n)&&(r=e[n],null===r||"string"==typeof r?(t={value:r,dataType:"string"},e[n]=t):t=r,void 0===this[n]&&this.defineAttribute(n,t))}},_enterDocument:{value:function(e){var t;if(e){t=this.originalElement;var n,r,i,a,o,s,l;if(n=t.attributes)for(i=n.length,r=0;i>r;r++)a=n[r].name,o=n[r].value,l=this._getElementAttributeDescriptor(a,this),(l||void 0!==this[a])&&(null===this._elementAttributeValues&&(this._elementAttributeValues={}),void 0===this._elementAttributeValues[a]&&(this._elementAttributeValues[a]=o,(void 0===this[a]||null==this[a])&&(this[a]=o)));if(l=this._getElementAttributeDescriptor("textContent",this)){var u=t.textContent;void 0===this._elementAttributeValues.textContent&&(this._elementAttributeValues.textContent=u,null==this.textContent&&(this.textContent=u))}if(this._elementAttributeDescriptors)for(s in this._elementAttributeDescriptors){l=this._elementAttributeDescriptors[s];var c="_"+s;null===this[c]&&null!==l&&"value"in l&&(this[c]=this._elementAttributeDescriptors[s].value)}}}},_draw:{value:function(){var e,t=this.element;for(var n in this._elementAttributeValues)if(this._elementAttributeValues.hasOwnProperty(n)){var r=this[n];e=this._getElementAttributeDescriptor(n,this),e&&("boolean"===e.dataType?r===!0?(t[n]=!0,t.setAttribute(n,n.toLowerCase())):(t[n]=!1,t.removeAttribute(n)):void 0!==r&&("textContent"===n?t.textContent=r:t.setAttribute(n,r))),delete this._elementAttributeValues[n]}this._drawClassListIntoComponent()}},_classList:{value:null},_classListDirty:{value:!1},classList:{get:function(){return null===this._classList&&(this._classList=new p,this._subscribeToToClassListChanges(),this._initializeClassListFromElement(this.element)),this._classList}},_initializeClassListFromElement:{value:function(e){var t;if(e&&e.className&&(t=e.className.trim())&&0!==t.length){var n=this.classList;this._unsubscribeToClassListChanges&&this._unsubscribeToClassListChanges(),n.addEach(t.split(/\s+/)),this._subscribeToToClassListChanges()}}},_unsubscribeToClassListChanges:{value:null},_subscribeToToClassListChanges:{value:function(){this._unsubscribeToClassListChanges=this._classList.addRangeChangeListener(this,"classList")}},handleClassListRangeChange:{value:function(){this._classListDirty=!0,this.needsDraw=!0}},_drawClassListIntoComponent:{value:function(){if(this._classListDirty){for(var e,t=this.element.classList,n=this._classList,r=0,i=t.length;i>r;r++)e=t.item(r),n.has(e)||(t.remove(e),r--,i--);this._classList.forEach(function(e){t.add(e)}),this._classListDirty=!1}}},dispose:{value:function(){this.cancelBindings(),this.detachFromParentComponent(),d.unregisterEventHandlerForElement(this,this._element),this._element=null,this.childComponents.forEach(function(e){e.dispose()})}}}),m=f.specialize({constructor:{value:function m(){this.super()}},init:{value:function(){return this}},needsDraw:{enumerable:!0,get:function(){return!1},set:function(e){if(this._needsDraw!==e&&(this._needsDraw=!!e,e))for(var t,n=this.childComponents,r=0;t=n[r];r++)h.isDebug&&h.debug(this,"needsDraw = true for: "+t._montage_metadata.exportedSymbol),t.needsDraw=!0}},canDrawGate:{get:function(){return this._canDrawGate||(this._canDrawGate=(new s).initWithDelegate(this))}},_clearNeedsDrawTimeOut:{value:null},_needsDrawList:{value:[]},_cannotDrawList:{value:null},componentBlockDraw:{value:function(e){this._cannotDrawList=this._cannotDrawList?this._cannotDrawList:{},this._cannotDrawList[e.uuid]=e,this._clearNeedsDrawTimeOut&&(window.clearTimeout(this._clearNeedsDrawTimeOut),this._clearNeedsDrawTimeOut=null)}},componentCanDraw:{value:function(e,t){if(t){if(!this._cannotDrawList)return;if(delete this._cannotDrawList[e.uuid],this._needsDrawList.push(e),0===Object.keys(this._cannotDrawList).length&&this._needsDrawList.length>0&&!this._clearNeedsDrawTimeOut){var n=this;this._clearNeedsDrawTimeOut=window.setTimeout(function(){n._clearNeedsDrawList()},0)}}else this._clearNeedsDrawTimeOut&&(window.clearTimeout(this._clearNeedsDrawTimeOut),this._clearNeedsDrawTimeOut=null)}},_clearNeedsDrawList:{value:function(){var e,t,n,r=this._needsDrawList;for(n=r.length,t=0;n>t;t++)e=r[t],e.needsDraw&&e._addToParentsDrawList();this._clearNeedsDrawTimeOut=null,r.splice(0,n)}},removeFromCannotDrawList:{value:function(e){if(this._cannotDrawList&&(delete this._cannotDrawList[e.uuid],0===Object.keys(this._cannotDrawList).length&&this._needsDrawList.length>0&&!this._clearNeedsDrawTimeOut)){var t=this;this._clearNeedsDrawTimeOut=window.setTimeout(function(){t._clearNeedsDrawList()},0)}}},_cancelDrawIfScheduled:{value:function(){var e=this.requestedAnimationFrame,t=this.cancelAnimationFrame;null!==e&&(this._frameTime||(u.isDebug&&u.debug(this,"clearing draw"),t?t.call(window,e):window.clearTimeout(e),this.requestedAnimationFrame=null))}},_addToDrawList:{value:function(e){this.__addToDrawList(e),h.isDebug&&h.debug(this,this.canDrawGate.value,this.requestedAnimationFrame),this.drawTree()},enumerable:!1},addToComposerList:{value:function(e){this.composerList.push(e),h.isDebug&&h.debug(this,e,"Added to composer list"),this._scheduleComposerRequest=!0,this.drawTree()}},composerListSwap:{value:[],distinct:!0},_scheduleComposerRequest:{value:!1},requestedAnimationFrame:{value:null,enumerable:!1},requestAnimationFrame:{value:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,enumerable:!1},cancelAnimationFrame:{value:window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame,enumerable:!1},_frameTime:{value:null},_oldSource:{value:null},_diff:{value:function(e,t){for(var n={},r={},i=0;t.length>i;i++)null==n[t[i]]&&(n[t[i]]={rows:[],o:null}),n[t[i]].rows.push(i);for(i=0;e.length>i;i++)null==r[e[i]]&&(r[e[i]]={rows:[],n:null}),r[e[i]].rows.push(i);for(i in n)1===n[i].rows.length&&void 0!==r[i]&&1===r[i].rows.length&&(t[n[i].rows[0]]={text:t[n[i].rows[0]],row:r[i].rows[0]},e[r[i].rows[0]]={text:e[r[i].rows[0]],row:n[i].rows[0]});for(i=0;t.length-1>i;i++)null!=t[i].text&&null==t[i+1].text&&t[i].row+1<e.length&&null==e[t[i].row+1].text&&t[i+1]==e[t[i].row+1]&&(t[i+1]={text:t[i+1],row:t[i].row+1},e[t[i].row+1]={text:e[t[i].row+1],row:i+1});for(i=t.length-1;i>0;i--)null!=t[i].text&&null==t[i-1].text&&t[i].row>0&&null==e[t[i].row-1].text&&t[i-1]==e[t[i].row-1]&&(t[i-1]={text:t[i-1],row:t[i].row-1},e[t[i].row-1]={text:e[t[i].row-1],row:i-1});return{o:e,n:t}}},_previousDrawDate:{enumerable:!1,value:0},_documentResources:{value:null},_needsStylesheetsDraw:{value:!1},_stylesheets:{value:[]},addStylesheet:{value:function(e){this._stylesheets.push(e),this._needsStylesheetsDraw=!0}},drawStylesheets:{value:function(){for(var e,t=this._documentResources,n=this._stylesheets;e=n.shift();)t.addStyle(e);this._needsStylesheetsDraw=!1}},drawTree:{value:function(){if(null===this.requestedAnimationFrame){h.isDebug&&h.debug(this,"requesting a draw");var e=this,t=this.requestAnimationFrame,n=function(t){var n;if(e._needsStylesheetsDraw&&e.drawStylesheets(),!e._documentResources.areStylesLoaded)return c.isDebug&&console.log("Draw Cycle Waiting Stylesheets: ",e._documentResources._expectedStyles.length),e.requestedAnimationFrame=null,e.drawTree(),void 0;if(c.isDebug&&(n=window.performance?window.performance.now():Date.now()),e._frameTime=t?t:Date.now(),e._clearNeedsDrawTimeOut&&e._clearNeedsDrawList(),h.isDebug){var r=document.documentElement.innerHTML;if(e._oldSource&&r!==e._oldSource){for(var i=["DOM modified outside of the draw loop"],a=e._diff(e._oldSource.split("\n"),r.split("\n")),o=0;a.n.length>o;o++)if(null==a.n[o].text)i.push("+ "+a.n[o]);else for(var s=a.n[o].row+1;a.o.length>s&&null==a.o[s].text;s++)i.push("- "+a.o[s]);console.warn(i.join("\n"))}console.group((t?h.toTimeString(new Date(t))+" ":"")+"Draw Fired")}if(e.drawIfNeeded(),c.isDebug){if(window.performance)var l=window.performance.now();else var l=Date.now();console.log("Draw Cycle Time: ",l-n,", Components: ",e._lastDrawComponentsCount)}h.isDebug&&(console.groupEnd(),e._oldSource=document.documentElement.innerHTML),e._frameTime=null,e._scheduleComposerRequest&&e.drawTree()};if(t)this.requestedAnimationFrame=t.call(window,n);else{var r=Date.now(),i=17-r+this._previousDrawDate;0>i&&(i=0),this.requestedAnimationFrame=setTimeout(n,i),this._previousDrawDate=r+i}this._scheduleComposerRequest=!1}},enumerable:!1},_readyToDrawList:{enumerable:!1,value:[]},_readyToDrawListIndex:{enumerable:!1,value:null},addToDrawCycle:{value:function(e){var t=this._readyToDrawListIndex;return t.hasOwnProperty(e.uuid)?(h.isDebug&&h.debug("components should not be added to the draw cycle twice"),void 0):(this._readyToDrawList.push(e),this._readyToDrawListIndex[e.uuid]=!0,e._updateComponentDom(),void 0)}},_lastDrawComponentsCount:{value:null},drawIfNeeded:{value:function(){var e,t,n,r,i,a,o=this._readyToDrawList,s=0,l=this.composerList;if(o.length=0,a=l.length,this._readyToDrawListIndex={},a>0){for(this.composerList=this.composerListSwap,t=0;a>t;t++)i=l[t],i.needsFrame=!1,i.frame(this._frameTime);l.splice(0,a),this.composerListSwap=l}for(this._drawIfNeeded(0),n=o.length;n>s;){for(t=s;n>t;t++)e=o[t],"function"==typeof e.willDraw&&e.willDraw(this._frameTime),h.isDebug&&h.debug(e._montage_metadata.objectName," willDraw treeLevel ",e._treeLevel);this._drawIfNeeded(0),s=n,n=o.length}var u=function(e,t){return e._treeLevel-t._treeLevel};for(o.sort(u),t=0;n>t;t++)e=o[t],e.needsDraw=!1;for(this.requestedAnimationFrame=null,t=n-1;t>=0;t--)e=o[t],e._draw(this._frameTime),e.draw(this._frameTime),h.isDebug&&h.debug(e._montage_metadata.objectName," draw treeLevel ",e._treeLevel);for(t=0;n>t;t++)e=o[t],e.didDraw(this._frameTime),e._completedFirstDraw||(r=document.createEvent("CustomEvent"),r.initCustomEvent("firstDraw",!0,!1,null),e.dispatchEvent(r),e._completedFirstDraw=!0),h.isDebug&&h.debug(e._montage_metadata.objectName," didDraw treeLevel ",e._treeLevel);return c.isDebug&&(this._lastDrawComponentsCount=o.length),!!o.length}},element:{get:function(){return this._element},set:function(e){d.registerEventHandlerForElement(this,e),this._element=e,this._documentResources=o.getInstanceForDocument(e)}}}),v=(new m).init();t.__root__=v}}),montageDefine("d407295","ui/text.reel/text",{dependencies:["montage","ui/component"],factory:function(e,t){var n=(e("montage").Montage,e("ui/component").Component);t.Text=n.specialize({constructor:{value:function(){this.super()}},hasTemplate:{value:!1},_value:{value:null},value:{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=e,this.needsDraw=!0)}},converter:{value:null},defaultValue:{value:""},_valueNode:{value:null},_RANGE:{value:document.createRange()},enterDocument:{value:function(e){if(e){var t=this._RANGE;t.selectNodeContents(this.element),t.deleteContents(),this._valueNode=document.createTextNode(""),t.insertNode(this._valueNode),this.element.classList.add("montage-Text")}}},draw:{value:function(){var e=this._value,t=e||0===e?e:this.defaultValue;this.converter&&(t=this.converter.convert(t)),this._valueNode.data=t}}})}}),montageDefine("d407295","core/target",{dependencies:["montage","core/event/event-manager","core/event/mutable-event"],factory:function(e,t){var n=e("montage").Montage,r=e("core/event/event-manager").defaultEventManager,i=e("core/event/mutable-event").MutableEvent;t.Target=n.specialize({constructor:{value:function(){this.super()}},acceptsActiveTarget:{serializable:!1,value:!1},isActiveTarget:{get:function(){return this===r.activeTarget}},willBecomeActiveTarget:{value:Function.noop},didBecomeActiveTarget:{value:Function.noop},surrendersActiveTarget:{value:function(){return!0}},nextTarget:{serializable:!1,value:null},dispatchEvent:{value:function(e){var t=e;e instanceof i||(t=i.fromEvent(t)),t.target=this,r.handleEvent(t)}},dispatchEventNamed:{value:function(e,t,n,a){var o=i.fromType(e,t,n,a);o.target=this,r.handleEvent(o)}},addEventListener:{value:function(e,t,n){t&&r.registerEventListener(this,e,t,n)}},removeEventListener:{value:function(e,t,n){t&&r.unregisterEventListener(this,e,t,n)}}})}}),montageDefine("d407295","core/template",{dependencies:["montage","core/serialization","core/document-part","core/document-resources","core/serialization/serialization","core/serialization/serializer/montage-labeler","core/promise","core/mini-url","core/logger","core/event/event-manager","core/application"],factory:function(e,t){function n(e,t,n){var r,i,a=new d,s=e.documentElement.outerHTML,l=new o,u=e.documentElement;return r=a.createHtmlDocumentWithHtml(s,e.location.href),a.initWithDocument(r,t).then(function(){return a.setBaseUrl(e.location.href),i=a._createTemplateObjects(n),l.initWithTemplateAndFragment(a),a._instantiateObjects(i,u).then(function(e){return l.objects=e,a._invokeDelegates(l),l})})}var r,i=e("montage").Montage,a=e("core/serialization").Deserializer,o=e("core/document-part").DocumentPart,s=e("core/document-resources").DocumentResources,l=e("core/serialization/serialization").Serialization,u=e("core/serialization/serializer/montage-labeler").MontageLabeler,c=e("core/promise").Promise,h=e("core/mini-url");e("core/logger").logger("template"),e("core/event/event-manager").defaultEventManager;var d=i.specialize({_SERIALIZATON_SCRIPT_TYPE:{value:"text/montage-serialization"},_ELEMENT_ID_ATTRIBUTE:{value:"data-montage-id"},PARAM_ATTRIBUTE:{value:"data-param"},_require:{value:null},_resources:{value:null},document:{value:null},_baseUrl:{value:null},_instances:{value:null},_metadata:{value:null},_objectsString:{value:null},objectsString:{get:function(){return this._objectsString},set:function(e){this._objectsString=e,this._serialization&&this._serialization.initWithString(e),this.__deserializer=null}},__deserializer:{value:null},_deserializer:{get:function(){var e,t,n=this.__deserializer;if(!n){if(e=this._metadata){t=Object.create(null);for(var r in e)t[r]=e[r].require}n=(new a).init(this.objectsString,this._require,t),this.__deserializer=n}return n}},getDeserializer:{value:function(){return this._deserializer}},_serialization:{value:null},getSerialization:{value:function(){var e=this._serialization;return e||(e=this._serialization=new l,e.initWithString(this.objectsString)),e}},constructor:{value:function d(){this.super()}},initWithRequire:{value:function(e){return this._require=e,this.document=this.createHtmlDocumentWithHtml(""),this.objectsString="",this}},initWithDocument:{value:function(e,t){var n=this;return this._require=t,this.setDocument(e),this.getObjectsString(e).then(function(e){return n.objectsString=e,n})}},initWithHtml:{value:function(e,t){var n=this;return this._require=t,this.document=this.createHtmlDocumentWithHtml(e),this.getObjectsString(this.document).then(function(e){return n.objectsString=e,n})}},initWithObjectsAndDocumentFragment:{value:function(e,t,n){return this._require=n,this.document=this.createHtmlDocumentWithHtml(""),this.document.body.appendChild(this.document.importNode(t,!0)),this.setObjects(e),this}},initWithModuleId:{value:function(e,t){var n=this;return this._require=t,this.createHtmlDocumentWithModuleId(e,t).then(function(r){var i=t(e).directory;return n.document=r,n.setBaseUrl(i),n.getObjectsString(r).then(function(e){return n.objectsString=e,n})})}},clone:{value:function(){var e=new d;return e._require=this._require,e._baseUrl=this._baseUrl,e.setDocument(this.document),e.objectsString=this.objectsString,e._instances=Object.clone(this._instances,1),e}},instantiate:{value:function(e){return this.instantiateWithInstances(null,e)}},instantiateWithInstances:{value:function(e,t){var n,r,i,a=this,s=new o;return e=e||this._instances,n=this._createMarkupDocumentFragment(t),i=this._getParameters(n),s.initWithTemplateAndFragment(this,n),s.startActingAsTopComponent(),s.parameters=i,r=this._createTemplateObjects(e),this._instantiateObjects(r,n).then(function(n){var r;return s.objects=n,a._invokeDelegates(s,e),s.stopActingAsTopComponent(),r=a.getResources(),!r.resourcesLoaded()&&r.hasResources()&&r.loadResources(t),s})}},_objectsInstantiationOptimized:{value:!1},_optimizeObjectsInstantiationPromise:{value:null},_optimizeObjectsInstantiation:{value:function(){var e,t=this;return this._objectsInstantiationOptimized?void 0:(this._optimizeObjectsInstantiationPromise||(e=this._deserializer.preloadModules(),e?this._optimizeObjectsInstantiationPromise=e.then(function(){t._objectsInstantiationOptimized=!0}):this._objectsInstantiationOptimized=!0),this._optimizeObjectsInstantiationPromise)}},setBaseUrl:{value:function(e){this._baseUrl=e}},getBaseUrl:{value:function(){return this._baseUrl}},getResources:{value:function(){var e=this._resources;return e||(e=this._resources=new p,e.initWithTemplate(this)),e}},_createTemplateObjects:{value:function(t){var n=Object.create(t||null);return void 0===r&&(r=e("core/application").application),n.application=r,n.template=this,n}},_instantiateObjects:{value:function(e,t){var n,r=this._deserializer;return n=this._optimizeObjectsInstantiation(),n?n.then(function(){return r.deserialize(e,t)}):r.deserialize(e,t)}},_createMarkupDocumentFragment:{value:function(e){for(var t=e.createDocumentFragment(),n=this.document.body.childNodes,r=0,i=n.length;i>r;r++)t.appendChild(e.importNode(n[r],!0));return t}},getParameterName:{value:function(e){return e.getAttribute(this.PARAM_ATTRIBUTE)}},getParameters:{value:function(){return this._getParameters(this.document.body)}},_getParameters:{value:function(e){for(var t,n=e.querySelectorAll("*["+this.PARAM_ATTRIBUTE+"]"),r=n.length,i={},a=0;r>a;a++){t=n[a];var o=this.getParameterName(t);if(o in i)throw Error('The parameter "'+o+'" is'+" declared more than once in "+this.getBaseUrl()+".");i[o]=t}if("*"in i&&r>1)throw Error('The star "*" template parameter was declared when other parameters were also present in '+this.getBaseUrl()+": "+Object.keys(i)+".");return i}},hasParameters:{value:function(){return!!this.document.querySelector("*["+this.PARAM_ATTRIBUTE+"]")}},_invokeDelegates:{value:function(e,t){var n,r,i=e.objects,a=i.owner||t&&t.owner;for(var o in i)t&&o in t||(n=i[o],r=this._getObjectOwner(o,a),n&&("function"==typeof n._deserializedFromTemplate&&n._deserializedFromTemplate(r,o,e),"function"==typeof n.deserializedFromTemplate&&n.deserializedFromTemplate(r,o,e)));if(a){var s=this.getSerialization();s.isExternalObject("owner")||("function"==typeof a._templateDidLoad&&a._templateDidLoad(e),"function"==typeof a.templateDidLoad&&a.templateDidLoad(e))}}},setInstances:{value:function(e){this._instances=e}},getInstances:{value:function(){return this._instances}},setObjects:{value:function(e){this.objectsString=JSON.stringify(e,null,4)}},setObjectMetadata:{value:function(e,t,n,r){var i=this._metadata;i||(this._metadata=i=Object.create(null)),i[e]={require:t,label:n,owner:r},this.__deserializer=null}},getObjectMetadata:{value:function(e){var t=this._metadata;return t&&e in t?t[e]:{require:this._require,label:e}}},_getObjectOwner:{value:function(e,t){var n,r=this._metadata;return n=r&&e in r?r[e].owner:t}},setDocument:{value:function(e){var t=e.documentElement.innerHTML;this.document=this.createHtmlDocumentWithHtml(t,e.baseURI)}},getObjectsString:{value:function(e){var t;return t=this.getInlineObjectsString(e),null===t?this.getExternalObjectsString(e):c.resolve(t)}},getInlineObjectsString:{value:function(e){var t="script[type='"+this._SERIALIZATON_SCRIPT_TYPE+"']",n=e.querySelector(t);return n?n.textContent:null}},getExternalObjectsString:{value:function(e){var t,n,r,i,a=e.querySelector('link[rel="serialization"]');return a?(t=new XMLHttpRequest,n=a.getAttribute("href"),r=this.getBaseUrl()||"",/^https?:\/\/|^\//.test(n)?c.reject(Error("Relative link found for the objects file but the document URL is unknown: '"+n+"'.")):(n=r+n,i=c.defer(),t.open("GET",n),t.addEventListener("load",function(){200==t.status?i.resolve(t.responseText):i.reject(Error("Unable to retrive '"+n+"', code status: "+t.status))},!1),t.addEventListener("error",function(e){i.reject(Error("Unable to retrive '"+n+"' with error: "+e.error+"."))},!1),t.send(),i.promise)):c.resolve(null)}},createHtmlDocumentWithHtml:{value:function(e,t){var n=document.implementation.createHTMLDocument("");return n.documentElement.innerHTML=e,this.normalizeRelativeUrls(n,t),n}},createHtmlDocumentWithModuleId:{value:function(e,t){var n=this;return"function"!=typeof t?c.reject(Error("Missing 'require' function to load module '"+e+"'.")):t.async(e).then(function(e){return n.createHtmlDocumentWithHtml(e.content,e.directory)})}},_removeObjects:{value:function(e){var t="script[type='"+this._SERIALIZATON_SCRIPT_TYPE+"'], link[rel='serialization']";Array.prototype.forEach.call(e.querySelectorAll(t),function(e){e.parentNode.removeChild(e)})}},_addObjects:{value:function(e,t){if(t){var n=e.createElement("script");n.setAttribute("type",this._SERIALIZATON_SCRIPT_TYPE),n.textContent=JSON.stringify(JSON.parse(t),null,4),e.head.appendChild(n)}}},_templateFromElementContentsCache:{value:null},clearTemplateFromElementContentsCache:{value:function(){this._templateFromElementContentsCache=null}},createTemplateFromElementContents:{value:function(e){var t,n,r,i=this._templateFromElementContentsCache;return i||(i=Object.create(null),this._templateFromElementContentsCache=i),e in i?Object.create(i[e]):(t=this.getElementById(e),r=this.document.createRange(),r.selectNodeContents(t),n=this.createTemplateFromRange(r),i[e]=n,Object.create(n))}},createTemplateFromElement:{value:function(e){var t,n;return t=this.getElementById(e),n=this.document.createRange(),n.selectNode(t),this.createTemplateFromRange(n)}},createTemplateFromRange:{value:function(e){var t,n,r,i,a,o=new l;return t=e.cloneContents(),n=this._getChildrenElementIds(t),o.initWithString(this.objectsString),r=o.getSerializationLabelsWithElements(n),a=o.extractSerialization(r,["owner"]),i=new d,i.initWithObjectsAndDocumentFragment(null,t,this._require),i.objectsString=a.getSerializationString(),i._resources=this.getResources(),i}},_createSerializationWithElementIds:{value:function(e){var t,n,r=new l;return r.initWithString(this.objectsString),t=r.getSerializationLabelsWithElements(e),n=r.extractSerialization(t,["owner"])}},expandParameters:{value:function(e,t){var n,r,i,a,o,s,l=[],u={},c=this.getSerialization(),h={};n=this.getParameters();for(var d in n)if(a=n[d],o=t.getTemplateParameterArgument(e,d),l.push.apply(l,this._getElementIds(o)),r=this.replaceNode(o,a))for(var p in r)u[p]=r[p];return h.elementIds=l,h.elementIdsCollisions=u,s=e._createSerializationWithElementIds(l),s.renameElementReferences(u),i=c.mergeSerialization(s),this.objectsString=c.getSerializationString(),h.labels=s.getSerializationLabels(),h.labelsCollisions=i,h}},_resolveElementIdCollisions:{value:function(e){var t,n,r,i,a,o=new u;r=this.getElementIds();for(var s,l=0;s=r[l];l++)o.setObjectLabel(null,s);n=this._getElements(e);for(var s in n)this.getElementById(s)&&(i=n[s],a=o.getObjectLabel(i),this.setElementId(i,a),t||(t=Object.create(null)),t[s]=a);return t}},replaceNode:{value:function(e,t){var n;return n=this._resolveElementIdCollisions(e),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.parentNode.replaceChild(e,t),n}},insertNodeBefore:{value:function(e,t){var n;return n=this._resolveElementIdCollisions(e),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.parentNode.insertBefore(e,t),n}},appendNode:{value:function(e,t){var n;return n=this._resolveElementIdCollisions(e),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.appendChild(e),n}},getElementId:{value:function(e){return e.getAttribute?e.getAttribute(this._ELEMENT_ID_ATTRIBUTE):void 0}},setElementId:{value:function(e,t){e.setAttribute(this._ELEMENT_ID_ATTRIBUTE,t)}},getElementIds:{value:function(){return this._getElementIds(this.document.body)}},_getElements:{value:function(e){var t,n,r="*["+this._ELEMENT_ID_ATTRIBUTE+"]",i={};t=e.querySelectorAll(r);for(var a,o=0;a=t[o];o++)n=this.getElementId(a),i[n]=a;return n=this.getElementId(e),n&&(i[n]=e),i}},_getChildrenElementIds:{value:function(e){var t,n="*["+this._ELEMENT_ID_ATTRIBUTE+"]",r=[];t=e.querySelectorAll(n);for(var i,a=0;i=t[a];a++)r.push(this.getElementId(i));return r}},_getElementIds:{value:function(e){var t,n=this._getChildrenElementIds(e);return t=this.getElementId(e),t&&n.push(t),n}},getElementById:{value:function(e){var t="*["+this._ELEMENT_ID_ATTRIBUTE+"='"+e+"']";return this.document.querySelector(t)}},html:{get:function(){var e=this.document;return this._removeObjects(e),this._addObjects(e,this.objectsString),this._getDoctypeString(e.doctype)+"\n"+e.documentElement.outerHTML}},_getDoctypeString:{value:function(e){return"<!DOCTYPE "+e.name+(e.publicId?' PUBLIC "'+e.publicId+'"':"")+(!e.publicId&&e.systemId?" SYSTEM":"")+(e.systemId?' "'+e.systemId+'"':"")+">"}},normalizeRelativeUrls:{value:function(e,t){if("string"==typeof t&&""!==t&&"about:blank"!==t)for(var n="http://www.w3.org/1999/xlink",r=/^[\w\-]+:|^\//,i=-1!==d._NORMALIZED_TAG_NAMES.indexOf(e.tagName)?[e]:e.querySelectorAll(d._NORMALIZED_TAG_NAMES_SELECTOR),a=0,o=i.length;o>a;a++){var s,l=i[a];"image"===l.tagName?(s=l.getAttributeNS(n,"href"),r.test(s)||l.setAttributeNS(n,"href",h.resolve(t,s))):(s=l.getAttribute("src"),r.test(s)||l.setAttribute("src",h.resolve(t,s)))}}}},{_templateCache:{value:{moduleId:Object.create(null)}},_getTemplateCacheKey:{value:function(e,t){return e=t.resolve(e),t.location+"#"+e}},getTemplateWithModuleId:{value:function(e,t){var n,r;return n=this._getTemplateCacheKey(e,t),r=this._templateCache.moduleId[n],r||(r=(new d).initWithModuleId(e,t),this._templateCache.moduleId[n]=r),r}},_NORMALIZED_TAG_NAMES:{value:["IMG","image","IFRAME"]},__NORMALIZED_TAG_NAMES_SELECTOR:{value:null},_NORMALIZED_TAG_NAMES_SELECTOR:{get:function(){return this.__NORMALIZED_TAG_NAMES_SELECTOR||(this.__NORMALIZED_TAG_NAMES_SELECTOR=this._NORMALIZED_TAG_NAMES.join(",")),this.__NORMALIZED_TAG_NAMES_SELECTOR}}}),p=i.specialize({_resources:{value:null},_resourcesLoaded:{value:!1},template:{value:null},rootUrl:{value:""},constructor:{value:function p(){this._resources=Object.create(null)}},initWithTemplate:{value:function(e){this.template=e}},hasResources:{value:function(){return this.getStyles().length>0||this.getScripts().length>0}},resourcesLoaded:{value:function(){return this._resourcesLoaded}},loadResources:{value:function(e){return this._resourcesLoaded=!0,c.all([this.loadScripts(e),this.loadStyles(e)])}},getScripts:{value:function(){var e,t,n,r=this._resources.scripts;if(!r){t=this.template,r=this._resources.scripts=[],n=t.document.querySelectorAll("script");for(var i=0,a=n.length;a>i;i++)e=n[i],e.type!==this.template._SERIALIZATON_SCRIPT_TYPE&&r.push(e)}return r}},loadScripts:{value:function(e){var t,n=[];t=this.getScripts();for(var r=0,i=t.length;i>r;r++)n.push(this.loadScript(t[r],e));return c.all(n)}},loadScript:{value:function(e,t){var n,r;return n=s.getInstanceForDocument(t),r=this._cloneScriptElement(e,t),n.addScript(r)}},_cloneScriptElement:{value:function(e,t){for(var n,r=t.createElement("script"),i=e.attributes,a=0,o=i.length;o>a;a++)n=i[a],r.setAttribute(n.name,n.value);return r}},getStyles:{value:function(){var e,t,n,r=this._resources.styles;return r||(n='link[rel="stylesheet"], style',e=this.template,t=e.document.querySelectorAll(n),r=Array.prototype.slice.call(t,0),this._resources.styles=r),r}},loadStyles:{value:function(e){var t,n=[];t=this.getStyles();for(var r=0,i=t.length;i>r;r++)n.push(this.loadStyle(t[r],e));return c.all(n)}},loadStyle:{value:function(e,t){var n,r,i=this.template.getBaseUrl();return n=e.getAttribute("href"),n?(r=s.getInstanceForDocument(t),n=r.normalizeUrl(n,i),r.preloadResource(n)):c.resolve()}},createStylesForDocument:{value:function(e){var t,n,r,i,a=this.getStyles(),o=[],l=this.template.getBaseUrl();n=s.getInstanceForDocument(e);for(var u,c=0;u=a[c];c++)r=u.getAttribute("href"),t=e.importNode(u,!0),o.push(t),r&&(i=n.normalizeUrl(r,l),t.setAttribute("href",i));return o}}});t.Template=d,t.TemplateResources=p,t.instantiateDocument=n}}),montageDefine("d407295","core/document-resources",{dependencies:["montage","core/promise","core/mini-url"],factory:function(e,t){var n=e("montage").Montage,r=e("core/promise").Promise,i=e("core/mini-url"),a=n.specialize({_SCRIPT_TIMEOUT:{value:5e3},_document:{value:null},_resources:{value:null},_preloaded:{value:null},_expectedStyles:{value:null},constructor:{value:function a(){this.super(),this._expectedStyles=[]}},initWithDocument:{value:function(e){return this.clear(),this._document=e,this}},clear:{value:function(){this._resources=Object.create(null),this._preloaded=Object.create(null)}},_addResource:{value:function(e){this._resources[e]=!0}},hasResource:{value:function(e){return e in this._resources}},isResourcePreloaded:{value:function(e){return this._preloaded[e]===!0}},isResourcePreloading:{value:function(e){return r.isPromise(this._preloaded[e])}},setResourcePreloadedPromise:{value:function(e,t){this._preloaded[e]=t}},setResourcePreloaded:{value:function(e){this._preloaded[e]=!0}},getResourcePreloadedPromise:{value:function(e){return this._preloaded[e]}},addScript:{value:function(e){var t=this.normalizeUrl(e.src);return t?this.isResourcePreloaded(t)?r.resolve():this.isResourcePreloading(t)?this.getResourcePreloadedPromise(t):this._importScript(e):this._importScript(e)}},_importScript:{value:function(e){var t,n,i=this,a=this._document,o=a.head,s=r.defer(),l=e.src;return l?(i._addResource(l),t=function(){i.setResourcePreloaded(l),e.removeEventListener("load",t),e.removeEventListener("error",t),clearTimeout(n),s.resolve()},e.addEventListener("load",t,!1),e.addEventListener("error",t,!1),n=setTimeout(function(){i.setResourcePreloaded(l),s.resolve()},this._SCRIPT_TIMEOUT),this.setResourcePreloadedPromise(l,s.promise)):s.resolve(),o.appendChild(a.createComment("Inserted from FIXME")),o.appendChild(e),s.promise}},addStyle:{value:function(e){var t,n=e.getAttribute("href");if(n=this.normalizeUrl(n)){if(this.hasResource(n))return;this._addResource(n)}t=this._document.head,this._expectedStyles.push(n),t.insertBefore(e,t.firstChild)}},normalizeUrl:{value:function(e,t){return t||(t=this._document.location.href),i.resolve(t,e)}},preloadResource:{value:function(e){return e=this.normalizeUrl(e),this.isResourcePreloaded(e)?r.resolve():this.isResourcePreloading(e)?this.getResourcePreloadedPromise(e):this._preloadResource(e)}},_preloadResource:{value:function(e){var t,n,i=this,a=new XMLHttpRequest,o=r.defer();return a.open("GET",e),t=function(){i.setResourcePreloaded(e),a.removeEventListener("load",t),a.removeEventListener("error",t),clearTimeout(n),o.resolve()},a.addEventListener("load",t,!1),a.addEventListener("error",t,!1),a.send(),n=setTimeout(function(){i.setResourcePreloaded(e),o.resolve()},this._SCRIPT_TIMEOUT),this.setResourcePreloadedPromise(e,o.promise),o.promise
}},areStylesLoaded:{get:function(){var e,t;if(this._expectedStyles.length>0){e=this._document.styleSheets;for(var n,r=0;n=e[r];r++)t=this._expectedStyles.indexOf(n.href),t>=0&&this._expectedStyles.splice(t,1)}return 0===this._expectedStyles.length}}},{getInstanceForDocument:{value:function(e){var t=e.__montage_resources__;return t||(t=e.__montage_resources__=(new a).initWithDocument(e)),t}}});t.DocumentResources=a}}),montageDefine("d407295","core/gate",{dependencies:["montage","core/logger"],factory:function(e,t){var n=e("montage").Montage,r=e("core/logger").logger("gate");t.Gate=n.specialize({constructor:{value:function(){this.super()}},init:{enumerable:!1,value:function(){return this.reset(),this}},initWithDelegate:{enumerable:!1,value:function(e){return this.reset(),this.delegate=e,this}},initWithDescriptor:{enumerable:!1,value:function(e){var t;this.reset();for(t in e)this.setField(t,e[t].value);return this}},count:{value:0},table:{value:null},getField:{enumerable:!1,value:function(e){var t=this.table;return!t||t[e]}},setField:{enumerable:!1,value:function(e,t){var n,i=this.table,a=this.count;i=i?i:this.table={},n=i[e],void 0!==n||t?void 0!==n&&n!==t?t?this.count--:this.count++:t&&r.error(this,e+" was not set before."):this.count++,i[e]=!!t,0===this.count&&a>0?this.callDelegateMethod(!0):0===a&&this.count>0&&this.callDelegateMethod(!1)}},removeField:{enumerable:!1,value:function(e){var t=this.table,n=t[e];void 0===n||n||this.count--,delete t[e]}},delegate:{enumerable:!1,value:null},callDelegateMethod:{value:function(e){var t;this.delegate&&"function"==typeof(t=this.delegate["gateDidBecome"+(e?"True":"False")])&&t.call(this.delegate,this)},enumerable:!1},value:{enumerable:!1,get:function(){return 0===this.count}},reset:{enumerable:!1,value:function(){this.table={},this.count=0}},toString:{value:function(){var e,t,n=this._fields,r="";for(e=0;t=n[e];e++)r+=t+"["+(this._value&n[t])+"], ";return r}}})}}),montageDefine("d407295","core/application",{dependencies:["core/core","core/target","window-loader/montage-window","core/dom","core/template"],factory:function(e,t){var n,r=(e("core/core").Montage,e("core/target").Target),i=e("window-loader/montage-window").MontageWindow;e("core/dom"),t.Application=r.specialize({eventManager:{value:null},parentApplication:{value:null},mainApplication:{get:function(){for(var e=this;e.parentApplication;)e=e.parentApplication;return e}},_windowsSortOrder:{value:"reverse-z-order"},windowsSortOrder:{get:function(){return null==this.parentApplication?this._windowsSortOrder:this.mainApplication.windowsSortOrder},set:function(e){null==this.parentApplication?-1!==["z-order","reverse-z-order","z-order","reverse-open-order"].indexOf(e)&&(this._windowsSortOrder=e):this.mainApplication.windowsSortOrder=e}},windows:{get:function(){var e;if(null==this.parentApplication){if(!this._windows){var e=new i;e.application=this,e.window=window,this.window=e,this._windows=[this.window],this._multipleWindow=!0}return this._windows}return this.mainApplication.windows}},_window:{value:null},window:{get:function(){if(!this._window&&this==this.mainApplication){var e=new i;e.application=this,e.window=window,this._window=e}return this._window},set:function(e){this._window||(this._window=e)}},attachedWindows:{value:[]},eventManagerForWindow:{value:function(e){return e.defaultEventMananger}},focusWindow:{get:function(){var e=this.windows,t=this.windowsSortOrder;if("z-order"==t)return e[0];if("reverse-z-order"==t)return e[e.length-1];for(var n in e)if(e[n].focused)return e[n]}},delegate:{value:null},nextTarget:{get:function(){return this.delegate}},openWindow:{value:function(e,t,n){var r,a,o=this,s=new i,l={location:!1,menubar:!1,resizable:!0,scrollbars:!0,status:!1,titlebar:!0,toolbar:!1},u={module:e,name:t,parent:window,callback:function(e,t){var n;r=e.document.application,s.window=e,s.application=r,s.component=t,r.window=s,o.attachedWindows.push(s),n=o.mainApplication.windowsSortOrder,"z-order"==n||"reverse-open-order"==n?o.windows.unshift(s):o.windows.push(s),a=document.createEvent("CustomEvent"),a.initCustomEvent("load",!0,!0,null),s.dispatchEvent(a)}};if(this!==this.mainApplication||this._multipleWindow||this.window,"object"==typeof n){var c,h,d="",p="";for(c in n)n.hasOwnProperty(c)&&(l[c]=n[c])}var f=["name"];for(c in l)-1==f.indexOf(c)&&(h=l[c],"boolean"==typeof h?h=h?"yes":"no":(h+="",h.match(/[ ,"]/)&&(h='"'+h.replace(/"/g,'\\"')+'"')),p+=d+c+"="+h,d=",");return window.require.loadPackage({name:"montage"}).then(function(e){var t=window.open(e.location+"window-loader/index.html","_blank",p);t.loadInfo=u}).done(),s}},attachWindow:{value:function(e){var t,n=e.application.parentApplication;return n!==this&&(n&&n.detachWindow(e),e.parentApplication=this,this.attachedWindows.push(e),t=this.mainApplication.windowsSortOrder,"z-order"==t||"reverse-open-order"==t?this.windows.unshift(e):this.windows.push(e),e.focus()),e}},detachWindow:{value:function(e){var t,n,r=this.windows;return void 0===e&&(e=this.window),n=e.application.parentApplication,n==this?(t=this.attachedWindows.indexOf(e),-1!==t&&this.attachedWindows.splice(t,1),t=r.indexOf(e),-1!==t&&r.splice(t,1),e.application.parentApplication=null):n&&n.detachWindow(e),e}},constructor:{value:function(){window.loadInfo&&!this.parentApplication&&(this.parentApplication=window.loadInfo.parent.document.application)}},_load:{value:function(n,r){var i,a=this;t.application=a,e.async("ui/component").then(function(t){return i=t.__root__,i.element=document,e("core/template").instantiateDocument(window.document,n).then(function(){a.callDelegateMethod("willFinishLoading",a),i.needsDraw=!0,r&&r(a)})}).done()}},_alertPopup:{value:null,enumerable:!1},_confirmPopup:{value:null,enumerable:!1},_notifyPopup:{value:null,enumerable:!1},_zIndex:{value:null},_isSystemPopup:{value:function(e){return"alert"===e||"confirm"===e||"notify"===e}},_createPopupSlot:{value:function(e){var t=document.createElement("div");document.body.appendChild(t),t.style.zIndex=e,t.style.position="absolute";var r=new n;return r.element=t,r.attachToParentComponent(),r}},getPopupSlot:{value:function(t,r,i){var a=this;e.async("ui/slot.reel/slot").then(function(e){n=n||e.Slot,t=t||"custom";var o,s,l=a._isSystemPopup(t);if(a.popupSlots=a.popupSlots||{},l)switch(t){case"alert":o=9004;break;case"confirm":o=9003;break;case"notify":o=9002}else a._zIndex=a._zIndex?a._zIndex+1:7e3,o=a._zIndex;s=a.popupSlots[t],s||(s=a.popupSlots[t]=a._createPopupSlot(o)),l||(s.element.style.zIndex=o),s.content=r,i.call(this,s)}).done()}},returnPopupSlot:{value:function(e){var t=this;if(t.popupSlots&&t.popupSlots[e]){var n=t.popupSlots[e];n.content=null}}},_getActivePopupSlots:{value:function(){var e=[];if(this.popupSlots){var t=Object.keys(this.popupSlots);if(t&&t.length>0){var n,r=0,i=t.length;for(r=0;i>r;r++)n=this.popupSlots[t[r]],n&&null!==n.content&&e.push(n)}}return e}}})}}),montageDefine("d407295","core/document-part",{dependencies:["montage","core/logger","core/promise","core/event/event-manager"],factory:function(e,t){var n=e("montage").Montage,r=(e("core/logger").logger("document-part"),e("core/promise").Promise),i=e("core/event/event-manager").defaultEventManager,a=n.specialize({template:{value:null},fragment:{value:null},objects:{value:null},childComponents:{value:null},parameters:{value:null},constructor:{value:function a(){this.super()}},initWithTemplateAndFragment:{value:function(e,t){this.template=e,this.fragment=t,this.objects=null,this.childComponents=[],this.parameters=null}},startActingAsTopComponent:{value:function(){this.fragment&&i.registerEventHandlerForElement(this,this.fragment)}},stopActingAsTopComponent:{value:function(){this.fragment&&i.unregisterEventHandlerForElement(this.fragment)}},addChildComponent:{value:function(e){-1==this.childComponents.indexOf(e)&&this.childComponents.push(e)}},removeChildComponent:{value:function(e){var t=this.childComponents,n=t.indexOf(e);n>-1&&(t.splice(n,1),e._parentComponent=null,e._alternateParentComponent=null)}},_addToDrawList:{value:function(){}},_componentTreeLoadedDeferred:{value:null},loadComponentTree:{value:function(){var e,t=this._componentTreeLoadedDeferred;return t||(t=r.defer(),this._componentTreeLoadedDeferred=t,e=[],this.childComponents.forEach(function(t){e.push(t.loadComponentTree())}),r.all(e).then(function(){t.resolve()},t.reject).done()),t.promise}}});t.DocumentPart=a}}),montageDefine("d407295","core/serialization/serialization",{dependencies:["core/core","./serializer/montage-labeler","./deserializer/montage-reviver","frb/parse","frb/stringify"],factory:function(e,t){var n=e("core/core").Montage,r=e("./serializer/montage-labeler").MontageLabeler,i=e("./deserializer/montage-reviver").MontageReviver,a=e("frb/parse"),o=e("frb/stringify"),s=n.specialize({_serializationString:{value:null},_serializationObject:{value:null},initWithString:{value:function(e){return this._serializationString=e,this._serializationObject=null,this}},initWithObject:{value:function(e){return this._serializationString=null,this._serializationObject=e,this}},getSerializationObject:{value:function(){return this._serializationObject||(this._serializationObject=JSON.parse(this._serializationString)),this._serializationObject}},getSerializationString:{value:function(){return this._serializationString||(this._serializationString=JSON.stringify(this._serializationObject)),this._serializationString}},getSerializationLabels:{value:function(){var e=this.getSerializationObject();return Object.keys(e)}},getExternalObjectLabels:{value:function(){var e=this.getSerializationObject(),t=[];for(var n in e)0===Object.keys(e[n]).length&&t.push(n);return t}},isExternalObject:{value:function(e){var t=this.getSerializationObject();return t&&e in t?0===Object.keys(t[e]).length:!1}},getSerializationLabelsWithElements:{value:function(e){var t=new u,n=[];return t.initWithSerialization(this),t.visitSerialization(function(t){"Element"===t.type&&e.indexOf(t.data)>=0&&(t=t.parent,t&&"properties"===t.name&&(t=t.parent,t&&"montageObject"===t.type&&n.push(t.label)))}),n}},renameElementReferences:{value:function(e){var t=new u;t.initWithSerialization(this),t.visitSerialization(function(t){"Element"===t.type&&t.data in e&&(t.data=e[t.data])})}},renameSerializationLabels:{value:function(e){var t=new u;t.initWithSerialization(this),t.visitSerialization(function(t){if(t.label){var n=t.label;n in e&&(t.label=e[n])}if("reference"===t.type){var r=t.data;r in e&&(t.data=e[r])}})}},mergeSerialization:{value:function(e){return l.mergeSerializations(this,e)}},extractSerialization:{value:function(e,t){var n=new c;return n.initWithSerialization(this),n.extractSerialization(e,t)}}}),l=n.specialize(null,{mergeSerializations:{value:function(e,t){var n,r,i,a,o,l;a=e.getSerializationLabels(),o=t.getSerializationLabels(),l=this._createCollisionTable(a,o),l&&(i=t.getSerializationString(),t=(new s).initWithString(i),t.renameSerializationLabels(l),o=t.getSerializationLabels()),n=e.getSerializationObject(),r=t.getSerializationObject();for(var u,c=0;u=o[c];c++)n[u]=r[u];return e.initWithObject(n),l}},_createCollisionTable:{value:function(e,t){for(var n=new r,i={},a=!1,o=0;e.length>o;o++)n.setObjectLabel(null,e[o]);for(var s,o=0;s=t[o];o++)e.indexOf(s)>=0&&(i[s]=n.generateObjectLabel({}),a=!0);return a?i:void 0}}}),u=n.specialize({initWithSerialization:{value:function(e){this._serialization=e}},visitSerialization:{value:function(e){var t=this._serialization.getSerializationObject();this._walkRootObjects(e,t),this._serialization.initWithObject(t)}},visitSerializationObject:{value:function(e,t){var n=this._serialization.getSerializationObject();if(!(e in n))throw Error('Object "'+e+'" does not exist in '+this._serialization.getSerializationString());this._walkRootObject(t,n,e),this._serialization.initWithObject(n)}},changeLabel:{value:function(e,t){var n,r=this._serialization.getSerializationObject();n=r[e],delete r[e],r[t]=n}},_walkRootObjects:{value:function(e,t){for(var n in t)this._walkRootObject(e,t,n)}},_walkRootObject:{value:function(e,t,n){var r=t[n];"value"in r?this._walkObject(e,r,"value",n):this._walkCustomObject(e,t,n)}},_walkObject:{value:function(e,t,n,r,a){var o,s=t[n],l=i.getTypeOf(s);if(o={type:l},r?o.label=r:o.name=n,a&&(o.parent=a),"number"===l||"string"===l||"null"===l)o.data=s,e(o),t[n]=o.data;else if("regexp"===l)o.data=s["/"],e(o),s["/"]=o.data;else if("reference"===l)o.data=s["@"],e(o),s["@"]=o.data;else if("Element"===l)o.data=s["#"],e(o),s["#"]=o.data;else if("array"===l){o.data=s,e(o),t[n]=s=o.data;for(var u=0,c=s.length;c>u;u++)this._walkObject(e,s,""+u,null,o)}else if("object"===l){o.data=s,e(o),t[n]=s=o.data;for(var n in s)this._walkObject(e,s,n,null,o)}o.label!=r&&this.changeLabel(r,o.label)}},_walkCustomObject:{value:function(e,t,n){var r,i=t[n];r={type:"montageObject",label:n,data:i},e(r),t[n]=i=r.data,r.label!=n&&this.changeLabel(n,r.label),i.properties&&this._walkObject(e,i,"properties",null,r),i.listeners&&this._walkObject(e,i,"listeners",null,r),i.bindings&&this._walkBindings(e,i,null,r),i.localizations&&this._walkLocalizations(e,i,null,r)}},_walkBindings:{value:function(e,t,n){var r,i=t.bindings;r={type:"bindings",data:i,parent:n},e(r),t.bindings=i=r.data;for(var a in i)this._walkBinding(e,i,a,r)}},_walkBinding:{value:function(e,t,n,r){var i,a=t[n];i={type:"binding",name:n,data:a,parent:r},e(i),t[n]=a=i.data,this._walkBindingData(e,a,i)}},_walkBindingData:{value:function(e,t,n){var r,i,s=!1;r=t["<-"]||t["<->"],i=a(r),this._walksBindingReferences(i,function(t){var n={type:"reference",data:t.label};e(n),t.label!==n.data&&(t.label=n.data,s=!0)}),s&&("<-"in t?t["<-"]=o(i):t["<->"]=o(i)),t.converter&&this._walkObject(e,t,"converter",null,n)}},_walkLocalizations:{value:function(e,t,n){var r,i=t.localizations;r={type:"localizations",data:i,parent:n},e(r),t.localizations=i=r.data;for(var a in i)this._walkLocalization(e,i,a,r)}},_walkLocalization:{value:function(e,t,n,r){var i,a,o=t[n];if(i={type:"localization",name:n,data:o,parent:r},e(i),t[n]=o=i.data,"object"==typeof o.key&&this._walkBindingData(e,o.key,i),"object"==typeof o.default&&this._walkBindingData(e,o.default,i),"object"==typeof o.data){a=o.data;for(var n in a)this._walkBindingData(e,a[n],i)}}},_walksBindingReferences:{value:function(e,t){var n=e.args;if("component"===e.type&&t(e),n)for(var r=0,i=n.length;i>r;r++)this._walksBindingReferences(n[r],t)}}}),c=n.specialize({_serialization:{value:null},initWithSerialization:{value:function(e){this._serialization=e}},extractSerialization:{value:function(e,t){var n,r=new u,i={},a=[];n=this._serialization.getSerializationObject(),r.initWithSerialization(this._serialization);for(var o,l=0;o=e[l];l++)i[o]=n[o],r.visitSerializationObject(o,function(t){var n;"reference"===t.type&&(n=t.data,-1===a.indexOf(n)&&-1===e.indexOf(n)&&a.push(n))});if(t)for(var o,l=0;o=t[l];l++)o in n&&!(o in i)&&(i[o]={});for(var o,l=0;o=a[l];l++)i[o]={};return(new s).initWithObject(i)}}});t.Serialization=s,t.SerializationMerger=l,t.SerializationInspector=u,t.SerializationExtractor=c}}),montageDefine("d407295","window-loader/montage-window",{dependencies:["montage"],factory:function(e,t){var n=e("montage").Montage;t.MontageWindow=n.specialize({_application:{value:null},application:{get:function(){return this._application},set:function(e){null===this._application&&(this._application=e,this.focused&&this._setFocusedWindow(this))}},_window:{value:null},window:{get:function(){return this._window},set:function(e){if(null===this._window){var t=e.document.body;this._window=e,e.addEventListener("beforeunload",this,!0),e.addEventListener("focus",this,!0),e.addEventListener("mousedown",this,!0),null===t.getAttribute("tabIndex")&&(t.setAttribute("tabIndex",-1),t.focus())}}},document:{get:function(){return this._window.document}},_component:{value:null},component:{get:function(){return this._component},set:function(e){null===this._component&&(this._component=e)}},title:{get:function(){return this.document.title},set:function(e){this.document.title=e}},focused:{value:!1},focus:{value:function(){this._window&&this._window.focus()}},_setFocusedWindow:{value:function(e){var t,n,r,i=this.application;if(i._multipleWindow){t=i.windows;for(r in t)n=t[r],n.window===e?n.focused!==!0&&(n.focused=!0,"z-order"==i.windowsSortOrder?(t.splice(r,1),t.unshift(n)):"reverse-z-order"==i.windowsSortOrder&&(t.splice(r,1),t.push(n))):n.focused=!1}else this.focused=!0}},closed:{get:function(){return this._window?this._window.closed:!1}},close:{value:function(){this._window&&this._window.close()}},resizeTo:{value:function(e,t){this._window&&this._window.resizeTo(e,t)}},moveTo:{value:function(e,t){this._window&&this._window.moveTo(e,t)}},captureFocus:{value:function(e){var t=this.application;if(!this.application)return this.focused=!0,void 0;if(t.parentApplication)t.mainApplication.window.captureFocus(e);else{var n=(e.target.ownerDocument?e.target.ownerDocument.defaultView:null)||e.target.defaultView||e.target;this._setFocusedWindow(n)}}},captureMousedown:{value:function(e){this.captureFocus(e)}},captureBeforeunload:{value:function(){var e,t=this.application,n=t.windows,r=t.attachedWindows;t.attachedWindows=[];for(var e in r)r[e].close();t.parentApplication&&(r=t.parentApplication.attachedWindows,e=r.indexOf(this),-1!==e&&r.splice(e,1),e=n.indexOf(this),-1!==e&&n.splice(e,1),this.window.removeEventListener("beforeunload",this,!0),this.close())}}})}}),montageDefine("d407295","core/dom",{dependencies:["core/geometry/point"],factory:function(e,t){var n=e("core/geometry/point").Point,r=Node.prototype,i=Element.prototype;Object.defineProperty(i,"set",{value:function(e,t,n){var r,i,a,o,s,l=e.indexOf(".",n);n=n||0,i=e.substring(n,-1===l?e.length:l),-1===l?this.setAttribute(i,t):(a=e.lastIndexOf("."),"style"===i?(o=e.substring(l+1,e.length),this.style[o]=t):"classList"===i?(s=e.substring(l+1,e.length),t?this.classList.add(s):this.classList.remove(s)):(r=this.get(e.substring(0,a)))&&(r[e.substring(a+1,e.length)]=t))},enumerable:!1}),r.get=function(e){return this.getAttribute(e)||this[e]},Object.getPrototypeOf(document).addRule=function(e,t){var n,r;if(null==(n=document.styleSheets[0])){var i=document.createElement("style");i.type="text/css",document.head.appendChild(i),n=document.styleSheets[0]}else r=document.getRule(e,n);r||n.insertRule(e+" "+t,n.cssRules.length)},Object.getPrototypeOf(document).getRule=function(e,t){var n;if(t.cssRules)for(var r=0;n=t.cssRules[r];r++){if(n.name&&n.name===e)return n;if(n.selectorText===e)return n}},"undefined"!=typeof Element&&function(){var e="classList";if(!Element.prototype.hasOwnProperty(e)){var t=/^\s+|\s+$/g,n=function(e,t){e.setAttribute("class",t.join(" "))},r=function(e,t){if(""===t)throw"SYNTAX_ERR";if(/\s/.test(t))throw"INVALID_CHARACTER_ERR";return e.indexOf(t)},i=function(){var e=this,i=e.getAttribute("class")||"";return i=i.replace(t,"").split(/\s+/),{length:i.length,item:function(e){return i[e]||null},contains:function(e){return-1!==r(i,e)},add:function(t){-1===r(i,t)&&(i.push(t),this.length=i.length,n(e,i))},remove:function(t){var a=r(i,t);-1!==a&&(i.splice(a,1),this.length=i.length,n(e,i))},toggle:function(e){-1===r(i,e)?this.add(e):this.remove(e)},toString:function(){return e.getAttribute("class")||""}}};Object.defineProperty?Object.defineProperty(Element.prototype,e,{get:i,enumerable:!0}):Object.prototype.__defineGetter__&&Element.prototype.__defineGetter__(e,i)}}(),r.parentOf=function(e){for(;(e=e.parentNode)&&e!==this;);return e?!0:!1};var a=function(e){var t,n,r,i,a=e.ownerDocument;if(e&&a){if(n=a.documentElement,r=a.body,i=a.defaultView,e!==r){if(t=e.getBoundingClientRect(),n.parentOf(e)){var o=n.clientTop||r.clientTop||0,s=n.clientLeft||r.clientLeft||0,l=i.pageYOffset||n.scrollTop||r.scrollTop,u=i.pageXOffset||n.scrollLeft||r.scrollLeft,c=t.top+l-o,h=t.left+u-s;return{top:c,left:h}}return{top:t.top,left:t.left}}return{top:r.offsetTop,left:r.offsetLeft}}return null},o=null;try{o=new WebKitPoint(0,0)}catch(s){}var l=function(){t.convertPointFromNodeToPage=function(e,t){return t?(o.x=t.x,o.y=t.y):(o.x=0,o.y=0),t=webkitConvertPointFromNodeToPage(e,o),t?(new n).init(t.x,t.y):null},t.convertPointFromPageToNode=function(e,t){return t?(o.x=t.x,o.y=t.y):(o.x=0,o.y=0),t=webkitConvertPointFromPageToNode(e,o),t?(new n).init(t.x,t.y):null}},u=function(){t.convertPointFromNodeToPage=function(e,t){if(!e||void 0!==e.x)return null;var r;return(r=a(e))?(new n).init((t?t.x:0)+r.left,(t?t.y:0)+r.top):(new n).init(t?t.x:0,t?t.y:0)},t.convertPointFromPageToNode=function(e,t){if(!e||void 0!==e.x)return null;var r;return(r=a(e))?(new n).init((t?t.x:0)-r.left,(t?t.y:0)-r.top):(new n).init(t?t.x:0,t?t.y:0)}};o?l():u()}}),montageDefine("d407295","ui/base/abstract-number-field",{dependencies:["montage","ui/base/abstract-control","composer/key-composer","collections/dict"],factory:function(e,t){var n=(e("montage").Montage,e("ui/base/abstract-control").AbstractControl),r=e("composer/key-composer").KeyComposer;e("collections/dict");var i=t.AbstractNumberField=n.specialize({constructor:{value:function i(){if(this.constructor===i)throw Error("AbstractNumberField cannot be instantiated.");n.constructor.call(this),this._propertyNamesUsed={},this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"})}},enterDocument:{value:function(e){if(e){var t=this._propertyNamesUsed;t.min||(this.min=this.element.getAttribute("min")||this._min),t.max||(this.max=this.element.getAttribute("max")||this._max),t.step||(this.step=this.element.getAttribute("step")||this._step),t.value||(this.value=this.element.getAttribute("value")||this._value),delete this._propertyNamesUsed,this._numberFieldTextFieldComponent.addEventListener("action",this,!1),this._numberFieldMinusComponent.addEventListener("action",this,!1),this._numberFieldPlusComponent.addEventListener("action",this,!1),this._numberFieldTextFieldComponent.delegate=this,this.element.addEventListener("mousedown",this,!1),this.element.tabIndex="-1",this._upKeyComposer=r.createKey(this,"up","increase"),this._downKeyComposer=r.createKey(this,"down","decrease"),this._rightKeyComposer=r.createKey(this,"right","increase"),this._leftKeyComposer=r.createKey(this,"left","decrease")}}},textFieldShouldBeginEditing:{value:function(){return this.enabled}},textFieldDidChange:{value:function(){}},textFieldDidEndEditing:{value:function(){this.value=this._numberFieldTextFieldComponent.value}},prepareForActivationEvents:{value:function(){this.addEventListener("keyPress",this,!1),this._upKeyComposer.addEventListener("keyPress",null,!1),this._downKeyComposer.addEventListener("keyPress",null,!1),this._leftKeyComposer.addEventListener("keyPress",null,!1),this._rightKeyComposer.addEventListener("keyPress",null,!1)}},draw:{value:function(){this.element.setAttribute("aria-valuemax",this.max),this.element.setAttribute("aria-valuemin",this.min),this.element.setAttribute("aria-valuenow",this.value)}},acceptsActiveTarget:{value:!0},handleMousedown:{value:function(){this.element.focus()}},handlePlusAction:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e;t%this.step?0>t?t-=t%this.step:t+=this.step-t%this.step:t+=this.step,this.value=t+e}},handleMinusAction:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e;t-=t%this.step?t>0?t%this.step:this.step+t%this.step:this.step,this.value=t+e}},handleKeyPress:{value:function(e){this.enabled&&(this.value=this._numberFieldTextFieldComponent.value,"increase"===e.identifier?this.handlePlusAction():"decrease"===e.identifier&&this.handleMinusAction())}},handleAction:{value:function(e){(e.target===this._numberFieldTextFieldComponent||e.target===this._numberFieldMinusComponent||e.target===this._numberFieldPlusComponent)&&(e.stopPropagation(),this.dispatchActionEvent())}},_value:{value:0},_required:{value:!1},_min:{value:"any"},_max:{value:"any"},_step:{value:1},min:{get:function(){return this._min},set:function(e){return"any"!==e&&isNaN(e=parseFloat(e))?!1:(this._min!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.min=!0),this._min=e,this.needsDraw=!0,"number"==typeof e&&e>this.value&&(this.value=e)),void 0)}},max:{get:function(){return this._max},set:function(e){return"any"!==e&&isNaN(e=parseFloat(e))?!1:(this._max!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.max=!0),this._max=e,this.needsDraw=!0,"number"==typeof e&&this.value>e&&(this.value=e)),void 0)}},step:{get:function(){return this._step},set:function(e){return isNaN(e=parseFloat(e))||0>=e?!1:(this._step!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.step=!0),this._step=e),void 0)}},value:{get:function(){return this._value},set:function(e){isNaN(e=parseFloat(e))||("number"==typeof this.min&&this.min>e&&(e=this.min),"number"==typeof this.max&&e>this.max&&(e=this.max),this._value!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.value=!0),this._value=e,this.needsDraw=!0)),this._numberFieldTextFieldComponent&&this._value!==this._numberFieldTextFieldComponent.value&&(this._numberFieldTextFieldComponent.value=this._value)}},enabled:{value:!0},_numberFieldTextFieldComponent:{value:null},_numberFieldMinusComponent:{value:null},_numberFieldPlusComponent:{value:null}})}}),montageDefine("d407295","ui/base/abstract-slider",{dependencies:["ui/base/abstract-control","composer/translate-composer","composer/key-composer","collections/dict"],factory:function(e,t){var n=e("ui/base/abstract-control").AbstractControl,r=e("composer/translate-composer").TranslateComposer,i=e("composer/key-composer").KeyComposer;e("collections/dict");var a=t.AbstractSlider=n.specialize({constructor:{value:function a(){if(this.constructor===a)throw Error("AbstractSlider cannot be instantiated.");n.constructor.call(this),this._propertyNamesUsed={},this.addOwnPropertyChangeListener("_sliderMagnitude",this),this.addOwnPropertyChangeListener("_min",this),this.addOwnPropertyChangeListener("_max",this),this.addOwnPropertyChangeListener("_value",this),this.addOwnPropertyChangeListener("_step",this),this.addOwnPropertyChangeListener("axis",this),this.axis="horizontal",this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage-Slider--active')",{"<-":"active"})}},enterDocument:{value:function(e){if(e){this._translateComposer=new r,this._translateComposer.identifier="thumb",this._translateComposer.axis=this.axis,this._translateComposer.hasMomentum=!1,this.addComposerForElement(this._translateComposer,this._sliderThumbElement),this._transform="webkitTransform"in this.element.style?"webkitTransform":"MozTransform"in this.element.style?"MozTransform":"oTransform"in this.element.style?"oTransform":"transform";var t=this._propertyNamesUsed;t._min||(this.min=this.element.getAttribute("min")||this._min),t._max||(this.max=this.element.getAttribute("max")||this._max),t._step||(this.step=this.element.getAttribute("step")||this._step),t._value||(this.value=this.element.getAttribute("value")||this._value),delete this._propertyNamesUsed,this.element.setAttribute("role","slider"),this.element.tabIndex="-1",this._upKeyComposer=i.createKey(this,"up","increase"),this._downKeyComposer=i.createKey(this,"down","decrease"),this._rightKeyComposer=i.createKey(this,"right","increase"),this._leftKeyComposer=i.createKey(this,"left","decrease")}}},prepareForActivationEvents:{value:function(){this._translateComposer.addEventListener("translateStart",this,!1),this._translateComposer.addEventListener("translate",this,!1),this._translateComposer.addEventListener("translateEnd",this,!1),this._sliderThumbElement.addEventListener("touchstart",this,!1),document.addEventListener("touchend",this,!1),this._sliderThumbElement.addEventListener("mousedown",this,!1),document.addEventListener("mouseup",this,!1),this.addEventListener("keyPress",this,!1),this._upKeyComposer.addEventListener("keyPress",null,!1),this._downKeyComposer.addEventListener("keyPress",null,!1),this._leftKeyComposer.addEventListener("keyPress",null,!1),this._rightKeyComposer.addEventListener("keyPress",null,!1)}},willDraw:{value:function(){this._sliderMagnitude=this._calculateSliderMagnitude()}},_previousPercentage:{value:null},draw:{value:function(){"vertical"===this.axis?this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d(0,"+.01*(this._previousPercentage-this._valuePercentage)*this._sliderMagnitude+"px,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.top=100-this._valuePercentage+"%",this._sliderThumbElement.style.left=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage):this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d("+.01*(this._valuePercentage-this._previousPercentage)*this._sliderMagnitude+"px,0,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.left=this._valuePercentage+"%",this._sliderThumbElement.style.top=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage),this.element.setAttribute("aria-valuemax",this.max),this.element.setAttribute("aria-valuemin",this.min),this.element.setAttribute("aria-valuenow",this.value)}},acceptsActiveTarget:{value:!0},handleTouchstart:{value:function(){this.active=!0,this.element.focus(),this._isUpdatingTranslate=!0}},handleTouchend:{value:function(){this.active=!1}},handleMousedown:{value:function(e){this.active=!0,this.element.focus(),e.preventDefault(),this._isUpdatingTranslate=!0}},handleMouseup:{value:function(){this.active=!1}},_isUpdatingTranslate:{value:!1},handleThumbTranslateStart:{value:function(e){this._startTranslate="vertical"===this.axis?e.translateY:e.translateX,this._startValue=this.value}},handleThumbTranslate:{value:function(e){this.value="vertical"===this.axis?this._startValue+(this._startTranslate-e.translateY)/this._sliderMagnitude*(this._max-this._min):this._startValue+(e.translateX-this._startTranslate)/this._sliderMagnitude*(this._max-this._min),this._isUpdatingTranslate=!0}},handleThumbTranslateEnd:{value:function(){this.active=!1,this._isUpdatingTranslate=!1}},_increase:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,n=this.step|(this.max-this.min)/100;t%n?0>t?t-=t%n:t+=n-t%n:t+=n,this.value=t+e}},_decrease:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,n=this.step|(this.max-this.min)/100;t-=t%n?t>0?t%n:n+t%n:n,this.value=t+e}},handleKeyPress:{value:function(e){this.enabled&&("increase"===e.identifier?this._increase():"decrease"===e.identifier&&this._decrease())}},surrenderPointer:{value:function(){return!1}},active:{value:!1},_min:{value:0},_max:{value:100},_step:{value:"any"},min:{get:function(){return this._min},set:function(e){isNaN(e=parseFloat(e))||this._min!==e&&(this._min=e)}},max:{get:function(){return this._max},set:function(e){isNaN(e=parseFloat(e))||this._max!==e&&(this._max=e)}},step:{get:function(){return this._step},set:function(e){!isNaN(e=parseFloat(e))&&e>=0&&this._step!==e&&(this._step=e)}},_value:{value:50},value:{get:function(){return this._value},set:function(e){isNaN(e=parseFloat(e))||(e>this._max?e=this._max:this._min>e&&(e=this._min),this._value!==e&&(this._value=e))}},enabled:{value:!0},axis:{value:null},_sliderThumbElement:{value:null},_translateComposer:{value:null},_transform:{value:null},_transition:{value:null},_sliderMagnitude:{value:null},_startTranslate:{value:null},_startValue:{value:null},_valuePercentage:{value:null},_calculateSliderMagnitude:{value:function(){var e=window.getComputedStyle(this._element);return"vertical"===this.axis?this._element.clientHeight-parseFloat(e.getPropertyValue("padding-top"))-parseFloat(e.getPropertyValue("padding-bottom")):this._element.clientWidth-parseFloat(e.getPropertyValue("padding-left"))-parseFloat(e.getPropertyValue("padding-right"))}},handleAxisChange:{value:function(){this._translateComposer&&(this._translateComposer.axis=this.axis),"vertical"===this.axis?(this.classList.add("montage-Slider--vertical"),this.classList.remove("montage-Slider--horizontal")):(this.classList.remove("montage-Slider--vertical"),this.classList.add("montage-Slider--horizontal"))
}},_propertyRegex:{value:/_sliderMagnitude|_min|_max|_value|_step/},handlePropertyChange:{value:function(e,t){if(null!==t.match(this._propertyRegex)){if(this._propertyNamesUsed&&(this._propertyNamesUsed[t]=!0),this._value<=this._min)this._value=this._min;else{var n=this._value-this._min,r=n%this._step;if(r){var i=r>=.5*this._step&&this._value-r+this._step<=this._max;this._value=i?this._value-r+this._step:this._value-r}}this._value>this._max&&(this._value=this._max),this._valuePercentage=100*(this._value-this._min)/(this._max-this._min),this.needsDraw=!0}}}})}}),montageDefine("d407295","core/geometry/point",{dependencies:["montage"],factory:function(e,t){var n=e("montage").Montage;t.Point=n.specialize({init:{enumerable:!1,value:function(e,t){return this.x=null===e?0:e,this.y=null===t?0:t,this}},x:{enumerable:!0,value:0},y:{enumerable:!0,value:0}},{interpolate:{enumerable:!1,value:function(e,n,r,i){var a,o;return a=n.x+(r.x-n.x)*e,o=n.y+(r.y-n.y)*e,i>0&&(a=Math.round(a*i)/i,o=Math.round(o*i)/i),(new t.Point).init(a,o)}}})}}),montageDefine("d407295","ui/base/abstract-control",{dependencies:["montage","ui/component","collections/dict"],factory:function(e,t){var n=(e("montage").Montage,e("ui/component").Component),r=e("collections/dict");t.AbstractControl=n.specialize({dispatchActionEvent:{value:function(){this.dispatchEvent(this.createActionEvent())}},_detail:{value:null},detail:{get:function(){return null==this._detail&&(this._detail=new r),this._detail}},createActionEvent:{value:function(){var e,t=document.createEvent("CustomEvent");return e=this._detail,t.initCustomEvent("action",!0,!0,e),t}}})}}),montageDefine("d407295","composer/key-composer",{dependencies:["montage","composer/composer"],factory:function(e,t){var n=e("montage").Montage,r=e("composer/composer").Composer,i="keyPress",a="longKeyPress",o="keyRelease",s=t.KeyComposer=r.specialize({_isLoaded:{value:!1},_shouldDispatchEvent:{value:!1},shouldDispatchLongPress:{value:!1},_longPressTimeout:{value:null},_keyRegistered:{value:!1},_keys:{value:null},keys:{get:function(){return this._keys},set:function(e){this._keyRegistered?(u.defaultKeyManager.unregisterKey(this),this._keys=e,u.defaultKeyManager.registerKey(this)):this._keys=e}},_identifier:{value:null},identifier:{get:function(){return this._identifier},set:function(e){this._identifier=e}},load:{value:function(){this._isLoaded=!0,this._shouldDispatchEvent&&!this._keyRegistered&&(u.defaultKeyManager.registerKey(this),this._keyRegistered=!0)}},unload:{value:function(){this._isLoaded=!1,u.defaultKeyManager.unregisterKey(this),this._keyRegistered=!1}},addEventListener:{value:function(e,t,n){var s=this.component;r.addEventListener.call(this,e,t,n),(e==i||e==a||e==o)&&(this._shouldDispatchEvent=!0,e==a&&(this._shouldDispatchLongPress=!0),this._isLoaded?this._keyRegistered||(u.defaultKeyManager.registerKey(this),this._keyRegistered=!0):s&&"function"!=typeof s.addComposer&&(this.element||(this.element=window),this.load()))}},constructor:{value:function(){r.constructor.call(this)}},deserializedFromTemplate:{value:function(){var e=this.component;null===this.identifier&&(this.identifier=n.getInfoForObject(this).label),e&&("function"==typeof e.addComposer?e.addComposer(this):this._isLoaded||(this.element||(this.element=window),this.load()))}}},{createKey:{value:function(e,t,n){var r=this;return this===s&&(r=new s),n||(n=e.identifier?e.identifier+t.toLowerCase().replace(/[ +]/g).toCapitalized():t.toLowerCase().replace(/[ +]/g)),r.keys=t,r.identifier=n,e.addComposer(r),r}},createGlobalKey:{value:function(e,t,n){var r=this;return this===s&&(r=new s),r.keys=t,r.identifier=n,e.addComposerForElement(r,window),r}}}),l=null,u=n.specialize({_defaultKeyManager:{value:null},_loadingDefaultKeyManager:{value:!1},_keysToRegister:{value:[]},constructor:{value:function(){}},registerKey:{value:function(t){var n=this;this._defaultKeyManager?this._defaultKeyManager.registerKey(t):(this._keysToRegister.push(t),this._loadingDefaultKeyManager||(this._loadingDefaultKeyManager=!0,e.async("core/event/key-manager").then(function(e){var t=n._defaultKeyManager=e.defaultKeyManager;n._keysToRegister.forEach(function(e){t.registerKey(e)}),n._keysToRegister.length=0}).done()))}},unregisterKey:{value:function(e){this._defaultKeyManager&&this._defaultKeyManager.unregisterKey(e)}}},{defaultKeyManager:{get:function(){return l||(l=new u),this._defaultKeyManager?this._defaultKeyManager:l}}})}}),montageDefine("d407295","composer/translate-composer",{dependencies:["montage","composer/composer","core/event/event-manager"],factory:function(e,t){var n=(e("montage").Montage,e("composer/composer").Composer),r=e("core/event/event-manager").defaultEventManager,i=t.TranslateComposer=n.specialize({_NATIVE_ELEMENTS:{value:["A","IFRAME","EMBED","OBJECT","VIDEO","AUDIO","CANVAS","LABEL","INPUT","BUTTON","SELECT","TEXTAREA","KEYGEN","DETAILS","COMMAND"]},_WHEEL_POINTER:{value:"wheel",writable:!1},_externalUpdate:{value:!0},isAnimating:{value:!1},isMoving:{value:!1},frame:{value:function(){this.isAnimating&&this._animationInterval(),this._externalUpdate=!1}},_pointerSpeedMultiplier:{value:1},pointerSpeedMultiplier:{get:function(){return this._pointerSpeedMultiplier},set:function(e){this._pointerSpeedMultiplier=e}},pointerStartEventPosition:{value:null},_shouldDispatchTranslate:{value:!1},_isSelfUpdate:{value:!1},_allowFloats:{value:!1},allowFloats:{get:function(){return this._allowFloats},set:function(e){this._allowFloats!==e&&(this._allowFloats=e,this.translateX=this._translateX,this.translateY=this._translateY)}},_translateX:{value:0},translateX:{get:function(){return this._translateX},set:function(e){if("vertical"===this._axis)this._translateX=this._minTranslateX||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateX&&this._minTranslateX>t&&(t=this._minTranslateX),null!==this._maxTranslateX&&t>this._maxTranslateX&&(t=this._maxTranslateX),this._isSelfUpdate||(this.isAnimating=!1),this._translateX=t}}},_translateY:{value:0},translateY:{get:function(){return this._translateY},set:function(e){if("horizontal"===this._axis)this._translateY=this._minTranslateY||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateY&&this._minTranslateY>t&&(t=this._minTranslateY),null!==this._maxTranslateY&&t>this._maxTranslateY&&(t=this._maxTranslateY),this._isSelfUpdate||(this.isAnimating=!1),this._translateY=t}}},_minTranslateX:{value:null},minTranslateX:{get:function(){return this._minTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateX!=e&&(null!==e&&e>this._translateX&&(this.translateX=e),this._minTranslateX=e)}},_maxTranslateX:{value:null},maxTranslateX:{get:function(){return this._maxTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateX!=e&&(null!==e&&this._translateX>e&&(this.translateX=e),this._maxTranslateX=e)}},_minTranslateY:{value:null},minTranslateY:{get:function(){return this._minTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateY!=e&&(null!==e&&e>this._translateY&&(this.translateY=e),this._minTranslateY=e)}},_maxTranslateY:{value:null},maxTranslateY:{get:function(){return this._maxTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateY!=e&&(null!==e&&this._translateY>e&&(this.translateY=e),this._maxTranslateY=e)}},_axis:{value:"both"},axis:{get:function(){return this._axis},set:function(e){switch(e){case"vertical":case"horizontal":this._axis=e,this.translateX=this._translateX,this.translateY=this._translateY;break;default:this._axis="both"}}},invertAxis:{depends:["invertXAxis","invertYAxis"],get:function(){return this._invertXAxis===this._invertYAxis?this._invertXAxis:null},set:function(e){this.invertXAxis=e,this.invertYAxis=e}},_invertXAxis:{value:!1},invertXAxis:{get:function(){return this._invertXAxis},set:function(e){this._invertXAxis=!!e}},_invertYAxis:{value:!1},invertYAxis:{get:function(){return this._invertYAxis},set:function(e){this._invertYAxis=!!e}},startTranslateSpeed:{value:500},startTranslateRadius:{value:8},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=e?!0:!1}},__momentumDuration:{value:650},_momentumDuration:{get:function(){return this.__momentumDuration},set:function(e){this.__momentumDuration=isNaN(e)?1:e>>0,1>this.__momentumDuration&&(this.__momentumDuration=1)}},_pointerX:{value:null},_pointerY:{value:null},_touchIdentifier:{value:null},_isFirstMove:{value:!1},_start:{value:function(e,t,n){this.pointerStartEventPosition={pageX:e,pageY:t,target:n},this._pointerX=e,this._pointerY=t,window.Touch?(document.addEventListener("touchend",this,!0),this._element.addEventListener("touchmove",this,!1)):(document.addEventListener("mouseup",this,!0),this._element.addEventListener("mousemove",this,!1)),this.isAnimating&&(this.isAnimating=!1,this._dispatchTranslateEnd()),this._isFirstMove=!0}},_observedPointer:{value:null},_shouldPreventDefault:{value:function(e){return!!e.target.tagName&&-1===i._NATIVE_ELEMENTS.indexOf(e.target.tagName)&&!e.target.isContentEditable}},captureMousedown:{value:function(e){0===e.button&&(this._observedPointer="mouse",this._start(e.clientX,e.clientY,e.target))}},handleMousedown:{value:function(e){0!==e.button||this.eventManager.componentClaimingPointer(this._observedPointer)||this.eventManager.claimPointer(this._observedPointer,this)}},handleMousemove:{value:function(e){this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(e.preventDefault(),this._firstMove()):("both"===this.axis||this._analyzeMovement(e))&&this._stealPointer()&&(e.preventDefault(),this._firstMove())}},captureMousemove:{value:function(e){this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(e.preventDefault(),this._move(e.clientX,e.clientY)):("both"===this.axis||this._analyzeMovement(e))&&this._stealPointer()&&(e.preventDefault(),this._move(e.clientX,e.clientY))}},captureMouseup:{value:function(e){this._end(e)}},_releaseInterest:{value:function(){window.Touch?(document.removeEventListener("touchend",this,!0),this._isFirstMove?this._element.removeEventListener("touchmove",this,!1):document.removeEventListener("touchmove",this,!0)):(document.removeEventListener("mouseup",this,!0),this._isFirstMove?this._element.removeEventListener("mousemove",this,!1):document.removeEventListener("mousemove",this,!0)),this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null}},captureTouchstart:{value:function(e){null!==this._observedPointer&&this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)||e.targetTouches&&1===e.targetTouches.length&&(this._observedPointer=e.targetTouches[0].identifier,this._start(e.targetTouches[0].clientX,e.targetTouches[0].clientY,e.targetTouches[0].target))}},handleTouchstart:{value:function(e){this.eventManager.componentClaimingPointer(this._observedPointer)||e.targetTouches&&1===e.targetTouches.length&&(this._shouldPreventDefault(e)&&e.preventDefault(),this.eventManager.claimPointer(this._observedPointer,this))}},handleTouchmove:{value:function(e){this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(e.preventDefault(),this._firstMove()):("both"===this.axis||this._analyzeMovement(e))&&this._stealPointer()&&(e.preventDefault(),this._firstMove())}},captureTouchmove:{value:function(e){for(var t=0,n=e.changedTouches.length;n>t&&e.changedTouches[t].identifier!==this._observedPointer;)t++;n>t&&(this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(e.preventDefault(),this._move(e.changedTouches[t].clientX,e.changedTouches[t].clientY)):this._analyzeMovement(e.changedTouches[t]))}},captureTouchend:{value:function(e){for(var t=0,n=e.changedTouches.length;n>t&&e.changedTouches[t].identifier!==this._observedPointer;)t++;n>t&&this._end(e.changedTouches[t])}},_analyzeMovement:{value:function(e){var t=e.velocity;if(t){var n,r,i,a,o,s,l,u,c=.7853981633974483,h=2.356194490192345,d=-2.356194490192345,p=-.7853981633974483;if(s=t.speed,0!==t.speed&&!isNaN(t.speed))if(o=t.angle,"horizontal"===this.axis){if(i=c>=o&&o>=p,a=o>=h||d>=o,i||a)return this._stealPointer()}else if("vertical"===this.axis){if(n=p>=o&&o>=d,r=o>=c&&h>=o,n||r)return this._stealPointer()}else{if(s>=this.startTranslateSpeed)return this._stealPointer();if(l=this.pointerStartEventPosition.pageX-e.pageX,u=this.pointerStartEventPosition.pageY-e.pageY,l*l+u*u>this.startTranslateRadius*this.startTranslateRadius)return this._stealPointer()}}}},_stealPointer:{value:function(){return this.eventManager.claimPointer(this._observedPointer,this)}},_translateEndTimeout:{value:null},captureWheel:{value:function(){this.eventManager.componentClaimingPointer(this._WHEEL_POINTER)||this.eventManager.claimPointer(this._WHEEL_POINTER,this.component)}},handleWheel:{value:function(e){var t=this;if(this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this.component)){var n=this._translateY,r=e.wheelDeltaY||-e.deltaY||0;this._dispatchTranslateStart(),this.translateY=this._translateY-20*r/120,this._dispatchTranslate(),window.clearTimeout(this._translateEndTimeout),this._translateEndTimeout=window.setTimeout(function(){t._dispatchTranslateEnd()},400),n!==this._translateY&&this._shouldPreventDefault(e)&&e.preventDefault(),this.eventManager.forfeitPointer(this._WHEEL_POINTER,this.component)}}},_firstMove:{value:function(){this._isFirstMove&&(this._dispatchTranslateStart(this._translateX,this._translateY),this._isFirstMove=!1,this.isMoving=!0,window.Touch?(document.addEventListener("touchmove",this,!0),this._element.removeEventListener("touchmove",this,!1)):(document.addEventListener("mousemove",this,!0),this._element.removeEventListener("mousemove",this,!1)))}},_move:{value:function(e,t){var n;this._isSelfUpdate=!0,"vertical"!=this._axis&&(n=this._invertXAxis?this._pointerX-e:e-this._pointerX,this.translateX+=n*this._pointerSpeedMultiplier),"horizontal"!=this._axis&&(n=this._invertYAxis?this._pointerY-t:t-this._pointerY,this.translateY+=n*this._pointerSpeedMultiplier),this._isSelfUpdate=!1,this._pointerX=e,this._pointerY=t,this._shouldDispatchTranslate&&this._dispatchTranslate()}},_bezierTValue:{value:function(e,t,n,r,i){var a,o,s,l,u=1-3*r+3*t,c=3*r-6*t,h=3*t,d=.5;for(o=0;10>o;o++)l=d*d,a=3*u*l+2*c*d+h,s=1-d,d-=(3*(s*s*d*t+s*l*r)+l*d-e)/a;return l=d*d,s=1-d,3*(s*s*d*n+s*l*i)+l*d}},_dispatchTranslateStart:{value:function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent("translateStart",!0,!0,null),n.translateX=e,n.translateY=t,n.scroll=0,this.dispatchEvent(n)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,this.dispatchEvent(e)}},animateBouncingX:{value:!1,enumerable:!1},startTimeBounceX:{value:!1,enumerable:!1},animateBouncingY:{value:!1,enumerable:!1},startTimeBounceY:{value:!1,enumerable:!1},animateMomentum:{value:!1,enumerable:!1},startTime:{value:null,enumerable:!1},startX:{value:null,enumerable:!1},posX:{value:null,enumerable:!1},endX:{value:null,enumerable:!1},startY:{value:null,enumerable:!1},posY:{value:null,enumerable:!1},endY:{value:null,enumerable:!1},translateStrideX:{value:null},translateStrideY:{value:null},translateStrideDuration:{value:330},_animationInterval:{value:function(){var e,t,n,r,i=Date.now(),a=!1;this.animateMomentum&&(e=i-this.startTime,this.__momentumDuration>e?(this.posX=this.startX-(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.posY=this.startY-(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posX-this.endX)<.75*this.translateStrideX)&&(this.startStrideXTime=i),this.translateStrideY&&null===this.startStrideYTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posY-this.endY)<.75*this.translateStrideY)&&(this.startStrideYTime=i)):this.animateMomentum=!1),t=Math.round(this.endX/this.translateStrideX),this.startStrideXTime&&i-this.startStrideXTime>0&&(i-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((i-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),this.posX=this.posX*(1-e)+t*this.translateStrideX*e,a=!0):this.posX=t*this.translateStrideX),t=Math.round(this.endY/this.translateStrideY),this.startStrideYTime&&i-this.startStrideYTime>0&&(i-this.startStrideYTime<this.translateStrideDuration?(e=this._bezierTValue((i-this.startStrideYTime)/this.translateStrideDuration,.275,0,.275,1),this.posY=this.posY*(1-e)+t*this.translateStrideY*e,a=!0):this.posY=t*this.translateStrideY),n=this.posX,r=this.posY,this._isSelfUpdate=!0,this.translateX=n,this.translateY=r,this._shouldDispatchTranslate&&this._dispatchTranslate(),this._isSelfUpdate=!1,this.isAnimating=this.animateMomentum||a,this.isAnimating?this.needsFrame=!0:this._dispatchTranslateEnd()}},_end:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY,this._hasMomentum&&(e.velocity.speed>40||this.translateStrideX||this.translateStrideY)?(this.momentumX="vertical"!=this._axis?e.velocity.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):0,this.momentumY="horizontal"!=this._axis?e.velocity.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):0,this.endX=this.startX-this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY-this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateEnd()),this._releaseInterest()}},surrenderPointer:{value:function(){return!this.isMoving}},eventManager:{get:function(){return r}},load:{value:function(){if(window.Touch)this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("touchstart",this,!1);else{this._element.addEventListener("mousedown",this,!0),this._element.addEventListener("mousedown",this,!1);var e;e=void 0!==window.onwheel?"wheel":"mousewheel",this._element.addEventListener(e,this,!1),this._element.addEventListener(e,this,!0)}this.eventManager.isStoringPointerEvents=!0}},addEventListener:{value:function(e,t,r){n.addEventListener.call(this,e,t,r),"translate"===e&&(this._shouldDispatchTranslate=!0)}}});i.prototype.handleMousewheel=i.prototype.handleWheel,i.prototype.captureMousewheel=i.prototype.captureWheel}}),montageDefine("d407295","composer/composer",{dependencies:["montage","core/target"],factory:function(e,t){var n=(e("montage").Montage,e("core/target").Target);t.Composer=n.specialize({_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},lazyLoad:{value:!1},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:function(){}},_resolveDefaults:{value:function(){null==this.element&&null!=this.component&&(this.element=this.component.element)}},_load:{value:function(){this.element||this._resolveDefaults(),this.load()}},load:{value:function(){}},unload:{value:function(){}},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}})}}),montageDefine("d407295","ui/base/abstract-text-field",{dependencies:["montage","ui/base/abstract-control","composer/key-composer","collections/dict"],factory:function(e,t){var n=(e("montage").Montage,e("ui/base/abstract-control").AbstractControl),r=e("composer/key-composer").KeyComposer;e("collections/dict");var i=t.AbstractTextField=n.specialize({constructor:{value:function i(){if(this.constructor===i)throw Error("AbstractTextField cannot be instantiated.");n.constructor.call(this),this._keyComposer=new r,this._keyComposer.component=this,this._keyComposer.keys="enter",this.addComposer(this._keyComposer),this.defineBindings({"classList.has('montage--disabled')":{"<-":"!enabled"}})}},hasTemplate:{value:!1},acceptsActiveTarget:{get:function(){var e=this.callDelegateMethod("shouldBeginEditing",this);return e!==!1}},delegate:{value:null},enabled:{value:!0},_placeholderValue:{value:null},placeholderValue:{set:function(e){this._placeholderValue=e,this.needsDraw=!0},get:function(){return this._placeholderValue}},_value:{value:null},value:{set:function(e){e===this._value||this.hasFocus||(this._value=e,this.needsDraw=!0)},get:function(){return this._value}},_hasFocus:{value:!1},hasFocus:{get:function(){return this._hasFocus}},_keyComposer:{value:null},handleKeyPress:{value:function(e){this.enabled&&e.keyComposer===this._keyComposer&&this.dispatchActionEvent()}},prepareForActivationEvents:{value:function(){this.addEventListener("keyPress",this,!1),this._keyComposer.addEventListener("keyPress",null,!1)}},enterDocument:{value:function(e){e&&(this.element.addEventListener("input",this,!1),this.element.addEventListener("change",this,!1),this.element.addEventListener("focus",this,!1),this.element.addEventListener("blur",this,!1))}},draw:{value:function(){var e=this.value;this.element.value=null===e||void 0===e?"":"boolean"==typeof e||"object"==typeof e||"number"==typeof e?""+e:e,null!=this.placeholderValue&&this.element.setAttribute("placeholder",this.placeholderValue)}},handleChange:{value:function(){this._updateValueFromDom()}},handleInput:{value:function(){this._updateValueFromDom()}},handleFocus:{value:function(){this.acceptsActiveTarget?(this._hasFocus=!0,this.callDelegateMethod("didBeginEditing",this)):this.element.blur()}},handleBlur:{value:function(){var e=this.callDelegateMethod("shouldEndEditing",this);e===!1?this.element.focus():(this._hasFocus=!1,this.callDelegateMethod("didEndEditing",this))}},_updateValueFromDom:{value:function(){this._value!==this.element.value&&(this._value=this.element.value,this.dispatchOwnPropertyChange("value",this._value),this.callDelegateMethod("didChange",this))}}})}}),montageDefine("d407295","ui/base/abstract-button",{dependencies:["montage","ui/base/abstract-control","composer/press-composer"],factory:function(e,t){var n=(e("montage").Montage,e("ui/base/abstract-control").AbstractControl),r=e("composer/press-composer").PressComposer,i=t.AbstractButton=n.specialize({constructor:{value:function i(){if(this.constructor===i)throw Error("AbstractControl cannot be instantiated.");n.constructor.call(this),this._pressComposer=new r,this.addComposer(this._pressComposer),this._pressComposer.defineBinding("longPressThreshold ",{"<-":"holdThreshold",source:this}),this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage--active')",{"<-":"active"})}},enabled:{value:!0},_preventFocus:{value:!1},preventFocus:{get:function(){return this._preventFocus},set:function(e){this._preventFocus=!!e,this.needsDraw=!0}},acceptsActiveTarget:{value:function(){return!this._preventFocus}},willBecomeActiveTarget:{value:function(){}},_labelNode:{value:void 0,enumerable:!1},_label:{value:void 0,enumerable:!1},label:{get:function(){return this._label},set:function(e){if(void 0!==e&&this.converter)try{e=this.converter.convert(e),this.error&&(this.error=null)}catch(t){this.error=t}this._label=""+e,this.isInputElement&&(this.value=this._label),this.needsDraw=!0}},_setLabelInitialValue:{value:function(e){void 0===this._label&&(this._label=e)}},holdThreshold:{value:1e3},_pressComposer:{value:null},_active:{value:!1},active:{get:function(){return this._active},set:function(e){this._active=e,this.needsDraw=!0}},prepareForActivationEvents:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},addEventListener:{value:function(e,t,r){n.addEventListener.call(this,e,t,r),"longAction"===e&&this._pressComposer.addEventListener("longPress",this,!1)}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1),this._preventFocus||this._element.focus()}},handlePress:{value:function(){this.active=!1,this.dispatchActionEvent(),document.removeEventListener("touchmove",this,!1)}},handleKeyup:{value:function(e){32===e.keyCode&&(this.active=!1,this.dispatchActionEvent())}},handleLongPress:{value:function(){this._pressComposer.cancelPress();var e=document.createEvent("CustomEvent");e.initCustomEvent("longAction",!0,!0,null),this.dispatchEvent(e)}},handlePressCancel:{value:function(){this.active=!1,document.removeEventListener("touchmove",this,!1)}},handleTouchmove:{value:function(e){e.preventDefault()}},isInputElement:{value:!1},enterDocument:{value:function(e){e&&(this.isInputElement="INPUT"===this.originalElement.tagName,this.isInputElement?(Object.defineProperty(this,"value",{get:function(){return this._label},set:function(e){this.label=e}}),void 0===this._label&&(this._label=this.originalElement.value)):(this.originalElement.firstChild||this.originalElement.appendChild(document.createTextNode("")),this._labelNode=this.originalElement.firstChild,this._setLabelInitialValue(this._labelNode.data),void 0===this._label&&(this._label=this._labelNode.data)),this.element.setAttribute("role","button"),this.element.addEventListener("keyup",this,!1))}},_drawLabel:{enumerable:!1,value:function(e){this.isInputElement?this._element.setAttribute("value",e):this._labelNode&&(this._labelNode.data=e)}},draw:{value:function(){this._elementNeedsTabIndex()&&(this._preventFocus?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex","-1")),this.isInputElement&&(this.element.disabled=!this.enabled),this._drawLabel(this.label)}},_elementNeedsTabIndexRegex:{value:/INPUT|TEXTAREA|A|SELECT|BUTTON|LABEL/},_elementNeedsTabIndex:{value:function(){return null===this.element.tagName.match(this._elementNeedsTabIndexRegex)}}})}}),montageDefine("d407295","composer/press-composer",{dependencies:["montage","composer/composer","core/event/mutable-event"],factory:function(e,t){var n=e("montage").Montage,r=e("composer/composer").Composer,i=e("core/event/mutable-event").MutableEvent,a=t.PressComposer=r.specialize({load:{value:function(){window.Touch?this._element.addEventListener("touchstart",this,!0):this._element.addEventListener("mousedown",this,!0)}},unload:{value:function(){window.Touch?this._element.removeEventListener("touchstart",this,!0):this._element.removeEventListener("mousedown",this,!0)}},delegate:{value:null},cancelPress:{value:function(){return this._state===a.PRESSED?(this._dispatchPressCancel(),this._endInteraction(),!0):!1}},addEventListener:{value:function(e,t,n){r.addEventListener.call(this,e,t,n),"longPress"===e&&(this._shouldDispatchLongPress=!0)}},UNPRESSED:{value:0},PRESSED:{value:1},CANCELLED:{value:2},_state:{enumerable:!1,value:0},state:{get:function(){return this._state}},_shouldDispatchLongPress:{enumerable:!1,value:!1},_longPressThreshold:{enumerable:!1,value:1e3},longPressThreshold:{get:function(){return this._longPressThreshold},set:function(e){this._longPressThreshold!==e&&(this._longPressThreshold=e)}},_longPressTimeout:{enumberable:!1,value:null},_observedPointer:{enumerable:!1,value:null},_startInteraction:{enumerable:!1,value:function(e){if("enabled"in this.component&&!this.component.enabled||null!==this._observedPointer)return!1;var t;"touchstart"===e.type?(t=e.changedTouches.length,1===t&&(this._observedPointer=e.changedTouches[0].identifier),document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1)):"mousedown"===e.type&&(this._observedPointer="mouse",document.addEventListener("mouseup",this,!1),document.addEventListener("click",this,!1)),this._element.addEventListener("dragstart",this,!1),this.component.eventManager.claimPointer(this._observedPointer,this),this._dispatchPressStart(e)}},_interpretInteraction:{value:function(e){var t,n,r;if(null===this._observedPointer)return this._endInteraction(e),void 0;for(t=!this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this),n=e.target;n!==this._element&&n&&n.parentNode;)n=n.parentNode;if(r=n===this._element,t&&"click"===e.type)return e.preventDefault(),this._endInteraction(e),void 0;if("mouseup"===e.type){if(!t&&r)return this._dispatchPress(e),this._endInteraction(e),void 0;if(!t&&!r)return this._dispatchPressCancel(e),this._endInteraction(e),void 0;t&&!r&&this._endInteraction(e)}}},_endInteraction:{value:function(e){e&&"touchend"!==e.type&&"touchcancel"!==e.type?e&&"click"!==e.type&&"mouseup"!==e.type||(document.removeEventListener("click",this),document.removeEventListener("mouseup",this)):(document.removeEventListener("touchend",this),document.removeEventListener("touchcancel",this)),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.component.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._state=a.UNPRESSED}},_changedTouchisObserved:{value:function(){if(null===this._observedPointer)return!1;for(var e=0,t=event.changedTouches.length;t>e;e++)if(event.changedTouches[e].identifier===this._observedPointer)return e;return!1}},surrenderPointer:{value:function(e,t){var n=this.callDelegateMethod("surrenderPointer",e,t);return void 0!==n&&n===!1?!1:(this._dispatchPressCancel(),!0)}},captureTouchstart:{value:function(e){this._startInteraction(e)}},handleTouchend:{value:function(e){return null===this._observedPointer?(this._endInteraction(e),void 0):(this._changedTouchisObserved(e.changedTouches)!==!1&&(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?this._dispatchPress(e):e.preventDefault(),this._endInteraction(e)),void 0)}},handleTouchcancel:{value:function(e){(null===this._observedPointer||this._changedTouchisObserved(e.changedTouches)!==!1)&&(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this._dispatchPressCancel(e),this._endInteraction(e))}},captureMousedown:{value:function(e){this._startInteraction(e)}},handleClick:{value:function(e){this._interpretInteraction(e)}},handleMouseup:{value:function(e){this._interpretInteraction(e)}},handleDragstart:{value:function(e){this._dispatchPressCancel(e),this._endInteraction()}},_createPressEvent:{enumerable:!1,value:function(e,t){var n,r;return t||(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!0,!0,null)),n=new o,n.event=t,n.type=e,n.pointer=this._observedPointer,n.targetElement=t.target,t.changedTouches&&(r=this._changedTouchisObserved(t.changedTouches))!==!1&&(n.touch=t.changedTouches[r]),n}},_dispatchPressStart:{enumerable:!1,value:function(e){if(this._state=a.PRESSED,this.dispatchEvent(this._createPressEvent("pressStart",e)),this._shouldDispatchLongPress){var t=this;this._longPressTimeout=setTimeout(function(){t._dispatchLongPress()},this._longPressThreshold)}}},_dispatchPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this.dispatchEvent(this._createPressEvent("press",e)),this._state=a.UNPRESSED}},_dispatchLongPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(this.dispatchEvent(this._createPressEvent("longPress",e)),this._longPressTimeout=null)}},_dispatchPressCancel:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this._state=a.CANCELLED,this.dispatchEvent(this._createPressEvent("pressCancel",e))
}}}),o=function(){var e,t,r,a,o,s;for(e=i.specialize({type:{value:"press"},_event:{enumerable:!1,value:null},event:{get:function(){return this._event},set:function(e){this._event=e}},_touch:{enumerable:!1,value:null},touch:{get:function(){return this._touch},set:function(e){this._touch=e}}}),t=["altKey","ctrlKey","metaKey","shiftKey","cancelBubble","currentTarget","defaultPrevented","eventPhase","timeStamp","preventDefault","stopImmediatePropagation","stopPropagation"],r=["clientX","clientY","pageX","pageY","screenX","screenY","target"],a=function(e){return{get:function(){return this._event[e]}}},o=function(e){return{get:function(){return this._touch?this._touch[e]:this._event[e]}}},s=t.length-1;s>=0;s--)n.defineProperty(e,t[s],a(t[s]));for(s=r.length-1;s>=0;s--)n.defineProperty(e,r[s],o(r[s]));return e}()}}),montageDefine("fdadc45","shim",{dependencies:["./shim-array","./shim-object","./shim-function","./shim-regexp"],factory:function(e){e("./shim-array"),e("./shim-object"),e("./shim-function"),e("./shim-regexp")}}),montageDefine("fdadc45","listen/property-changes",{dependencies:["../shim","weak-map"],factory:function(e,t,n){function r(){throw Error("This is an abstract interface. Mix it. Don't construct it")}e("../shim");var i=e("weak-map"),a=Object.prototype.hasOwnProperty,o=new i,s=new i;n.exports=r,r.debug=!0,r.prototype.getOwnPropertyChangeDescriptor=function(e){o.has(this)||o.set(this,{});var t=o.get(this);return a.call(t,e)||(t[e]={willChangeListeners:[],changeListeners:[]}),t[e]},r.prototype.hasOwnPropertyChangeDescriptor=function(e){if(!o.has(this))return!1;if(!e)return!0;var t=o.get(this);return a.call(t,e)?!0:!1},r.prototype.addOwnPropertyChangeListener=function(e,t,n){this.makeObservable&&!this.isObservable&&this.makeObservable();var i,a=r.getOwnPropertyChangeDescriptor(this,e);i=n?a.willChangeListeners:a.changeListeners,r.makePropertyObservable(this,e),i.push(t);var o=this;return function(){r.removeOwnPropertyChangeListener(o,e,i,n),o=null}},r.prototype.addBeforeOwnPropertyChangeListener=function(e,t){return r.addOwnPropertyChangeListener(this,e,t,!0)},r.prototype.removeOwnPropertyChangeListener=function(e,t,n){var i,a=r.getOwnPropertyChangeDescriptor(this,e);i=n?a.willChangeListeners:a.changeListeners;var o=i.lastIndexOf(t);if(-1===o)throw Error("Can't remove listener: does not exist.");i.splice(o,1),0===a.changeListeners.length+a.willChangeListeners.length&&r.makePropertyUnobservable(this,e)},r.prototype.removeBeforeOwnPropertyChangeListener=function(e,t){return r.removeOwnPropertyChangeListener(this,e,t,!0)},r.prototype.dispatchOwnPropertyChange=function(e,t,n){var i=r.getOwnPropertyChangeDescriptor(this,e);if(!i.isActive){i.isActive=!0;var a;a=n?i.willChangeListeners:i.changeListeners;var o=(n?"Will":"")+"Change",s="handleProperty"+o,l=e+"";l=l&&l[0].toUpperCase()+l.slice(1);var u="handle"+l+o;try{a.forEach(function(n){var r=n;if(n=n[u]||n[s]||n,!n.call)throw Error("No event listener for "+u+" or "+s+" or call on "+n);n.call(r,t,e,this)},this)}finally{i.isActive=!1}}},r.prototype.dispatchBeforeOwnPropertyChange=function(e,t){return r.dispatchOwnPropertyChange(this,e,t,!0)},r.prototype.makePropertyObservable=function(e){if(!Array.isArray(this)){if(!Object.isExtensible(this,e))throw Error("Can't make property "+JSON.stringify(e)+" observable on "+this+" because object is not extensible");var t;"object"==typeof this.__state__?t=this.__state__:(t={},Object.isExtensible(this,"__state__")&&Object.defineProperty(this,"__state__",{value:t,writable:!0,enumerable:!1})),t[e]=this[e],s.has(this)||(n={},s.set(this,n));var n=s.get(this);if(!a.call(n,e)){var i,o=this;Object.getOwnPropertyDescriptor(o,e);do{if(i=Object.getOwnPropertyDescriptor(o,e))break;o=Object.getPrototypeOf(o)}while(o);if(i=i||{value:void 0,enumerable:!0,writable:!0,configurable:!0},!i.configurable)throw Error("Can't observe non-configurable properties");if(n[e]=i,i.writable||i.set){var l;l="value"in i?{get:function(){return i.value},set:function(n){return n===i.value?n:(r.dispatchBeforeOwnPropertyChange(this,e,i.value),i.value=n,t[e]=n,r.dispatchOwnPropertyChange(this,e,n),n)},enumerable:i.enumerable,configurable:!0}:{get:function(){return i.get?i.get.apply(this,arguments):void 0},set:function(n){var a;return i.get&&(a=i.get.apply(this,arguments)),i.set&&i.set.apply(this,arguments),i.get&&(n=i.get.apply(this,arguments),t[e]=n),n===a?n:(r.dispatchBeforeOwnPropertyChange(this,e,a),r.dispatchOwnPropertyChange(this,e,n),n)},enumerable:i.enumerable,configurable:!0},Object.defineProperty(this,e,l)}}}},r.prototype.makePropertyUnobservable=function(e){if(!Array.isArray(this)){if(!s.has(this))throw Error("Can't uninstall observer on property");var t=s.get(this);if(!t[e])throw Error("Can't uninstall observer on property");var n=t[e];delete t[e];var r;"object"==typeof this.__state__?r=this.__state__:(r={},Object.isExtensible(this,"__state__")&&Object.defineProperty(this,"__state__",{value:r,writable:!0,enumerable:!1})),delete r[e],Object.defineProperty(this,e,n)}},r.getOwnPropertyChangeDescriptor=function(e,t){return e.getOwnPropertyChangeDescriptor?e.getOwnPropertyChangeDescriptor(t):r.prototype.getOwnPropertyChangeDescriptor.call(e,t)},r.hasOwnPropertyChangeDescriptor=function(e,t){return e.hasOwnPropertyChangeDescriptor?e.hasOwnPropertyChangeDescriptor(t):r.prototype.hasOwnPropertyChangeDescriptor.call(e,t)},r.addOwnPropertyChangeListener=function(e,t,n,i){return Object.isObject(e)?e.addOwnPropertyChangeListener?e.addOwnPropertyChangeListener(t,n,i):r.prototype.addOwnPropertyChangeListener.call(e,t,n,i):void 0},r.removeOwnPropertyChangeListener=function(e,t,n,i){return Object.isObject(e)?e.removeOwnPropertyChangeListener?e.removeOwnPropertyChangeListener(t,n,i):r.prototype.removeOwnPropertyChangeListener.call(e,t,n,i):void 0},r.dispatchOwnPropertyChange=function(e,t,n,i){return Object.isObject(e)?e.dispatchOwnPropertyChange?e.dispatchOwnPropertyChange(t,n,i):r.prototype.dispatchOwnPropertyChange.call(e,t,n,i):void 0},r.addBeforeOwnPropertyChangeListener=function(e,t,n){return r.addOwnPropertyChangeListener(e,t,n,!0)},r.removeBeforeOwnPropertyChangeListener=function(e,t,n){return r.removeOwnPropertyChangeListener(e,t,n,!0)},r.dispatchBeforeOwnPropertyChange=function(e,t,n){return r.dispatchOwnPropertyChange(e,t,n,!0)},r.makePropertyObservable=function(e,t){return e.makePropertyObservable?e.makePropertyObservable(t):r.prototype.makePropertyObservable.call(e,t)},r.makePropertyUnobservable=function(e,t){return e.makePropertyUnobservable?e.makePropertyUnobservable(t):r.prototype.makePropertyUnobservable.call(e,t)}}}),montageDefine("fdadc45","map",{dependencies:["./shim","./set","./generic-collection","./generic-map","./listen/property-changes","map"],factory:function(e,t,n){"use strict";function r(e,t,n,a){return this instanceof r?(t=t||Object.equals,n=n||Object.hash,a=a||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=a,this.store=new i(void 0,function(e,n){return t(e.key,n.key)},function(e){return n(e.key)}),this.length=0,this.addEach(e),void 0):new r(e,t,n,a)}e("./shim");var i=e("./set"),a=e("./generic-collection"),o=e("./generic-map"),s=e("./listen/property-changes");n.exports=r,r.Map=r,Object.addEach(r.prototype,a.prototype),Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,s.prototype),r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},r.prototype.log=function(e,t,n,r){t=t||this.logNode,this.store.log(e,function(e,n,r){t(e.value.value,n,r)},n,r)},r.prototype.logNode=function(e,t){t(" key: "+e.key),t(" value: "+e.value)}}}),montageDefine("fdadc45","shim-array",{dependencies:["./shim-function","./generic-collection","./generic-order","weak-map"],factory:function(e,t,n){"use strict";function r(e,t){Object.defineProperty(Array.prototype,e,{value:t,writable:!0,configurable:!0,enumerable:!1})}function i(e,t,n){this.array=e,this.start=null==t?0:t,this.end=n}e("./shim-function");var a=e("./generic-collection"),o=e("./generic-order"),s=e("weak-map");n.exports=Array,Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=function(e){var t=[];return t.addEach(e),t},Array.unzip=function(e){for(var t=[],n=1/0,r=0;e.length>r;r++){var i=e[r];e[r]=i.toArray(),n>i.length&&(n=i.length)}for(var r=0;e.length>r;r++)for(var i=e[r],a=0;i.length>a;a++)n>a&&a in i&&(t[a]=t[a]||[],t[a][r]=i[a]);return t},r("addEach",a.prototype.addEach),r("deleteEach",a.prototype.deleteEach),r("toArray",a.prototype.toArray),r("toObject",a.prototype.toObject),r("all",a.prototype.all),r("any",a.prototype.any),r("min",a.prototype.min),r("max",a.prototype.max),r("sum",a.prototype.sum),r("average",a.prototype.average),r("only",a.prototype.only),r("flatten",a.prototype.flatten),r("zip",a.prototype.zip),r("enumerate",a.prototype.enumerate),r("group",a.prototype.group),r("sorted",a.prototype.sorted),r("reversed",a.prototype.reversed),r("constructClone",function(e){var t=new this.constructor;return t.addEach(e),t}),r("has",function(e,t){return-1!==this.find(e,t)}),r("get",function(e,t){if(+e!==e)throw Error("Indicies must be numbers");return!e in this?t:this[e]}),r("set",function(e,t){return this.splice(e,1,t),!0}),r("add",function(e){return this.push(e),!0}),r("delete",function(e,t){var n=this.find(e,t);return-1!==n?(this.splice(n,1),!0):!1}),r("find",function(e,t){t=t||this.contentEquals||Object.equals;for(var n=0;this.length>n;n++)if(n in this&&t(this[n],e))return n;return-1}),r("findLast",function(e,t){t=t||this.contentEquals||Object.equals;var n=this.length;do if(n--,n in this&&t(this[n],e))return n;while(n>0);return-1}),r("swap",function(e,t,n){var r=Array.prototype.slice.call(arguments,0,2);return n&&(Array.isArray(n)||(n=Array.prototype.slice.call(n)),r.push.apply(r,n)),this.splice.apply(this,r)}),r("one",function(){for(var e in this)if(Object.owns(this,e))return this[e]}),r("clear",function(){return this.length=0,this}),r("compare",function(e,t){t=t||Object.compare;var n,r,i,a,s;if(this===e)return 0;if(!e||!Array.isArray(e))return o.prototype.compare.call(this,e,t);for(r=Math.min(this.length,e.length),n=0;r>n;n++)if(n in this){if(!(n in e))return-1;if(i=this[n],a=e[n],s=t(i,a))return s}else if(n in e)return 1;return this.length-e.length}),r("equals",function(e,t){t=t||Object.equals;var n,r,i=0,a=this.length;if(this===e)return!0;if(!e||!Array.isArray(e))return o.prototype.equals.call(this,e);if(a!==e.length)return!1;for(;a>i;++i)if(i in this){if(!(i in e))return!1;if(n=this[i],r=e[i],!t(n,r))return!1}else if(i in e)return!1;return!0}),r("clone",function(e,t){if(void 0===e)e=1/0;else if(0===e)return this;t=t||new s;var n=[];for(var r in this)Object.owns(this,r)&&(n[r]=Object.clone(this[r],e-1,t));return n}),r("iterate",function(e,t){return new i(this,e,t)}),r("Iterator",i),i.prototype.next=function(){if(this.start===(null==this.end?this.array.length:this.end))throw StopIteration;return this.array[this.start++]}}}),montageDefine("fdadc45","shim-object",{dependencies:["weak-map"],factory:function(e,t,n){"use strict";var r=e("weak-map");n.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.isObject=function(e){return Object(e)===e},Object.getValueOf=function(e){return Object.can(e,"valueOf")&&(e=e.valueOf()),e};var i=new r;Object.hash=function(e){return Object.can(e,"hash")?""+e.hash():Object(e)===e?(i.has(e)||i.set(e,Math.random().toString(36).slice(2)),i.get(e)):""+e};var a=Object.prototype.hasOwnProperty;Object.owns=function(e,t){return a.call(e,t)},Object.can=function(e,t){return null!=e&&"function"==typeof e[t]&&!a.call(e,t)},Object.has=function(e,t){if("object"!=typeof e)throw Error("Object.has can't accept non-object: "+typeof e);if(Object.can(e,"has"))return e.has(t);if("string"==typeof t)return t in e&&e[t]!==Object.prototype[t];throw Error("Key must be a string for Object.has on plain objects")},Object.get=function(e,t,n){if("object"!=typeof e)throw Error("Object.get can't accept non-object: "+typeof e);return Object.can(e,"get")?e.get(t,n):Object.has(e,t)?e[t]:n},Object.set=function(e,t,n){Object.can(e,"set")?e.set(t,n):e[t]=n},Object.addEach=function(e,t){return t&&(Object.can(t,"forEach")?"function"==typeof t.keys?t.forEach(function(t,n){e[n]=t}):t.forEach(function(t){e[t[0]]=t[1]}):Object.keys(t).forEach(function(n){e[n]=t[n]})),e},Object.forEach=function(e,t,n){Object.keys(e).forEach(function(r){t.call(n,e[r],r,e)})},Object.map=function(e,t,n){return Object.keys(e).map(function(r){return t.call(n,e[r],r,e)})},Object.values=function(e){return Object.map(e,Function.identity)},Object.concat=function(){for(var e={},t=0;arguments.length>t;t++)Object.addEach(e,arguments[t]);return e},Object.from=Object.concat,Object.is=function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t},Object.equals=function(e,t,n){if(n=n||Object.equals,e=Object.getValueOf(e),t=Object.getValueOf(t),e===t)return 0!==e||1/e===1/t;if(null===e||null===t)return e===t;if(Object.can(e,"equals"))return e.equals(t,n);if(Object.can(t,"equals"))return t.equals(e,n);if("object"==typeof e&&"object"==typeof t){var r=Object.getPrototypeOf(e),i=Object.getPrototypeOf(t);if(r===i&&(r===Object.prototype||null===r)){for(var a in e)if(!n(e[a],t[a]))return!1;for(var a in t)if(!n(e[a],t[a]))return!1;return!0}}return e!==e&&t!==t},Object.compare=function(e,t){e=Object.getValueOf(e),t=Object.getValueOf(t);var n=typeof e,r=typeof t;return e===t?0:n!==r?0:"number"===n?e-t:"string"===n?t>e?-1:1:Object.can(e,"compare")?e.compare(t):Object.can(t,"compare")?-t.compare(e):0},Object.clone=function(e,t,n){if(e=Object.getValueOf(e),n=n||new r,void 0===t)t=1/0;else if(0===t)return e;if(Object.isObject(e)){if(!n.has(e))if(Object.can(e,"clone"))n.set(e,e.clone(t,n));else{var i=Object.getPrototypeOf(e);if(null!==i&&i!==Object.prototype)throw Error("Can't clone "+e);var a=Object.create(i);n.set(e,a);for(var o in e)a[o]=Object.clone(e[o],t-1,n)}return n.get(e)}return e},Object.clear=function(e){if(Object.can(e,"clear"))e.clear();else for(var t=Object.keys(e),n=t.length;n;)n--,delete e[t[n]];return e}}}),montageDefine("fdadc45","shim-function",{dependencies:[],factory:function(e,t,n){n.exports=Function,Function.noop=function(){},Function.identity=function(e){return e},Function.by=function(e,t){t=t||Object.compare,e=e||Function.identity;var n=function(n,r){return t(e(n),e(r))};return n.compare=t,n.by=e,n},Function.get=function(e){return function(t){return Object.get(t,e)}}}}),montageDefine("fdadc45","shim-regexp",{dependencies:[],factory:function(){if(!RegExp.escape){var e=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(t){return t.replace(e,"\\$&")}}}}),montageDefine("fdadc45","set",{dependencies:["./shim","./list","./fast-set","./generic-collection","./generic-set","./listen/property-changes","./listen/range-changes","set"],factory:function(e,t,n){"use strict";function r(e,t,n,i){return this instanceof r?(t=t||Object.equals,n=n||Object.hash,i=i||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=i,this.order=new this.Order(void 0,t),this.store=new this.Store(void 0,function(e,n){return t(e.value,n.value)},function(e){return n(e.value)}),this.length=0,this.addEach(e),void 0):new r(e,t,n,i)}e("./shim");var i=e("./list"),a=e("./fast-set"),o=e("./generic-collection"),s=e("./generic-set"),l=e("./listen/property-changes"),u=e("./listen/range-changes");n.exports=r,r.Set=r,Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,l.prototype),Object.addEach(r.prototype,u.prototype),r.prototype.Order=i,r.prototype.Store=a,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},r.prototype.has=function(e){var t=new this.order.Node(e);return this.store.has(t)},r.prototype.get=function(e){var t=new this.order.Node(e);return t=this.store.get(t),t?t.value:this.getDefault(e)},r.prototype.add=function(e){var t=new this.order.Node(e);if(!this.store.has(t)){var n=this.length;return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],n),this.order.add(e),t=this.order.head.prev,this.store.add(t),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],n),!0}return!1},r.prototype["delete"]=function(e){var t=new this.order.Node(e);if(this.store.has(t)){var t=this.store.get(t);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],t.index),this.store["delete"](t),this.order.splice(t,1),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],t.index),!0}return!1},r.prototype.pop=function(){if(this.length){var e=this.order.head.prev.value;return this["delete"](e),e}},r.prototype.shift=function(){if(this.length){var e=this.order.head.next.value;return this["delete"](e),e}},r.prototype.one=function(){return this.length>0?this.store.one().value:void 0},r.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange([],e,0)),this.store.clear(),this.order.clear(),this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},r.prototype.reduce=function(e,t){var n=arguments[2],r=this.order,i=0;return r.reduce(function(t,r){return e.call(n,t,r,i++,this)},t,this)},r.prototype.reduceRight=function(e,t){var n=arguments[2],r=this.order,i=this.length-1;return r.reduceRight(function(t,r){return e.call(n,t,r,i--,this)},t,this)},r.prototype.iterate=function(){return this.order.iterate()},r.prototype.log=function(){var e=this.store;return e.log.apply(e,arguments)},r.prototype.makeObservable=function(){this.order.makeObservable()}}}),montageDefine("fdadc45","generic-collection",{dependencies:["./shim-array"],factory:function(e,t,n){"use strict";function r(){throw Error("Can't construct. GenericCollection is a mixin.")}n.exports=r,r.prototype.addEach=function(e){if(e&&Object(e)===e)if("function"==typeof e.forEach)e.forEach(this.add,this);else if("number"==typeof e.length)for(var t=0;e.length>t;t++)this.add(e[t],t);else Object.keys(e).forEach(function(t){this.add(e[t],t)},this);return this},r.prototype.deleteEach=function(e,t){return e.forEach(function(e){this["delete"](e,t)},this),this},r.prototype.forEach=function(e){var t=arguments[1];return this.reduce(function(n,r,i,a,o){e.call(t,r,i,a,o)},void 0)},r.prototype.map=function(e){var t=arguments[1],n=[];return this.reduce(function(r,i,a,o,s){n.push(e.call(t,i,a,o,s))},void 0),n},r.prototype.enumerate=function(e){null==e&&(e=0);var t=[];return this.reduce(function(n,r){t.push([e++,r])},void 0),t},r.prototype.group=function(e,t,n){n=n||Object.equals;var r=[],i=[];return this.forEach(function(a,o,s){var l,o=e.call(t,a,o,s),u=i.indexOf(o,n);-1===u?(l=[],r.push([o,l]),i.push(o)):l=r[u][1],l.push(a)}),r},r.prototype.toArray=function(){return this.map(Function.identity)},r.prototype.toObject=function(){var e={};return this.reduce(function(t,n,r){e[r]=n},void 0),e},r.prototype.filter=function(e){var t=arguments[1],n=this.constructClone();return this.reduce(function(r,i,a,o,s){e.call(t,i,a,o,s)&&n.add(i)},void 0),n},r.prototype.every=function(e){var t=arguments[1];return this.reduce(function(n,r,i,a,o){return n&&e.call(t,r,i,a,o)},!0)},r.prototype.some=function(e){var t=arguments[1];return this.reduce(function(n,r,i,a,o){return n||e.call(t,r,i,a,o)},!1)},r.prototype.all=function(){return this.every(Boolean)},r.prototype.any=function(){return this.some(Boolean)},r.prototype.min=function(e){e=e||this.contentCompare||Object.compare;var t=!0;return this.reduce(function(n,r){return t?(t=!1,r):0>e(r,n)?r:n},void 0)},r.prototype.max=function(e){e=e||this.contentCompare||Object.compare;var t=!0;return this.reduce(function(n,r){return t?(t=!1,r):e(r,n)>0?r:n},void 0)},r.prototype.sum=function(e){return e=void 0===e?0:e,this.reduce(function(e,t){return e+t},e)},r.prototype.average=function(e){var t=void 0===e?0:e,n=void 0===e?0:e;return this.reduce(function(e,r){t+=r,n+=1},void 0),t/n},r.prototype.concat=function(){for(var e=this.constructClone(this),t=0;arguments.length>t;t++)e.addEach(arguments[t]);return e},r.prototype.flatten=function(){var e=this;return this.reduce(function(t,n){return n.forEach(function(e){this.push(e)},t,e),t},[])},r.prototype.zip=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(this),Array.unzip(e)},r.prototype.join=function(e){return this.reduce(function(t,n){return t+e+n})},r.prototype.sorted=function(e,t,n){return e=e||this.contentCompare||Object.compare,e.by?(t=e.by,e=e.compare||this.contentCompare||Object.compare):t=t||Function.identity,void 0===n&&(n=1),this.map(function(e){return{by:t(e),value:e}}).sort(function(t,r){return e(t.by,r.by)*n}).map(function(e){return e.value})},r.prototype.reversed=function(){return this.constructClone(this).reverse()},r.prototype.clone=function(e,t){if(void 0===e)e=1/0;else if(0===e)return this;var n=this.constructClone();return this.forEach(function(r,i){n.add(Object.clone(r,e-1,t),i)},this),n},r.prototype.only=function(){return 1===this.length?this.one():void 0},r.prototype.iterator=function(){return this.iterate.apply(this,arguments)},e("./shim-array")}}),montageDefine("fdadc45","generic-map",{dependencies:["./shim-object","./listen/map-changes","./listen/property-changes"],factory:function(e,t,n){"use strict";function r(){throw Error("Can't construct. GenericMap is a mixin.")}function i(e,t){this.key=e,this.value=t}var a=e("./shim-object"),o=e("./listen/map-changes"),s=e("./listen/property-changes");n.exports=r,a.addEach(r.prototype,o.prototype),a.addEach(r.prototype,s.prototype),r.prototype.isMap=!0,r.prototype.addEach=function(e){return e&&a(e)===e&&("function"==typeof e.forEach?e.isMap===!0?e.forEach(function(e,t){this.set(t,e)},this):e.forEach(function(e){this.set(e[0],e[1])},this):a.keys(e).forEach(function(t){this.set(t,e[t])},this)),this},r.prototype.get=function(e,t){var n=this.store.get(new this.Item(e));return n?n.value:arguments.length>1?t:this.getDefault(e)},r.prototype.set=function(e,t){var n=new this.Item(e,t),r=this.store.get(n),i=!1;return r?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,r.value),r.value=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t)):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),this.store.add(n)&&(this.length++,i=!0),this.dispatchesMapChanges&&this.dispatchMapChange(e,t)),i},r.prototype.add=function(e,t){return this.set(t,e)},r.prototype.has=function(e){return this.store.has(new this.Item(e))},r.prototype["delete"]=function(e){var t=new this.Item(e);if(this.store.has(t)){var n=this.store.get(t).value;return this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,n),this.store["delete"](t),this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0}return!1},r.prototype.clear=function(){var e;this.dispatchesMapChanges&&(this.forEach(function(e,t){this.dispatchBeforeMapChange(t,e)},this),e=this.keys()),this.store.clear(),this.length=0,this.dispatchesMapChanges&&e.forEach(function(e){this.dispatchMapChange(e)},this)},r.prototype.reduce=function(e,t,n){return this.store.reduce(function(t,r){return e.call(n,t,r.value,r.key,this)},t,this)},r.prototype.reduceRight=function(e,t,n){return this.store.reduceRight(function(t,r){return e.call(n,t,r.value,r.key,this)},t,this)},r.prototype.keys=function(){return this.map(function(e,t){return t})},r.prototype.values=function(){return this.map(Function.identity)},r.prototype.entries=function(){return this.map(function(e,t){return[t,e]})},r.prototype.items=function(){return this.entries()},r.prototype.equals=function(e,t){if(t=t||a.equals,this===e)return!0;if(a.can(e,"every"))return e.length===this.length&&e.every(function(e,n){return t(this.get(n),e)},this);var n=a.keys(e);return n.length===this.length&&a.keys(e).every(function(n){return t(this.get(n),e[n])},this)},r.prototype.Item=i,i.prototype.equals=function(e){return a.equals(this.key,e.key)&&a.equals(this.value,e.value)},i.prototype.compare=function(e){return a.compare(this.key,e.key)}}}),montageDefine("fdadc45","generic-order",{dependencies:["./shim-object"],factory:function(e,t,n){function r(){throw Error("Can't construct. GenericOrder is a mixin.")}var i=e("./shim-object");n.exports=r,r.prototype.equals=function(e,t){return t=t||this.contentEquals||i.equals,this===e?!0:e?this.length===e.length&&this.zip(e).every(function(e){return t(e[0],e[1])}):!1},r.prototype.compare=function(e,t){if(t=t||this.contentCompare||i.compare,this===e)return 0;if(!e)return 1;var n=Math.min(this.length,e.length),r=this.zip(e).reduce(function(e,r,i){return 0===e?i>=n?e:t(r[0],r[1]):e},0);return 0===r?this.length-e.length:r}}}),montageDefine("fdadc45","list",{dependencies:["./shim","./generic-collection","./generic-order","./listen/property-changes","./listen/range-changes","list"],factory:function(e,t,n){"use strict";function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);var i=this.head=new this.Node;i.next=i,i.prev=i,this.contentEquals=t||Object.equals,this.getDefault=n||Function.noop,this.length=0,this.addEach(e)}function i(e){this.head=e,this.at=e.next}function a(e){this.value=e,this.prev=null,this.next=null}n.exports=r,e("./shim");var o=e("./generic-collection"),s=e("./generic-order"),l=e("./listen/property-changes"),u=e("./listen/range-changes");r.List=r,Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,l.prototype),Object.addEach(r.prototype,u.prototype),r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.getDefault)},r.prototype.find=function(e,t){t=t||this.contentEquals;for(var n=this.head,r=n.next;r!==n;){if(t(r.value,e))return r;r=r.next}},r.prototype.findLast=function(e,t){t=t||this.contentEquals;for(var n=this.head,r=n.prev;r!==n;){if(t(r.value,e))return r;r=r.prev}},r.prototype.has=function(e,t){return!!this.find(e,t)},r.prototype.get=function(e,t){var n=this.find(e,t);return n?n.value:this.getDefault(e)},r.prototype["delete"]=function(e,t){var n=this.findLast(e,t);if(n){if(this.dispatchesRangeChanges){var r=[],i=[e];this.dispatchBeforeRangeChange(r,i,n.index)}return n["delete"](),this.length--,this.dispatchesRangeChanges&&(this.updateIndexes(n.next,n.index),this.dispatchRangeChange(r,i,n.index)),!0}return!1},r.prototype.clear=function(){var e,t;this.dispatchesRangeChanges&&(t=this.toArray(),e=[],this.dispatchBeforeRangeChange(e,t,0)),this.head.next=this.head.prev=this.head,this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange(e,t,0)},r.prototype.add=function(e){var t=new this.Node(e);return this.dispatchesRangeChanges&&(t.index=this.length,this.dispatchBeforeRangeChange([e],[],t.index)),this.head.addBefore(t),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],t.index),!0},r.prototype.push=function(){var e=this.head;if(this.dispatchesRangeChanges){var t=Array.prototype.slice.call(arguments),n=[],r=this.length;this.dispatchBeforeRangeChange(t,n,r);var i=this.head.prev}for(var a=0;arguments.length>a;a++){var o=arguments[a],s=new this.Node(o);e.addBefore(s)}this.length+=arguments.length,this.dispatchesRangeChanges&&(this.updateIndexes(i.next,void 0===i.index?0:i.index+1),this.dispatchRangeChange(t,n,r))},r.prototype.unshift=function(){if(this.dispatchesRangeChanges){var e=Array.prototype.slice.call(arguments),t=[];this.dispatchBeforeRangeChange(e,t,0)}for(var n=this.head,r=0;arguments.length>r;r++){var i=arguments[r],a=new this.Node(i);n.addAfter(a),n=a}this.length+=arguments.length,this.dispatchesRangeChanges&&(this.updateIndexes(this.head.next,0),this.dispatchRangeChange(e,t,0))},r.prototype.pop=function(){var e,t=this.head;if(t.prev!==t){if(e=t.prev.value,this.dispatchesRangeChanges){var n=[],r=[e],i=this.length-1;this.dispatchBeforeRangeChange(n,r,i)}t.prev["delete"](),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange(n,r,i)}return e},r.prototype.shift=function(){var e,t=this.head;if(t.prev!==t){if(e=t.next.value,this.dispatchesRangeChanges){var n=[],r=[e];this.dispatchBeforeRangeChange(n,r,0)}t.next["delete"](),this.length--,this.dispatchesRangeChanges&&(this.updateIndexes(this.head.next,0),this.dispatchRangeChange(n,r,0))}return e},r.prototype.peek=function(){return this.head!==this.head.next?this.head.next.value:void 0},r.prototype.poke=function(e){this.head!==this.head.next?this.head.next.value=e:this.push(e)},r.prototype.one=function(){return this.peek()},r.prototype.scan=function(e,t){var n=this.head;if("number"==typeof e){var r=e;if(r>=0)for(e=n.next;r&&(r--,e=e.next,e!=n););else for(e=n;0>r&&(r++,e=e.prev,e!=n););return e}return e||t},r.prototype.slice=function(e,t){var n=[],r=this.head;for(e=this.scan(e,r.next),t=this.scan(t,r);e!==t&&e!==r;)n.push(e.value),e=e.next;return n},r.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},r.prototype.swap=function(e,t,n){var r=e;e=this.scan(e,this.head),null==t&&(t=1/0),n=Array.from(n);for(var i=[],a=e;t--&&t>=0&&a!==this.head;)i.push(a.value),a=a.next;var o,s;this.dispatchesRangeChanges&&(o=e===this.head?this.length:e.prev===this.head?0:e.index,s=e.prev,this.dispatchBeforeRangeChange(n,i,o));for(var a=e,l=0,a=e;i.length>l;l++,a=a.next)a["delete"]();null==r&&a===this.head&&(a=this.head.next);for(var l=0;n.length>l;l++){var u=new this.Node(n[l]);a.addBefore(u)}return this.length+=n.length-i.length,this.dispatchesRangeChanges&&(e===this.head?this.updateIndexes(this.head.next,0):this.updateIndexes(s.next,s.index+1),this.dispatchRangeChange(n,i,o)),i},r.prototype.reverse=function(){if(this.dispatchesRangeChanges){var e=this.toArray(),t=e.reversed();this.dispatchBeforeRangeChange(t,e,0)}var n=this.head;do{var r=n.next;n.next=n.prev,n.prev=r,n=n.next}while(n!==this.head);return this.dispatchesRangeChanges&&this.dispatchRangeChange(t,e,0),this},r.prototype.sort=function(){this.swap(0,this.length,this.sorted())},r.prototype.reduce=function(e,t){for(var n=arguments[2],r=this.head,i=r.next;i!==r;)t=e.call(n,t,i.value,i,this),i=i.next;return t},r.prototype.reduceRight=function(e,t){for(var n=arguments[2],r=this.head,i=r.prev;i!==r;)t=e.call(n,t,i.value,i,this),i=i.prev;return t},r.prototype.updateIndexes=function(e,t){for(;e!==this.head;)e.index=t++,e=e.next},r.prototype.makeObservable=function(){this.head.index=-1,this.updateIndexes(this.head.next,0),this.dispatchesRangeChanges=!0},r.prototype.iterate=function(){return new i(this.head)},i.prototype.next=function(){if(this.at===this.head)throw StopIteration;var e=this.at.value;return this.at=this.at.next,e},r.prototype.Node=a,a.prototype["delete"]=function(){this.prev.next=this.next,this.next.prev=this.prev},a.prototype.addBefore=function(e){var t=this.prev;this.prev=e,e.prev=t,t.next=e,e.next=this},a.prototype.addAfter=function(e){var t=this.next;this.next=e,e.next=t,t.prev=e,e.prev=this}}}),montageDefine("fdadc45","fast-set",{dependencies:["./shim","./dict","./list","./generic-collection","./generic-set","./tree-log","./listen/property-changes","fast-set"],factory:function(e,t,n){"use strict";function r(e,t,n,i){return this instanceof r?(t=t||Object.equals,n=n||Object.hash,i=i||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=i,this.buckets=new this.Buckets(null,this.Bucket),this.length=0,this.addEach(e),void 0):new r(e,t,n,i)}e("./shim");var i=e("./dict"),a=e("./list"),o=e("./generic-collection"),s=e("./generic-set"),l=e("./tree-log"),u=e("./listen/property-changes");Object.prototype.hasOwnProperty,n.exports=r,r.FastSet=r,Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,u.prototype),r.prototype.Buckets=i,r.prototype.Bucket=a,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},r.prototype.has=function(e){var t=this.contentHash(e);return this.buckets.get(t).has(e)},r.prototype.get=function(e){var t=this.contentHash(e),n=this.buckets;return n.has(t)?n.get(t).get(e):this.getDefault(e)},r.prototype["delete"]=function(e){var t=this.contentHash(e),n=this.buckets;
if(n.has(t)){var r=n.get(t);if(r["delete"](e))return this.length--,0===r.length&&n["delete"](t),!0}return!1},r.prototype.clear=function(){this.buckets.clear(),this.length=0},r.prototype.add=function(e){var t=this.contentHash(e),n=this.buckets;return n.has(t)||n.set(t,new this.Bucket(null,this.contentEquals)),n.get(t).has(e)?!1:(n.get(t).add(e),this.length++,!0)},r.prototype.reduce=function(e,t){var n=arguments[2],r=this.buckets,i=0;return r.reduce(function(t,r){return r.reduce(function(t,r){return e.call(n,t,r,i++,this)},t,this)},t,this)},r.prototype.one=function(){return this.length>0?this.buckets.one().one():void 0},r.prototype.iterate=function(){return this.buckets.values().flatten().iterate()},r.prototype.log=function(e,t,n,r){e=e||l.unicodeSharp,t=t||this.logNode,n||(n=console.log,r=console),n=n.bind(r);var i=this.buckets,a=i.keys();a.forEach(function(o,s){var l,u;s===a.length-1?(l=e.fromAbove,u=" "):0===s?(l=e.branchDown,u=e.strafe):(l=e.fromBoth,u=e.strafe);var c=i.get(o);n.call(r,l+e.through+e.branchDown+" "+o),c.forEach(function(i,a){var o,s;a===c.head.prev?(o=e.fromAbove,s=" "):(o=e.fromBoth,s=e.strafe);var l;t(a,function(t){l?n.call(r,u+" "+s+"  "+t):(n.call(r,u+" "+o+e.through+e.through+t),l=!0)},function(t){n.call(r,u+" "+e.strafe+"  "+t)})})})},r.prototype.logNode=function(e,t){var n=e.value;Object(n)===n?JSON.stringify(n,null,4).split("\n").forEach(function(e){t(" "+e)}):t(" "+n)}}}),montageDefine("fdadc45","generic-set",{dependencies:[],factory:function(e,t,n){function r(){throw Error("Can't construct. GenericSet is a mixin.")}n.exports=r,r.prototype.union=function(e){var t=this.constructClone(this);return t.addEach(e),t},r.prototype.intersection=function(e){return this.constructClone(this.filter(function(t){return e.has(t)}))},r.prototype.difference=function(e){var t=this.constructClone(this);return t.deleteEach(e),t},r.prototype.symmetricDifference=function(e){var t=this.union(e),n=this.intersection(e);return t.difference(n)},r.prototype.equals=function(e,t){var n=this;return Object.can(e,"reduce")&&this.length===e.length&&e.reduce(function(e,r){return e&&n.has(r,t)},!0)},r.prototype.contains=function(e){return this.has(e)},r.prototype.remove=function(e){return this["delete"](e)},r.prototype.toggle=function(e){this.has(e)?this["delete"](e):this.add(e)}}}),montageDefine("fdadc45","listen/range-changes",{dependencies:["weak-map","../dict"],factory:function(e,t,n){"use strict";function r(){throw Error("Can't construct. RangeChanges is a mixin.")}var i=e("weak-map"),a=e("../dict"),o=new i;n.exports=r,r.prototype.getAllRangeChangeDescriptors=function(){return o.has(this)||o.set(this,a()),o.get(this)},r.prototype.getRangeChangeDescriptor=function(e){var t=this.getAllRangeChangeDescriptors();return e=e||"",t.has(e)||t.set(e,{isActive:!1,changeListeners:[],willChangeListeners:[]}),t.get(e)},r.prototype.addRangeChangeListener=function(e,t,n){!this.isObservable&&this.makeObservable&&this.makeObservable();var r,i=this.getRangeChangeDescriptor(t);r=n?i.willChangeListeners:i.changeListeners,r.push(e),Object.defineProperty(this,"dispatchesRangeChanges",{value:!0,writable:!0,configurable:!0,enumerable:!1});var a=this;return function(){a&&(a.removeRangeChangeListener(e,t,n),a=null)}},r.prototype.removeRangeChangeListener=function(e,t,n){var r,i=this.getRangeChangeDescriptor(t);r=n?i.willChangeListeners:i.changeListeners;var a=r.lastIndexOf(e);if(-1===a)throw Error("Can't remove listener: does not exist.");r.splice(a,1)},r.prototype.dispatchRangeChange=function(e,t,n,r){var i=this.getAllRangeChangeDescriptors(),a="Range"+(r?"WillChange":"Change");i.forEach(function(i,o){if(!i.isActive){i.isActive=!0;var s;s=r?i.willChangeListeners:i.changeListeners;var l="handle"+(o.slice(0,1).toUpperCase()+o.slice(1))+a;try{s.forEach(function(i){if(i[l])i[l](e,t,n,this,r);else{if(!i.call)throw Error("Handler "+i+" has no method "+l+" and is not callable");i.call(this,e,t,n,this,r)}},this)}finally{i.isActive=!1}}},this)},r.prototype.addBeforeRangeChangeListener=function(e,t){return this.addRangeChangeListener(e,t,!0)},r.prototype.removeBeforeRangeChangeListener=function(e,t){return this.removeRangeChangeListener(e,t,!0)},r.prototype.dispatchBeforeRangeChange=function(e,t,n){return this.dispatchRangeChange(e,t,n,!0)}}}),montageDefine("fdadc45","listen/map-changes",{dependencies:["weak-map","../list","../dict"],factory:function(e,t,n){"use strict";function r(){throw Error("Can't construct. MapChanges is a mixin.")}var i=e("weak-map"),a=e("../list");n.exports=r,Object.prototype.hasOwnProperty;var o=new i;r.prototype.getAllMapChangeDescriptors=function(){var t=e("../dict");return o.has(this)||o.set(this,t()),o.get(this)},r.prototype.getMapChangeDescriptor=function(e){var t=this.getAllMapChangeDescriptors();return e=e||"",t.has(e)||t.set(e,{willChangeListeners:new a,changeListeners:new a}),t.get(e)},r.prototype.addMapChangeListener=function(e,t,n){!this.isObservable&&this.makeObservable&&this.makeObservable();var r,i=this.getMapChangeDescriptor(t);r=n?i.willChangeListeners:i.changeListeners,r.push(e),Object.defineProperty(this,"dispatchesMapChanges",{value:!0,writable:!0,configurable:!0,enumerable:!1});var a=this;return function(){a&&(a.removeMapChangeListener(e,t,n),a=null)}},r.prototype.removeMapChangeListener=function(e,t,n){var r,i=this.getMapChangeDescriptor(t);r=n?i.willChangeListeners:i.changeListeners;var a=r.findLast(e);if(!a)throw Error("Can't remove listener: does not exist.");a["delete"]()},r.prototype.dispatchMapChange=function(e,t,n){var r=this.getAllMapChangeDescriptors(),i="Map"+(n?"WillChange":"Change");r.forEach(function(r,a){if(!r.isActive){r.isActive=!0;var o;o=n?r.willChangeListeners:r.changeListeners;var s="handle"+(a.slice(0,1).toUpperCase()+a.slice(1))+i;try{o.forEach(function(n){if(n[s])n[s](t,e,this);else{if(!n.call)throw Error("Handler "+n+" has no method "+s+" and is not callable");n.call(n,t,e,this)}},this)}finally{r.isActive=!1}}},this)},r.prototype.addBeforeMapChangeListener=function(e,t){return this.addMapChangeListener(e,t,!0)},r.prototype.removeBeforeMapChangeListener=function(e,t){return this.removeMapChangeListener(e,t,!0)},r.prototype.dispatchBeforeMapChange=function(e,t){return this.dispatchMapChange(e,t,!0)}}}),montageDefine("fdadc45","listen/array-changes",{dependencies:["../shim","../list","weak-map","./property-changes","./range-changes","./map-changes"],factory:function(e){function t(e){for(var t in e)Object.defineProperty(Array.prototype,t,{value:e[t],writable:!0,configurable:!0,enumerable:!1})}e("../shim"),e("../list"),e("weak-map");var n=e("./property-changes"),r=e("./range-changes"),i=e("./map-changes"),a=Array.prototype.splice,o=Array.prototype.slice;Array.prototype.reverse;var s,l=Array.prototype.sort,u={}.__proto__===Object.prototype;s=u?function(){this.__proto__=h}:function(){Object.defineProperties(this,c)},Object.defineProperty(Array.prototype,"makeObservable",{value:s,writable:!0,configurable:!0,enumerable:!1}),t(n.prototype),t(r.prototype),t(i.prototype);var c={isObservable:{value:!0,writable:!0,configurable:!0},makeObservable:{value:Function.noop,writable:!0,configurable:!0},reverse:{value:function(){var e=this.constructClone(this);return e.reverse(),this.swap(0,this.length,e),this},writable:!0,configurable:!0},sort:{value:function(){this.dispatchBeforeRangeChange(this,this,0);for(var e=0;this.length>e;e++)n.dispatchBeforeOwnPropertyChange(this,e,this[e]),this.dispatchBeforeMapChange(e,this[e]);l.apply(this,arguments);for(var e=0;this.length>e;e++)n.dispatchOwnPropertyChange(this,e,this[e]),this.dispatchMapChange(e,this[e]);return this.dispatchRangeChange(this,this,0),this},writable:!0,configurable:!0},splice:{value:function(e,t){var r=o.call(this,e,e+t),i=o.call(arguments,2);if(!r.length&&!i.length)return i;var s=i.length-r.length,l=this.length,u=Math.max(this.length+s,e+i.length),c=Math.max(l,u);if(s&&n.dispatchBeforeOwnPropertyChange(this,"length",this.length),this.dispatchBeforeRangeChange(i,r,e),0===s)for(var h=e;e+i.length>h;h++)n.dispatchBeforeOwnPropertyChange(this,h,this[h]),this.dispatchBeforeMapChange(h,this[h]);else if(n.hasOwnPropertyChangeDescriptor(this))for(var h=e;c>h;h++)n.dispatchBeforeOwnPropertyChange(this,h,this[h]),this.dispatchBeforeMapChange(h,this[h]);e>l&&(this.length=e);var d=a.apply(this,arguments);if(0===s)for(var h=e;e+i.length>h;h++)n.dispatchOwnPropertyChange(this,h,this[h]),this.dispatchMapChange(h,this[h]);else if(n.hasOwnPropertyChangeDescriptor(this))for(var h=e;c>h;h++)n.dispatchOwnPropertyChange(this,h,this[h]),this.dispatchMapChange(h,this[h]);return this.dispatchRangeChange(i,r,e),s&&n.dispatchOwnPropertyChange(this,"length",this.length),d},writable:!0,configurable:!0},set:{value:function(e,t){return this.splice(e,1,t),this},writable:!0,configurable:!0},shift:{value:function(){return this.splice(0,1)[0]},writable:!0,configurable:!0},pop:{value:function(){return this.length?this.splice(this.length-1,1)[0]:void 0},writable:!0,configurable:!0},push:{value:function(e){if(1===arguments.length)return this.splice(this.length,0,e);var t=o.call(arguments);return this.swap(this.length,0,t)},writable:!0,configurable:!0},unshift:{value:function(e){if(1===arguments.length)return this.splice(0,0,e);var t=o.call(arguments);return this.swap(0,0,t)},writable:!0,configurable:!0},clear:{value:function(){return this.splice(0,this.length)},writable:!0,configurable:!0}},h=Object.create(Array.prototype,c)}}),montageDefine("fdadc45","sorted-array",{dependencies:["./shim","./generic-collection","./listen/property-changes","./listen/range-changes","sorted-array"],factory:function(e,t,n){"use strict";function r(e,t,n,i){return this instanceof r?(Array.isArray(e)?(this.array=e,e=e.splice(0,e.length)):this.array=[],this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.getDefault=i||Function.noop,this.length=0,this.addEach(e),void 0):new r(e,t,n,i)}function i(e,t,n){for(var r=0,i=e.length-1;i>=r;){var a=r+i>>1,o=n(t,e[a]);if(o>0)r=a+1;else{if(!(0>o))return a;i=a-1}}return-(r+1)}function a(e,t,n,r){var a=i(e,t,n);if(0>a)return-1;for(;a>0&&r(t,e[a-1]);)a--;return r(t,e[a])?a:-1}function o(e,t,n,r){var a=i(e,t,n);if(0>a)return-1;for(;e.length-1>a&&r(t,e[a+1]);)a++;return r(t,e[a])?a:-1}function s(e,t,n){var r=i(e,t,n);if(0>r)return-r-1;for(var a=e.length-1;a>r&&0===n(t,e[r+1]);)r++;return r}n.exports=r,e("./shim");var l=e("./generic-collection"),u=e("./listen/property-changes"),c=e("./listen/range-changes");r.SortedArray=r,Object.addEach(r.prototype,l.prototype),Object.addEach(r.prototype,u.prototype),Object.addEach(r.prototype,c.prototype),r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare,this.getDefault)},r.prototype.has=function(e){var t=i(this.array,e,this.contentCompare);return t>=0&&this.contentEquals(this.array[t],e)},r.prototype.get=function(e){var t=a(this.array,e,this.contentCompare,this.contentEquals);return-1!==t?this.array[t]:this.getDefault(e)},r.prototype.add=function(e){var t=s(this.array,e,this.contentCompare);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],t),this.array.splice(t,0,e),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],t),!0},r.prototype["delete"]=function(e){var t=a(this.array,e,this.contentCompare,this.contentEquals);return-1!==t?(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],t),this.array.splice(t,1),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],t),!0):!1},r.prototype.indexOf=function(e){return a(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.lastIndexOf=function(e){return o(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.find=function(e){return a(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.findLast=function(e){return o(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.push=function(){this.addEach(arguments)},r.prototype.unshift=function(){this.addEach(arguments)},r.prototype.pop=function(){return this.array.pop()},r.prototype.shift=function(){return this.array.shift()},r.prototype.slice=function(){return this.array.slice.apply(this.array,arguments)},r.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},r.prototype.swap=function(e,t,n){if(void 0===e&&void 0===t)return[];e=e||0,0>e&&(e+=this.length),void 0===t&&(t=1/0);var r=this.slice(e,e+t);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(n,r,e),this.array.splice(e,t),this.addEach(n),this.dispatchesRangeChanges&&this.dispatchRangeChange(n,r,e),r},r.prototype.reduce=function(e,t){var n=arguments[2];return this.array.reduce(function(t,r,i){return e.call(n,t,r,i,this)},t,this)},r.prototype.reduceRight=function(){var e=arguments[2];return this.array.reduceRight(function(t,n,r){return callback.call(e,t,n,r,this)},basis,this)},r.prototype.min=function(){return this.length?this.array[0]:void 0},r.prototype.max=function(){return this.length?this.array[this.length-1]:void 0},r.prototype.one=function(){return this.array.one()},r.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.array.slice(),this.dispatchBeforeRangeChange([],e,0)),this.length=0,this.array.clear(),this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},r.prototype.equals=function(e,t){return this.array.equals(e,t)},r.prototype.compare=function(e,t){return this.array.compare(e,t)},r.prototype.iterate=function(e,t){return new this.Iterator(this.array,e,t)},r.prototype.Iterator=Array.prototype.Iterator}}),montageDefine("fdadc45","sorted-set",{dependencies:["./shim","./generic-collection","./generic-set","./listen/property-changes","./listen/range-changes","./tree-log","sorted-set"],factory:function(e,t,n){"use strict";function r(e,t,n,i){return this instanceof r?(this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.getDefault=i||Function.noop,this.root=null,this.length=0,this.addEach(e),void 0):new r(e,t,n,i)}function i(e){this.value=e,this.left=null,this.right=null,this.length=1}function a(e,t,n){if(this.set=e,this.prev=null,this.end=n,t){var r=this.set.findLeastGreaterThanOrEqual(t);r&&(this.set.splay(r.value),this.prev=r.getPrevious())}}n.exports=r,e("./shim");var o=e("./generic-collection"),s=e("./generic-set"),l=e("./listen/property-changes"),u=e("./listen/range-changes"),c=e("./tree-log");r.SortedSet=r,Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,l.prototype),Object.addEach(r.prototype,u.prototype),r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare,this.getDefault)},r.prototype.has=function(e){return this.root?(this.splay(e),this.contentEquals(e,this.root.value)):!1},r.prototype.get=function(e){return this.root&&(this.splay(e),this.contentEquals(e,this.root.value))?this.root.value:this.getDefault(e)},r.prototype.add=function(e){var t=new this.Node(e);if(!this.root)return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],0),this.root=t,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],0),!0;if(this.splay(e),!this.contentEquals(e,this.root.value)){var n=this.contentCompare(e,this.root.value);if(0===n)throw Error("SortedSet cannot contain incomparable but inequal values: "+e+" and "+this.root.value);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],this.root.index),0>n?(t.right=this.root,t.left=this.root.left,this.root.left=null,this.root.touch()):(t.left=this.root,t.right=this.root.right,this.root.right=null,this.root.touch()),t.touch(),this.root=t,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],this.root.index),!0}return!1},r.prototype["delete"]=function(e){if(this.root&&(this.splay(e),this.contentEquals(e,this.root.value))){var t=this.root.index;if(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],t),this.root.left){var n=this.root.right;this.root=this.root.left,this.splay(e),this.root.right=n}else this.root=this.root.right;return this.length--,this.root&&this.root.touch(),this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],t),!0}return!1},r.prototype.indexOf=function(e){return this.root&&(this.splay(e),this.contentEquals(e,this.root.value))?this.root.index:-1},r.prototype.find=function(e){return this.root&&(this.splay(e),this.contentEquals(e,this.root.value))?this.root:void 0},r.prototype.findGreatest=function(e){if(this.root){for(e=e||this.root;e.right;)e=e.right;return e}},r.prototype.findLeast=function(e){if(this.root){for(e=e||this.root;e.left;)e=e.left;return e}},r.prototype.findGreatestLessThanOrEqual=function(e){return this.root?(this.splay(e),this.root):void 0},r.prototype.findGreatestLessThan=function(e){return this.root?(this.splay(e),this.root.getPrevious()):void 0},r.prototype.findLeastGreaterThanOrEqual=function(e){if(this.root){this.splay(e);var t=this.contentCompare(e,this.root.value);return 0===t?this.root:this.root.getNext()}},r.prototype.findLeastGreaterThan=function(e){return this.root?(this.splay(e),this.contentCompare(e,this.root.value),this.root.getNext()):void 0},r.prototype.pop=function(){if(this.root){var e=this.findGreatest();return this["delete"](e.value),e.value}},r.prototype.shift=function(){if(this.root){var e=this.findLeast();return this["delete"](e.value),e.value}},r.prototype.push=function(){this.addEach(arguments)},r.prototype.unshift=function(){this.addEach(arguments)},r.prototype.slice=function(e,t){e=e||0,t=t||this.length,0>e&&(e+=this.length),0>t&&(t+=this.length);var n=[];if(this.root)for(this.splayIndex(e);t>this.root.index&&(n.push(this.root.value),this.root.right);)this.splay(this.root.getNext().value);return n},r.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},r.prototype.swap=function(e,t,n){if(void 0===e&&void 0===t)return[];e=e||0,0>e&&(e+=this.length),void 0===t&&(t=1/0);var r=[];if(this.root){this.splayIndex(e);for(var i=0;t>i;i++){r.push(this.root.value);var a=this.root.getNext();if(this["delete"](this.root.value),!a)break;this.splay(a.value)}}return this.addEach(n),r},r.prototype.splay=function(e){var t,n,r,a,o,s;if(this.root){for(t=n=r=new this.Node,s=new this.Node,o=this.root;;){var l=this.contentCompare(e,o.value);if(0>l){if(!o.left)break;if(0>this.contentCompare(e,o.left.value)&&(a=o.left,o.left=a.right,o.touch(),a.right=o,a.touch(),o=a,!o.left))break;a=new i,a.right=o,a.left=s.left,s.left=a,r.left=o,r.touch(),r=o,o=o.left}else{if(!(l>0))break;if(!o.right)break;if(this.contentCompare(e,o.right.value)>0&&(a=o.right,o.right=a.left,o.touch(),a.left=o,a.touch(),o=a,!o.right))break;a=new i,a.left=o,a.right=s.right,s.right=a,n.right=o,n.touch(),n=o,o=o.right}}for(n.right=o.left,n.touch(),r.left=o.right,r.touch(),o.left=t.right,o.right=t.left;s.left;)s.left.right.touch(),s.left=s.left.left;for(;s.right;)s.right.left.touch(),s.right=s.right.right;o.touch(),this.root=o}},r.prototype.splayIndex=function(e){if(this.root){for(var t=this.root,n=this.root.index;n!==e;)if(n>e&&t.left)t=t.left,n-=1+(t.right?t.right.length:0);else{if(!(e>n&&t.right))break;t=t.right,n+=1+(t.left?t.left.length:0)}return this.splay(t.value),this.root.index===e}return!1},r.prototype.reduce=function(e,t,n){return this.root&&(t=this.root.reduce(e,t,0,n,this)),t},r.prototype.reduceRight=function(e,t,n){return this.root&&(t=this.root.reduceRight(e,t,this.length-1,n,this)),t},r.prototype.min=function(e){var t=this.findLeast(e);return t?t.value:void 0},r.prototype.max=function(e){var t=this.findGreatest(e);return t?t.value:void 0},r.prototype.one=function(){return this.min()},r.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange([],e,0)),this.root=null,this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},r.prototype.iterate=function(e,t){return new this.Iterator(this,e,t)},r.prototype.Iterator=a,r.prototype.summary=function(){return this.root?this.root.summary():"()"},r.prototype.log=function(e,t,n,r){e=e||c.unicodeRound,t=t||this.logNode,n||(n=console.log,r=console),n=n.bind(r),this.root&&this.root.log(e,t,n,n)},r.prototype.logNode=function(e,t){t(" "+e.value)},r.logCharsets=c,r.prototype.Node=i,i.prototype.reduce=function(e,t,n,r,i,a){if(a=a||0,this.left){var o=this.left.length;t=this.left.reduce(e,t,n,r,i,a+1),n+=o}return t=e.call(r,t,this.value,n,i,this,a),n+=1,this.right&&(t=this.right.reduce(e,t,n,r,i,a+1)),t},i.prototype.reduceRight=function(e,t,n,r,i,a){return a=a||0,this.right&&(t=this.right.reduce(e,t,n,r,i,a+1),n-=this.right.length),t=e.call(r,t,this.value,this.value,i,this,a),n-=1,this.left&&(t=this.left.reduce(e,t,n,r,i,a+1)),t},i.prototype.touch=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},i.prototype.checkIntegrity=function(){var e=1;if(e+=this.left?this.left.checkIntegrity():0,e+=this.right?this.right.checkIntegrity():0,this.length!==e)throw Error("Integrity check failed: "+this.summary());return e},i.prototype.getNext=function(){var e=this;if(e.right){for(e=e.right;e.left;)e=e.left;return e}},i.prototype.getPrevious=function(){var e=this;if(e.left){for(e=e.left;e.right;)e=e.right;return e}},i.prototype.summary=function(){var e=this.value||"-";return e+=" <"+this.length,this.left||this.right?"("+e+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+e+")"},i.prototype.log=function(e,t,n,r){var i,a=this;i=this.left&&this.right?e.intersection:this.left?e.branchUp:this.right?e.branchDown:e.through;var o;this.left&&this.left.log(e,t,function(t){o?r(e.strafe+" "+t):(o=!0,r(e.fromBelow+e.through+t))},function(e){r("  "+e)});var s;t(this,function(t){s?n((a.right?e.strafe:" ")+t):(s=!0,n(i+t))},function(t){r((a.left?e.strafe:" ")+t)});var l;this.right&&this.right.log(e,t,function(t){l?n("  "+t):(l=!0,n(e.fromAbove+e.through+t))},function(t){n(e.strafe+" "+t)})},a.prototype.next=function(){var e;if(e=this.prev?this.set.findLeastGreaterThan(this.prev.value):this.set.findLeast(),!e)throw StopIteration;if(void 0!==this.end&&this.set.contentCompare(e.value,this.end)>=0)throw StopIteration;return this.prev=e,e.value}}}),montageDefine("fdadc45","heap",{dependencies:["./listen/array-changes","./shim","./generic-collection","./listen/map-changes","./listen/range-changes","./listen/property-changes","heap"],factory:function(e,t,n){function r(e,t,n){return this instanceof r?(this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.content=[],this.length=0,this.addEach(e),void 0):new r(e,t,n)}e("./listen/array-changes"),e("./shim");var i=e("./generic-collection"),a=e("./listen/map-changes"),o=e("./listen/range-changes"),s=e("./listen/property-changes");n.exports=r,r.Heap=r,Object.addEach(r.prototype,i.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,a.prototype),r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare)},r.prototype.push=function(e){this.content.push(e),this.float(this.content.length-1),this.length++},r.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content.set(0,t),this.sink(0)),this.length--,e},r.prototype.add=function(e){this.push(e)},r.prototype.indexOf=function(e){for(var t=0;this.length>t;t++)if(this.contentEquals(this.content[t],e))return t;return-1},r.prototype.delete=function(e){var t=this.indexOf(e);if(-1===t)return!1;var n=this.content.pop();if(t===this.content.length)return!0;this.content.set(t,n);var r=this.contentCompare(n,e);return r>0?this.float(t):0>r&&this.sink(t),this.length--,!0},r.prototype.peek=function(){return this.length?this.content[0]:void 0},r.prototype.max=function(){return this.peek()},r.prototype.one=function(){return this.peek()},r.prototype.float=function(e){for(var t=this.content[e];e>0;){var n=Math.floor((e+1)/2)-1,r=this.content[n];if(!(0>this.contentCompare(r,t)))break;this.content.set(n,t),this.content.set(e,r),e=n}},r.prototype.sink=function(e){for(var t,n,r,i,a,o,s=this.content.length,l=this.content[e];;){if(i=2*(e+1),r=i-1,o=!1,s>r){var t=this.content[r],u=this.contentCompare(t,l);u>0&&(a=r,o=!0)}if(s>i){var n=this.content[i],u=this.contentCompare(n,o?t:l);u>0&&(a=i,o=!0)}if(!o)break;this.content.set(e,this.content[a]),this.content.set(a,l),e=a}},r.prototype.clear=function(){this.content.clear(),this.length=0},r.prototype.reduce=function(e,t){var n=arguments[2];return this.content.reduce(function(t,r,i){return e.call(n,t,r,i,this)},t,this)},r.prototype.reduceRight=function(e,t){var n=arguments[2];return this.content.reduceRight(function(t,r,i){return e.call(n,t,r,i,this)},t,this)},r.prototype.makeObservable=function(){this.content.addRangeChangeListener(this,"content"),this.content.addBeforeRangeChangeListener(this,"content"),this.content.addMapChangeListener(this,"content"),this.content.addBeforeMapChangeListener(this,"content")},r.prototype.handleContentRangeChange=function(e,t,n){this.dispatchRangeChange(e,t,n)},r.prototype.handleContentRangeWillChange=function(e,t,n){this.dispatchBeforeRangeChange(e,t,n)},r.prototype.handleContentMapChange=function(e,t){this.dispatchMapChange(t,e)},r.prototype.handleContentMapWillChange=function(e,t){this.dispatchBeforeMapChange(t,e)}}}),montageDefine("fdadc45","dict",{dependencies:["./shim","./generic-collection","./generic-map","./listen/property-changes","dict"],factory:function(e,t,n){"use strict";function r(e,t){return this instanceof r?(t=t||Function.noop,this.getDefault=t,this.store={},this.length=0,this.addEach(e),void 0):new r(e,t)}function i(e){return"~"+e}function a(e){return e.slice(1)}e("./shim");var o=e("./generic-collection"),s=e("./generic-map"),l=e("./listen/property-changes");n.exports=r,r.Dict=r,Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,l.prototype),r.prototype.constructClone=function(e){return new this.constructor(e,this.mangle,this.getDefault)},r.prototype.assertString=function(e){if("string"!=typeof e)throw new TypeError("key must be a string but Got "+e)},r.prototype.get=function(e,t){this.assertString(e);var n=i(e);return n in this.store?this.store[n]:arguments.length>1?t:this.getDefault(e)},r.prototype.set=function(e,t){this.assertString(e);var n=i(e);return n in this.store?(this.dispatchesBeforeMapChanges&&this.dispatchBeforeMapChange(e,this.store[n]),this.store[n]=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t),!1):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),this.length++,this.store[n]=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t),!0)},r.prototype.has=function(e){this.assertString(e);var t=i(e);return t in this.store},r.prototype["delete"]=function(e){this.assertString(e);var t=i(e);return t in this.store?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this.store[t]),delete this.store[i(e)],this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0):!1},r.prototype.clear=function(){var e,t;for(t in this.store)e=a(t),this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this.store[t]),delete this.store[t],this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0);this.length=0},r.prototype.reduce=function(e,t,n){for(var r in this.store)t=e.call(n,t,this.store[r],a(r),this);return t},r.prototype.reduceRight=function(e,t,n){var r=this,i=this.store;return Object.keys(this.store).reduceRight(function(t,o){return e.call(n,t,i[o],a(o),r)},t)},r.prototype.one=function(){var e;for(e in this.store)return this.store[e]}}}),montageDefine("fdadc45","tree-log",{dependencies:[],factory:function(e,t,n){"use strict";function r(){}n.exports=r,r.ascii={intersection:"+",through:"-",branchUp:"+",branchDown:"+",fromBelow:".",fromAbove:"'",fromBoth:"+",strafe:"|"},r.unicodeRound={intersection:"╋",through:"━",branchUp:"┻",branchDown:"┳",fromBelow:"╭",fromAbove:"╰",fromBoth:"┣",strafe:"┃"},r.unicodeSharp={intersection:"╋",through:"━",branchUp:"┻",branchDown:"┳",fromBelow:"┏",fromAbove:"┗",fromBoth:"┣",strafe:"┃"}}}),montageDefine("dba904f","deserialization/reviver",{dependencies:["q"],factory:function(e,t){(function(t){function n(){}function r(e){var t=n.prototype.getCustomObjectTypeOf;return function(n){return e(n)||t(n)}}var i=function(){return this}(),a=e("q");Object.defineProperties(n.prototype,{_createAssignValueFunction:{value:function(e,t){return function(n){e[t]=n}}},getTypeOf:{value:function(e){var t=typeof e;return null===e?"null":Array.isArray(e)?"array":"object"===t&&1===Object.keys(e).length?"@"in e?"reference":"/"in e?"regexp":"object":t}},getCustomObjectTypeOf:{writable:!0,value:function(){}},reviveRootObject:{value:function(e,t,n){var r;return e.debugger,"value"in e?t.hasUserObject(n)?(r=t.getUserObject(n),t.setObjectLabel(r,n),r):this.reviveValue(e.value,t,n):0===Object.keys(e).length?t.hasUserObject(n)?(r=t.getUserObject(n),t.setObjectLabel(r,n),r):this.reviveExternalObject(e,t,n):this.reviveCustomObject(e,t,n)}},reviveValue:{value:function(e,t,n){var r=this.getTypeOf(e);return"string"===r||"number"===r||"boolean"===r||"null"===r||"undefined"===r?this.reviveNativeValue(e,t,n):"regexp"===r?this.reviveRegExp(e,t,n):"reference"===r?this.reviveObjectReference(e,t,n):"array"===r?this.reviveArray(e,t,n):"object"===r?this.reviveObjectLiteral(e,t,n):this._callReviveMethod("revive"+r,e,t,n)}},reviveNativeValue:{value:function(e,t,n){return n&&t.setObjectLabel(e,n),e}},reviveObjectLiteral:{value:function(e,t,n){var r,i=[];n&&t.setObjectLabel(e,n);for(var o in e)r=this.reviveValue(e[o],t),a.isPromise(r)?i.push(r.then(this._createAssignValueFunction(e,o))):e[o]=r;return 0===i.length?e:a.all(i).then(function(){return e})}},reviveRegExp:{value:function(e,t,n){var e=e["/"],r=RegExp(e.source,e.flags);return n&&t.setObjectLabel(r,n),r}},reviveObjectReference:{value:function(e,t){var e=e["@"],n=t.getObject(e);return n}},reviveArray:{value:function(e,t,n){var r,i=[];n&&t.setObjectLabel(e,n);for(var o=0,s=e.length;s>o;o++)r=this.reviveValue(e[o],t),a.isPromise(r)?i.push(r.then(this._createAssignValueFunction(e,o))):e[o]=r;return 0===i.length?e:a.all(i).then(function(){return e})}},reviveCustomObject:{value:function(e,t,n){var r=this.getCustomObjectTypeOf(e),s=o["revive"+r];return r?s.call(i,e,t,n):a.reject(Error("Object's type is unknown: "+JSON.stringify(e)))}},reviveExternalObject:{value:function(e,t,n){return a.reject(Error("External object '"+n+"' not found in user objects."))}},_callReviveMethod:{value:function(e,t,n,r){return this[e](t,n,r)}}});var o=Object.create(null);n.addCustomObjectReviver=function(e){for(var t in e)if("getTypeOf"!==t&&"function"==typeof e[t]&&/^revive/.test(t)){if(void 0!==o[t])return Error("Reviver '"+t+"' is already registered.");o[t]=e[t].bind(e)}this.prototype.getCustomObjectTypeOf=r(e.getTypeOf)},n.resetCustomObjectRevivers=function(){o=Object.create(null),this.prototype.getCustomObjectTypeOf=function(){}},t.Reviver=n})(t),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)})}}),montageDefine("dba904f","serialization/malker",{dependencies:[],factory:function(e,t){(function(e){function t(e){this._visitHandler=e,this._enteredObjects={}}Object.defineProperties(t.prototype,{_visitHandler:{value:null,writable:!0},_enteredObjects:{value:null,writable:!0},_isObjectEntered:{value:function(e){return Object.hash(e)in this._enteredObjects}},_markObjectAsEntered:{value:function(e){this._enteredObjects[Object.hash(e)]=!0}},visit:{value:function(e,t){this._visitValue(e,t)},enumerable:!0},_getTypeOf:{value:function(e){return Array.isArray(e)?"array":RegExp.isRegExp(e)?"regexp":null===e?"null":"object"==typeof e||"function"==typeof e?this._getObjectType(e):typeof e}},_getObjectType:{value:function(e){var t,n=this._visitHandler;return"function"==typeof n.getTypeOf&&(t=n.getTypeOf(e)),void 0===t?typeof e:t
}},_visitValue:{value:function(e,t){var n=this._getTypeOf(e);"object"===n?this._visitObject(e,t):"array"===n?this._visitArray(e,t):"regexp"===n?this._visitRegExp(e,t):"number"===n?this._visitNumber(e,t):"string"===n?this._visitString(e,t):"boolean"===n?this._visitBoolean(e,t):"null"===n?this._visitNull(t):"undefined"===n?this._visitUndefined(t):this._visitCustomType(n,e,t)}},_visitCustomType:{value:function(e,t,n){this._callVisitorMethod("visit"+e,t,n)}},_enterCustomObject:{value:function(e,t,n){this._callVisitorMethod("enter"+e,t,n),this._callVisitorMethod("exit"+e,t,n)}},_visitObject:{value:function(e,t){var n;this._isObjectEntered(e)?this._callVisitorMethod("visitObject",e,t):(n=this._callVisitorMethod("willEnterObject",e,t),n!==!1&&(this._markObjectAsEntered(e),this._enterObject(e,t)))}},_enterObject:{value:function(e,t){var n,r=Object.keys(e);this._callVisitorMethod("enterObject",e,t);for(var i=0,a=r.length;a>i;i++)n=r[i],this._visitValue(e[n],n);this._callVisitorMethod("exitObject",e,t)}},_visitArray:{value:function(e,t){var n;this._isObjectEntered(e)?this._callVisitorMethod("visitArray",e,t):(n=this._callVisitorMethod("willEnterArray",e,t),n!==!1&&(this._markObjectAsEntered(e),this._enterArray(e,t)))}},_enterArray:{value:function(e,t){this._callVisitorMethod("enterArray",e,t);for(var n=0,r=e.length;r>n;n++)this._visitValue(e[n],""+n);this._callVisitorMethod("exitArray",e,t)}},_visitRegExp:{value:function(e,t){this._callVisitorMethod("visitRegExp",e,t)}},_visitString:{value:function(e,t){this._callVisitorMethod("visitString",e,t)}},_visitNumber:{value:function(e,t){this._callVisitorMethod("visitNumber",e,t)}},_visitBoolean:{value:function(e,t){this._callVisitorMethod("visitBoolean",e,t)}},_visitNull:{value:function(e){this._callVisitorMethod("visitNull",e)}},_visitUndefined:{value:function(e){this._callVisitorMethod("visitUndefined",e)}},_callVisitorMethod:{value:function(e){var t,n=this._visitHandler;return"function"==typeof n[e]?(t=Array.prototype.slice.call(arguments,1),t.unshift(this),n[e].apply(n,t)):void 0}}}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),RegExp.isRegExp||(RegExp.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}),e.Malker=t,e.visit=function(e,n){var r=new t(n);r.visit(e)}})(t)}}),montageDefine("dba904f","serialization/serializer",{dependencies:["./malker","./builder","./labeler","./visitor"],factory:function(e,t){(function(t){function n(){var e;this._builder=new i,this._labeler=new a,e=new o(this._builder,this._labeler),this._malker=new r(e)}var r=e("./malker").Malker,i=e("./builder").Builder,a=e("./labeler").Labeler,o=e("./visitor").Visitor;Object.defineProperties(n.prototype,{_labeler:{value:null,writable:!0},_builder:{value:null,writable:!0},_serializationIndentation:{value:2,writable:!0},_malker:{value:null,writable:!0},setSerializationIndentation:{value:function(e){this._serializationIndentation=e}},serialize:{value:function(e){var t;this._labeler.initWithObjects(e);for(var n in e)this._malker.visit(e[n]);return t=this._formatSerialization(this._builder.getSerialization(this._serializationIndentation))}},serializeObject:{value:function(e){return this.serialize({root:e})}},_formatSerializationBindingsRegExp:{value:/\{\s*("(?:<->?)")\s*:\s*("[^"]+"\s*(?:,\s*"converter"\s*:\s*\{\s*"@"\s*:\s*"[^"]+"\s*\}\s*|,\s*"deferred"\s*:\s*(true|false)\s*)*)\}/gi},_formatSerializationBindingsReplacer:{value:function(e,t,n){return"{"+t+": "+n.replace(/\n\s*/g,"").replace(/,\s*/g,", ")+"}"}},_formatSerializationBindings:{value:function(e){return e.replace(this._formatSerializationBindingsRegExp,this._formatSerializationBindingsReplacer)}},_formatSerializationReferencesRegExp:{value:/\{\s*("[#@]")\s*:\s*("[^"]+")\s*\}/gi},_formatSerializationReferences:{value:function(e){return e.replace(this._formatSerializationReferencesRegExp,"{$1: $2}")}},_formatSerialization:{value:function(e){return this._formatSerializationBindings(this._formatSerializationReferences(e))}}}),t.Serializer=n,t.serialize=function(e){return(new n).serializeObject(e)}})(t)}}),montageDefine("dba904f","deserialization/interpreter",{dependencies:["./reviver","./context"],factory:function(e,t){(function(t){function n(){}var r=e("./reviver").Reviver,i=e("./context").Context;Object.defineProperties(n.prototype,{instantiate:{value:function(e,t){var n=new r,a=new i(e,n,t);return a.getObjects()}}}),t.Interpreter=n})(t)}}),montageDefine("dba904f","deserialization/deserializer",{dependencies:["q","./interpreter"],factory:function(e,t){(function(t){function n(e){this._serializationString=e}function r(e){return new n(e).deserializeObject()}var i=e("q"),a=e("./interpreter").Interpreter;Object.defineProperties(n.prototype,{_interpreter:{value:new a},_serializationString:{value:null,writable:!0},deserialize:{value:function(e){var t;try{t=JSON.parse(this._serializationString)}catch(n){return i.reject(n)}return this._interpreter.instantiate(t,e)}},deserializeObject:{value:function(e){return this.deserialize(e).then(function(e){return e.root})}}}),t.Deserializer=n,t.deserialize=r})(t)}}),montageDefine("dba904f","serialization/builder",{dependencies:["./ast"],factory:function(e,t){(function(t){function n(){this.init()}var r=e("./ast");Object.defineProperties(n.prototype,{_root:{value:null,writable:!0},_stack:{value:null,writable:!0},_references:{value:null,writable:!0},_placeholderProperty:{value:Object.create(null)},init:{value:function(){return this._references=Object.create(null),this._root=new r.Root,this._stack=[this._root],this}},cleanup:{value:function(){this._references=null,this._root=null,this._stack=null}},getExternalReferences:{value:function(){var e=this._references,t=this._root,n=[];for(var r in e)t.hasProperty(r)&&t.getProperty(r)!==this._placeholderProperty||n.push(r);return n}},relabelReferences:{value:function(e,t){var n=this._references[e];if(n){n=n.slice(0);for(var r=0,i=n.length;i>r;r++)n[r].value=t}}},_registerReference:{value:function(e){var t=this._references,n=e.value;t[n]?t[n].push(e):t[n]=[e]}},_unregisterReference:{value:function(e){var t,n=e.label,r=this._references[n];1===r.length?delete this._references[n]:(t=r.indexOf(e),-1===t?console.log("BUG: reference '"+n+"' not found in registry."):r.splice(t,1))}},_createPlaceholdersForReferences:{value:function(){var e=this._references,t=this._root;for(var n in e)t.hasProperty(n)||t.setProperty(n,this._placeholderProperty)}},getSerialization:{value:function(e){return this._createPlaceholdersForReferences(),this._root.serialize(e)}},root:{get:function(){return this._root}},top:{get:function(){return this._stack[0]}},push:{value:function(e){return this._stack.unshift(e)}},pop:{value:function(){return this._stack.shift()}},createObjectLiteral:{value:function(){return new r.ObjectLiteral(this._root,Object.create(null))}},createArray:{value:function(){return new r.ObjectLiteral(this._root,[])}},createObjectReference:{value:function(e){var t=new r.ObjectReference(this._root,e);return this._registerReference(t),t}},createRegExp:{value:function(e){return new r.RegExpObject(this._root,e)}},createString:{value:function(e){return new r.Value(this._root,e)}},createNumber:{value:function(e){return new r.Value(this._root,e)}},createBoolean:{value:function(e){return new r.Value(this._root,e)}},createNull:{value:function(){return new r.Value(this._root,null)}},createCustomObject:{value:function(){return new r.CustomObject(this._root)}}}),t.Builder=n})(t)}}),montageDefine("dba904f","serialization/labeler",{dependencies:[],factory:function(e,t){(function(e){function t(){this._objectsLabels=Object.create(null),this._objects=Object.create(null),this._objectNamesIndex=Object.create(null),this._userDefinedLabels=Object.create(null)}Object.defineProperties(t.prototype,{_objectsLabels:{value:null,writable:!0},_objects:{value:null,writable:!0},_INITIAL_LABEL_NUMBER:{value:2},_objectNamesIndex:{value:null,writable:!0},_userDefinedLabels:{value:null,writable:!0},initWithObjects:{value:function(e){for(var t in e)this.setObjectLabel(e[t],t),this._userDefinedLabels[t]=!0}},cleanup:{value:function(){this._objectsLabels=null,this._objects=null,this._objectNamesIndex=null,this._userDefinedLabels=null}},getObjectName:{value:function(e){return Array.isArray(e)?"array":RegExp.isRegExp(e)?"regexp":"object"}},generateObjectLabel:{value:function(e){var t,n=this.getObjectName(e),r=this._objectNamesIndex[n];do r?(t=n+r,this._objectNamesIndex[n]=r+=1):(t=n,this._objectNamesIndex[n]=r=this._INITIAL_LABEL_NUMBER);while(t in this._objects);return t}},getObjectLabel:{value:function(e){var t,n=Object.hash(e);return n in this._objectsLabels?t=this._objectsLabels[n]:(t=this.generateObjectLabel(e),this._objectsLabels[n]=t,this._objects[t]=e),t}},setObjectLabel:{value:function(e,t){if(void 0!==e){var n=Object.hash(e);this._objectsLabels[n]=t,this._objects[t]=e}}},getObjectByLabel:{value:function(e){return this._objects[e]}},isUserDefinedLabel:{value:function(e){return e in this._userDefinedLabels}}}),e.Labeler=t})(t)}}),montageDefine("dba904f","serialization/visitor",{dependencies:["collections/shim-object"],factory:function(e,t){(function(t){function n(e,t){this.builder=e,this.labeler=t,this._objectsSerialization=Object.create(null)}function r(e){var t=n.prototype.getCustomObjectTypeOf;return function(n){return e(n)||t(n)}}e("collections/shim-object"),Object.defineProperties(n.prototype,{builder:{value:null,writable:!0},labeler:{value:null,writable:!0},getTypeOf:{value:function(e){return this.isCustomObject(e)?"CustomObject":void 0}},getCustomObjectTypeOf:{value:function(){},writable:!0},isCustomObject:{value:function(e){var t=this.getCustomObjectTypeOf(e);return"string"==typeof t}},_objectsSerialization:{value:null,writable:!0},setObjectSerialization:{value:function(e,t){this._objectsSerialization[Object.hash(e)]=t}},getObjectSerialization:{value:function(e){return this._objectsSerialization[Object.hash(e)]}},isObjectSerialized:{value:function(e){return Object.hash(e)in this._objectsSerialization}},enterObject:{value:function(e,t){var n=this.builder.createObjectLiteral();this.setObjectSerialization(t,n),this.builder.push(n)}},exitObject:{value:function(e,t,n){this.storeValue(this.builder.pop(),t,n)}},visitObject:{value:function(e,t,n){var r=this.labeler.getObjectLabel(t),i=this.builder.createObjectReference(r);this.getObjectSerialization(t).setLabel(r),this.builder.top.setProperty(n,i)}},enterArray:{value:function(e,t){var n=this.builder.createArray();this.setObjectSerialization(t,n),this.builder.push(n)}},exitArray:{value:function(e,t,n){this.storeValue(this.builder.pop(),t,n)}},visitArray:{value:function(e,t,n){var r=this.labeler.getObjectLabel(t),i=this.builder.createObjectReference(r);this.getObjectSerialization(t).setLabel(r),this.builder.top.setProperty(n,i)}},visitRegExp:{value:function(e,t,n){this.storeValue(this.builder.createRegExp(t),t,n)}},visitString:{value:function(e,t,n){this.storeValue(this.builder.createString(t),t,n)}},visitNumber:{value:function(e,t,n){this.storeValue(this.builder.createNumber(t),t,n)}},visitBoolean:{value:function(e,t,n){this.storeValue(this.builder.createBoolean(t),t,n)}},visitNull:{value:function(e,t){this.storeValue(this.builder.createNull(),null,t)}},visitCustomObject:{value:function(e,t,n){var r=this.getCustomObjectTypeOf(t),a=i["visit"+r];if(r)return a.call(global,e,this,t,n);throw Error("Object's type is unknown: "+t)}},storeValue:{value:function(e,t,n){void 0===n?e.setLabel(this.labeler.getObjectLabel(t)):this.builder.top.setProperty(n,e)}}});var i=Object.create(null);n.addCustomObjectVisitor=function(e){for(var t in e)if("getTypeOf"!==t&&"function"==typeof e[t]&&/^visit/.test(t)){if(void 0!==i[t])return Error("Visitor '"+t+"' is already registered.");i[t]=e[t].bind(e)}this.prototype.getCustomObjectTypeOf=r(e.getTypeOf)},n.resetCustomObjectVisitors=function(){i=Object.create(null),this.prototype.getCustomObjectTypeOf=function(){}},t.Visitor=n})(t)}}),montageDefine("dba904f","deserialization/context",{dependencies:["q"],factory:function(e,t){var n=e("q");(function(e){function t(e,t,n){if(this._reviver=t,this._serialization=e,this._objects=Object.create(null),n){this._userObjects=Object.create(null);for(var r in n)this._userObjects[r]=n[r]}}Object.defineProperties(t.prototype,{_objects:{value:null,writable:!0},_userObjects:{value:null,writable:!0},_serialization:{value:null,writable:!0},_reviver:{value:null,writable:!0},setObjectLabel:{value:function(e,t){this._objects[t]=e}},getObject:{value:function(e){var t,r=this._serialization,i=this._reviver,a=this._objects;return e in a?a[e]:e in r?(t=i.reviveRootObject(r[e],this,e),e in a||(a[e]=t),t):n.reject(Error("Object with label '"+e+"' was not found."))}},getObjects:{value:function(){var e,t=this,r=(this._reviver,this._serialization),i=[];for(var a in r)e=this.getObject(a),n.isPromise(e)&&i.push(e);return 0===i.length?n.resolve(this._invokeDidReviveObjects()):n.all(i).then(function(){return t._invokeDidReviveObjects()})}},hasUserObject:{value:function(e){var t=this._userObjects;return t?e in t:!1}},getUserObject:{value:function(e){var t=this._userObjects;return t?t[e]:void 0}},_invokeDidReviveObjects:{value:function(){var e,t=this,r=this._reviver;return"function"==typeof r.didReviveObjects&&(e=r.didReviveObjects(this._objects,this),n.isPromise(e))?e.then(function(){return t._objects}):this._objects}}}),e.Context=t})(t)}}),montageDefine("dba904f","serialization/ast",{dependencies:[],factory:function(e,t){(function(e){function t(){this.object=Object.create(null)}function n(e,t){this.root=e,this.value=t}function r(e,t){n.call(this,e,t)}function i(e,t){n.call(this,e,t)}function a(e,t){n.call(this,e,t)}function o(e){n.call(this,e,Object.create(null))}function s(e,t){n.call(this,e,t)}Object.defineProperties(t.prototype,{object:{value:null,writable:!0},setProperty:{value:function(e,t){null!=e&&(this.object[e]=t)}},getProperty:{value:function(e){return this.object[e]}},clearProperty:{value:function(e){delete this.object[e]}},hasProperty:{value:function(e){return e in this.object}},serialize:{value:function(e){return JSON.stringify(this,null,e)}},toJSON:{value:function(){var e,t=Object.create(null);for(var n in this.object)e=this.object[n],t[n]=e.toJSON?e.toJSON(n,1):e;return t}}}),Object.defineProperties(n.prototype,{root:{value:null,writable:!0},label:{value:null,writable:!0},value:{value:null,writable:!0},setLabel:{value:function(e){this.label&&this.root.clearProperty(this.label),this.label=e,this.root.setProperty(e,this)}},getLabel:{value:function(){return this.label}},clearLabel:{value:function(){this.root.clearProperty(this.label),this.label=null}},_getSerializationValue:{value:function(){return this.value}},toJSON:{value:function(e,t){var n=this._getSerializationValue();return 1===t?{value:n}:n}}}),r.prototype=Object.create(n.prototype,{constructor:{value:r},toJSON:{value:function(e,t){var n,r=this._getSerializationValue();return 1===t?{value:r}:this.label?(n=new s(this.root,this.label),n.toJSON()):r}}}),i.prototype=Object.create(r.prototype,{constructor:{value:i},setProperty:{value:function(e,t){null!=e&&(this.value[e]=t)}},getProperty:{value:function(e){return this.value[e]}},clearProperty:{value:function(e){delete this.value[e]}},getPropertyNames:{value:function(){return Object.keys(this.value)}}}),a.prototype=Object.create(r.prototype,{constructor:{value:a},_getSerializationValue:{value:function(){var e=this.value;return{"/":{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")}}}}}),o.prototype=Object.create(n.prototype,{constructor:{value:o},setProperty:{value:function(e,t){null!=e&&(this.value[e]=t)}},getProperty:{value:function(e){return this.value[e]}},clearProperty:{value:function(e){delete this.value[e]}},toJSON:{value:function(e,t){var n,r=this._getSerializationValue();return 1===t?r:(n=new s(this.root,this.label),n.toJSON())}}}),s.prototype=Object.create(n.prototype,{constructor:{value:s},_getSerializationValue:{value:function(){return{"@":this.value}}}}),e.Root=t,e.Value=n,e.ReferenceableValue=r,e.ObjectLiteral=i,e.RegExpObject=a,e.CustomObject=o,e.ObjectReference=s})(t)}}),montageDefine("1af4c9e","weak-map",{dependencies:[],factory:function(e,t,n){(function(){"use strict";function e(t){t.permitHostObjects___&&t.permitHostObjects___(e)}function t(e){return!(e.substr(0,u.length)==u&&"___"===e.substr(e.length-3))}function r(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[c];if(t&&t.key===e)return t;if(!l(e))return void 0;var n=[],r=[];return t={key:e,gets:n,vals:r},s(e,c,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}function i(e){return e.prototype=null,Object.freeze(e)}if("undefined"==typeof ses||!ses.ok||ses.ok()){if("undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=e),"function"==typeof WeakMap){var a=WeakMap;if("undefined"==typeof navigator||!/Firefox/.test(navigator.userAgent))return n.exports=WeakMap,void 0}Object.prototype.hasOwnProperty;var o=Object.getOwnPropertyNames,s=Object.defineProperty,l=Object.isExtensible,u="weakmap:",c=u+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var h=new ArrayBuffer(25),d=new Uint8Array(h);crypto.getRandomValues(d),c=u+"rand:"+Array.prototype.map.call(d,function(e){return(e%36).toString(36)}).join("")+"___"}if(s(Object,"getOwnPropertyNames",{value:function(e){return o(e).filter(t)}}),"getPropertyNames"in Object){var p=Object.getPropertyNames;s(Object,"getPropertyNames",{value:function(e){return p(e).filter(t)}})}(function(){var e=Object.freeze;s(Object,"freeze",{value:function(t){return r(t),e(t)}});var t=Object.seal;s(Object,"seal",{value:function(e){return r(e),t(e)}});var n=Object.preventExtensions;s(Object,"preventExtensions",{value:function(e){return r(e),n(e)}})})();var f=function(){function e(t,n){var i,a,l=r(t);return l?(i=l.gets.indexOf(e),a=l.vals):(i=o.indexOf(t),a=s),i>=0?a[i]:n}function t(t){var n,i=r(t);return n=i?i.gets.indexOf(e):o.indexOf(t),n>=0}function n(t,n){var i,a=r(t);a?(i=a.gets.indexOf(e),i>=0?a.vals[i]=n:(a.gets.push(e),a.vals.push(n))):(i=o.indexOf(t),i>=0?s[i]=n:(o.push(t),s.push(n)))}function a(t){var n,i=r(t);return i?(n=i.gets.indexOf(e),n>=0&&(i.gets.splice(n,1),i.vals.splice(n,1))):(n=o.indexOf(t),n>=0&&(o.splice(n,1),s.splice(n,1))),!0}var o=[],s=[];return Object.create(f.prototype,{get___:{value:i(e)},has___:{value:i(t)},set___:{value:i(n)},delete___:{value:i(a)}})};f.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){this.set___(e,t)},writable:!0,configurable:!0},"delete":{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof a?function(){function t(){function t(e,t){return l?s.has(e)?s.get(e):l.get___(e,t):s.get(e,t)}function n(e){return s.has(e)||(l?l.has___(e):!1)}function r(e,t){if(u)try{s.set(e,t)}catch(n){l||(l=new f),l.set___(e,t)}else s.set(e,t)}function o(e){s["delete"](e),l&&l.delete___(e)}var s=new a,l=void 0,u=!1;return Object.create(f.prototype,{get___:{value:i(t)},has___:{value:i(n)},set___:{value:i(r)},delete___:{value:i(o)},permitHostObjects___:{value:i(function(t){if(t!==e)throw Error("bogus call to permitHostObjects___");u=!0})}})}t.prototype=f.prototype,n.exports=t,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),n.exports=f)}})()}}),montageDefine("eabe77a","parse",{dependencies:["collections/shim","./grammar"],factory:function(e,t,n){function r(e,t){if(Array.isArray(e))return{type:"tuple",args:e.map(function(e){return r(e,t)})};try{return i.parse(e,t||Object.empty)}catch(n){throw n.message=n.message.replace(/[\s\.]+$/,"")+" "+" on line "+n.line+" column "+n.column,n}}e("collections/shim");var i=e("./grammar");n.exports=r}}),montageDefine("eabe77a","evaluate",{dependencies:["./parse","./compile-evaluator","./scope"],factory:function(e,t,n){function r(e,t,n,r,s){var l;l="string"==typeof e?i(e):e;var u=a(l),c=new o(t);return c.parameters=n,c.document=r,c.components=s,u(c)}var i=e("./parse"),a=e("./compile-evaluator"),o=e("./scope");n.exports=r}}),montageDefine("eabe77a","assign",{dependencies:["./parse","./compile-assigner","./scope"],factory:function(e,t,n){function r(e,t,n,r,s,l){var u;u="string"==typeof t?i(t):t;var c=a(u),h=new o(e);return h.parameters=r,h.document=s,h.components=l,c(n,h)}var i=e("./parse"),a=e("./compile-assigner"),o=e("./scope");n.exports=r}}),montageDefine("eabe77a","observe",{dependencies:["./parse","./compile-observer","./observers","./scope"],factory:function(e,t,n){function r(e,t,n){var r;r="function"==typeof n?{change:n}:n,r=r||u,r.source=e,r.sourcePath=t;var c=r.parameters=r.parameters||e,h=r.document,d=r.components,p=r.beforeChange,f=r.contentChange,m=new l(e);m.parameters=c,m.document=h,m.components=d,m.beforeChange=p;var v=i(t),g=a(v);return f===!0&&(g=o.makeRangeContentObserver(g)),g(s(function(t){if(t){if("function"!=typeof f)return r.change.apply(e,arguments);if("function"==typeof f)return t.addRangeChangeListener(f),o.once(function(){t.removeRangeChangeListener(f)})}}),m)}var i=e("./parse"),a=e("./compile-observer"),o=e("./observers"),s=o.autoCancelPrevious,l=e("./scope");n.exports=r;var u={}}}),montageDefine("eabe77a","bind",{dependencies:["./parse","./algebra","./stringify","./compile-observer","./compile-binder","./observers","./scope"],factory:function(e,t,n){function r(e,t,n){n.target=e,n.targetPath=t;var r=n.source=n.source||e,s=n["<-"]||n["<->"]||"",l=n.twoWay="<->"in n;n.sourcePath=s,n.value;var u=n.parameters=n.parameters||r,c=n.document,h=n.components,p=n.trace,f=n.sourceScope=new d(r);f.parameters=u,f.document=c,f.components=h;var m=n.targetScope=new d(e);if(m.parameters=u,m.document=c,m.components=h,n.converter){var v=n.converter;v.convert&&(n.convert=v.convert.bind(v)),v.revert&&(n.revert=v.revert.bind(v))}else if(n.reverter){var g=n.reverter;g.convert&&(n.revert=g.convert.bind(g)),g.revert&&(n.convert=g.revert.bind(g))}var b=n.convert,_=n.revert,y=n.sourceSyntax=o(s),w=n.targetSyntax=o(t);p&&console.log("DEFINE BINDING",t,"<-",s,e);var E=i(m,w,f,y,b,n,p),C=a;return l&&(p&&console.log("DEFINE BINDING",t,"->",s,r),C=i(f,y,m,w,_,n,p)),function(){E(),C()}}function i(e,t,n,r,i,a,o){var d=s(t,r);t=d[0],r=d[1];var p=u(r);i&&(p=h.makeConverterObserver(p,i,n));var f=c(t);return f(p,n,e,a,o?{sourcePath:l(r),targetPath:l(t)}:null)}function a(){}var o=e("./parse"),s=e("./algebra"),l=e("./stringify"),u=e("./compile-observer"),c=e("./compile-binder"),h=e("./observers"),d=e("./scope");n.exports=r}}),montageDefine("eabe77a","compile-observer",{dependencies:["./observers","./operators"],factory:function(e,t,n){function r(e){return o.compile(e)}var i=e("./observers"),a=e("./operators");n.exports=r;var o=r.semantics={compilers:{property:i.makePropertyObserver,get:i.makeGetObserver,path:i.makePathObserver,"with":i.makeWithObserver,"if":i.makeConditionalObserver,parent:i.makeParentObserver,not:i.makeNotObserver,and:i.makeAndObserver,or:i.makeOrObserver,"default":i.makeDefaultObserver,defined:i.makeDefinedObserver,rangeContent:i.makeAsArrayObserver,mapContent:Function.identity,keys:i.makeKeysObserver,values:i.makeValuesObserver,items:i.makeEntriesObserver,entries:i.makeEntriesObserver,toMap:i.makeToMapObserver,mapBlock:i.makeMapBlockObserver,filterBlock:i.makeFilterBlockObserver,everyBlock:i.makeEveryBlockObserver,someBlock:i.makeSomeBlockObserver,sortedBlock:i.makeSortedBlockObserver,sortedSetBlock:i.makeSortedSetBlockObserver,groupBlock:i.makeGroupBlockObserver,groupMapBlock:i.makeGroupMapBlockObserver,minBlock:i.makeMinBlockObserver,maxBlock:i.makeMaxBlockObserver,min:i.makeMinObserver,max:i.makeMaxObserver,enumerate:i.makeEnumerationObserver,reversed:i.makeReversedObserver,flatten:i.makeFlattenObserver,concat:i.makeConcatObserver,view:i.makeViewObserver,sum:i.makeSumObserver,average:i.makeAverageObserver,last:i.makeLastObserver,only:i.makeOnlyObserver,one:i.makeOneObserver,has:i.makeHasObserver,tuple:i.makeArrayObserver,range:i.makeRangeObserver,startsWith:i.makeStartsWithObserver,endsWith:i.makeEndsWithObserver,contains:i.makeContainsObserver,join:i.makeJoinObserver,toArray:i.makeToArrayObserver,asArray:i.makeToArrayObserver},compile:function(e){var t=this.compilers;if("literal"===e.type)return i.makeLiteralObserver(e.value);if("value"===e.type)return i.observeValue;if("parameters"===e.type)return i.observeParameters;if("element"===e.type)return i.makeElementObserver(e.id);if("component"===e.type)return i.makeComponentObserver(e.label,e);if("record"===e.type){var n={},r=e.args;for(var a in r)n[a]=this.compile(r[a]);return i.makeObjectObserver(n)}t.hasOwnProperty(e.type)||(t[e.type]=i.makeMethodObserverMaker(e.type));var o=e.args.map(this.compile,this);return t[e.type].apply(null,o)}},s=o.compilers;Object.keys(a).forEach(function(e){s[e]||(s[e]=i.makeOperatorObserverMaker(a[e]))}),s.toString=i.makeOperatorObserverMaker(a.toString)}}),montageDefine("eabe77a","scope",{dependencies:[],factory:function(e,t,n){function r(e){this.parent=null,this.value=e}n.exports=r,r.prototype.nest=function(e){var t=Object.create(this);return t.value=e,t.parent=this,t}}}),montageDefine("eabe77a","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/sorted-set","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(e,t){function n(e){return function(t){return t(e)||Function.noop}}function r(e,t){return e(t.value)||Function.noop}function i(e,t){return e(t.parameters)||Function.noop}function a(e){return function(t,n){return t(n.document.getElementById(e))||Function.noop}}function o(e,t){return function(n,r){var i=r.components,a=i.getObjectByLabel||i.getComponentByLabel,o=a.call(i,e);return t.component=o,n(o)||Function.noop}}function s(e,t,n,r){function i(e,t,r){a(),a=n(e,t,r)||Function.noop}if(null==e)return n();var a=Function.noop;return xt.addOwnPropertyChangeListener(e,t,i,r.beforeChange),i(e[t],t,e),Ct(function(){a(),xt.removeOwnPropertyChangeListener(e,t,i,r.beforeChange)})}function l(e,t){return function(n,r){return t(Et(function(t){return"string"!=typeof t&&"number"!=typeof t?n():e(Et(function(e){return null==e?n():e.observeProperty?e.observeProperty(t,n,r):Dt(e,t,n,r)}),r)}),r)}}function u(e,t,n,r){function i(e,r,i){o(t,r)&&(a(),a=n(e,t,i)||Function.noop)}var a=Function.noop,o=e.contentEquals||Object.equals;return i(e.get(t),t,e),e.addMapChangeListener(i,r.beforeChange),Ct(function(){a(),e.removeMapChangeListener(i)})}function c(e,t){return function(n,r){return e(Et(function(e){return e?t(Et(function(t){return null==t?n():e.observeGet?e.observeGet(t,n,r):Mt(e,t,n,r)}),r):n()}),r)}}function h(e,t){return function(n,r){return n=yt(n),t(Et(function(t){return e(Et(function(e){return e?Z(e,function(){return n((e.has||e.contains).call(e,t))},r):n()}),r)}),r)}}function d(e){return function(t,n){for(var r=Array(e.length),i=0;e.length>i;i++)r[i]=void 0;var a=e.map(function(e,t){return e(function(e){r.set(t,e)},n)}),o=t(r)||Function.noop;return Ct(function(){o(),wt(a)})}}function p(e){return function(t,n){var r={},i={};for(var a in e)(function(e,t){r[e]=t(function(t){i[e]=t},n)})(a,e[a]);var o=t(i)||Function.noop;return function(){o();for(var e in r)r[e]()}}}function f(){return d(Array.prototype.slice.call(arguments))}function m(e){return function(){var t=d(Array.prototype.slice.call(arguments)),n=it(t);return function(t,r){return n(Et(function(n){return n.every(kt.defined)?t(e.apply(void 0,n)):t()}),r)}}}function v(e){var t=e.slice(0,1).toUpperCase()+e.slice(1),n="make"+t+"Observer",r="observe"+t;return function(){var t=arguments[0],i=Array.prototype.slice.call(arguments,1),a=i.map(function(e){return function(t,n){return e(Et(t),n)}}),o=d(i),s=it(o);return function(i,o){return t(Et(function(t){return t?t[n]?t[n].apply(t,a)(i,o):t[r]?t[r](i,o):s(Et(function(n){return n.every(kt.defined)?"function"==typeof t[e]?i(t[e].apply(t,n)):i():i()}),o):i()}),o)}}}function g(e){return function(t,n){return e(Et(function(e){return t(!e)}),n)}}function b(e,t){return function(n,r){return e(Et(function(e){return e?t(n,r):n(e)}),r)}}function _(e,t){return function(n,r){return e(Et(function(e){return e?n(e):t(n,r)}),r)}}function y(e,t,n){return function(r,i){return e(Et(function(e){return null==e?r():e?t(r,i):n(r,i)}),i)}}function w(e){return function(t,n){return e(Et(function(e){return t(null!=e)}),n)}}function E(e,t){return function(n,r){return e(Et(function(e){return null==e?t(n,r):n(e)}),r)}}function C(e,t){return function(n,r){return e(Et(function(e){function i(t){for(;e.length>t;t++)s[t].index=t}function a(e,n,a){s.swap(a,n.length,e.map(function(e,t){return{index:a+t}})),i(a+e.length);var u,c=[];wt(l.swap(a,n.length,e.map(function(e,n){var i=s[a+n];return t(Et(function(e){u?o.set(i.index,e):c[n]=e}),r.nest(e))}))),u=!0,o.swap(a,n.length,c)}if(!e)return n();var o=[],s=[],l=[],u=Z(e,a,r),c=n(o,e)||Function.noop;return Ct(function(){c(),wt(l),u()})}),r)}}function x(e,t){var n=C(e,t);return function(e,t){return n(Et(function(n,r){function i(e){for(;n.length>e;e++)l[e+1]=l[e]+!!n[e]}function a(e,t,n){var a=r.slice(n,n+e.length),s=t.map(Boolean).sum(),u=a.filter(function(t,n){return e[n]}),c=l[n],h=o.slice(c,c+s);(h.length!==u.length||h.some(function(e,t){return e!==u[t]}))&&o.swap(c,s,u),i(c)}if(!r)return e();var o=[],s=[],l=[0],u=Z(n,a,t),c=e(o)||Function.noop;return Ct(function(){c(),wt(s),u()})}),t)}}function O(e,t){var n=P(t),r=C(e,n),i=function(e,t){return r(Et(function(n){function r(e,t){a.addEach(e),a.deleteEach(t)}if(!n)return e();var i=[],a=Ot(i,S,T),o=Z(n,r,t),s=e(i)||Function.noop;return function(){s(),o()}}),t)};return Lt(i,ct)}function S(e,t){return Object.equals(e[1],t[1])}function T(e,t){return Object.compare(e[1],t[1])}function P(e){return function(t,n){return e(Et(function(e){return t([n.value,e])||Function.noop}),n)}}function k(e,t){var n=P(t),r=C(e,n),i=R(r,dt),a=C(i,$(dt));return function(e,t){function n(e,t){return e=s.get(e),t=s.get(t),Object.compare(e,t)}function r(e,t){return e=s.get(e),t=s.get(t),Object.equals(e,t)}function i(e,t){t.forEach(function(e){l["delete"](e[0]),s["delete"](e[0])}),e.forEach(function(e){s.set(e[0],e[1]),l.add(e[0])})}function o(e){return l.clear(),Z(e,i,t)}var s=new Tt,l=new St(null,r,n),u=e(l)||Function.noop,c=a(o,t);return function(){u(),c()}}}function D(e){return function(t,n){return e(Et(function(e){function r(e,t,n){var r=i.length-n-t.length;i.swap(r,t.length,e.reversed())}if(!e)return t();var i=[],a=Z(e,r,n),o=t(i);return Ct(function(){o(),a()})}),n)}}function M(e){return function(t,n){return e(Et(function(e){function r(t){for(var n=t;e.length>n;n++)l[n].index=n,s[n+1]=e[n]?s[n]+e[n].length:s[n]}function i(e,t,i){var u=s[i],c=s[i+t.length],h=c-u;a.swap(u,h,[]),l.swap(i,t.length,e.map(function(){return{index:null}})),r(i),wt(o.swap(i,t.length,e.map(function(e,t){function o(e,t,n){r(u.index);var i=s[u.index]+n,o=s[u.index]+n+t.length,l=o-i;a.swap(i,l,e)}var u=l[i+t];return Z(e,o,n)})))}if(!e)return t();var a=[],o=[],s=[0],l=[],u=Z(e,i,n),c=t(a)||Function.noop;return Ct(function(){c(),wt(o),u()})}),n)}}function L(){return At(d(Array.prototype.slice.call(arguments)))}function j(e,t){var n=jt(e,t),r=l(n,Rt);return mt(r,Boolean)}function A(e,t){var n=mt(t,kt.not),r=jt(e,n),i=l(r,Rt);return mt(i,kt.not)}function R(e,t){var n=I(e,t);return Nt(n)}function I(e,t){var n=P(t),r=C(e,n);return function(e,t){return r(Et(function(n,r){function i(e,t){t.forEach(function(e){var t=a.get(e[1]);1===t.length?a["delete"](e[1]):t["delete"](e[0])}),e.forEach(function(e){var t,n=!a.has(e[1]);t=n?r.constructClone():a.get(e[1]),t.add(e[0]),n&&a.set(e[1],t)
})}if(!n)return e();var a=Tt(),o=Z(n,i,t),s=e(a)||Function.noop;return function(){o(),s()}}),t)}}function z(e,t,n){function r(e,t){return Object.compare(e[1],t[1])*n}var i=P(t),a=C(e,i);return function(e,t){return a(Et(function(n){function i(e,t){o.addEach(e),o.deleteEach(t)}function a(t,n){return 0===n?t?e(t[0]):e():void 0}if(!n)return e();var o=new Pt(null,S,r),s=Z(n,i,t),l=ot(o,a,t);return function(){s(),l()}}),t)}}function B(e,t){return z(e,t,1)}function N(e,t){return z(e,t,-1)}function F(e){return z(e,r,1)}function q(e){return z(e,r,-1)}function W(e){return function(t){return function(n,r){return n=yt(n),t(Et(function(t){if(!t)return n();var i=e(t,n);return Z(t,function(e,t,r){return n(i(e,t,r))},r)}),r)}}}function U(e){return"number"==typeof e&&!isNaN(e)}function V(e,t,n){return n||(n=t,t=It),function(r,i){return e(Et(function(e){function a(t,n,r){if(h){var i=t.length-n.length;s>=r?i>0?(c.swap(0,0,e.slice(s,s+i)),c.splice(o,c.length-o)):(c.splice(0,-i),c.swap(c.length,0,e.slice(s+c.length,s+o))):s+o>r&&(c.swap(r-s,n.length,t),i>0?c.splice(o,c.length-o):c.swap(c.length,0,e.slice(s+c.length,s+o)))}}if(!e)return r();var o,s,l,u,c=[],h=!1,d=Z(e,a,i),p=n(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof t&&"number"==typeof s,r=Math.max(0,t);"number"==typeof u&&(r=Math.min(r,e.length-u)),h!==n?(n?c.swap(0,0,e.slice(u,u+r)):c.clear(),h=n):h&&l!==r&&(l>r?c.splice(t,l-r):c.swap(l,0,e.slice(u+l,u+r))),o=t,l=r},i),f=t(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof o&&"number"==typeof t,r=Math.max(0,t);"number"==typeof o&&(r=Math.min(r,e.length));var i=Math.max(0,o);if("number"==typeof r&&(i=Math.min(i,e.length-r)),h!==n)n?c.swap(0,c.length,e.slice(r,r+i)):c.clear(),h=n;else if(h&&u!==r){var a=Math.abs(r-u);l>a&&u>r?(c.swap(0,0,e.slice(r,u)),c.splice(i,c.length-i)):l>a&&r>u?(c.swap(c.length,0,e.slice(u+l,r+i)),c.splice(0,c.length-i)):c.swap(0,c.length,e.slice(r,r+i))}s=t,u=r,l=i},i),m=r(c)||Function.noop;return function(){m(),p(),f(),d()}}),i)}}function H(e){return function(t,n){return e(Et(function(e){function r(e){for(;a.length>e;e++)a[e].set(0,e)}function i(e,t,n){a.swap(n,t.length,e.map(function(e,t){return[n+t,e]})),r(n+e.length)}if(!e)return t();var a=[],o=Z(e,i,n),s=t(a)||Function.noop;return function(){s(),o()}}),n)}}function Y(e){return function(t,n){var r=[],i=t(r)||Function.noop,a=e(function(e){if(e>>>=0,null==e)r.clear();else if(e>r.length){for(var t=[],n=r.length;e>n;n++)t.push(n);r.swap(r.length,0,t)}else r.length>e&&r.splice(e,r.length)},n);return function(){i(),a()}}}function G(e,t){return function(n,r){return t(function(t){var i=RegExp("^"+RegExp.escape(t));return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function X(e,t){return function(n,r){return t(function(t){var i=RegExp(RegExp.escape(t)+"$");return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function K(e,t){return function(n,r){return t(function(t){var i=RegExp(RegExp.escape(t));return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function J(e,t){return t=t||zt,function(n,r){return e(Et(function(e){return e?t(Et(function(t){function i(){a=n(e.join(t))||Function.noop}if("string"!=typeof t)return n()||Function.noop;var a=Function.noop,o=Z(e,i,r);return function(){o(),a()}}),r):n()||Function.noop}),r)}}function Z(e,t,n){function r(e,n,r){i(),i=t(e,n,r)||Function.noop}if(e){var i=Function.noop;if(e.toArray&&e.addRangeChangeListener){r(e.toArray(),[],0);var a=e.addRangeChangeListener(r,null,n.beforeChange);return Ct(function(){i(),a()})}}}function $(e){return function(t,n){return e(Et(function(e){return Bt(e,t,n)}),n)}}function Q(e,t,n){function r(n,r,s){if(i+=n.length-r.length,!(i>s+r.length&&i>s+n.length)){var l=0>i?null:e.get(i);a(),a=t(l)||Function.noop,o=l}}var i=-1,a=Function.noop,o=null,s=Z(e,r,n);return function(){a(),s()}}function et(e){return function(t,n){return e(Et(yt(function(e){return tt(e,t,n)})),n)}}function tt(e,t,n){function r(n,r){return i+=n.length-r.length,1===i?t(e.only()):t()}var i=0;return Z(e,r,n)}function nt(e){return function(t,n){return e(Et(yt(function(e){return rt(e,t,n)})),n)}}function rt(e,t,n){function r(n,r){return i+=n.length-r.length,i>0?t(e.one()):t()}var i=0;return Z(e,r,n)}function it(e){return function(t,n){return e(Et(function(e){return e&&e.addRangeChangeListener?Z(e,function(){return t(e)},n):t(e)}),n)}}function at(e){return function(t,n){return e(Et(function(e){return e&&e.addMapChangeListener?ot(e,function(){return t(e)},n):t(e)}),n)}}function ot(e,t,n){function r(e,n,r){var a=i.get(n)||Function.noop;i["delete"](n),a(),a=t(e,n,r)||Function.noop,void 0===e?a():i.set(n,a)}if(e.addMapChangeListener){var i=new Tt;e.forEach(r);var a=e.addMapChangeListener(r,n.beforeChange);return Ct(function(){i.forEach(function(e){e()}),a()})}}function st(e){return function(t,n){return e(Et(function(e){return e?lt(e,t,n):t()}),n)}}function lt(e,t,n){function r(e,t){var n,r;a.has(t)?null==e?(n=a.get(t),a["delete"](t),r=i.indexOf(n),i.splice(r,1)):(n=a.get(t),n.set(1,e)):(n=[t,e],a.set(t,n),i.push(n))}var i=[],a=Tt(),o=t(i)||Function.noop,s=ot(e,r,n)||Function.noop;return Ct(function(){o(),s()})}function ut(e){var t=Nt(e);return Lt(t,ct)}function ct(e,t){return t.value?e(t.value[0])||Function.noop:e()}function ht(e){var t=Nt(e);return Lt(t,dt)}function dt(e,t){return t.value?e(t.value[1])||Function.noop:e()}function pt(e){return function(t,n){var r=new Tt,i=t(r)||Function.noop,a=e(Et(function(e){function t(e,t){void 0===e?r["delete"](t):r.set(t,e)}if(r.clear(),e&&"object"==typeof e){if(e.addRangeChangeListener)return Ft(Et(function(e){function t(e,t){t.forEach(function(e){r["delete"](e[0])}),e.forEach(function(e){r.set(e[0],e[1])})}return Z(e,t,n)}),n.nest(e));if(e.addMapChangeListener)return ot(e,t,n);var i=Object.keys(e).map(function(t){return Dt(e,t,Et(function(e){void 0===e?r["delete"](t):r.set(t,e)}),n)});return function(){wt(i)}}}),n);return function(){i(),a()}}}function ft(e){return function(t,n){return e(t,n.parent||n.nest())}}function mt(e,t,n){return function(r,i){return r=yt(r),e(Et(function(e){return r(t.call(n,e))}),i)}}function vt(e,t,n){return function(r,i){return r=yt(r),e(Et(function(e){return e&&e.every(kt.defined)?r(t.apply(n,e)):void 0}),i)}}function gt(t,n){var r=e("./parse"),i=e("./compile-observer");return function(e,a){return e=yt(e),n(Et(function(n){if(null==n)return e();var o,s;try{o=r(n),s=i(o)}catch(l){return e()}return t(Et(function(t){return s(e,a.nest(t))}),a)}),a)}}function bt(e,t){return function(n,r){return e(Et(function(e){return t(Et(function(e){return n(e)}),r.nest(e))}),r)}}function _t(e){return function(){var t=e.apply(this,arguments);return function(e,n){var r=[],i=t(Et(function(e){function t(e,t,n){r.swap(n,t.length,e)}if(e){qt(r,e);var i=e.addRangeChangeListener(t,null,n.beforeChange);return Ct(i)}r.clear()}),n),a=e(r)||Function.noop;return Ct(function(){i(),a()})}}}function yt(e){var t;return function(n){if(n!==t){var r=e.apply(this,arguments);return t=n,r}}}function wt(e){e.forEach(function(e){e&&e()})}function Et(e){var t=Function.noop;return function(){return t(),t=e.apply(this,arguments)||Function.noop,function(){t()}}}function Ct(e){var t;return function(){return t?Function.noop:(t=!0,e.apply(this,arguments))}}e("collections/shim");var xt=e("collections/listen/property-changes");e("collections/listen/array-changes");var Ot=e("collections/sorted-array"),St=e("collections/sorted-set"),Tt=e("collections/map");e("collections/set");var Pt=e("collections/heap");e("./scope");var kt=e("./operators");t.makeLiteralObserver=n,t.observeValue=r,t.observeParameters=i,t.makeElementObserver=a,t.makeComponentObserver=o,t.observeProperty=s;var Dt=s;t.makePropertyObserver=l,t.observeKey=u,t.observeGet=u;var Mt=u;t.makeGetObserver=c,t.makeHasObserver=h,t.makeObserversObserver=d,t.makeRecordObserver=p,t.makeObjectObserver=p,t.makeTupleObserver=f,t.makeArrayObserver=f,t.makeOperatorObserverMaker=m,t.makeMethodObserverMaker=v,t.makeNotObserver=g,t.makeAndObserver=b,t.makeOrObserver=_,t.makeConditionalObserver=y,t.makeDefinedObserver=w,t.makeDefaultObserver=E;var Lt=t.makeMapBlockObserver=_t(C),jt=t.makeFilterBlockObserver=_t(x);t.makeSortedBlockObserver=O,t.makeSortedSetBlockObserver=k,t.makeReversedObserver=_t(D);var At=t.makeFlattenObserver=_t(M);t.makeConcatObserver=L,t.makeSomeBlockObserver=j,t.makeEveryBlockObserver=A,t.makeGroupBlockObserver=R,t.makeGroupMapBlockObserver=I,t.makeMaxBlockObserver=B,t.makeMinBlockObserver=N,t.makeMaxObserver=F,t.makeMinObserver=q;var Rt=n("length");t.makeSumObserver=W(function(){var e=0;return function(t,n){return t=t.filter(U),n=n.filter(U),e+=t.sum()-n.sum()}}),t.makeAverageObserver=W(function(){var e=0,t=0;return function(n,r){return n=n.filter(U),r=r.filter(U),e+=n.sum()-r.sum(),t+=n.length-r.length,e/t}}),t.makeViewObserver=_t(V);var It=n(0);t.makeEnumerateObserver=_t(H),t.makeEnumerationObserver=t.makeEnumerateObserver,t.makeRangeObserver=Y,t.makeStartsWithObserver=G,t.makeEndsWithObserver=X,t.makeContainsObserver=K,t.makeJoinObserver=J;var zt=n("");t.observeRangeChange=Z,t.makeLastObserver=$,t.observeLast=Q;var Bt=Q;t.makeOnlyObserver=et,t.observeOnly=tt,t.makeOneObserver=nt,t.observeOne=rt,t.makeRangeContentObserver=it,t.makeMapContentObserver=at,t.observeMapChange=ot;var Nt=t.makeEntriesObserver=_t(st);t.observeEntries=lt,t.makeKeysObserver=ut,t.observeEntryKey=ct,t.makeValuesObserver=ht,t.observeEntryValue=dt,t.makeToMapObserver=pt;var Ft=Lt(R(r,ct),$(dt));t.makeParentObserver=ft,t.makeConverterObserver=mt,t.makeComputerObserver=vt,t.makePathObserver=gt,t.makeExpressionObserver=gt,t.makeWithObserver=bt,t.makeToArrayObserver=_t(Function.identity),t.makeAsArrayObserver=t.makeToArrayObserver;var qt=e("./merge").merge;t.makeUniq=yt,t.cancelEach=wt,t.autoCancelPrevious=Et,t.once=Ct}}),montageDefine("eabe77a","stringify",{dependencies:["./parse","./language"],factory:function(e,t,n){"use strict";function r(e,t){return r.semantics.stringify(e,t)}function i(e){return function(t,n,r){var i=e+"{"+r(t.args[1],n)+"}";return"value"===t.args[0].type?i:r(t.args[0],n)+"."+i}}e("./parse");var a=e("./language").precedence,o=e("./language").operatorTypes;e("./language").operatorTokens,n.exports=r,r.semantics={makeBlockStringifier:i,stringify:function(e,t,n){function r(e){var n=o(e,t);return n?n:"this"}var i,o=this.stringify.bind(this),s=this.stringifiers;if(s[e.type])i=s[e.type](e,t,o);else if(e.inline)i="&"+e.type+"("+e.args.map(r).join(", ")+")";else{var l;1===e.args.length&&"mapBlock"===e.args[0].type?(l=e.type+"{"+o(e.args[0].args[1],t)+"}",e=e.args[0]):l=e.type+"("+e.args.slice(1).map(r).join(", ")+")",i="value"===e.args[0].type?l:o(e.args[0],t)+"."+l}return!n||n.type===e.type&&"if"!==n.type||a.get(n.type).has(e.type)?i:"("+i+")"},stringifiers:{value:function(){return""},literal:function(e){return"string"==typeof e.value?"'"+e.value.replace("'","\\'")+"'":""+e.value},parameters:function(){return"$"},record:function(e,t,n){return"{"+Object.map(e.args,function(e,r){var i;return i="value"===e.type?"this":n(e,t),r+": "+i}).join(", ")+"}"},tuple:function(e,t,n){return"["+Object.map(e.args,function(e){return"value"===e.type?"this":n(e)}).join(", ")+"]"},component:function(e,t){var n;return t&&t.components&&e.component?t.components.getObjectLabel?n=t.components.getObjectLabel(e.component):t.components.getLabelForObject&&(n=t.components.getLabelForObject(e.component)):n=e.label,"@"+n},element:function(e){return"#"+e.id},mapBlock:i("map"),filterBlock:i("filter"),someBlock:i("some"),everyBlock:i("every"),sortedBlock:i("sorted"),sortedSetBlock:i("sortedSet"),groupBlock:i("group"),groupMapBlock:i("groupMap"),minBlock:i("min"),maxBlock:i("max"),property:function(e,t,n){return"value"===e.args[0].type?"string"==typeof e.args[1].value?e.args[1].value:"literal"===e.args[1].type?"."+e.args[1].value:"this["+n(e.args[1],t)+"]":"parameters"===e.args[0].type?"$"+e.args[1].value:"literal"===e.args[1].type&&/^[\w\d_]+$/.test(e.args[1].value)?n(e.args[0],t,{type:"scope"})+"."+e.args[1].value:n(e.args[0],{type:"scope"},t)+"["+n(e.args[1],t)+"]"},"with":function(e,t,n){var r=n(e.args[1],t,e);return n(e.args[0],t)+"."+r},not:function(e,t,n){return"equals"===e.args[0].type?n(e.args[0].args[0],t,{type:"equals"})+" != "+n(e.args[0].args[1],t,{type:"equals"}):"!"+n(e.args[0],t,e)},neg:function(e,t,n){return"-"+n(e.args[0],t,e)},toNumber:function(e,t,n){return"+"+n(e.args[0],t,e)},parent:function(e,t,n){return"^"+n(e.args[0],t,e)},"if":function(e,t,n){return n(e.args[0],t,e)+" ? "+n(e.args[1],t)+" : "+n(e.args[2],t)},event:function(e,t,n){return e.when+" "+e.event+" -> "+n(e.listener,t)},binding:function(e,t,n,r){var i=r(t.args[0],n)+" "+e+" "+r(t.args[1],n),a="",o=t.descriptor;if(o)for(var s in o)a+=", "+s+": "+r(o[s],n);return i+a},bind:function(e,t,n){return this.binding("<-",e,t,n)},bind2:function(e,t,n){return this.binding("<->",e,t,n)},assign:function(e,t,n){return n(e.args[0],t)+": "+n(e.args[1],t)},block:function(e,t,n){var r="@"+e.label;return e.connection&&("prototype"===e.connection?r+=" < ":"object"===e.connection&&(r+=" : "),r+=n({type:"literal",value:e.module}),e.exports&&"value"!==e.exports.type&&(r+=" "+n(e.exports,t))),r+" {\n"+e.statements.map(function(e){return"    "+n(e,t)+";\n"}).join("")+"}\n"},sheet:function(e,t,n){return"\n"+e.blocks.map(function(e){return n(e,t)}).join("\n")+"\n"}}},o.forEach(function(e,t){r.semantics.stringifiers[t]=function(t,n,r){return t.args.map(function(e){return r(e,n,t)}).join(" "+e+" ").trim()}})}}),montageDefine("eabe77a","expand",{dependencies:["collections/set","collections/map","./operators"],factory:function(e,t,n){function r(e,t){var n=r.semantics.expand.bind(r.semantics);return n(e,t,n)}var i=e("collections/set"),a=e("collections/map");e("./operators"),n.exports=r,r.semantics={reflexive:i(["literal","element","rangeContent","mapContent"]),traverseLeft:i(["with","mapBlock","filterBlock","someBlock","everyBlock","sortedBlock","groupBlock","groupMapBlock"]),expanders:a({value:function(e,t){return t.value||{type:"value"}},parameters:function(e,t){return t.parameters||{type:"parameters"}},record:function(e,t,n){var r={type:"record",args:[]};for(var i in e.args)r.args[i]=n(e.args[i],t,n);return r},component:function(e,t){return t.components&&e.component?{type:"component",label:t.components.getObjectLabel(e.component)}:e}}),expand:function(e,t,n){return this.expanders.has(e.type)?this.expanders.get(e.type)(e,t,n):this.traverseLeft.has(e.type)?{type:e.type,args:[n(e.args[0],t,n)].concat(e.args.slice(1))}:this.reflexive.has(e.type)?e:{type:e.type,args:e.args.map(function(e){return n(e,t,n)})}}}}}),montageDefine("eabe77a","bindings",{dependencies:["collections/map","./bind","./compute","./observe"],factory:function(e,t){function n(e,t,n){if(t)for(var i in t)r(e,i,t[i],n);return e}function r(e,n,r,a){a=a||Object.empty;var o=i(e);if(d.call(o,n))throw Error("Can't bind to already bound target, "+JSON.stringify(n));return"<-"in r||"<->"in r||"compute"in r?(r.target=e,r.parameters=r.parameters||a.parameters,r.document=r.document||a.document,r.components=r.components||a.components,r.cancel="compute"in r?c(e,n,r):u(e,n,r),o[n]=r,t.count++):("get"in r||"set"in r||"writable"in r||(r.writable=!0),"configurable"in r||(r.configurable=!0),"enumerable"in r||(r.enumerable=!0),Object.defineProperty(e,n,r)),e}function i(e){return h.has(e)||h.set(e,{}),h.get(e)}function a(e,t){var n=i(e);return n[t]}function o(e){var t=i(e);for(var n in t)s(e,n)}function s(e,n){var r=i(e);if(!r[n])throw Error("Can't cancel non-existent binding to "+JSON.stringify(n));var a=r[n];if(a&&a.cancel){a.cancel(),delete r[n],t.count--;for(var n in r)return;h["delete"](e)}}var l=e("collections/map"),u=e("./bind"),c=e("./compute");e("./observe");var h=new l,d=Object.prototype.hasOwnProperty;t.count=0,t.bindings=h,t.defineBindings=n,t.defineBinding=r,t.getBindings=i,t.getBinding=a,t.cancelBindings=o,t.cancelBinding=s}}),montageDefine("eabe77a","grammar",{dependencies:[],factory:function(e,t,n){n.exports=function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,r,i){function a(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r,i;switch(e.length){case 0:r="end of input";break;case 1:r=e[0];break;default:r=e.slice(0,-1).join(", ")+" or "+e[e.length-1]}return i=t?'"'+n(t)+'"':"end of input","Expected "+r+" but "+i+" found."}this.expected=e,this.found=t,this.offset=n,this.line=r,this.column=i,this.name="SyntaxError",this.message=a(e,t)}function n(e){function n(t){function n(t,n,r){var i,a;for(i=n;r>i;i++)a=e.charAt(i),"\n"===a?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===a||"\u2028"===a||"\u2029"===a?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return Hi!==t&&(Hi>t&&(Hi=0,Yi={line:1,column:1,seenCR:!1}),n(Yi,Hi,t),Hi=t),Yi}function r(e){Gi>Ui||(Ui>Gi&&(Gi=Ui,Xi=[]),Xi.push(e))}function i(e){var t=0;for(e.sort();e.length>t;)e[t-1]===e[t]?e.splice(t,1):t++}function a(){var e,t;return Ki++,e=l(),Ki--,null===e&&(t=null,0===Ki&&r(Q)),e}function o(){var t,n,i,o,s,l,u;if(t=Ui,n=a(),null!==n){for(i=[],o=Ui,44===e.charCodeAt(Ui)?(s=tt,Ui++):(s=null,0===Ki&&r(nt)),null!==s?(l=F(),null!==l?(u=a(),null!==u?(s=[s,l,u],o=s):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et);null!==o;)i.push(o),o=Ui,44===e.charCodeAt(Ui)?(s=tt,Ui++):(s=null,0===Ki&&r(nt)),null!==s?(l=F(),null!==l?(u=a(),null!==u?(s=[s,l,u],o=s):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et);null!==i?(Vi=t,n=rt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function s(){var t,n,i,a;return t=Ui,40===e.charCodeAt(Ui)?(n=it,Ui++):(n=null,0===Ki&&r(at)),null!==n?(i=F(),null!==i?(41===e.charCodeAt(Ui)?(a=ot,Ui++):(a=null,0===Ki&&r(st)),null!==a?(Vi=t,n=lt(),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,40===e.charCodeAt(Ui)?(n=it,Ui++):(n=null,0===Ki&&r(at)),null!==n?(i=o(),null!==i?(41===e.charCodeAt(Ui)?(a=ot,Ui++):(a=null,0===Ki&&r(st)),null!==a?(Vi=t,n=ut(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)),t}function l(){var t,n,i,o,s,l,c,h,d,p,f;return t=Ui,n=u(),null!==n?(i=F(),null!==i?(o=Ui,63===e.charCodeAt(Ui)?(s=ht,Ui++):(s=null,0===Ki&&r(dt)),null!==s?(l=F(),null!==l?(c=a(),null!==c?(h=F(),null!==h?(58===e.charCodeAt(Ui)?(d=pt,Ui++):(d=null,0===Ki&&r(ft)),null!==d?(p=F(),null!==p?(f=a(),null!==f?(s=[s,l,c,h,d,p,f],o=s):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et),null===o&&(o=ct),null!==o?(Vi=t,n=mt(n,o),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),t}function u(){var t,n,i,a,o,s,l,u;if(t=Ui,n=c(),null!==n){for(i=[],a=Ui,o=F(),null!==o?(e.substr(Ui,2)===vt?(s=vt,Ui+=2):(s=null,0===Ki&&r(gt)),null!==s?(l=F(),null!==l?(u=c(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==a;)i.push(a),a=Ui,o=F(),null!==o?(e.substr(Ui,2)===vt?(s=vt,Ui+=2):(s=null,0===Ki&&r(gt)),null!==s?(l=F(),null!==l?(u=c(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==i?(Vi=t,n=bt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function c(){var t,n,i,a,o,s,l,u;if(t=Ui,n=h(),null!==n){for(i=[],a=Ui,o=F(),null!==o?(e.substr(Ui,2)===_t?(s=_t,Ui+=2):(s=null,0===Ki&&r(yt)),null!==s?(l=F(),null!==l?(u=h(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==a;)i.push(a),a=Ui,o=F(),null!==o?(e.substr(Ui,2)===_t?(s=_t,Ui+=2):(s=null,0===Ki&&r(yt)),null!==s?(l=F(),null!==l?(u=h(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==i?(Vi=t,n=bt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function h(){var t,n,i,a,o,s,l,u,c;return t=Ui,n=d(),null!==n?(i=Ui,a=F(),null!==a?(o=Ui,e.substr(Ui,3)===wt?(s=wt,Ui+=3):(s=null,0===Ki&&r(Et)),null===s&&(e.substr(Ui,2)===Ct?(s=Ct,Ui+=2):(s=null,0===Ki&&r(xt)),null===s&&(e.substr(Ui,2)===Ot?(s=Ot,Ui+=2):(s=null,0===Ki&&r(St)),null===s&&(s=Ui,60===e.charCodeAt(Ui)?(l=Tt,Ui++):(l=null,0===Ki&&r(Pt)),null!==l?(u=Ui,Ki++,45===e.charCodeAt(Ui)?(c=kt,Ui++):(c=null,0===Ki&&r(Dt)),Ki--,null===c?u=ct:(Ui=u,u=et),null!==u?(l=[l,u],s=l):(Ui=s,s=et)):(Ui=s,s=et),null===s&&(62===e.charCodeAt(Ui)?(s=Mt,Ui++):(s=null,0===Ki&&r(Lt)),null===s&&(e.substr(Ui,2)===jt?(s=jt,Ui+=2):(s=null,0===Ki&&r(At)),null===s&&(e.substr(Ui,2)===Rt?(s=Rt,Ui+=2):(s=null,0===Ki&&r(It)))))))),null!==s&&(s=e.substring(o,Ui)),o=s,null!==o?(s=F(),null!==s?(l=d(),null!==l?(a=[a,o,s,l],i=a):(Ui=i,i=et)):(Ui=i,i=et)):(Ui=i,i=et)):(Ui=i,i=et),null===i&&(i=ct),null!==i?(Vi=t,n=zt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),t}function d(){var t,n,i,a,o,s,l,u;if(t=Ui,n=p(),null!==n){for(i=[],a=Ui,o=F(),null!==o?(s=Ui,43===e.charCodeAt(Ui)?(l=Bt,Ui++):(l=null,0===Ki&&r(Nt)),null===l&&(45===e.charCodeAt(Ui)?(l=kt,Ui++):(l=null,0===Ki&&r(Dt))),null!==l&&(l=e.substring(s,Ui)),s=l,null!==s?(l=F(),null!==l?(u=p(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==a;)i.push(a),a=Ui,o=F(),null!==o?(s=Ui,43===e.charCodeAt(Ui)?(l=Bt,Ui++):(l=null,0===Ki&&r(Nt)),null===l&&(45===e.charCodeAt(Ui)?(l=kt,Ui++):(l=null,0===Ki&&r(Dt))),null!==l&&(l=e.substring(s,Ui)),s=l,null!==s?(l=F(),null!==l?(u=p(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==i?(Vi=t,n=bt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function p(){var t,n,i,a,o,s,l,u;if(t=Ui,n=f(),null!==n){for(i=[],a=Ui,o=F(),null!==o?(s=Ui,42===e.charCodeAt(Ui)?(l=Ft,Ui++):(l=null,0===Ki&&r(qt)),null===l&&(47===e.charCodeAt(Ui)?(l=Wt,Ui++):(l=null,0===Ki&&r(Ut)),null===l&&(37===e.charCodeAt(Ui)?(l=Vt,Ui++):(l=null,0===Ki&&r(Ht)),null===l&&(e.substr(Ui,3)===Yt?(l=Yt,Ui+=3):(l=null,0===Ki&&r(Gt))))),null!==l&&(l=e.substring(s,Ui)),s=l,null!==s?(l=F(),null!==l?(u=f(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==a;)i.push(a),a=Ui,o=F(),null!==o?(s=Ui,42===e.charCodeAt(Ui)?(l=Ft,Ui++):(l=null,0===Ki&&r(qt)),null===l&&(47===e.charCodeAt(Ui)?(l=Wt,Ui++):(l=null,0===Ki&&r(Ut)),null===l&&(37===e.charCodeAt(Ui)?(l=Vt,Ui++):(l=null,0===Ki&&r(Ht)),null===l&&(e.substr(Ui,3)===Yt?(l=Yt,Ui+=3):(l=null,0===Ki&&r(Gt))))),null!==l&&(l=e.substring(s,Ui)),s=l,null!==s?(l=F(),null!==l?(u=f(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==i?(Vi=t,n=bt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function f(){var t,n,i,a,o,s,l,u;if(t=Ui,n=m(),null!==n){for(i=[],a=Ui,o=F(),null!==o?(s=Ui,e.substr(Ui,2)===Xt?(l=Xt,Ui+=2):(l=null,0===Ki&&r(Kt)),null===l&&(e.substr(Ui,2)===Jt?(l=Jt,Ui+=2):(l=null,0===Ki&&r(Zt)),null===l&&(e.substr(Ui,2)===$t?(l=$t,Ui+=2):(l=null,0===Ki&&r(Qt)))),null!==l&&(l=e.substring(s,Ui)),s=l,null!==s?(l=F(),null!==l?(u=m(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==a;)i.push(a),a=Ui,o=F(),null!==o?(s=Ui,e.substr(Ui,2)===Xt?(l=Xt,Ui+=2):(l=null,0===Ki&&r(Kt)),null===l&&(e.substr(Ui,2)===Jt?(l=Jt,Ui+=2):(l=null,0===Ki&&r(Zt)),null===l&&(e.substr(Ui,2)===$t?(l=$t,Ui+=2):(l=null,0===Ki&&r(Qt)))),null!==l&&(l=e.substring(s,Ui)),s=l,null!==s?(l=F(),null!==l?(u=m(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==i?(Vi=t,n=bt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function m(){var t,n,i,a,o,s,l,u;if(t=Ui,n=v(),null!==n){for(i=[],a=Ui,o=F(),null!==o?(e.substr(Ui,2)===en?(s=en,Ui+=2):(s=null,0===Ki&&r(tn)),null!==s?(l=F(),null!==l?(u=v(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==a;)i.push(a),a=Ui,o=F(),null!==o?(e.substr(Ui,2)===en?(s=en,Ui+=2):(s=null,0===Ki&&r(tn)),null!==s?(l=F(),null!==l?(u=v(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==i?(Vi=t,n=bt(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function v(){var t,n,i;return t=Ui,n=Ui,33===e.charCodeAt(Ui)?(i=nn,Ui++):(i=null,0===Ki&&r(rn)),null===i&&(43===e.charCodeAt(Ui)?(i=Bt,Ui++):(i=null,0===Ki&&r(Nt)),null===i&&(45===e.charCodeAt(Ui)?(i=kt,Ui++):(i=null,0===Ki&&r(Dt)))),null!==i&&(i=e.substring(n,Ui)),n=i,null!==n?(i=v(),null!==i?(Vi=t,n=an(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=g()),t}function g(){var e,t,n,r;if(e=Ui,t=y(),null!==t){for(n=[],r=b();null!==r;)n.push(r),r=b();null!==n?(Vi=e,t=on(t,n),null===t?(Ui=e,e=t):e=t):(Ui=e,e=et)}else Ui=e,e=et;return e}function b(){var t,n,i,o;return t=Ui,46===e.charCodeAt(Ui)?(n=sn,Ui++):(n=null,0===Ki&&r(ln)),null!==n?(i=_(),null!==i?(Vi=t,n=un(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,91===e.charCodeAt(Ui)?(n=cn,Ui++):(n=null,0===Ki&&r(hn)),null!==n?(i=a(),null!==i?(93===e.charCodeAt(Ui)?(o=dn,Ui++):(o=null,0===Ki&&r(pn)),null!==o?(Vi=t,n=fn(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)),t}function _(){var t,n,i,o,l;return t=Ui,n=Ui,i=w(),null!==i&&(i=e.substring(n,Ui)),n=i,null!==n?(123===e.charCodeAt(Ui)?(i=mn,Ui++):(i=null,0===Ki&&r(vn)),null!==i?(o=a(),null!==o?(125===e.charCodeAt(Ui)?(l=gn,Ui++):(l=null,0===Ki&&r(bn)),null!==l?(Vi=t,n=_n(n,o),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,n=Ui,i=w(),null!==i&&(i=e.substring(n,Ui)),n=i,null!==n?(i=s(),null!==i?(Vi=t,n=yn(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,n=I(),null!==n&&(Vi=t,n=wn(n)),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,n=Ui,i=w(),null!==i&&(i=e.substring(n,Ui)),n=i,null!==n&&(Vi=t,n=En(n)),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,n=T(),null!==n&&(Vi=t,n=Cn(n)),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,n=P(),null!==n&&(Vi=t,n=Cn(n)),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,40===e.charCodeAt(Ui)?(n=it,Ui++):(n=null,0===Ki&&r(at)),null!==n?(i=a(),null!==i?(41===e.charCodeAt(Ui)?(o=ot,Ui++):(o=null,0===Ki&&r(st)),null!==o?(Vi=t,n=Cn(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et))))))),t}function y(){var t,n,i,o;return t=T(),null===t&&(t=P(),null===t&&(t=E(),null===t&&(t=M(),null===t&&(t=Ui,e.substr(Ui,4)===xn?(n=xn,Ui+=4):(n=null,0===Ki&&r(On)),null!==n&&(Vi=t,n=Sn()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,4)===Tn?(n=Tn,Ui+=4):(n=null,0===Ki&&r(Pn)),null!==n&&(Vi=t,n=kn()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,5)===Dn?(n=Dn,Ui+=5):(n=null,0===Ki&&r(Mn)),null!==n&&(Vi=t,n=Ln()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,4)===jn?(n=jn,Ui+=4):(n=null,0===Ki&&r(An)),null!==n&&(Vi=t,n=Rn()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,64===e.charCodeAt(Ui)?(n=In,Ui++):(n=null,0===Ki&&r(zn)),null!==n?(i=Ui,o=Y(),null!==o&&(o=e.substring(i,Ui)),i=o,null!==i?(Vi=t,n=Bn(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,36===e.charCodeAt(Ui)?(n=Nn,Ui++):(n=null,0===Ki&&r(Fn)),null!==n?(i=Ui,o=w(),null!==o&&(o=e.substring(i,Ui)),i=o,null!==i?(Vi=t,n=qn(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,36===e.charCodeAt(Ui)?(n=Nn,Ui++):(n=null,0===Ki&&r(Fn)),null!==n&&(Vi=t,n=Wn()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,35===e.charCodeAt(Ui)?(n=Un,Ui++):(n=null,0===Ki&&r(Vn)),null!==n?(i=Ui,o=w(),null!==o&&(o=e.substring(i,Ui)),i=o,null!==i?(Vi=t,n=Hn(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,38===e.charCodeAt(Ui)?(n=Yn,Ui++):(n=null,0===Ki&&r(Gn)),null!==n?(i=Ui,o=w(),null!==o&&(o=e.substring(i,Ui)),i=o,null!==i?(o=s(),null!==o?(Vi=t,n=Xn(i,o),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,94===e.charCodeAt(Ui)?(n=Kn,Ui++):(n=null,0===Ki&&r(Jn)),null!==n?(i=y(),null!==i?(Vi=t,n=Zn(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,40===e.charCodeAt(Ui)?(n=it,Ui++):(n=null,0===Ki&&r(at)),null!==n?(i=a(),null!==i?(41===e.charCodeAt(Ui)?(o=ot,Ui++):(o=null,0===Ki&&r(st)),null!==o?(Vi=t,n=$n(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,n=_(),null!==n&&(Vi=t,n=Qn(n)),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,n=[],null!==n&&(Vi=t,n=er()),null===n?(Ui=t,t=n):t=n)))))))))))))))),t}function w(){var t,n;if(Ki++,t=[],nr.test(e.charAt(Ui))?(n=e.charAt(Ui),Ui++):(n=null,0===Ki&&r(rr)),null!==n)for(;null!==n;)t.push(n),nr.test(e.charAt(Ui))?(n=e.charAt(Ui),Ui++):(n=null,0===Ki&&r(rr));else t=et;return Ki--,null===t&&(n=null,0===Ki&&r(tr)),t}function E(){var t,n,i,a;if(Ki++,t=Ui,39===e.charCodeAt(Ui)?(n=ar,Ui++):(n=null,0===Ki&&r(or)),null!==n){for(i=[],a=C();null!==a;)i.push(a),a=C();null!==i?(39===e.charCodeAt(Ui)?(a=ar,Ui++):(a=null,0===Ki&&r(or)),null!==a?(Vi=t,n=sr(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)}else Ui=t,t=et;if(null===t)if(t=Ui,34===e.charCodeAt(Ui)?(n=lr,Ui++):(n=null,0===Ki&&r(ur)),null!==n){for(i=[],a=x();null!==a;)i.push(a),a=x();null!==i?(34===e.charCodeAt(Ui)?(a=lr,Ui++):(a=null,0===Ki&&r(ur)),null!==a?(Vi=t,n=sr(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)}else Ui=t,t=et;return Ki--,null===t&&(n=null,0===Ki&&r(ir)),t}function C(){var t,n;return cr.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(hr)),null===t&&(t=Ui,e.substr(Ui,2)===dr?(n=dr,Ui+=2):(n=null,0===Ki&&r(pr)),null!==n&&(Vi=t,n=fr()),null===n?(Ui=t,t=n):t=n,null===t&&(t=O())),t}function x(){var t,n;return mr.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(vr)),null===t&&(t=Ui,e.substr(Ui,2)===gr?(n=gr,Ui+=2):(n=null,0===Ki&&r(br)),null!==n&&(Vi=t,n=_r()),null===n?(Ui=t,t=n):t=n,null===t&&(t=O())),t}function O(){var t,n,i,a,o,s,l,u;return t=Ui,e.substr(Ui,2)===yr?(n=yr,Ui+=2):(n=null,0===Ki&&r(wr)),null!==n&&(Vi=t,n=Er()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===Cr?(n=Cr,Ui+=2):(n=null,0===Ki&&r(xr)),null!==n&&(Vi=t,n=Or()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===Sr?(n=Sr,Ui+=2):(n=null,0===Ki&&r(Tr)),null!==n&&(Vi=t,n=Pr()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===kr?(n=kr,Ui+=2):(n=null,0===Ki&&r(Dr)),null!==n&&(Vi=t,n=Mr()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===Lr?(n=Lr,Ui+=2):(n=null,0===Ki&&r(jr)),null!==n&&(Vi=t,n=Ar()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===Rr?(n=Rr,Ui+=2):(n=null,0===Ki&&r(Ir)),null!==n&&(Vi=t,n=zr()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===Br?(n=Br,Ui+=2):(n=null,0===Ki&&r(Nr)),null!==n&&(Vi=t,n=Fr()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===qr?(n=qr,Ui+=2):(n=null,0===Ki&&r(Wr)),null!==n&&(Vi=t,n=Ur()),null===n?(Ui=t,t=n):t=n,null===t&&(t=Ui,e.substr(Ui,2)===Vr?(n=Vr,Ui+=2):(n=null,0===Ki&&r(Hr)),null!==n?(i=Ui,a=Ui,o=S(),null!==o?(s=S(),null!==s?(l=S(),null!==l?(u=S(),null!==u?(o=[o,s,l,u],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et),null!==a&&(a=e.substring(i,Ui)),i=a,null!==i?(Vi=t,n=Yr(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et))))))))),t}function S(){var t;return Gr.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(Xr)),t}function T(){var t,n,i,a;return t=Ui,91===e.charCodeAt(Ui)?(n=cn,Ui++):(n=null,0===Ki&&r(hn)),null!==n?(i=F(),null!==i?(93===e.charCodeAt(Ui)?(a=dn,Ui++):(a=null,0===Ki&&r(pn)),null!==a?(Vi=t,n=Kr(),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,91===e.charCodeAt(Ui)?(n=cn,Ui++):(n=null,0===Ki&&r(hn)),null!==n?(i=o(),null!==i?(93===e.charCodeAt(Ui)?(a=dn,Ui++):(a=null,0===Ki&&r(pn)),null!==a?(Vi=t,n=Jr(i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)),t}function P(){var t,n,i,a,o,s;return t=Ui,123===e.charCodeAt(Ui)?(n=mn,Ui++):(n=null,0===Ki&&r(vn)),null!==n?(i=F(),null!==i?(125===e.charCodeAt(Ui)?(a=gn,Ui++):(a=null,0===Ki&&r(bn)),null!==a?(o=F(),null!==o?(Vi=t,n=Zr(),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,123===e.charCodeAt(Ui)?(n=mn,Ui++):(n=null,0===Ki&&r(vn)),null!==n?(i=F(),null!==i?(a=k(),null!==a?(125===e.charCodeAt(Ui)?(o=gn,Ui++):(o=null,0===Ki&&r(bn)),null!==o?(s=F(),null!==s?(Vi=t,n=$r(a),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)),t
}function k(){var t,n,i,a,o,s,l;if(t=Ui,n=D(),null!==n){for(i=[],a=Ui,44===e.charCodeAt(Ui)?(o=tt,Ui++):(o=null,0===Ki&&r(nt)),null!==o?(s=F(),null!==s?(l=D(),null!==l?(o=[o,s,l],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==a;)i.push(a),a=Ui,44===e.charCodeAt(Ui)?(o=tt,Ui++):(o=null,0===Ki&&r(nt)),null!==o?(s=F(),null!==s?(l=D(),null!==l?(o=[o,s,l],a=o):(Ui=a,a=et)):(Ui=a,a=et)):(Ui=a,a=et);null!==i?(Vi=t,n=Qr(n,i),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function D(){var t,n,i,o,s;return t=Ui,n=Ui,i=w(),null!==i&&(i=e.substring(n,Ui)),n=i,null!==n?(58===e.charCodeAt(Ui)?(i=pt,Ui++):(i=null,0===Ki&&r(ft)),null!==i?(o=F(),null!==o?(s=a(),null!==s?(Vi=t,n=ei(n,s),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),t}function M(){var t,n,i;return Ki++,t=Ui,n=Ui,i=L(),null!==i&&(i=e.substring(n,Ui)),n=i,null!==n&&(Vi=t,n=ni(n)),null===n?(Ui=t,t=n):t=n,Ki--,null===t&&(n=null,0===Ki&&r(ti)),t}function L(){var e,t,n,r;return e=Ui,t=j(),null!==t?(n=A(),null!==n?(r=R(),null!==r?(t=[t,n,r],e=t):(Ui=e,e=et)):(Ui=e,e=et)):(Ui=e,e=et),null===e&&(e=Ui,t=j(),null!==t?(n=A(),null!==n?(t=[t,n],e=t):(Ui=e,e=et)):(Ui=e,e=et),null===e&&(e=Ui,t=j(),null!==t?(n=R(),null!==n?(t=[t,n],e=t):(Ui=e,e=et)):(Ui=e,e=et),null===e&&(e=j()))),e}function j(){var t,n,i,a;return t=Ui,n=N(),null!==n?(i=I(),null!==i?(n=[n,i],t=n):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=B(),null===t&&(t=Ui,45===e.charCodeAt(Ui)?(n=kt,Ui++):(n=null,0===Ki&&r(Dt)),null!==n?(i=N(),null!==i?(a=I(),null!==a?(n=[n,i,a],t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,45===e.charCodeAt(Ui)?(n=kt,Ui++):(n=null,0===Ki&&r(Dt)),null!==n?(i=B(),null!==i?(n=[n,i],t=n):(Ui=t,t=et)):(Ui=t,t=et)))),t}function A(){var t,n,i;return t=Ui,46===e.charCodeAt(Ui)?(n=sn,Ui++):(n=null,0===Ki&&r(ln)),null!==n?(i=I(),null!==i?(n=[n,i],t=n):(Ui=t,t=et)):(Ui=t,t=et),t}function R(){var e,t,n;return e=Ui,t=z(),null!==t?(n=I(),null!==n?(t=[t,n],e=t):(Ui=e,e=et)):(Ui=e,e=et),e}function I(){var e,t;if(e=[],t=B(),null!==t)for(;null!==t;)e.push(t),t=B();else e=et;return e}function z(){var t,n,i;return t=Ui,ri.test(e.charAt(Ui))?(n=e.charAt(Ui),Ui++):(n=null,0===Ki&&r(ii)),null!==n?(ai.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=null,0===Ki&&r(oi)),null===i&&(i=ct),null!==i?(n=[n,i],t=n):(Ui=t,t=et)):(Ui=t,t=et),t}function B(){var t;return si.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(li)),t}function N(){var t;return ui.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(ci)),t}function F(){var e,t;for(e=[],t=q(),null===t&&(t=W());null!==t;)e.push(t),t=q(),null===t&&(t=W());return e}function q(){var t,n;return Ki++,di.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(pi)),null===t&&(fi.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(mi))),Ki--,null===t&&(n=null,0===Ki&&r(hi)),t}function W(){var t,n;return Ki++,gi.test(e.charAt(Ui))?(t=e.charAt(Ui),Ui++):(t=null,0===Ki&&r(bi)),Ki--,null===t&&(n=null,0===Ki&&r(vi)),t}function U(){var e,t,n,r;if(e=Ui,t=F(),null!==t){for(n=[],r=V();null!==r;)n.push(r),r=V();null!==n?(r=F(),null!==r?(Vi=e,t=_i(n),null===t?(Ui=e,e=t):e=t):(Ui=e,e=et)):(Ui=e,e=et)}else Ui=e,e=et;return e}function V(){var t,n,i,a,o,s,l,u,c,h;return t=Ui,64===e.charCodeAt(Ui)?(n=In,Ui++):(n=null,0===Ki&&r(zn)),null!==n?(i=Ui,a=Y(),null!==a&&(a=e.substring(i,Ui)),i=a,null!==i?(a=F(),null!==a?(o=H(),null===o&&(o=ct),null!==o?(123===e.charCodeAt(Ui)?(s=mn,Ui++):(s=null,0===Ki&&r(vn)),null!==s?(l=F(),null!==l?(u=G(),null!==u?(125===e.charCodeAt(Ui)?(c=gn,Ui++):(c=null,0===Ki&&r(bn)),null!==c?(h=F(),null!==h?(Vi=t,n=yi(i,o,u),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),t}function H(){var t,n,i,o,s,l,u,c;return t=Ui,60===e.charCodeAt(Ui)?(n=Tt,Ui++):(n=null,0===Ki&&r(Pt)),null===n&&(58===e.charCodeAt(Ui)?(n=pt,Ui++):(n=null,0===Ki&&r(ft))),null!==n?(i=F(),null!==i?(o=E(),null===o&&(o=ct),null!==o?(s=F(),null!==s?(l=Ui,u=Ui,Ki++,123===e.charCodeAt(Ui)?(c=mn,Ui++):(c=null,0===Ki&&r(vn)),Ki--,null===c?u=ct:(Ui=u,u=et),null!==u?(c=a(),null!==c?(u=[u,c],l=u):(Ui=l,l=et)):(Ui=l,l=et),null===l&&(l=ct),null!==l?(u=F(),null!==u?(Vi=t,n=wi(n,o,l),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,n=F(),null!==n&&(Vi=t,n=Ei()),null===n?(Ui=t,t=n):t=n),t}function Y(){var t,n,i,a,o,s,l;if(t=Ui,n=[],Ci.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=null,0===Ki&&r(xi)),null!==i)for(;null!==i;)n.push(i),Ci.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=null,0===Ki&&r(xi));else n=et;if(null!==n){if(i=[],a=Ui,58===e.charCodeAt(Ui)?(o=pt,Ui++):(o=null,0===Ki&&r(ft)),null!==o){if(s=[],Ci.test(e.charAt(Ui))?(l=e.charAt(Ui),Ui++):(l=null,0===Ki&&r(xi)),null!==l)for(;null!==l;)s.push(l),Ci.test(e.charAt(Ui))?(l=e.charAt(Ui),Ui++):(l=null,0===Ki&&r(xi));else s=et;null!==s?(o=[o,s],a=o):(Ui=a,a=et)}else Ui=a,a=et;for(;null!==a;)if(i.push(a),a=Ui,58===e.charCodeAt(Ui)?(o=pt,Ui++):(o=null,0===Ki&&r(ft)),null!==o){if(s=[],Ci.test(e.charAt(Ui))?(l=e.charAt(Ui),Ui++):(l=null,0===Ki&&r(xi)),null!==l)for(;null!==l;)s.push(l),Ci.test(e.charAt(Ui))?(l=e.charAt(Ui),Ui++):(l=null,0===Ki&&r(xi));else s=et;null!==s?(o=[o,s],a=o):(Ui=a,a=et)}else Ui=a,a=et;null!==i?(n=[n,i],t=n):(Ui=t,t=et)}else Ui=t,t=et;return t}function G(){var t,n,i,a,o,s,l,u,c;if(t=Ui,n=X(),null!==n)if(i=F(),null!==i){for(a=[],o=Ui,59===e.charCodeAt(Ui)?(s=Oi,Ui++):(s=null,0===Ki&&r(Si)),null!==s?(l=F(),null!==l?(u=X(),null!==u?(c=F(),null!==c?(s=[s,l,u,c],o=s):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et);null!==o;)a.push(o),o=Ui,59===e.charCodeAt(Ui)?(s=Oi,Ui++):(s=null,0===Ki&&r(Si)),null!==s?(l=F(),null!==l?(u=X(),null!==u?(c=F(),null!==c?(s=[s,l,u,c],o=s):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et)):(Ui=o,o=et);null!==a?(59===e.charCodeAt(Ui)?(o=Oi,Ui++):(o=null,0===Ki&&r(Si)),null===o&&(o=ct),null!==o?(s=F(),null!==s?(Vi=t,n=rt(n,a),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)}else Ui=t,t=et;else Ui=t,t=et;return null===t&&(t=Ui,n=X(),null!==n?(i=F(),null!==i?(59===e.charCodeAt(Ui)?(a=Oi,Ui++):(a=null,0===Ki&&r(Si)),null===a&&(a=ct),null!==a?(o=F(),null!==o?(Vi=t,n=Ti(n),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t&&(t=Ui,n=F(),null!==n&&(Vi=t,n=lt()),null===n?(Ui=t,t=n):t=n)),t}function X(){var t,n,i,o,s,l,u,c,h,d,p,f,m,v,g,b,_;if(t=Ui,e.substr(Ui,2)===Pi?(n=Pi,Ui+=2):(n=null,0===Ki&&r(ki)),null===n&&(e.substr(Ui,6)===Di?(n=Di,Ui+=6):(n=null,0===Ki&&r(Mi))),null!==n?(32===e.charCodeAt(Ui)?(i=Li,Ui++):(i=null,0===Ki&&r(ji)),null!==i?(o=F(),null!==o?(s=Ui,l=w(),null!==l&&(l=e.substring(s,Ui)),s=l,null!==s?(l=F(),null!==l?(e.substr(Ui,2)===Ai?(u=Ai,Ui+=2):(u=null,0===Ki&&r(Ri)),null!==u?(c=F(),null!==c?(h=a(),null!==h?(d=F(),null!==d?(Vi=t,n=Ii(n,s,h),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et),null===t){if(t=Ui,n=a(),null!==n)if(i=F(),null!==i)if(58===e.charCodeAt(Ui)?(o=pt,Ui++):(o=null,0===Ki&&r(ft)),null===o&&(e.substr(Ui,3)===zi?(o=zi,Ui+=3):(o=null,0===Ki&&r(Bi)),null===o&&(e.substr(Ui,2)===Ni?(o=Ni,Ui+=2):(o=null,0===Ki&&r(Fi)))),null!==o)if(s=F(),null!==s)if(l=a(),null!==l)if(u=F(),null!==u){for(c=[],h=Ui,44===e.charCodeAt(Ui)?(d=tt,Ui++):(d=null,0===Ki&&r(nt)),null!==d?(p=F(),null!==p?(f=Ui,m=w(),null!==m&&(m=e.substring(f,Ui)),f=m,null!==f?(m=F(),null!==m?(58===e.charCodeAt(Ui)?(v=pt,Ui++):(v=null,0===Ki&&r(ft)),null!==v?(g=F(),null!==g?(b=a(),null!==b?(_=F(),null!==_?(d=[d,p,f,m,v,g,b,_],h=d):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et);null!==h;)c.push(h),h=Ui,44===e.charCodeAt(Ui)?(d=tt,Ui++):(d=null,0===Ki&&r(nt)),null!==d?(p=F(),null!==p?(f=Ui,m=w(),null!==m&&(m=e.substring(f,Ui)),f=m,null!==f?(m=F(),null!==m?(58===e.charCodeAt(Ui)?(v=pt,Ui++):(v=null,0===Ki&&r(ft)),null!==v?(g=F(),null!==g?(b=a(),null!==b?(_=F(),null!==_?(d=[d,p,f,m,v,g,b,_],h=d):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et)):(Ui=h,h=et);null!==c?(Vi=t,n=qi(n,o,l,c),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)}else Ui=t,t=et;else Ui=t,t=et;else Ui=t,t=et;else Ui=t,t=et;else Ui=t,t=et;else Ui=t,t=et;null===t&&(t=Ui,n=Ui,i=w(),null!==i&&(i=e.substring(n,Ui)),n=i,null!==n?(i=F(),null!==i?(o=a(),null!==o?(s=F(),null!==s?(Vi=t,n=Wi(n,o),null===n?(Ui=t,t=n):t=n):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et)):(Ui=t,t=et))}return t}var K,J=arguments.length>1?arguments[1]:{},Z={expression:a,sheet:U},$=a,Q="expression",et=null,tt=",",nt='","',rt=function(e,t){for(var n=[e],r=0;t.length>r;r++)n.push(t[r][2]);return n},it="(",at='"("',ot=")",st='")"',lt=function(){return[]},ut=function(e){return e},ct="",ht="?",dt='"?"',pt=":",ft='":"',mt=function(e,t){if(t){var n=t[2],r=t[6];return{type:"if",args:[e,n,r]}}return e},vt="||",gt='"||"',bt=function(e,t){for(var n=0;t.length>n;n++)e={type:Ji[t[n][1]],args:[e,t[n][3]]};return e},_t="&&",yt='"&&"',wt="<=>",Et='"<=>"',Ct="<=",xt='"<="',Ot=">=",St='">="',Tt="<",Pt='"<"',kt="-",Dt='"-"',Mt=">",Lt='">"',jt="==",At='"=="',Rt="!=",It='"!="',zt=function(e,t){if(t){var n=t[1],r=t[3];return"!="===n?{type:"not",args:[{type:"equals",args:[e,r]}]}:{type:Ji[n],args:[e,r]}}return e},Bt="+",Nt='"+"',Ft="*",qt='"*"',Wt="/",Ut='"/"',Vt="%",Ht='"%"',Yt="rem",Gt='"rem"',Xt="**",Kt='"**"',Jt="//",Zt='"//"',$t="%%",Qt='"%%"',en="??",tn='"??"',nn="!",rn='"!"',an=function(e,t){return{type:Zi[e],args:[t]}},on=function(e,t){for(var n=0;t.length>n;n++)e=t[n](e);return e},sn=".",ln='"."',un=function(e){return e},cn="[",hn='"["',dn="]",pn='"]"',fn=function(e){return function(t){return{type:"property",args:[t,e]}}},mn="{",vn='"{"',gn="}",bn='"}"',_n=function(e,t){return $i[e]?function(n){return{type:$i[e],args:[n,t]}}:"value"===t.type?function(t){return{type:e,args:[t]}}:function(n){return{type:e,args:[{type:"mapBlock",args:[n,t]}]}}},yn=function(e,t){return function(n){return{type:e,args:[n].concat(t)}}},wn=function(e){return function(t){return{type:"property",args:[t,{type:"literal",value:+e.join("")}]}}},En=function(e){return function(t){return{type:"property",args:[t,{type:"literal",value:e}]}}},Cn=function(e){return function(t){return{type:"with",args:[t,e]}}},xn="this",On='"this"',Sn=function(){return{type:"value"}},Tn="true",Pn='"true"',kn=function(){return{type:"literal",value:!0}},Dn="false",Mn='"false"',Ln=function(){return{type:"literal",value:!1}},jn="null",An='"null"',Rn=function(){return{type:"literal",value:null}},In="@",zn='"@"',Bn=function(e){return{type:"component",label:e}},Nn="$",Fn='"$"',qn=function(e){return{type:"property",args:[{type:"parameters"},{type:"literal",value:e}]}},Wn=function(){return{type:"parameters"}},Un="#",Vn='"#"',Hn=function(e){return{type:"element",id:e}},Yn="&",Gn='"&"',Xn=function(e,t){return{type:e,args:t,inline:!0}},Kn="^",Jn='"^"',Zn=function(e){return{type:"parent",args:[e]}},$n=function(e){return e},Qn=function(e){return e({type:"value"})},er=function(){return{type:"value"}},tr="word",nr=/^[a-zA-Z_0-9\-]/,rr="[a-zA-Z_0-9\\-]",ir="string",ar="'",or='"\'"',sr=function(e){return{type:"literal",value:e.join("")}},lr='"',ur='"\\""',cr=/^[^'\\\0-\x1F]/,hr="[^'\\\\\\0-\\x1F]",dr="\\'",pr='"\\\\\'"',fr=function(){return"'"},mr=/^[^"\\\0-\x1F]/,vr='[^"\\\\\\0-\\x1F]',gr='\\"',br='"\\\\\\""',_r=function(){return'"'},yr="\\\\",wr='"\\\\\\\\"',Er=function(){return"\\"},Cr="\\/",xr='"\\\\/"',Or=function(){return"/"},Sr="\\b",Tr='"\\\\b"',Pr=function(){return"\b"},kr="\\f",Dr='"\\\\f"',Mr=function(){return"\f"},Lr="\\n",jr='"\\\\n"',Ar=function(){return"\n"},Rr="\\r",Ir='"\\\\r"',zr=function(){return"\r"},Br="\\t",Nr='"\\\\t"',Fr=function(){return"	"},qr="\\0",Wr='"\\\\0"',Ur=function(){return"\0"},Vr="\\u",Hr='"\\\\u"',Yr=function(e){return String.fromCharCode(parseInt(e,16))},Gr=/^[0-9a-fA-F]/,Xr="[0-9a-fA-F]",Kr=function(){return{type:"tuple",args:[]}},Jr=function(e){return{type:"tuple",args:e}},Zr=function(){return{type:"record",args:[]}},$r=function(e){return{type:"record",args:e}},Qr=function(e,t){var n={};n[e[0]]=e[1];for(var r=0;t.length>r;r++)n[t[r][2][0]]=t[r][2][1];return n},ei=function(e,t){return[e,t]},ti="number",ni=function(e){return{type:"literal",value:+e}},ri=/^[eE]/,ii="[eE]",ai=/^[+\-]/,oi="[+\\-]",si=/^[0-9]/,li="[0-9]",ui=/^[1-9]/,ci="[1-9]",hi="whitespace",di=/^[\t\x0B\f \xA0\uFEFF]/,pi="[\\t\\x0B\\f \\xA0\\uFEFF]",fi=/^[ \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000]/,mi="[ \\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000]",vi="line terminator",gi=/^[\n\r\u2028\u2029]/,bi="[\\n\\r\\u2028\\u2029]",_i=function(e){return{type:"sheet",blocks:e}},yi=function(e,t,n){return{type:"block",connection:t.connection,module:t.module,exports:t.exports,label:e,statements:n}},wi=function(e,t,n){return{connection:{"<":"prototype",":":"object"}[e],module:t&&t.value,exports:""!==n?n[1]:void 0}},Ei=function(){return{}},Ci=/^[a-zA-Z_0-9]/,xi="[a-zA-Z_0-9]",Oi=";",Si='";"',Ti=function(e){return[e]},Pi="on",ki='"on"',Di="before",Mi='"before"',Li=" ",ji='" "',Ai="->",Ri='"->"',Ii=function(e,t,n){return{type:"event",when:e,event:t,listener:n}},zi="<->",Bi='"<->"',Ni="<-",Fi='"<-"',qi=function(e,t,n,r){var i={type:Qi[t],args:[e,n]};if(r.length){for(var a={},o=0;r.length>o;o++)a[r[o][2]]=r[o][6];i.descriptor=a}return i},Wi=function(e,t){return{type:"unit",name:e,value:t}},Ui=0,Vi=0,Hi=0,Yi={line:1,column:1,seenCR:!1},Gi=0,Xi=[],Ki=0;if("startRule"in J){if(!(J.startRule in Z))throw Error("Can't start parsing from rule \""+J.startRule+'".');$=Z[J.startRule]}var Ji={"**":"pow","//":"root","%%":"log","*":"mul","/":"div","%":"mod",rem:"rem","+":"add","-":"sub","<":"lt",">":"gt","<=":"le",">=":"ge","==":"equals","<=>":"compare","??":"default","&&":"and","||":"or","<-":"bind","<->":"bind2",":":"assign"},Zi={"+":"toNumber","-":"neg","!":"not","^":"parent"},$i={map:"mapBlock",filter:"filterBlock",some:"someBlock",every:"everyBlock",sorted:"sortedBlock",sortedSet:"sortedSetBlock",group:"groupBlock",groupMap:"groupMapBlock",min:"minBlock",max:"maxBlock"},Qi={":":"assign","<-":"bind","<->":"bind2"};if(K=$(),null!==K&&Ui===e.length)return K;throw i(Xi),Vi=Math.max(Ui,Gi),new t(Xi,e.length>Vi?e.charAt(Vi):null,Vi,n(Vi).line,n(Vi).column)}return e(t,Error),{SyntaxError:t,parse:n}}()}}),montageDefine("eabe77a","compile-evaluator",{dependencies:["collections/shim-object","collections/map","collections/sorted-set","./operators","./scope","./parse"],factory:function(e,t,n){function r(e){return r.semantics.compile(e)}var i=e("collections/shim-object"),a=e("collections/map"),o=e("collections/sorted-set"),s=e("./operators");e("./scope"),n.exports=r;var l={literal:function(e){return function(){return e.value}},value:function(){return function(e){return e.value}},parameters:function(){return function(e){return e.parameters}},element:function(e){return function(t){return t.document.getElementById(e.id)}},component:function(e){return function(t){return t.components.getObjectByLabel(e.label)}},tuple:function(e){var t=e.args.map(this.compile,this);return function(e){return t.map(function(t){return t(e)})}},record:function(e){var t=e.args,n={};for(var r in t)n[r]=this.compile(t[r]);return function(e){var t={};for(var r in n)t[r]=n[r](e);return t}}},u={mapBlock:function(e,t){return function(n){return e(n).map(function(e){return t(n.nest(e))})}},filterBlock:function(e,t){return function(n){return e(n).filter(function(e){return t(n.nest(e))})}},someBlock:function(e,t){return function(n){return e(n).some(function(e){return t(n.nest(e))})}},everyBlock:function(e,t){return function(n){return e(n).every(function(e){return t(n.nest(e))})}},sortedBlock:function(e,t){return function(n){return e(n).sorted(Function.by(function(e){return t(n.nest(e))}))}},sortedSetBlock:function(e,t){return function(n){function r(e){return t(n.nest(e))}function a(e,t){return i.compare(r(e),r(t))}function s(e,t){return i.equals(r(e),r(t))}return new o(e(n),s,a)}},groupBlock:function(e,t){return function(n){return e(n).group(function(e){return t(n.nest(e))})}},groupMapBlock:function(e,t){return function(n){return new a(e(n).group(function(e){return t(n.nest(e))}))}},minBlock:function(e,t){return function(n){return e(n).min(Function.by(function(e){return t(n.nest(e))}))}},maxBlock:function(e,t){return function(n){return e(n).max(Function.by(function(e){return t(n.nest(e))}))}},parent:function(e){return function(t){return e(t.parent)}},"with":function(e,t){return function(n){return t(n.nest(e(n)))}},"if":function(e,t,n){return function(r){return e(r)?t(r):n(r)}},not:function(e){return function(t){return!e(t)}},and:function(e,t){return function(n){return e(n)&&t(n)}},or:function(e,t){return function(n){return e(n)||t(n)}},"default":function(e,t){return function(n){var r=e(n);return null==r&&(r=t(n)),r}},defined:function(e){return function(t){var n=e(t);return null!=n}},path:function(t,n){return function(i){var a=t(i),o=n(i),s=e("./parse");try{var l=s(o),u=r(l);return u(i.nest(a))}catch(c){}}}},c=i.clone(s,1);i.addEach(c,{property:function(e,t){return e[t]},get:function(e,t){return e.get(t)},mapContent:Function.identity,rangeContent:Function.identity,view:function(e,t,n){return e.slice(t,t+n)}}),r.semantics={compilers:l,argCompilers:u,operators:c,compile:function(e){var t=this.compilers,n=this.argCompilers,r=this.operators;if(t.hasOwnProperty(e.type))return t[e.type].call(this,e);if(n.hasOwnProperty(e.type)){var i=e.args.map(this.compile,this);return n[e.type].apply(null,i)}r.hasOwnProperty(e.type)||(r[e.type]=function(t){var n=Array.prototype.slice.call(arguments,1);if(!t[e.type])throw new TypeError("Can't call "+JSON.stringify(e.type)+" of "+t);return t[e.type].apply(t,n)});var a=r[e.type],i=e.args.map(this.compile,this);return function(e){var t=i.map(function(t){return t(e)});return t.every(s.defined)?a.apply(null,t):void 0}}}}}),montageDefine("eabe77a","compile-assigner",{dependencies:["./compile-evaluator","./algebra","./scope"],factory:function(e,t,n){function r(e){return r.semantics.compile(e)}var i=e("./compile-evaluator"),a=e("./algebra");e("./scope");var o={type:"value"},s={type:"literal",value:!0},l={type:"literal",value:!1};n.exports=r,r.semantics={compile:function(e){var t=this.compilers;if("equals"===e.type){var n=this.compile(e.args[0]),r=this.compileEvaluator(e.args[1]);return t.equals(n,r)}if("if"===e.type){var i=this.compileEvaluator(e.args[0]),s=this.compile(e.args[1]),l=this.compile(e.args[2]);return t["if"](i,s,l)}if("and"===e.type||"or"===e.type){var u=a(e.args[0],o),c=a(e.args[1],o),h=this.compileEvaluator(e.args[0]),r=this.compileEvaluator(e.args[1]),d=this.compileEvaluator(u[1]),p=this.compileEvaluator(c[1]),n=this.compile(u[0]),f=this.compile(c[0]);return t[e.type](n,f,h,r,d,p)}if("everyBlock"===e.type){var m=this.compileEvaluator(e.args[0]),v=a(e.args[1],{type:"literal",value:!0}),g=this.compile(v[0]),b=this.compileEvaluator(v[1]);return t.everyBlock(m,g,b)}if("parent"===e.type){var _=this.compile(e.args[0]);return function(e,t){return _(e,t.parent)}}if(t.hasOwnProperty(e.type)){var y=e.args.map(this.compileEvaluator,this.compileEvaluator.semantics);return t[e.type].apply(null,y)}throw Error("Can't compile assigner for "+JSON.stringify(e.type))},compileEvaluator:i,compilers:{property:function(e,t){return function(n,r){var i=e(r);if(i){var a=t(r);null!=a&&(Array.isArray(i)?i.set(a,n):i[a]=n)}}},get:function(e,t){return function(n,r){var i=e(r);if(i){var a=t(r);null!=a&&i.set(a,n)}}},has:function(e,t){return function(n,r){var i=e(r);if(i){var a=t(r);null!=n&&(n?(i.has||i.contains).call(i,a)||i.add(a):(i.has||i.contains).call(i,a)&&(i.remove||i["delete"]).call(i,a))}}},equals:function(e,t){return function(n,r){return n?e(t(r),r):void 0}},"if":function(e,t,n){return function(r,i){var a=e(i);return null!=a?a?t(r,i):n(r,i):void 0}},and:function(e,t,n,r,i,a){return function(o,l){null!=o&&(o?(e(i(s),l),t(a(s),l)):e(n(l)&&!r(l),l))}},or:function(e,t,n,r,i,a){return function(o,s){null!=o&&(o?e(n(s)||!r(s),s):(e(i(l),s),t(a(l),s)))}},rangeContent:function(e){return function(t,n){var r=e(n);r&&(t?r.swap(0,r.length,t):r.clear())}},mapContent:function(e){return function(t,n){var r=e(n);r&&(r.clear(),n.value&&r.addEach(t))}},reversed:function(e){return function(t,n){var r=e(n);r&&r.swap(0,r.length,t.reversed())}},everyBlock:function(e,t,n){return function(r,i){if(r){var a=e(i),o=n(i);a.forEach(function(e){t(o,i.nest(e))})}}}}}}}),montageDefine("eabe77a","algebra",{dependencies:[],factory:function(e,t,n){function r(e,t){return r.semantics.solve(e,t)}n.exports=r,r.semantics={solve:function(e,t){for(;;){for(;this.simplifiers.hasOwnProperty(e.type);){var n=this.simplifiers[e.type](e);if(!n)break;e=n}if(!this.solvers.hasOwnProperty(e.type))break;t=this.solvers[e.type](e,t),e=e.args[0]}return[e,t]},simplifiers:{not:function(e){var t=e.args[0];return"not"===t.type?t.args[0]:void 0},add:function(e){var t=e.args[0];return"literal"===t.type&&""===t.value?{type:"toString",args:[e.args[1]]}:void 0},someBlock:function(e){return{type:"not",args:[{type:"everyBlock",args:[e.args[0],{type:"not",args:[e.args[1]]}]}]}}},solvers:{reflect:function(e,t){return{type:e.type,args:[t]}},invert:function(e,t,n){return{type:n,args:[t,e.args[1]]}},toNumber:function(e,t){return this.reflect(e,t)},toString:function(e,t){return this.reflect(e,t)},not:function(e,t){return this.reflect(e,t)},neg:function(e,t){return this.reflect(e,t)},add:function(e,t){return this.invert(e,t,"sub")},sub:function(e,t){return this.invert(e,t,"add")},mul:function(e,t){return this.invert(e,t,"div")},div:function(e,t){return this.invert(e,t,"mul")},pow:function(e,t){return this.invert(e,t,"root")},root:function(e,t){return this.invert(e,t,"pow")},join:function(e,t){return this.invert(e,t,"split")},split:function(e,t){return this.invert(e,t,"join")}}}}}),montageDefine("eabe77a","compile-binder",{dependencies:["./compile-observer","./observers","./binders","./algebra"],factory:function(e,t,n){function r(e){return r.semantics.compile(e)}var i=e("./compile-observer");e("./observers");var a=e("./binders"),o=e("./algebra"),s={type:"value"},l={type:"literal",value:!0};n.exports=r,r.semantics={compilers:{property:a.makePropertyBinder,get:a.makeGetBinder,has:a.makeHasBinder,only:a.makeOnlyBinder,one:a.makeOneBinder,rangeContent:a.makeRangeContentBinder,mapContent:a.makeMapContentBinder,reversed:a.makeReversedBinder,and:a.makeAndBinder,or:a.makeOrBinder},compile:function(e){var t=this.compilers;if("default"===e.type)return this.compile(e.args[0]);if("literal"===e.type){if(null==e.value)return Function.noop;throw Error("Can't bind to literal: "+e.value)}if("equals"===e.type){var n=this.compile(e.args[0]),r=i(e.args[1]);return a.makeEqualityBinder(n,r)}if("if"===e.type){var u=i(e.args[0]),c=this.compile(e.args[1]),h=this.compile(e.args[2]);return a.makeConditionalBinder(u,c,h)}if("and"===e.type||"or"===e.type){var d=o(e.args[0],s),p=o(e.args[1],s),n=this.compile(d[0]),f=this.compile(p[0]),m=i(d[1]),v=i(p[1]),g=i(e.args[0]),r=i(e.args[1]);return this.compilers[e.type](n,f,g,r,m,v)}if("everyBlock"===e.type){var b=i(e.args[0]),_=o(e.args[1],l),y=this.compile(_[0]),w=i(_[1]);return a.makeEveryBlockBinder(b,y,w)}if("rangeContent"===e.type){var E,C=i(e.args[0]);try{E=this.compile(e.args[0])}catch(x){E=Function.noop}return a.makeRangeContentBinder(C,E)}if("defined"===e.type){var E=this.compile(e.args[0]);return a.makeDefinedBinder(E)}if("parent"===e.type){var E=this.compile(e.args[0]);return a.makeParentBinder(E)}if("with"===e.type){var C=i(e.args[0]),E=this.compile(e.args[1]);return a.makeWithBinder(C,E)}if(t.hasOwnProperty(e.type)){var O=e.args.map(i,i.semantics);return t[e.type].apply(null,O)}throw Error("Can't compile binder for "+JSON.stringify(e.type))}}}}),montageDefine("eabe77a","operators",{dependencies:["collections/shim-object","collections/shim-regexp","collections/map","collections/set"],factory:function(e,t){e("collections/shim-object"),e("collections/shim-regexp");var n=e("collections/map"),r=e("collections/set");t.toNumber=function(e){return+e},t.toString=function(e){return null==e?e:"string"==typeof e||"number"==typeof e?""+e:null},t.toArray=Array.from,t.toMap=n,t.toSet=r,t.not=function(e){return!e},t.neg=function(e){return-e},t.pow=function(e,t){return Math.pow(e,t)},t.root=function(e,t){return Math.pow(e,1/t)},t.log=function(e,t){return Math.log(e)/Math.log(t)},t.mul=function(e,t){return e*t},t.div=function(e,t){return e/t},t.mod=function(e,t){return(e%t+t)%t},t.rem=function(e,t){return e%t},t.add=function(e,t){return e+t},t.sub=function(e,t){return e-t},t.ceil=function(e){return Math.ceil(e)},t.floor=function(e){return Math.floor(e)},t.round=function(e){return Math.round(e)},t.lt=function(e,t){return 0>Object.compare(e,t)},t.gt=function(e,t){return Object.compare(e,t)>0},t.le=function(e,t){return 0>=Object.compare(e,t)},t.ge=function(e,t){return Object.compare(e,t)>=0},t.equals=Object.equals,t.compare=Object.compare,t.and=function(e,t){return e&&t},t.or=function(e,t){return e||t},t.defined=function(e){return null!=e},t.startsWith=function(e,t){var n=RegExp("^"+RegExp.escape(t));return n.test(e)},t.endsWith=function(e,t){var n=RegExp(RegExp.escape(t)+"$");return n.test(e)},t.contains=function(e,t){var n=RegExp(RegExp.escape(t));return n.test(e)},t.join=function(e,t){return e.join(t||"")},t.split=function(e,t){return e.split(t||"")},t.range=function(e){for(var t=[],n=0;e>n;n++)t.push(n);return t},t.last=function(e){return e.get(e.length-1)}}}),montageDefine("eabe77a","merge",{dependencies:["collections/shim"],factory:function(e,t){"use strict";function n(e,t){for(var n,r=(t.length+1)*(e.length+1),i=Array(r),a=Array(t.length+1),o=Array(t.length+1),s=0;e.length+1>s;s++){for(var l=0;t.length+1>l;l++){var u,c;if(0===s&&0===l)u=" ",c=0;else if(0===s)u="insert",c=l;else if(0===l)u="delete",c=s;else if(e[s-1]===t[l-1])u="retain",c=o[l-1];else{var h=a[l-1],d=o[l];h>d?(u="delete",c=d+1):(u="insert",c=h+1)}i[s+l*(e.length+1)]=u,a[l]=c}n=a,a=o,o=n}return{edges:i,cost:o[t.length],source:t,target:e}}function r(e){for(var t,n,r=[],i=e.edges,a=t=e.target.length,o=e.source.length;t||o;){var s=i[t+o*(a+1)];if("delete"===s){if(n&&"delete"===n[0])n[1]++;else{var l=["delete",1];n=l,r.push(l)}t--}else if("insert"===s){if(n&&"insert"===n[0])n[1]++;else{var l=["insert",1];n=l,r.push(l)}o--}else if("retain"===s){var l=["retain",1];n&&"retain"===n[0]?n[1]++:(n=l,r.push(l)),t--,o--}}return r.reverse(),r}function i(e,t){return r(n(e,t))}function a(e,t){for(var n=i(e,t),r=[],a=0,o=0,s=0;n.length>s;){var l=n[s++];if("insert"===l[0])r.push([o,0,t.slice(o,o+l[1])]),o+=l[1];else if("delete"===l[0])if(n.length>s&&"insert"===n[s][0]){var u=n[s++];r.push([o,l[1],t.slice(o,o+u[1])]),a+=l[1],o+=u[1]}else r.push([o,l[1]]),a+=l[1];else"retain"==l[0]&&(a+=l[1],o+=l[1])}return r}function o(e,t){for(var n=0;t.length>n;n++)e.swap.apply(e,t[n])}function s(e,t){o(e,a(e,t))}e("collections/shim"),t.graphOt=n,t.traceOt=r,t.ot=i,t.diff=a,t.apply=o,t.merge=s}}),montageDefine("eabe77a","language",{dependencies:["collections/set","collections/dict"],factory:function(e,t){var n=e("collections/set"),r=e("collections/dict"),i=t.precedence=r(),a=t.precedenceLevels=[["tuple","record"],["literal","value","parameters","property","element","component","mapBlock","filterBlock","sortedBlock","groupBlock","groupMapBlock","with"],["not","neg","number","parent"],["scope"],["default"],["pow","root","log"],["mul","div","mod","rem"],["add","sub"],["equals","lt","gt","le","ge","compare"],["and"],["or"],["if"]];a.forEach(function(e){var t=n(i.keys());e.forEach(function(e){i.set(e,t)})});var o=t.operatorTokens=r({"**":"pow","//":"root","%%":"log","*":"mul","/":"div","%":"mod",rem:"rem","+":"add","-":"sub","<":"lt",">":"gt","<=":"le",">=":"ge","==":"equals","<=>":"compare","!=":"notEquals","??":"default","&&":"and","||":"or","?":"then",":":"else"});t.operatorTypes=r(o.map(function(e,t){return[e,t]}))}}),montageDefine("eabe77a","compute",{dependencies:["./parse","./compile-observer","./compile-binder","./observers","./scope"],factory:function(e,t,n){function r(e,t,n){n.target=e,n.targetPath=t;var r=n.source=n.source||e,u=n.args,c=n.compute,h=n.parameters=n.parameters||r,d=n.document,p=n.components,f=n.trace,m=n.sourceScope=new l(r);m.parameters=h,m.document=d,m.components=p;var v=n.targetScope=new l(e);v.parameters=h,v.document=d,v.components=p;var g=u.map(function(e){return i(e)}).map(function(e){if("rangeContent"===e.type){var t=a(e.args[0]);return s.makeRangeContentObserver(t)}if("mapContent"===e.type){var t=a(e.args[0]);return s.makeMapContentObserver(t)}return a(e)}),b=s.makeRangeContentObserver(s.makeObserversObserver(g)),_=s.makeComputerObserver(b,c,e),y=i(t),w=o(y);return w(_,m,v,n,f?{sourcePath:u.join(", "),targetPath:t}:void 0)}var i=e("./parse"),a=e("./compile-observer"),o=e("./compile-binder"),s=e("./observers"),l=e("./scope");n.exports=r}}),montageDefine("eabe77a","binders",{dependencies:["./scope","./observers"],factory:function(e,t){function n(){return Error("").stack.replace(/^.*\n.*\n/,"\n")}function r(e,t,r,i,a,o){return r(x(function(r){if(!a.isActive)try{a.isActive=!0,o&&console.log("SET",o.targetPath,"TO",r,"ON",e,"BECAUSE",o.sourcePath,n()),Array.isArray(e)&&t>>>0===t?e.set(t,r):e[t]=r}finally{a.isActive=!1}}),i)}function i(e,t){return function(n,r,i,a,o){return t(x(function(t){return null!=t?e(x(function(e){return null!=e?e.bindProperty?e.bindProperty(t,n,r,a,o):A(e,t,n,r,a,o):void 0}),i):void 0}),i)}}function a(e,t,r,i,a,o){return r(x(function(r){if(!a.isActive)try{a.isActive=!0,o&&console.log("SET FOR KEY",t,"TO",r,"ON",e,"BECAUSE",o.sourcePath,n()),e.set(t,r)}finally{a.isActive=!1}}),i)}function o(e,t){return function(n,r,i,a,o){return e(x(function(e){return e?t(x(function(t){return null!=t?R(e,t,n,r,a,o):void 0}),i):void 0}),i)}}function s(e,t){return function(r,i,a,o,s){return e(x(function(e){return e?t(x(function(t){return null!=t?r(x(function(r){if(r)(e.has||e.contains).call(e,t)||(s&&console.log("ADD",t,"TO",s.targetPath,"BECAUSE",s.sourcePath,n()),e.add(t));else for(;(e.has||e.contains).call(e,t);)s&&console.log("REMOVE",t,"FROM",s.targetPath,"BECAUSE",s.sourcePath,n()),(e.remove||e["delete"]).call(e,t)}),i):void 0}),a):void 0}),a)}}function l(e,t){return function(r,i,a,o,s){return r(x(function(r){return r?(s&&console.log("BIND",s.targetPath,"TO",s.sourcePath,n()),e(t,i,i,o,s),function(){s&&console.log("UNBIND",s.targetPath,"FROM",s.sourcePath,n())}):void 0}),a)}}function u(e,t,n){return function(r,i,a,o,s){return r(x(function(r){return r?e(x(function(e){function r(e,r,l){i.swap(l,r.length,e.map(function(e){var r=a.nest(e);return t(n,r,r,o,s)}))}if(e){var i=[],l=S(e,r,a);return function(){T(i),l()}}}),a):void 0}),i)}}function c(e,t,n,r,i,a){var o=P(r),s=D(n,o);return function(n,r,o,l,u){return n(x(function(n){if(null!=n){if(n){var r=e(i,L,o,l,u),c=t(a,L,o,l,u);return function(){r(),c()}}return e(s,o,o,l,u)}}),r)}}function h(e,t,n,r,i,a){var o=P(r),s=k(n,o);return function(n,r,o,l,u){return n(x(function(n){if(null!=n){if(n)return e(s,o,o,l,u);var r=e(i,j,o,l,u),c=t(a,j,o,l,u);return function(){r(),c()}}}),r)}}function d(e,t,n){return function(r,i,a,o,s){return e(x(function(e){return null!=e?e?t(r,i,a,o,s):n(r,i,a,o,s):void 0}),i)}}function p(e){return function(t,n,r){return e(x(function(e){return e?t(x(function(t){null!=t&&(e.splice?e.splice(0,e.length,t):e.clear&&e.add&&(e.clear(),e.add(t)))}),n):void 0}),r)}}function f(e){return function(t,n,r){return e(x(function(e){return e?t(x(function(t){null!=t&&t!==e.one()&&(e.splice?e.splice(0,e.length,t):e.clear&&e.add&&(e.clear(),e.add(t)))}),n):void 0}),r)}}function m(e,t){return function(r,i,a,o,s){return e(x(function(e){return e?r(x(function(t){function r(t,r,i){w(e)||(s&&console.log("SWAPPING",r,"FOR",t,"AT",i,"ON",s.targetPath,n()),e.swap?e.swap(i,r.length,t):e.add&&(e.remove||e["delete"])&&(t.forEach(e.add,e),r.forEach(e.remove||e["delete"],e)))
}if(t!==e){if(!t)return e.clear(),void 0;if(t.addRangeChangeListener)return t.addRangeChangeListener(r),r(Array.from(t),Array.from(e),0),O(function(){t.removeRangeChangeListener(r)})}}),i):t(C.makeLiteralObserver([]),i,a,o,s)}),a)}}function v(e){return function(t,r,i,a,o){return e(x(function(e){return e?t(x(function(t){function r(t,r){if(!a.isActive)try{a.isActive=!0,void 0===t?(o&&o&&console.log("DELETED",o.targetPath,"FOR KEY",r,"ON",e,"BECAUSE",o.sourcePath,n()),Array.isArray(e)?e.splice(r,1):e["delete"](r)):(o&&o&&console.log("SET",o.targetPath,"FOR KEY",r,"TO",t,"ON",e,"BECAUSE",o.sourcePath,n()),e.set(r,t))}finally{a.isActive=!1}}return t?(e.clear(),t.forEach(r),t.addMapChangeListener(r)):(e.clear(),void 0)}),r):void 0}),i)}}function g(e){return function(t,n,r){return e(x(function(e){return e?t(x(function(t){function n(t,n,r){if(!w(e)){var i=e.length-r-n.length;e.swap(i,n.length,t.reversed())}}return t?(t.addRangeChangeListener(n),n(t,e,0),O(function(){t.removeRangeChangeListener(n)})):(e.clear(),void 0)}),n):void 0}),r)}}function b(e){return function(t,n,r,i,a){return t(x(function(t){return t?Function.noop:e(M,n,r,i,a)}),r)}}function _(e){return function(t,n,r,i,a){return r.parent?e(t,n,r.parent,i,a):void 0}}function y(e,t){return function(n,r,i,a,o){return e(x(function(e){return null!=e?t(n,r,i.nest(e),a,o):void 0}),i)}}function w(e){return e.getRangeChangeDescriptor&&e.getRangeChangeDescriptor().isActive}var E=e("./scope"),C=e("./observers"),x=C.autoCancelPrevious,O=C.once,S=C.observeRangeChange,T=C.cancelEach,P=C.makeNotObserver,k=C.makeOrObserver,D=C.makeAndObserver;C.observeValue;var M=C.makeLiteralObserver(),L=new E(!0),j=new E(!1);t.bindProperty=r;var A=r;t.makePropertyBinder=i,t.bindGet=a;var R=a;t.makeGetBinder=o,t.makeHasBinder=s,t.makeEqualityBinder=l,t.makeEveryBlockBinder=u,t.makeAndBinder=c,t.makeOrBinder=h,t.makeConditionalBinder=d,t.makeOnlyBinder=p,t.makeOneBinder=f,t.makeRangeContentBinder=m,t.makeMapContentBinder=v,t.makeReversedBinder=g,t.makeDefinedBinder=b,t.makeParentBinder=_,t.makeWithBinder=y}}),montageDefine("f177794","ui/number-field.reel/number-field",{dependencies:["montage/ui/base/abstract-number-field"],factory:function(e,t){var n=e("montage/ui/base/abstract-number-field").AbstractNumberField;t.NumberField=n.specialize({constructor:{value:function(){this.super()}}})}}),montageDefine("f177794","ui/slider.reel/slider",{dependencies:["montage/ui/base/abstract-slider"],factory:function(e,t){var n=e("montage/ui/base/abstract-slider").AbstractSlider;t.Slider=n.specialize({constructor:{value:function(){this.super()}}})}}),montageDefine("f177794","ui/number-field.reel/number-field.html",{text:'<!doctype html>\n<html>\n<head>\n    <meta charset=utf-8>\n    <link href=number-field.css rel=stylesheet>\n\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"numberField"},"_numberFieldTextFieldComponent":{"@":"textField"},"_numberFieldMinusComponent":{"@":"minus"},"_numberFieldPlusComponent":{"@":"plus"}}},"textField":{"prototype":"ui/text-field.reel","properties":{"element":{"#":"textField"}},"bindings":{"value":{"<->":"@owner.value"}}},"plus":{"prototype":"ui/button.reel","properties":{"element":{"#":"buttonPlus"}},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"minus":{"prototype":"ui/button.reel","properties":{"element":{"#":"buttonMinus"}},"listeners":[{"type":"action","listener":{"@":"owner"}}]}}</script>\n\n</head>\n<body>\n\n    <span data-montage-id=numberField class=digit-NumberField>\n        <button data-montage-id=buttonMinus class=digit-NumberField-minus tabindex=-1>-</button>\n        <input data-montage-id=textField class=digit-NumberField-input>\n        <button data-montage-id=buttonPlus class=digit-NumberField-plus tabindex=-1>+</button>\n    </span>\n    \n</body>\n</html>'}),montageDefine("f177794","ui/slider.reel/slider.html",{text:'<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=slider.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"slider"},"_sliderThumbElement":{"#":"sliderThumb"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=slider class=digit-Slider>\n        <div data-montage-id=sliderThumb class=digit-Slider-thumb></div>\n    </div>\n</body>\n</html>'}),montageDefine("f177794","ui/text-field.reel/text-field",{dependencies:["montage/ui/base/abstract-text-field"],factory:function(e,t){var n=e("montage/ui/base/abstract-text-field").AbstractTextField;t.TextField=n.specialize({hasTemplate:{value:!0},constructor:{value:function(){this.super()}}})}}),montageDefine("f177794","ui/button.reel/button",{dependencies:["montage/ui/base/abstract-button"],factory:function(e,t){var n=e("montage/ui/base/abstract-button").AbstractButton;t.Button=n.specialize({hasTemplate:{value:!0},constructor:{value:function(){this.super(),this.classList.add("digit-Button")}}})}}),montageDefine("f177794","ui/text-field.reel/text-field.html",{text:'<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=text-field.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"textField"}}}}</script>\n</head>\n<body>\n    <input data-montage-id=textField class=digit-TextField>\n</body>\n</html>'}),montageDefine("f177794","ui/button.reel/button.html",{text:"<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=button.css>\n</head>\n<body>\n</body>\n</html>"});
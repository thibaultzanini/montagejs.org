montageDefine("1ebf565","test/simple/test-stream2-large-read-stall",{dependencies:["../common.js","assert","../../readable"],factory:function(e){function t(){if(!(h>a)){if(h++===a)return console.error("   push(EOF)"),l.push(null);console.error("   push #%d",h),l.push(new Buffer(i))&&setTimeout(t)}}e("../common.js");var n=e("assert"),r=100,i=20,a=1e3,o=50,s=e("../../readable").Readable,l=new s({highWaterMark:o}),u=l._readableState;l._read=t,l.on("readable",function(){console.error(">> readable");do{console.error("  > read(%d)",r);var e=l.read(r);console.error("  < %j (%d remain)",e&&e.length,u.length)}while(e&&e.length===r);console.error("<< after read()",e&&e.length,u.needReadable,u.length)});var c=!1;l.on("end",function(){c=!0,console.error("end")});var h=0;l.read(0),process.on("exit",function(){n.equal(h,a+1),n(c)})}});
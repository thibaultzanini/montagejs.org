"use strict";function graphOt(e,t){for(var n,i=(t.length+1)*(e.length+1),r=Array(i),a=Array(t.length+1),o=Array(t.length+1),s=0;e.length+1>s;s++){for(var l=0;t.length+1>l;l++){var u,c;if(0===s&&0===l)u=" ",c=0;else if(0===s)u="insert",c=l;else if(0===l)u="delete",c=s;else if(e[s-1]===t[l-1])u="retain",c=o[l-1];else{var h=a[l-1],d=o[l];h>d?(u="delete",c=d+1):(u="insert",c=h+1)}r[s+l*(e.length+1)]=u,a[l]=c}n=a,a=o,o=n}return{edges:r,cost:o[t.length],source:t,target:e}}function traceOt(e){for(var t,n,i=[],r=e.edges,a=t=e.target.length,o=e.source.length;t||o;){var s=r[t+o*(a+1)];if("delete"===s){if(n&&"delete"===n[0])n[1]++;else{var l=["delete",1];n=l,i.push(l)}t--}else if("insert"===s){if(n&&"insert"===n[0])n[1]++;else{var l=["insert",1];n=l,i.push(l)}o--}else if("retain"===s){var l=["retain",1];n&&"retain"===n[0]?n[1]++:(n=l,i.push(l)),t--,o--}}return i.reverse(),i}function ot(e,t){return traceOt(graphOt(e,t))}function diff(e,t){for(var n=ot(e,t),i=[],r=0,a=0,o=0;n.length>o;){var s=n[o++];if("insert"===s[0])i.push([a,0,t.slice(a,a+s[1])]),a+=s[1];else if("delete"===s[0])if(n.length>o&&"insert"===n[o][0]){var l=n[o++];i.push([a,s[1],t.slice(a,a+l[1])]),r+=s[1],a+=l[1]}else i.push([a,s[1]]),r+=s[1];else"retain"==s[0]&&(r+=s[1],a+=s[1])}return i}function apply(e,t){for(var n=0;t.length>n;n++)e.swap.apply(e,t[n])}function merge(e,t){apply(e,diff(e,t))}require("collections/shim"),exports.graphOt=graphOt,exports.traceOt=traceOt,exports.ot=ot,exports.diff=diff,exports.apply=apply,exports.merge=merge;
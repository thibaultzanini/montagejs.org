montageDefine("7d473e6","ui/main.reel/main",{dependencies:["montage","montage/ui/component","m-car/m-car"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/ui/component").Component,s=e("m-car/m-car").MontageCar;t.Main=r.create(i,{didCreate:{value:function(){this.vehicle=s.create()}},vehicle:{value:null},vehicle:{get:function(){return this._vehicle},set:function(e){if(e===this._vehicle)return;this._vehicle=e,this.needsDraw=!0}},_currentManufacturer:{value:null},prepareForDraw:{value:function(){window.addEventListener("beforeunload",this,!0)}},draw:{value:function(){this._currentManufacturer&&this.element.classList.remove(this._currentManufacturer);var e=this.getProperty("vehicle.manufacturer");e&&this.element.classList.add(e),this._currentManufacturer=e}},captureBeforeunload:{value:function(){this.reflectState()}},handleShareButtonAction:{value:function(){this.reflectState()}},reflectState:{value:function(){if(!this.vehicle)return;var e=encodeURIComponent(this.vehicle.toHash());window.location.hash="#!"+e;var t="http://"+window.location.host.replace(/:\d+/,"")+":1337/save?hash="+e;console.log("share",e);var n=new XMLHttpRequest;n.open("POST",t),n.send()}}})}})
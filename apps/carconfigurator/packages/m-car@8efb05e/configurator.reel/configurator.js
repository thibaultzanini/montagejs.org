var Montage=require("montage").Montage,Component=require("montage/ui/component").Component,ArrayController=require("montage/ui/controller/array-controller").ArrayController,Popup=require("montage/ui/popup/popup.reel").Popup;exports.Configurator=Montage.create(Component,{bodyColorSection:{value:null},tridionColorSection:{value:null},interiorSection:{value:null},_vehicle:{value:null},vehicle:{get:function(){return this._vehicle},set:function(e){if(e===this._vehicle)return;this._vehicle=e}},bodyColorController:{value:null},tridionColorController:{value:null},wheelsetController:{value:null},interiorController:{value:null},interiorOptionsController:{value:null},didCreate:{value:function(){this.bodyColorController=ArrayController.create(),Object.defineBinding(this.bodyColorController,"content",{boundObject:this,boundObjectPropertyPath:"vehicle.options.bodyColor",oneway:!0}),Object.defineBinding(this.bodyColorController,"selectedObjects.0",{boundObject:this,boundObjectPropertyPath:"vehicle.bodyColor"}),this.tridionColorController=ArrayController.create(),Object.defineBinding(this.tridionColorController,"content",{boundObject:this,boundObjectPropertyPath:"vehicle.options.tridionColor",oneway:!0}),Object.defineBinding(this.tridionColorController,"selectedObjects.0",{boundObject:this,boundObjectPropertyPath:"vehicle.tridionColor"}),this.wheelsetController=ArrayController.create(),Object.defineBinding(this.wheelsetController,"content",{boundObject:this,boundObjectPropertyPath:"vehicle.options.wheelset",oneway:!0}),Object.defineBinding(this.wheelsetController,"selectedObjects.0",{boundObject:this,boundObjectPropertyPath:"vehicle.wheelset"}),this.interiorController=ArrayController.create(),Object.defineBinding(this.interiorController,"content",{boundObject:this,boundObjectPropertyPath:"vehicle.options.interior",oneway:!0}),Object.defineBinding(this.interiorController,"selectedObjects.0",{boundObject:this,boundObjectPropertyPath:"vehicle.interior"}),this.interiorOptionsController=ArrayController.create(),Object.defineBinding(this.interiorOptionsController,"content",{boundObject:this,boundObjectPropertyPath:"vehicle.options.interiorOptions",oneway:!0}),window.foo=this}},prepareForDraw:{value:function(){this.bodyColorController.selectedObjects=[this.vehicle.bodyColor],this.tridionColorController.selectedObjects=[this.vehicle.tridionColor],this.interiorController.selectedObjects=[this.vehicle.interior],this.wheelsetController.selectedObjects=[this.vehicle.wheelset],this.customColorSelected=this.vehicle.customBodyColor===this.vehicle.bodyColor,this.vehicle.addPropertyChangeListener("bodyColor",this,!1)}},customColorSelected:{value:!1},handleChange:{value:function(e){"bodyColor"===e.propertyPath&&(this.customColorSelected=this.vehicle.customBodyColor===this.vehicle.bodyColor)}},pickFromModel:{value:function(e){var t={material_14:"bodyColor",material_5:"tridionColor",interior1:"interior",material_19:"wheelset"},n=t[e.material.name];console.log(n,this.vehicle[n]),n&&(this.vehicle.highlightModel(n,e.material.name),this.highlightSection(n))}},_highlightTimeouts:{distinct:!0,value:{}},_highlightedSections:{distinct:!0,value:{}},highlightDuration:{value:400},highlightSection:{value:function(e){clearTimeout(this._highlightTimeouts[e]),this._highlightedSections[e]=!0,this.needsDraw=!0;var t=this;this._highlightTimeouts=setTimeout(function(){t.unhighlightSection(e)},this.highlightDuration)}},unhighlightSection:{value:function(e){this._highlightedSections[e]=!1,this.needsDraw=!0}},draw:{value:function(){var e=Object.keys(this._highlightedSections),t=e.length;while(t){t--;var n=e[t],r=this[n+"Section"];if(!r)continue;var i=this._highlightedSections[n];i?r.classList.add("highlighted"):r.classList.remove("highlighted")}}}})
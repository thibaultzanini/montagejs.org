montageDefine("87344ee","listen/property-changes",{dependencies:["../weak-map"],factory:function(e,t,n){function u(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}var r=e("../weak-map"),i=Object.prototype.hasOwnProperty,s=new r,o=new r;n.exports=u,u.debug=!0,u.prototype.getOwnPropertyChangeDescriptor=function(e){s.has(this)||s.set(this,{});var t=s.get(this);return i.call(t,e)||(t[e]={willChangeListeners:[],changeListeners:[]}),t[e]},u.prototype.hasOwnPropertyChangeDescriptor=function(e){if(!s.has(this))return!1;if(!e)return!0;var t=s.get(this);return i.call(t,e)?!0:!1},u.prototype.addOwnPropertyChangeListener=function(e,t,n){this.makeObservable&&!this.isObservable&&this.makeObservable();var r=u.getOwnPropertyChangeDescriptor(this,e),i;n?i=r.willChangeListeners:i=r.changeListeners,u.makePropertyObservable(this,e),i.push(t);var s=this;return function(){u.removeOwnPropertyChangeListener(s,e,i,n),s=null}},u.prototype.addBeforeOwnPropertyChangeListener=function(e,t){return u.addOwnPropertyChangeListener(this,e,t,!0)},u.prototype.removeOwnPropertyChangeListener=function(e,t,n){var r=u.getOwnPropertyChangeDescriptor(this,e),i;n?i=r.willChangeListeners:i=r.changeListeners;var s=i.lastIndexOf(t);if(s===-1)throw new Error("Can't remove listener: does not exist.");i.splice(s,1),r.changeListeners.length+r.willChangeListeners.length===0&&u.makePropertyUnobservable(this,e)},u.prototype.removeBeforeOwnPropertyChangeListener=function(e,t){return u.removeOwnPropertyChangeListener(this,e,t,!0)},u.prototype.dispatchOwnPropertyChange=function(e,t,n){var r=u.getOwnPropertyChangeDescriptor(this,e);if(r.isActive)return;r.isActive=!0;var i;n?i=r.willChangeListeners:i=r.changeListeners;var s=(n?"Will":"")+"Change",o="handleProperty"+s,a=String(e);a=a&&a[0].toUpperCase()+a.slice(1);var f="handle"+a+s;try{i.forEach(function(n){var r=n;n=n[f]||n[o]||n,n.call(r,t,e,this)},this)}finally{r.isActive=!1}},u.prototype.dispatchBeforeOwnPropertyChange=function(e,t){return u.dispatchOwnPropertyChange(this,e,t,!0)},u.prototype.makePropertyObservable=function(e){if(Array.isArray(this))return;if(!Object.isExtensible(this,e))throw new Error("Can't make property "+JSON.stringify(e)+" observable on "+this+" because object is not extensible");var t;typeof this.__state__=="object"?t=this.__state__:(t={},Object.isExtensible(this,"__state__")&&Object.defineProperty(this,"__state__",{value:t,writable:!0,enumerable:!1})),t[e]=this[e],o.has(this)||(n={},o.set(this,n));var n=o.get(this);if(i.call(n,e))return;var r,s=this,a=Object.getOwnPropertyDescriptor(s,e);do{r=Object.getOwnPropertyDescriptor(s,e);if(r)break;s=Object.getPrototypeOf(s)}while(s);r=r||{value:undefined,enumerable:!0,writable:!0,configurable:!0};if(!r.configurable)throw new Error("Can't observe non-configurable properties");n[e]=r;if(!r.writable&&!r.set)return;var f;"value"in r?f={get:function(){return r.value},set:function(n){return n===r.value?n:(u.dispatchBeforeOwnPropertyChange(this,e,r.value),r.value=n,t[e]=n,u.dispatchOwnPropertyChange(this,e,n),n)},enumerable:r.enumerable,configurable:!0}:f={get:function(){if(r.get)return r.get.apply(this,arguments)},set:function(n){var i;return r.get&&(i=r.get.apply(this,arguments)),r.set&&r.set.apply(this,arguments),r.get&&(n=r.get.apply(this,arguments),t[e]=n),n===i?n:(u.dispatchBeforeOwnPropertyChange(this,e,i),u.dispatchOwnPropertyChange(this,e,n),n)},enumerable:r.enumerable,configurable:!0},Object.defineProperty(this,e,f)},u.prototype.makePropertyUnobservable=function(e){if(Array.isArray(this))return;if(!o.has(this))throw new Error("Can't uninstall observer on property");var t=o.get(this);if(!t[e])throw new Error("Can't uninstall observer on property");var n=t[e];delete t[e];var r;typeof this.__state__=="object"?r=this.__state__:(r={},Object.isExtensible(this,"__state__")&&Object.defineProperty(this,"__state__",{value:r,writable:!0,enumerable:!1})),delete r[e],Object.defineProperty(this,e,n)},u.getOwnPropertyChangeDescriptor=function(e,t){return e.getOwnPropertyChangeDescriptor?e.getOwnPropertyChangeDescriptor(t):u.prototype.getOwnPropertyChangeDescriptor.call(e,t)},u.hasOwnPropertyChangeDescriptor=function(e,t){return e.hasOwnPropertyChangeDescriptor?e.hasOwnPropertyChangeDescriptor(t):u.prototype.hasOwnPropertyChangeDescriptor.call(e,t)},u.addOwnPropertyChangeListener=function(e,t,n,r){if(!!Object.isObject(e))return e.addOwnPropertyChangeListener?e.addOwnPropertyChangeListener(t,n,r):u.prototype.addOwnPropertyChangeListener.call(e,t,n,r)},u.removeOwnPropertyChangeListener=function(e,t,n,r){if(!!Object.isObject(e))return e.removeOwnPropertyChangeListener?e.removeOwnPropertyChangeListener(t,n,r):u.prototype.removeOwnPropertyChangeListener.call(e,t,n,r)},u.dispatchOwnPropertyChange=function(e,t,n,r){if(!!Object.isObject(e))return e.dispatchOwnPropertyChange?e.dispatchOwnPropertyChange(t,n,r):u.prototype.dispatchOwnPropertyChange.call(e,t,n,r)},u.addBeforeOwnPropertyChangeListener=function(e,t,n){return u.addOwnPropertyChangeListener(e,t,n,!0)},u.removeBeforeOwnPropertyChangeListener=function(e,t,n){return u.removeOwnPropertyChangeListener(e,t,n,!0)},u.dispatchBeforeOwnPropertyChange=function(e,t,n){return u.dispatchOwnPropertyChange(e,t,n,!0)},u.makePropertyObservable=function(e,t){return e.makePropertyObservable?e.makePropertyObservable(t):u.prototype.makePropertyObservable.call(e,t)},u.makePropertyUnobservable=function(e,t){return e.makePropertyUnobservable?e.makePropertyUnobservable(t):u.prototype.makePropertyUnobservable.call(e,t)}}})
var Montage=require("montage").Montage,Component=require("montage/ui/component").Component,Point=require("montage/core/geometry/point").Point,dom=require("montage/ui/dom");exports.Ruler=Montage.create(Component,{_position:{value:null},position:{get:function(){return this._position},set:function(e){if(e===this._position)return;this._position=e,this.needsDraw=!0}},_savedPosition:{value:null},savedPosition:{get:function(){return this._savedPosition},set:function(e){if(e===this._savedPosition)return;this._savedPosition=e,this.needsDraw=!0}},rangeStart:{value:0},rangeEnd:{value:null},_axis:{value:"x"},axis:{get:function(){return this._axis},set:function(e){if(e===this._axis)return;this._axis=e,this.needsDraw=!0}},container:{value:null},positionText:{value:null},savedPositionText:{value:null},distanceText:{value:null},prepareForDraw:{value:function(){window.Touch||document.addEventListener("mousemove",this)}},handleMousemove:{value:function(e){var t=Point.create().init(e.pageX,e.pageY);this.container&&(t=dom.convertPointFromPageToNode(this.container,t)),this.position=t[this.axis]}},distance:{dependencies:["savedPosition","position"],get:function(){return null!=this.savedPosition&&null!=this.position?this.position-this.savedPosition:null}},draw:{value:function(){"x"===this.axis?(this.element.classList.add("horizontal"),this.element.classList.remove("vertical")):(this.element.classList.add("vertical"),this.element.classList.remove("horizontal"));var e=this.position>this.rangeStart?this.position:this.rangeStart;null!=this.rangeEnd&&e>this.rangeEnd&&(e=this.rangeEnd),this.positionText.element.style.left=e+"px";var t=this.savedPosition>this.rangeStart?this.savedPosition:this.rangeStart;null!=this.rangeEnd&&t>this.rangeEnd&&(t=this.rangeEnd),this.savedPositionText.element.style.left=t+"px",null!=this.distance?(this.distanceText.element.style.width=Math.abs(this.distance)+"px",this.distance<0?this.distanceText.element.style.left=e+"px":this.distanceText.element.style.left=t+"px"):this.distanceText.element.style.width="0"}}})
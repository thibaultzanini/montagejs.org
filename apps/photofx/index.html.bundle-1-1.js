montageDefine("120b0c7","ui/controller/array-controller",{dependencies:["montage","ui/controller/object-controller","core/change-notification","ui/controller/array-controller"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/controller/object-controller").ObjectController,s=e("core/change-notification").ChangeNotification,o=t.ArrayController=r.create(i,{didCreate:{value:function(){var e=this;this.addPropertyChangeListener("selections",function(){var t=[];e._selections.forEach(function(e,n){e&&t.push(n)}),e.selectedIndexes=t}),this.addPropertyChangeListener("content",function(){e.selectedObjects=null,e.automaticallyOrganizeObjects&&e.organizeObjects()})}},_content:{value:null},content:{get:function(){return this._content},set:function(e){if(this._content===e)return;this._content=e}},delegate:{value:null},_organizedObjects:{distinct:!0,value:[]},organizedObjects:{get:function(){return this._organizedObjects}},automaticallyOrganizeObjects:{value:!0},_sortFunction:{value:null},sortFunction:{get:function(){return this._sortFunction},set:function(e){if(this._sortFunction===e)return;this._sortFunction=e,this.automaticallyOrganizeObjects&&this.organizeObjects()}},_filterFunction:{value:null},filterFunction:{get:function(){return this._filterFunction},set:function(e){if(this._filterFunction===e)return;this._filterFunction=e,this.automaticallyOrganizeObjects&&this.organizeObjects()}},_startIndex:{value:null},startIndex:{get:function(){return this._startIndex},set:function(e){if(this._startIndex===e)return;this._startIndex=e,this.automaticallyOrganizeObjects&&this.organizeObjects()}},_endIndex:{enumerable:!1,value:null},endIndex:{get:function(){return this._endIndex},set:function(e){if(this._endIndex===e)return;this._endIndex=e,this.automaticallyOrganizeObjects&&this.organizeObjects()}},_organizedObjectsIndexes:{value:null},_rangedOrganizedObjectsIndexes:{value:null},_selectedIndexes:{value:null},selectedIndexes:{get:function(){return this._selectedIndexes?this._selectedIndexes:this.selectedContentIndexes?this._selectedIndexes=this._convertIndexesFromContentToOrganized(this.selectedContentIndexes):null},set:function(e){if(this.selectedIndexes!==e){var t=e?this._convertIndexesFromOrganizedToContent(e):null,n=null;if(this.delegate&&typeof this.delegate.shouldChangeSelection=="function"){t&&(n=this.content.filter(function(e,n){return t.indexOf(n)>=0},this));if(this.delegate.shouldChangeSelection(this,n,this._selectedObjects)===!1)return}this.dispatchPropertyChange("selections","selectedContentIndexes","selectedObjects",function(){this._selectedIndexes=e,this._selectedContentIndexes=t,this._selectedObjects=null,this._selections=null})}}},_convertIndexesFromOrganizedToContent:{value:function(e){var t,n=[],r,i=e.length,s,o;r=this._rangedOrganizedObjectsIndexes?this._rangedOrganizedObjectsIndexes:this._organizedObjectsIndexes;if(r){o=r.length;for(t=0;t<i;t++)s=e[t],s<o&&s>=0&&(n[n.length]=r[s])}else for(t=0;t<i;t++)n[n.length]=e[t]+this.startIndex;return n.sort()}},_convertIndexesFromContentToOrganized:{value:function(e){var t,n=[],r,i=e.length,s;r=this._rangedOrganizedObjectsIndexes?this._rangedOrganizedObjectsIndexes:this._organizedObjectsIndexes;if(r)for(t=0;t<i;t++)s=e[t],s>=0&&(s=r.indexOf(s),s!==-1&&(n[n.length]=s));else for(t=0;t<i;t++)s=e[t]-this.startIndex,s>-1&&(this.endIndex==null||s<this.endIndex)&&(n[n.length]=s);return n.sort()}},organizeObjects:{value:function(){var e=this.content,t=this.filterFunction,n=this.sortFunction,r=0,i=0,s,o,u,a;e&&typeof t=="function"&&(s=[],e=e.filter(function(e){var n=t.call(this,e);return n&&(s[i]=r,i++),r++,n},this));if(typeof n=="function"){o=[],u=[],r=0;for(r=0;a=e[r];r++)a!==null&&typeof a=="object"?(a._montage_array_controller_index=r,u[r]=a):u[r]={_montage_array_controller_index:r,_montage_array_controller_value:a};u=u.sort(function(e,t){return e._montage_array_controller_value&&(e=e._montage_array_controller_value),t._montage_array_controller_value&&(t=t._montage_array_controller_value),n.call(this,e,t)}),e=[];for(r=0;a=u[r];r++)i=a._montage_array_controller_index,o[r]=s?s[i]:i,a._montage_array_controller_value?e[r]=a._montage_array_controller_value:(e[r]=a,delete a._montage_array_controller_index);this._organizedObjectsIndexes=o}else this._organizedObjectsIndexes=s;this._applyRangeIfNeeded(e)}},_applyRangeIfNeeded:{value:function(e){var t=this.startIndex,n=this.endIndex;e&&(typeof t=="number"||typeof n=="number")&&(t=typeof t=="number"&&t>=0?t:0,n=typeof n=="number"&&n<e.length?n:e.length,e=e.slice(t,n),this._organizedObjectsIndexes?this._rangedOrganizedObjectsIndexes=this._organizedObjectsIndexes.slice(t,n):this._rangedOrganizedObjectsIndexes=null),this.dispatchPropertyChange("organizedObjects",function(){this._organizedObjects=e?e:[]})}},_selectedObjects:{value:null},selectedObjects:{get:function(){return this._selectedObjects?this._selectedObjects:this._selectedContentIndexes?(this.content&&(this._selectedObjects=this.content.filter(function(e,t){return this._selectedContentIndexes.indexOf(t)>=0},this)),this._selectedObjects):null},set:function(e){e===null||typeof e=="undefined"?e=null:Array.isArray(e)||(e=[e]);if(this.selectedObjects===e)return;if(this.delegate&&typeof this.delegate.shouldChangeSelection=="function"&&this.delegate.shouldChangeSelection(this,e,this._selectedObjects)===!1)return;this.dispatchPropertyChange("selections","selectedContentIndexes","selectedIndexes",function(){this._selectedObjects=e,this._selectedContentIndexes=null,this._selectedIndexes=null,this._selections=null})}},_selectedContentIndexes:{value:null},selectedContentIndexes:{get:function(){if(this._selectedContentIndexes)return this._selectedContentIndexes;if(!this._selectedObjects)return null;this._selectedContentIndexes=[];var e;return this._selectedObjects.forEach(function(t){(e=this.content.indexOf(t))!==-1&&this._selectedContentIndexes.push(e)},this),this._selectedContentIndexes},set:function(e){e===null||e===!1||typeof e=="undefined"?e=null:Array.isArray(e)||(e=[e]);if(this.selectedContentIndexes===e)return;if(this.delegate&&typeof this.delegate.shouldChangeSelection=="function"){var t=e,n=null;t&&(n=this.content.filter(function(e,n){return t.indexOf(n)>=0},this));if(this.delegate.shouldChangeSelection(this,n,this._selectedObjects)===!1)return}this._selectedContentIndexes=e,this.dispatchPropertyChange("selections","selectedIndexes","selectedObjects",function(){this._selectedIndexes=null,this._selectedObjects=null,this._selections=null})}},_selections:{value:null},selections:{get:function(){if(!this._selections){this._selections=new Array(this._organizedObjects.length);if(this.selectedIndexes){var e=this._selections,t=this.selectedIndexes,n=t.length,r,i;for(r=0;r<n;r++)i=t[r],i<e.length&&(e[i]=!0)}}return this._selections}},initWithContent:{value:function(e){return this.content=e,this}},selectObjectsOnAddition:{value:!1},clearFilterFunctionOnAddition:{value:!0},add:{value:function(){var e=this.newObject();this.content.push(e),this.selectObjectsOnAddition&&(this.selectedContentIndexes=[this.content.length-1]),this.clearFilterFunctionOnAddition&&(this.filterFunction=null),this.automaticallyOrganizeObjects&&this.organizeObjects()}},addObjects:{value:function(){var e=Array.prototype.slice.call(arguments),t,n=e.length,r,i,s=this.content;s?s.push.apply(s,e):this.content=s=e;if(this.selectObjectsOnAddition){r=[],i=s.length-n;for(t=0;t<n;t++)r[t]=i++;this.selectedContentIndexes=r,this.selectedObjects=e}this.clearFilterFunctionOnAddition&&(this.filterFunction=null),this.automaticallyOrganizeObjects&&this.organizeObjects()}},remove:{value:function(){var e;return this.selectedObjects&&this.selectedObjects.length>0&&(e=this.removeObjects.apply(this,this.selectedObjects),this.automaticallyOrganizeObjects&&this.organizeObjects()),e}},removeObjects:{value:function(){var e=Array.prototype.slice.call(arguments),t;return t=this.content.filter(function(t){return e.indexOf(t)<0}),this.content=t,this.automaticallyOrganizeObjects&&this.organizeObjects(),e}},removeObjectsAtSelectedIndexes:{value:function(){return this.removeObjectsAtIndexes(this.selectedIndexes)}},removeObjectsAtIndexes:{value:function(e){var t,n;return e&&e.length>0&&(t=[],n=this.content.filter(function(n,r){return e.indexOf(r)<0?!0:(t.push(n),!1)}),this.content=n,this.automaticallyOrganizeObjects&&this.organizeObjects()),t}}})}}),montageDefine("120b0c7","ui/popup/popup.reel/popup",{dependencies:["montage","ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component,s=t.Popup=r.create(i,{hasTemplate:{value:!0},anchorElement:{value:null},_anchor:{value:null},anchor:{get:function(){return this._anchor},set:function(e){e&&(this._anchor=e,e.nodeName?this.anchorElement=e:this.anchorElement=e.element)}},delegate:{value:null},contentEl:{value:null},containerEl:{value:null},_slot:{value:null},slot:{get:function(){return this._slot},set:function(e){this._slot=e,this.content&&(this._slot.content=this.content)}},_content:{value:null},content:{get:function(){return this._content},set:function(e){this._content!==e&&this.slot&&(this.slot.content=e),this._content=e,this._content.popup=this,this.needsDraw=!0}},_modal:{value:!1},modal:{get:function(){return this._modal},set:function(e){e=!!e,this._modal!==e&&(this._modal=e,this.needsDraw=!0)}},_position:{value:null},position:{get:function(){return this._position},set:function(e){this._position=e}},autoHide:{value:0},_displayed:{value:!1},displayed:{get:function(){return this._displayed},set:function(e){this._displayed!==e&&(this.needsDraw=!0),this._displayed=e}},focusOnShow:{value:!0},prepareForDraw:{value:function(){this.type=this.type||"custom"}},_popupSlot:{value:null},_modalDialogMask:{value:null},_getElementPosition:{value:function(e){var t=0,n=0,r=0,i=0;if(e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop,r+=e.offsetHeight,i+=e.offsetWidth;while(e=e.offsetParent);return{top:n,left:t,height:r,width:i}}},_getCSSValue:{value:function(e){return e!=null?(typeof e=="number"&&(e+="px"),e):""}},_positionPopup:{value:function(){var e,t,n=this.delegate,r=this.anchorElement,i=this.type;if(this.position!==null)e=this.position;else{var s=this.contentEl||this.content.element,o=parseFloat(s.style.height||0)||s.offsetHeight||0,u=parseFloat(s.style.width||0)||s.offsetWidth||0,a=window.innerHeight,f=window.innerWidth;if(r){var l=this._getElementPosition(r),c=parseFloat(r.style.height||0)||r.offsetHeight||0,h=parseFloat(r.style.width||0)||r.offsetWidth||0;e={top:l.top+c,left:l.left+h/2-u/2},e.left<0&&(e.left=l.left,this._showHidePointer(!1))}else e={top:a/2-o/2,left:f/2-u/2}}n&&typeof n.willPositionPopup=="function"?t=n.willPositionPopup(this,e):t=e;var p=this._popupSlot;t&&(p.element.style.top=this._getCSSValue(t.top),p.element.style.left=this._getCSSValue(t.left),p.element.style.right=this._getCSSValue(t.right),p.element.style.bottom=this._getCSSValue(t.bottom))}},_createModalMask:{value:function(){var e=document.createElement("div");return e.classList.add("montage-Popup-modal-mask"),e.style.zIndex=6999,e.classList.add("montage-invisible"),document.body.appendChild(e),e}},_showHidePointer:{value:function(e){}},_addEventListeners:{value:function(){window.Touch?this.element.ownerDocument.addEventListener("touchstart",this,!1):(this.element.ownerDocument.addEventListener("mousedown",this,!1),this.element.ownerDocument.addEventListener("keyup",this,!1)),window.addEventListener("resize",this)}},_removeEventListeners:{value:function(){window.Touch?this.element.ownerDocument.removeEventListener("touchstart",this,!1):(this.element.ownerDocument.removeEventListener("mousedown",this,!1),this.element.ownerDocument.removeEventListener("keyup",this,!1)),window.removeEventListener("resize",this)}},show:{value:function(){var e=this.type,t=this;this.application.getPopupSlot(e,this,function(e){t._popupSlot=e,t.displayed=!0,t._addEventListeners()})}},hide:{value:function(){var e=this.type,t=this;this.application.getPopupSlot(e,this,function(e){t._removeEventListeners(),t.displayed=!1})}},_showModalMask:{value:function(){this._modalDialogMask=document.querySelector(".montage-Popup-modal-mask"),this._modalDialogMask=this._modalDialogMask||this._createModalMask(),this._modalDialogMask.classList.remove("montage-invisible")}},_hideModalMask:{value:function(){var e=this.application._getActivePopupSlots(),t=0;if(e&&e.length>0){var n,r=e.length;for(n=0;n<r;n++)e[n].content&&e[n].content.modal===!0&&e[n].content.displayed===!0&&t++}t<=0&&this._modalDialogMask.classList.add("montage-invisible")}},draw:{value:function(){if(this.displayed){if(this.modal===!0)this.element.classList.add("montage-Popup--modal");else{this.element.classList.remove("montage-Popup--modal");if(this.autoHide){var e=this;setTimeout(function(){e.hide()},this.autoHide)}}this.element.classList.remove("montage-invisible"),this.content.element.style.display="block",this.content.element.classList.remove("montage-invisible"),this.content.element.setAttribute("tabindex","0")}else this.element.classList.contains("montage-invisible")||this.element.classList.add("montage-invisible"),this.content.element.classList.add("montage-invisible"),this._popupSlot&&(this._popupSlot.content=null)}},didDraw:{value:function(){this._displayed?(this.modal===!0&&this._showModalMask(),this._positionPopup(),this.focusOnShow===!0&&this.content.element.focus()):this.modal===!0&&this._hideModalMask();var e=document.createEvent("CustomEvent");e.initCustomEvent(this._displayed===!0?"show":"hide",!0,!0,this),this.dispatchEvent(e)}},getZIndex:{value:function(e){var t,n,r;while(e&&e!==document){t=e.style.position;if(t==="absolute"||t==="relative"||t==="fixed"){r=e.style["z-index"],n=parseInt(r,10);if(!isNaN(n)&&n!==0)return n}e=e.parentNode}return 0}},_handleTouchMouseup:{value:function(e){var t=this.getZIndex(e.target),n=this.getZIndex(this.element);this.displayed===!0&&t<n&&this.modal!==!0&&(this.displayed=!1)}},_timeoutId:{value:null},handleResize:{value:function(e){var t=this;this.displayed===!0&&(window.clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){t.needsDraw=!0},100))}},handleMousedown:{value:function(e){this._handleTouchMouseup(e)}},handleTouchstart:{value:function(e){this._handleTouchMouseup(e)}},handleKeyup:{value:function(e){this.displayed===!0&&!this.modal&&e.keyCode===27&&this.hide()}}})}}),montageDefine("120b0c7","ui/scroll-bars.reel/scroll-bars",{dependencies:["montage","ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component,s=t.ScrollBars=r.create(i,{_verticalScroll:{value:0},_horizontalScroll:{value:0},_verticalLength:{value:0},_horizontalLength:{value:0},verticalScroll:{get:function(){return this._verticalScroll},set:function(e){this._verticalScroll=e,this.needsDraw=!0}},horizontalScroll:{get:function(){return this._horizontalScroll},set:function(e){this._horizontalScroll=e,this.needsDraw=!0}},verticalLength:{get:function(){return this._verticalLength},set:function(e){this._verticalLength=e,this.needsDraw=!0}},horizontalLength:{get:function(){return this._horizontalLength},set:function(e){this._horizontalLength=e,this.needsDraw=!0}},_opacity:{value:0},opacity:{get:function(){return this._opacity},set:function(e){this._opacity=e,this.needsDraw=!0}},_isDisplayUpdated:{value:!1},_displayVertical:{value:!1},displayVertical:{get:function(){return this._displayVertical},set:function(e){this._displayVertical!==e&&(this._displayVertical=e,this._isDisplayUpdated=!0,this.needsDraw=!0)}},_displayHorizontal:{value:!1},displayHorizontal:{get:function(){return this._displayHorizontal},set:function(e){this._displayHorizontal!==e&&(this._displayHorizontal=e,this._isDisplayUpdated=!0,this.needsDraw=!0)}},_top:{value:!1},_bottomClip:{value:!1},_bottom:{value:!1},_left:{value:!1},_rightClip:{value:!1},_right:{value:!1},_hasResizedHorizontal:{value:!1},_hasResizedVertical:{value:!1},willDraw:{value:function(){this._offsetWidth!==this._element.offsetWidth&&(this._offsetWidth=this._element.offsetWidth,this._hasResizedHorizontal=!0),this._offsetHeight!==this._element.offsetHeight&&(this._offsetHeight=this._element.offsetHeight,this._hasResizedVertical=!0)}},draw:{value:function(){var e,t,n,r;if(this._isDisplayUpdated){var i=this._displayVertical?"block":"none",s=this._displayHorizontal?"block":"none";this._top.style.display=this._bottomClip.style.display=i,this._left.style.display=this._rightClip.style.display=s,this._isDisplayUpdated=!1}this._hasResizedHorizontal&&this._displayHorizontal&&(this._rightClip.style.width=this._right.style.width=this._offsetWidth-4+"px",this._rightClip.style.clip="rect(-1px,"+(this._offsetWidth-3)+"px,6px,3px)",this._hasResizedHorizontal=!1),this._hasResizedVertical&&this._displayVertical&&(this._bottomClip.style.height=this._bottom.style.height=this._offsetHeight-4+"px",this._bottomClip.style.clip="rect(3px,6px,"+(this._offsetHeight-3)+"px,-1px)",this._hasResizedVertical=!1);if(this._opacity){if(this._displayHorizontal){n=this._offsetWidth-9-(this._displayVertical?6:0),e=Math.floor(n*this._horizontalLength),r=n-e,1-this._horizontalLength?t=Math.floor(r*this._horizontalScroll/(1-this._horizontalLength)):t=0,t<0&&(e+=t,e<0&&(e=0),t=0),t>r&&(e+=Math.floor(r-t),e<0&&(e=0),t=n-e);var o=e-this._offsetWidth+9+"px,0px",u=t+2+"px,0px";this._right.style.webkitTransform="translate3d("+o+",0)",this._right.style.MozTransform="translate("+o+")",this._right.style.transform="translate("+o+")",this._left.style.webkitTransform=this._rightClip.style.webkitTransform="translate3d("+u+",0)",this._left.style.MozTransform=this._rightClip.style.MozTransform="translate("+u+")",this._left.style.transform=this._rightClip.style.transform="translate("+u+")",this._left.style.webkitTransition=this._right.style.webkitTransition="none",this._left.style.MozTransition=this._right.style.MozTransition="none",this._left.style.transition=this._right.style.transition="none",this._left.style.opacity=this._right.style.opacity=this._opacity}if(this._displayVertical){n=this._offsetHeight-9-(this._displayHorizontal?6:0),e=Math.floor(n*this._verticalLength),r=n-e,1-this._verticalLength?t=Math.floor(r*this._verticalScroll/(1-this._verticalLength)):t=0,t<0&&(e+=t,e<0&&(e=0),t=0),t>r&&(e+=Math.floor(r-t),e<0&&(e=0),t=n-e);var a="0px,"+(e-this._offsetHeight+9)+"px",f="0px,"+(t+2)+"px";this._bottom.style.webkitTransform="translate3d("+a+",0)",this._bottom.style.MozTransform="translate("+a+")",this._bottom.style.transform="translate("+a+")",this._top.style.webkitTransform=this._bottomClip.style.webkitTransform="translate3d("+f+",0)",this._top.style.MozTransform=this._bottomClip.style.MozTransform="translate("+f+")",this._top.style.transform=this._bottomClip.style.transform="translate("+f+")",this._top.style.webkitTransition=this._bottom.style.webkitTransition="none",this._top.style.MozTransition=this._bottom.style.MozTransition="none",this._top.style.transition=this._bottom.style.transition="none",this._top.style.opacity=this._bottom.style.opacity=this._opacity}}else this._displayHorizontal&&(this._left.style.webkitTransition=this._right.style.webkitTransition="300ms opacity",this._left.style.opacity=this._right.style.opacity=0),this._displayVertical&&(this._top.style.webkitTransition=this._bottom.style.webkitTransition="300ms opacity",this._top.style.opacity=this._bottom.style.opacity=0)}}})}}),montageDefine("120b0c7","core/undo-manager",{dependencies:["montage","core/promise","collections/weak-map","collections/list"],factory:function(e,t,n){var r=e("montage").Montage,i=e("core/promise").Promise,s=e("collections/weak-map"),o=e("collections/list"),u=0,a=1,f=t.UndoManager=r.create(r,{_operationQueue:{value:null},_promiseOperationMap:{value:null},didCreate:{value:function(){this._operationQueue=[],this._promiseOperationMap=new s,this._undoStack=new o,this._redoStack=new o,Object.defineBinding(this,"undoCount",{boundObject:this._undoStack,boundObjectPropertyPath:"length",oneway:!0}),Object.defineBinding(this,"redoCount",{boundObject:this._redoStack,boundObjectPropertyPath:"length",oneway:!0})}},_maxUndoCount:{enumerable:!1,value:null},maxUndoCount:{get:function(){return this._maxUndoCount},set:function(e){if(e===this._maxUndoCount)return;this._maxUndoCount=e,this._maxUndoCount!=null&&this._trimStacks()}},_undoStack:{value:null},undoCount:{value:0},_redoStack:{value:null},redoCount:{value:0},_trimStacks:{enumerable:!1,value:function(){var e=this._undoStack.length-this._maxUndoCount,t=this._redoStack.length-this._maxUndoCount;e>0&&this._undoStack.splice(0,e),t>0&&this._redoStack.splice(0,t)}},register:{value:function(e,t){if(!i.isPromiseAlike(t))throw new Error("UndoManager expected a promise");if(0===this._maxUndoCount)return i.resolve(null);var n={label:e};return this._promiseOperationMap.set(t,n),this.isUndoing?(this._redoStack.length===this._maxUndoCount&&this._redoStack.shift(),this._redoStack.push(t)):(this._undoStack.length===this._maxUndoCount&&this._undoStack.shift(),this._undoStack.push(t),!this.isRedoing&&this._redoStack.length>0&&this.clearRedo()),t.spread(this._resolveUndoEntry(this,n))}},_resolveUndoEntry:{value:function(e,t){return function(){var n,r,i,s;typeof arguments[0]=="string"?(n=arguments[0],r=arguments[1],i=arguments[2],s=3):(r=arguments[0],i=arguments[1],s=2),n&&(t.label=n),t.undoFunction=r,t.context=i,t.args=Array.prototype.slice.call(arguments,s),e._flushOperationQueue()}}},_flushOperationQueue:{value:function(){var e=this._operationQueue,t=e.length,n,r=[],i,s,o,u=this._promiseOperationMap;if(0===t)return;for(n=t-1;n>=0;n--){s=e[n],o=this._promiseOperationMap.get(s);if(typeof o.undoFunction!="function")break;this._performOperation(o),r.push(s)}i=r.length,i>0&&(e.splice(t-i,i),r.forEach(function(e){u.delete(e)}))}},_performOperation:{value:function(e){e.operationType===u?this.undoEntry=e:this.redoEntry=e,e.undoFunction.apply(e.context,e.args),this.undoEntry=null,this.redoEntry=null,e.deferredOperation.resolve(!0)}},clearUndo:{value:function(){this._undoStack.splice(0,this._undoStack.length)}},clearRedo:{value:function(){this._redoStack.splice(0,this._redoStack.length)}},isUndoing:{dependencies:["undoEntry"],get:function(){return!!this.undoEntry}},isRedoing:{dependencies:["redoEntry"],get:function(){return!!this.redoEntry}},undoEntry:{enumerable:!1,value:null},redoEntry:{enumerable:!1,value:null},undo:{value:function(){return 0===this.undoCount?i.resolve(null):this._scheduleOperation(this._undoStack.pop(),u)}},redo:{value:function(){return 0===this.redoCount?i.resolve(null):this._scheduleOperation(this._redoStack.pop(),a)}},_scheduleOperation:{value:function(e,t){var n=i.defer(),r=this._promiseOperationMap.get(e);return r.deferredOperation=n,r.operationType=t,this._operationQueue.push(e),this._flushOperationQueue(),n.promise}},canUndo:{dependencies:["_undoStack.length"],get:function(){return!!this._undoStack.length}},canRedo:{dependencies:["_redoStack.length"],get:function(){return!!this._redoStack.length}},undoLabel:{dependencies:["_undoStack.length"],get:function(){var e;return this.canUndo&&(e=this._promiseOperationMap.get(this._undoStack.one()).label),e}},redoLabel:{dependencies:["_redoStack.length"],get:function(){var e;return this.canRedo&&(e=this._promiseOperationMap.get(this._redoStack.one()).label),e}}}),l=null;r.defineProperty(t,"defaultUndoManager",{get:function(){return l||(l=f.create()),l}})}}),montageDefine("120b0c7","ui/scroller.reel/scroller",{dependencies:["montage","ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component;t.Scroller=r.create(i,{_scrollX:{value:0},scrollX:{get:function(){return this._scrollX},set:function(e){this._scrollX!==e&&(this._scrollX=e,this.needsDraw=!0)}},_scrollY:{value:0},scrollY:{get:function(){return this._scrollY},set:function(e){this._scrollY!==e&&(this._scrollY=e,this.needsDraw=!0)}},_maxTranslateX:{value:0},_maxTranslateY:{value:0},_axis:{value:"auto"},axis:{get:function(){return this._axis},set:function(e){this._axis=e,this.needsDraw=!0}},_displayScrollbars:{value:"auto"},displayScrollbars:{get:function(){return this._displayScrollbars},set:function(e){switch(e){case"vertical":case"horizontal":case"both":case"auto":this._displayScrollbars=e;break;default:this._displayScrollbars="none"}this.needsDraw=!0}},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=e}},_content:{value:null},_scrollBars:{value:null},handleTranslateStart:{value:function(e){this._scrollBars.opacity=.5}},handleTranslateEnd:{value:function(e){this._scrollBars.opacity=0}},canDraw:{value:function(){return this.needsDraw=!0,i.canDraw.apply(this,arguments)}},willDraw:{value:function(){this._left=this._element.offsetLeft,this._top=this._element.offsetTop,this._width=this._element.offsetWidth,this._height=this._element.offsetHeight,this._maxTranslateX=this._content.scrollWidth-this._width,this._maxTranslateX<0&&(this._maxTranslateX=0),this._maxTranslateY=this._content.offsetHeight-this._height,this._maxTranslateY<0&&(this._maxTranslateY=0);var e=this.callDelegateMethod("didSetMaxScroll",{x:this._maxTranslateX,y:this._maxTranslateY});e&&(this._maxTranslateX=e.x,this._maxTranslateY=e.y),this.scrollX=Math.min(this._scrollX,this._maxTranslateX),this.scrollY=Math.min(this._scrollY,this._maxTranslateY);switch(this._displayScrollbars){case"horizontal":this._scrollBars.displayHorizontal=!0,this._scrollBars.displayVertical=!1;break;case"vertical":this._scrollBars.displayHorizontal=!1,this._scrollBars.displayVertical=!0;break;case"both":this._scrollBars.displayHorizontal=!0,this._scrollBars.displayVertical=!0;break;case"auto":this._scrollBars.displayHorizontal=!!this._maxTranslateX,this._scrollBars.displayVertical=!!this._maxTranslateY;break;case"none":this._scrollBars.displayHorizontal=!1,this._scrollBars.displayVertical=!1}this._scrollBars.displayHorizontal&&(this._content.scrollWidth?(this._scrollBars.horizontalLength=this._width/this._content.scrollWidth,this._scrollBars.horizontalScroll=this._scrollX/this._content.scrollWidth):(this._scrollBars.horizontalLength=1,this._scrollBars.horizontalScroll=0)),this._scrollBars.displayVertical&&(this._content.offsetHeight?(this._scrollBars.verticalLength=this._height/this._content.offsetHeight,this._scrollBars.verticalScroll=this._scrollY/this._content.offsetHeight):(this._scrollBars.verticalLength=1,this._scrollBars.verticalScroll=0))}},draw:{value:function(){var e=-this._scrollX+"px, "+ -this._scrollY+"px";this._content.style.webkitTransform="translate3d("+e+", 0px)",this._content.style.MozTransform="translate("+e+")",this._content.style.transform="translate("+e+")"}}})}}),montageDefine("a005228","ui/value-based-effect.reel/value-based-effect.html",{text:'<!doctype html>\n\n<html>\n<head>\n    <meta http-equiv=Content-Type content="text/html; charset=utf-8">\n    <title>ValueBasedEffect</title>\n    <link rel=stylesheet href=value-based-effect.css>\n\n    <script type="text/montage-serialization">{"enabledToggle":{"prototype":"montage/ui/toggle-button.reel","properties":{"element":{"#":"toggle"},"pressedClass":"success","pressedLabel":"ON","unpressedLabel":"OFF"},"bindings":{"pressed":{"<->":"@owner.enabled"}}},"valueSlider":{"prototype":"montage/ui/input-range.reel","properties":{"element":{"#":"valueSlider"},"identifier":"valueSlider"},"bindings":{"value":{"<->":"@owner.sliderValue"},"min":{"<->":"@owner.minValue"},"max":{"<->":"@owner.maxValue"}},"listeners":[{"type":"montage_range_interaction_start","listener":{"@":"owner"},"useCapture":false},{"type":"montage_range_interaction_end","listener":{"@":"owner"},"useCapture":false}]},"numberconverter1":{"prototype":"montage/core/converter/number-converter","properties":{"decimals":2}},"valueDisplay":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"valueDisplay"}},"bindings":{"value":{"<-":"@owner.value","converter":{"@":"numberconverter1"}}}},"resetListener":{"prototype":"montage/core/event/action-event-listener","properties":{"handler":{"@":"owner"},"action":"reset"}},"resetAvailableConverter":{"prototype":"ui/value-based-effect.reel[ResetAvailableConverter]","bindings":{"defaultValue":{"<-":"@owner.defaultValue"}}},"resetCondition":{"prototype":"montage/ui/condition.reel","properties":{"element":{"#":"resetCondition"}},"bindings":{"condition":{"<-":"@owner.value","converter":{"@":"resetAvailableConverter"}}}},"resetButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"resetButton"},"value":"Reset"},"listeners":[{"type":"action","listener":{"@":"resetListener"},"capture":false}]},"owner":{"properties":{"element":{"#":"control"}}}}</script>\n\n</head>\n<body>\n\n    <div data-montage-id=control class=ValueBasedEffect>\n        <button data-montage-id=toggle class=btn style="width: 60px">ON</button>\n        <div class=valueControl>\n            <input type=range data-montage-id=valueSlider class=slider name=multiply>\n            <div data-montage-id=valueDisplay class=value></div>\n        </div>\n\n        <div data-montage-id=resetCondition>\n            <div data-montage-id=resetButton class=text></div>\n        </div>\n    </div>\n\n</body>\n</html>'}),montageDefine("a005228","ui/ruler.reel/ruler",{dependencies:["montage","montage/ui/component","montage/core/geometry/point","montage/ui/dom"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/ui/component").Component,s=e("montage/core/geometry/point").Point,o=e("montage/ui/dom");t.Ruler=r.create(i,{_position:{value:null},position:{get:function(){return this._position},set:function(e){if(e===this._position)return;this._position=e,this.needsDraw=!0}},_savedPosition:{value:null},savedPosition:{get:function(){return this._savedPosition},set:function(e){if(e===this._savedPosition)return;this._savedPosition=e,this.needsDraw=!0}},rangeStart:{value:0},rangeEnd:{value:null},_axis:{value:"x"},axis:{get:function(){return this._axis},set:function(e){if(e===this._axis)return;this._axis=e,this.needsDraw=!0}},container:{value:null},positionText:{value:null},savedPositionText:{value:null},distanceText:{value:null},prepareForDraw:{value:function(){window.Touch||document.addEventListener("mousemove",this)}},handleMousemove:{value:function(e){var t=s.create().init(e.pageX,e.pageY);this.container&&(t=o.convertPointFromPageToNode(this.container,t)),this.position=t[this.axis]}},distance:{dependencies:["savedPosition","position"],get:function(){return null!=this.savedPosition&&null!=this.position?this.position-this.savedPosition:null}},draw:{value:function(){"x"===this.axis?(this.element.classList.add("horizontal"),this.element.classList.remove("vertical")):(this.element.classList.add("vertical"),this.element.classList.remove("horizontal"));var e=this.position>this.rangeStart?this.position:this.rangeStart;null!=this.rangeEnd&&e>this.rangeEnd&&(e=this.rangeEnd),this.positionText.element.style.left=e+"px";var t=this.savedPosition>this.rangeStart?this.savedPosition:this.rangeStart;null!=this.rangeEnd&&t>this.rangeEnd&&(t=this.rangeEnd),this.savedPositionText.element.style.left=t+"px",null!=this.distance?(this.distanceText.element.style.width=Math.abs(this.distance)+"px",this.distance<0?this.distanceText.element.style.left=e+"px":this.distanceText.element.style.left=t+"px"):this.distanceText.element.style.width="0"}}})}}),montageDefine("a005228","ui/search-panel.reel/search-panel.html",{text:'<!doctype html>\n\n<html>\n<head>\n    <meta http-equiv=Content-Type content="text/html; charset=utf-8">\n    <title>SearchPanel</title>\n    <link rel=stylesheet href=search-panel.css>\n\n    <script type="text/montage-serialization">{"owner":{"properties":{"element":{"#":"searchPanel"},"searchForm":{"#":"searchForm"},"searchResultsList":{"@":"searchResultsList"}},"bindings":{"queryParameter":{"<->":"@queryField.value"}}},"searchResultsController":{"prototype":"montage/ui/controller/array-controller","bindings":{"content":{"<->":"@owner.searchResults"}}},"queryField":{"prototype":"montage/ui/input-text.reel","properties":{"element":{"#":"queryField"}}},"searchButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"searchButton"}}},"searchResultsList":{"prototype":"montage/ui/list.reel","properties":{"element":{"#":"searchResultsList"},"contentController":{"@":"searchResultsController"},"axis":"vertical"}},"searchResult":{"prototype":"ui/search-result.reel","properties":{"element":{"#":"searchResult"}},"bindings":{"result":{"<-":"@searchResultsList.objectAtCurrentIteration"},"photoListController":{"<-":"@owner.photoListController"}}}}</script>\n\n</head>\n<body>\n\n    <div data-montage-id=searchPanel class=SearchPanel>\n\n        <form data-montage-id=searchForm class=searchForm>\n            <input data-montage-id=queryField>\n            <input type=submit data-montage-id=searchButton class="submit btn" value=Search>\n        </form>\n\n        <div class=searchArea>\n            <div class=loadingIndicator>Searching…</div>\n\n            <div data-montage-id=searchResultsList class=SearchResultsList>\n                <div data-montage-id=searchResult></div>\n            </div>\n        </div>\n\n    </div>\n\n</body>\n</html>'}),montageDefine("a005228","ui/photo-info-panel.reel/photo-info-panel.html",{text:'<!doctype html>\n\n<html>\n<head>\n    <meta http-equiv=Content-Type content="text/html; charset=utf-8">\n    <title>PhotoInfoPanel</title>\n    <link rel=stylesheet type="text/css" href=photo-info-panel.css>\n\n    <script type="text/montage-serialization">{"owner":{"properties":{"element":{"#":"photoInfoPanel"},"_dragProxy":{"#":"dragProxy"},"_canvas":{"#":"canvas"}}},"title":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"title"}},"bindings":{"value":{"<->":"@owner.photo.title"}}},"author":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"author"}},"bindings":{"value":{"<->":"@owner.photo.authors.0"}}},"thumbnailCondition":{"prototype":"montage/ui/condition.reel","properties":{"element":{"#":"thumbnailCondition"},"removalStrategy":"hide"},"bindings":{"condition":{"<->":"@owner.photo"}}}}</script>\n\n</head>\n<body>\n\n    <div data-montage-id=photoInfoPanel class=PhotoInfoPanel>\n        <div data-montage-id=thumbnailCondition class=thumbnail>\n            <img data-montage-id=dragProxy class=dragProxy>\n            <canvas data-montage-id=canvas class=canvas></canvas>\n        </div>\n        <h2 data-montage-id=title class="title text"></h2>\n        <p data-montage-id=author class="author text"></p>\n    </div>\n\n</body>\n</html>'}),montageDefine("a005228","ui/ruler.reel/ruler.html",{text:'<!doctype html>\n\n<html>\n<head>\n    <meta http-equiv=Content-Type content="text/html; charset=utf-8">\n    <title>Ruler</title>\n    <link rel=stylesheet type="text/css" href=ruler.css>\n\n    <script type="text/montage-serialization">{"positionText":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"positionText"}},"bindings":{"value":{"<-":"@owner.position"}}},"savedPositionText":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"savedPositionText"}},"bindings":{"value":{"<-":"@owner.savedPosition"}}},"distanceText":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"distanceText"}},"bindings":{"value":{"<-":"@owner.distance"}}},"owner":{"properties":{"element":{"#":"ruler"},"positionText":{"@":"positionText"},"savedPositionText":{"@":"savedPositionText"},"distanceText":{"@":"distanceText"}}}}</script>\n\n</head>\n<body>\n\n    <div data-montage-id=ruler class=Ruler>\n        <span data-montage-id=savedPositionText class=savedPositionText></span>\n        <span data-montage-id=distanceText class=distanceText></span>\n        <span data-montage-id=positionText class=positionText></span>\n    </div>\n\n</body>\n</html>'}),montageDefine("120b0c7","ui/composer/composer",{dependencies:["montage"],factory:function(e,t,n){var r=e("montage").Montage;t.Composer=r.create(r,{_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},lazyLoad:{value:!1},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:function(e){}},_resolveDefaults:{value:function(){this.element==null&&this.component!=null&&(this.element=this.component.element)}},_load:{value:function(){this.element||this._resolveDefaults(),this.load()}},load:{value:function(){}},unload:{value:function(){}},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}})}}),montageDefine("120b0c7","ui/popup/popup.reel/popup.html",{text:'<!DOCTYPE html>\n\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=popup.css>\n    <script type="text/montage-serialization">{"slot1":{"prototype":"ui/slot.reel","properties":{"element":{"#":"popup-content"}}},"owner":{"prototype":"ui/popup/popup.reel","properties":{"element":{"#":"popup-container"},"slot":{"@":"slot1"},"contentEl":{"#":"popup-content"},"containerEl":{"#":"popup-wrapper"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=popup-container class="montage-invisible montage-Popup-container">\n        <div data-montage-id=popup-wrapper class="montage-Popup-tooltip montage-Popup-wrapper montage-Popup-border">\n            <div data-montage-id=popup-content class=montage-Popup-content></div>\n        </div>\n    </div>\n</body>\n</html>'}),montageDefine("120b0c7","core/converter/converter",{dependencies:["montage"],factory:function(e,t,n){var r=e("montage").Montage,i="[object Function]",s="[object Boolean]",o="[object Number]",u="[object String]",a="[object Array]",f="[object Date]",l=Object.prototype.toString,c=function(e){return l.call(e)===o};t.isNumber=c;var h=function(e){return e&&typeof e!="undefined"};t.isDef=h;var p=t.Validator=r.create(r,{validate:{value:null}}),d=t.Converter=r.create(r,{allowPartialConversion:{value:!0},convert:{enumerable:!1,value:null},revert:{enumerable:!1,value:null}})}}),montageDefine("a005228","ui/point-marker.reel/point-marker.html",{text:'<!doctype html>\n\n<html>\n<head>\n    <meta http-equiv=Content-Type content="text/html; charset=utf-8">\n    <title>PointMarker</title>\n    <link rel=stylesheet href=point-marker.css>\n\n    <script type="text/montage-serialization">{"owner":{"properties":{"element":{"#":"pointMarker"}}}}</script>\n\n</head>\n<body>\n\n    <div data-montage-id=pointMarker class=PointMarker></div>\n\n</body>\n</html>'}),montageDefine("a005228","core/effect/desaturate-effect",{dependencies:["montage","core/effect/effect"],factory:function(e,t,n){var r=e("montage").Montage,i=e("core/effect/effect").Effect;t.DesaturateEffect=r.create(i,{applyEffect:{value:function(e,t){var n=0,r;for(n=0;n<t;n+=4)r=(e[n]+e[n+1]+e[n+2])/3,e[n]=r,e[n+1]=r,e[n+2]=r}}})}}),montageDefine("a005228","core/negation-converter",{dependencies:["montage","montage/core/converter/converter"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/core/converter/converter").Converter;t.NegationConverter=r.create(i,{convert:{value:function(e){return!e}},revert:{value:function(e){return!e}}})}}),montageDefine("a005228","core/valid-number-converter",{dependencies:["montage","montage/core/converter/converter"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/core/converter/converter").Converter;t.ValidNumberConverter=r.create(i,{convert:{value:function(e){return 0===e?!0:!!e}}})}}),montageDefine("120b0c7","ui/input-text.reel/input-text.html",{text:"<!DOCTYPE html>\n\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=input-text.css>\n</head>\n<body>\n</body>\n</html>"})
bundleLoaded(undefined)
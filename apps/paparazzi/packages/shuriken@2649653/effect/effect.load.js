montageDefine("2649653","effect/effect",{dependencies:["montage/core/core","animation/animation-manager","montage/ui/template"],factory:function(e,t,n){var r=e("montage/core/core").Montage,i=e("animation/animation-manager").AnimationManager,s=e("montage/ui/template").Template,o=r.create(r,{_path:{value:null},_type:{value:null},_startValue:{value:null},_endValue:{value:null},_context:{value:null},_delegate:{value:null},_duration:{value:0},_startTime:{value:0},_intervalRequest:{value:0},init:{value:function(e,t,n,r,i,s,o){this._type=t,this._startValue=n,this._endValue=r,this._context=s,this._delegate=o,this._duration=i,this._path=e}},handleUpdate:{value:function(){var e=new Date,t=e.getTime()/1e3,n=(t-this._startTime)/this._duration;if(this._delegate){var r;this._type==="vec4"?(r=[0,0,0,0],r[0]=(1-n)*this._startValue[0]+n*this._endValue[0],r[1]=(1-n)*this._startValue[1]+n*this._endValue[1],r[2]=(1-n)*this._startValue[2]+n*this._endValue[2],r[3]=(1-n)*this._startValue[3]+n*this._endValue[3]):this._type==="float"&&(r=(1-n)*this._startValue+n*this._endValue),this._delegate.handleAnimationValueUpdate&&this._delegate.handleAnimationValueUpdate(this,this._path,r)}}},stopAnimation:{value:function(){clearInterval(this._intervalRequest)}},run:{value:function(){var e=new Date,t=e.getTime()/1e3,n=this;this._startTime=t,this._intervalRequest=setInterval(function(){n.handleUpdate.call(n)},1/30),setTimeout(function(){n.stopAnimation.call(n)},this._duration*1e3)}}});Effect=t.Effect=r.create(r,{_name:{enumerable:!0,value:""},name:{enumerable:!1,get:function(){return this._name},set:function(e){this._name=e}},_profiles:{enumerable:!0,value:{}},profiles:{enumerable:!1,get:function(){return this._profiles},set:function(e){this._profiles=e}},_template:{enumerable:!0,value:{}},template:{enumerable:!1,get:function(){return this._template},set:function(e){this._template=e}},loadTemplate:{value:function(e,t,n,i){if(this.template&&(!this._isTemplateLoaded||!this._isTemplateLoading)){this._isTemplateLoading=!0;var o=this,u,a,f=this.inputs,l=function(n){n.instantiateWithOwnerAndDocument(o,window.document,function(n){n.name=t;if(f){var r=Object.keys(f);r.forEach(function(e){n.inputs[e].value=f[e].value},this)}e&&e(n,i)}),o._isTemplateLoaded=!0,o._isTemplateLoading=!1},c;n?(u=r.getInfoForObject(this),c=u.require):c=window.require,s.templateWithModuleId(c,this.template,l)}}},_inputsDidChange:{value:function(){var e=this.inputKeys,t=this;e.forEach(function(e){var t=this.inputs[e].value;r.defineProperty(this.inputs[e],"_value",{writable:!0,value:null}),r.defineProperty(this.inputs[e],"handleAnimationValueUpdate",{value:function(e,t,n){this.animatedValue=n}}),r.defineProperty(this.inputs[e],"animatedValue",{writable:!0,value:null}),r.defineProperty(this.inputs[e],"value",{get:function(){return this._value},set:function(e){var t=i.animationDuration>0;if(t&&this._value!==null&&this.type==="vec4"){var n=r.create(o);n.init(null,"vec4",this._value,e,i.animationDuration,this,this),n.run()}else this.animatedValue=e;this._value=e}}),this.inputs[e].animatedValue=t,this.inputs[e].value=t},this)}},_inputs:{enumerable:!1,value:null},inputs:{enumerable:!0,get:function(){return this._inputs},set:function(e){this._inputs=e,this._inputsDidChange()}},inputKeys:{enumerable:!1,get:function(){return this._inputs?Object.keys(this._inputs):[]}}})}})
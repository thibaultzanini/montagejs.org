function defineEach(e){for(var t in e)Object.defineProperty(Array.prototype,t,{value:e[t],writable:!0,configurable:!0,enumerable:!1})}require("../shim");var List=require("../list"),WeakMap=require("../weak-map"),PropertyChanges=require("./property-changes"),RangeChanges=require("./range-changes"),MapChanges=require("./map-changes"),array_splice=Array.prototype.splice,array_slice=Array.prototype.slice,array_reverse=Array.prototype.reverse,array_sort=Array.prototype.sort,protoIsSupported={}.__proto__===Object.prototype,array_makeObservable;protoIsSupported?array_makeObservable=function(){this.__proto__=ChangeDispatchArray}:array_makeObservable=function(){Object.defineProperties(this,observableArrayProperties)},Object.defineProperty(Array.prototype,"makeObservable",{value:array_makeObservable,writable:!0,configurable:!0,enumerable:!1}),defineEach(PropertyChanges.prototype),defineEach(RangeChanges.prototype),defineEach(MapChanges.prototype);var observableArrayProperties={isObservable:{value:!0,writable:!0,configurable:!0},makeObservable:{value:Function.noop,writable:!0,configurable:!0},reverse:{value:function(){this.dispatchBeforeRangeChange(this,this,0);for(var t=0;t<this.length;t++)PropertyChanges.dispatchBeforeOwnPropertyChange(this,t,this[t]),this.dispatchBeforeMapChange(t,this[t]);array_reverse.call(this);for(var t=0;t<this.length;t++)PropertyChanges.dispatchOwnPropertyChange(this,t,this[t]),this.dispatchMapChange(t,this[t]);return this.dispatchRangeChange(this,this,0),this},writable:!0,configurable:!0},sort:{value:function(){this.dispatchBeforeRangeChange(this,this,0);for(var t=0;t<this.length;t++)PropertyChanges.dispatchBeforeOwnPropertyChange(this,t,this[t]),this.dispatchBeforeMapChange(t,this[t]);array_sort.apply(this,arguments);for(var t=0;t<this.length;t++)PropertyChanges.dispatchOwnPropertyChange(this,t,this[t]),this.dispatchMapChange(t,this[t]);return this.dispatchRangeChange(this,this,0),this},writable:!0,configurable:!0},splice:{value:function(t,n){var r=array_slice.call(this,t,t+n),i=array_slice.call(arguments,2);if(!r.length&&!i.length)return i;var s=i.length-r.length,o=this.length,u=Math.max(this.length+s,t+i.length),a=Math.max(o,u);s&&PropertyChanges.dispatchBeforeOwnPropertyChange(this,"length",this.length),this.dispatchBeforeRangeChange(i,r,t);if(s===0)for(var f=t;f<t+i.length;f++)PropertyChanges.dispatchBeforeOwnPropertyChange(this,f,this[f]),this.dispatchBeforeMapChange(f,this[f]);else if(PropertyChanges.hasOwnPropertyChangeDescriptor(this))for(var f=t;f<a;f++)PropertyChanges.dispatchBeforeOwnPropertyChange(this,f,this[f]),this.dispatchBeforeMapChange(f,this[f]);t>o&&(this.length=t);var l=array_splice.apply(this,arguments);if(s===0)for(var f=t;f<t+i.length;f++)PropertyChanges.dispatchOwnPropertyChange(this,f,this[f]),this.dispatchMapChange(f,this[f]);else if(PropertyChanges.hasOwnPropertyChangeDescriptor(this))for(var f=t;f<a;f++)PropertyChanges.dispatchOwnPropertyChange(this,f,this[f]),this.dispatchMapChange(f,this[f]);return this.dispatchRangeChange(i,r,t),s&&PropertyChanges.dispatchOwnPropertyChange(this,"length",this.length),l},writable:!0,configurable:!0},set:{value:function(t,n){return this.splice(t,1,n),this},writable:!0,configurable:!0},shift:{value:function(){return this.splice(0,1)[0]},writable:!0,configurable:!0},pop:{value:function(){if(this.length)return this.splice(this.length-1,1)[0]},writable:!0,configurable:!0},push:{value:function(t){if(arguments.length===1)return this.splice(this.length,0,t);var n=array_slice.call(arguments);return this.swap(this.length,0,n)},writable:!0,configurable:!0},unshift:{value:function(t){if(arguments.length===1)return this.splice(0,0,t);var n=array_slice.call(arguments);return this.swap(0,0,n)},writable:!0,configurable:!0},clear:{value:function(){return this.splice(0,this.length)},writable:!0,configurable:!0}},ChangeDispatchArray=Object.create(Array.prototype,observableArrayProperties)
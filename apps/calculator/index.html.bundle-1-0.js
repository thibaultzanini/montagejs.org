montageDefine("120b0c7","ui/repetition.reel/repetition",{dependencies:["montage","ui/component","ui/template","core/logger","core/gate","core/change-notification"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component,s=e("ui/template").Template,o=e("core/logger").logger("repetition"),u=e("core/gate").Gate,a=e("core/change-notification").ChangeNotification,f=e("core/change-notification").PropertyChangeNotification,l=r.create(Object.prototype,{_repetition:{value:null},_fakeIndex:{value:null},_unusedIndexes:{value:null},initWithRepetition:{value:function(e){return this._repetition=e,this._fakeIndex=[],this._unusedIndexes=[],this}},automaticallyDispatchPropertyChangeListener:{value:function(){return!1}},undefinedGet:{value:function(e){if(this._repetition.objects)return this._repetition.objects[this._fakeIndex.indexOf(e)]}},0:{set:function(){throw'You cannot use a two-way binding on the "objectAtCurrentIteration" or "current" property.'},get:function(){if(this._repetition.objects)return this._repetition.objects[this._fakeIndex.indexOf("0")]}},addFakeObjectAtPosition:{value:function(e){var t;return this._unusedIndexes.length>0?t=this._unusedIndexes.pop():t=String(this._fakeIndex.length),this._fakeIndex.splice(e,0,t),t}},resetFakeObjects:{value:function(){var e=this._repetition.objects;this._fakeIndex.length=0;if(e)for(var t=0,n=e.length;t<n;t++)this._fakeIndex[t]=String(t)}},removeFakeObjectAtPosition:{value:function(e){var t;return this._unusedIndexes.unshift(this._fakeIndex.splice(e,1)[0]),this._unusedIndexes[0]}},_dispatchFakePropertyChange:{value:function(e,t){var n,r;n=a.getPropertyChangeDescriptor(this,e),n&&(r=Object.create(f),r.target=this,r.propertyPath=e,r.minus=t,r.plus=this.undefinedGet(e),t!==r.plus&&n.handleChange(r))}}}),c=t.Repetition=r.create(i,{hasTemplate:{value:!1},didCreate:{value:function(){this.addPropertyChangeListener("objects",this),this._fakeObjects=Object.create(l).initWithRepetition(this)}},clonesChildComponents:{value:!0},_emptyFunction:{value:function(){}},_updateItems:{value:function(e,t,n){var r=this._fakeObjects,i,s=e?e.length:0,o=t?t.length:0,u,a,f;u=Math.max(s,o),a=Math.min(s,o),f=o-s;for(var l=0;l<a;l++)r._dispatchFakePropertyChange(r._fakeIndex[n+l],e[n+l]);if(f>0){this._expectedChildComponentsCount+=(this._iterationChildComponentsCount||1)*f,this.canDrawGate.setField("iterationLoaded",!1);for(;l<u;l++)r.addFakeObjectAtPosition(n+l),this._addItem({index:n+l,insertionIndex:n+l})}else if(f<0){var c=n+a;for(;l<u;l++)i=r.removeFakeObjectAtPosition(c),r._dispatchFakePropertyChange(i,e[l]),this._deleteItem(c)}}},handleChange:{enumerable:!1,value:function(e){"objects"===e.currentPropertyPath&&this._isComponentExpanded&&this._updateItems(e.minus,e.plus,e.index||0)}},_fakeObjects:{value:null},_hasBeenDeserialized:{value:!1,enumerable:!1},_nextDeserializedItemIx:{enumerable:!1,value:0,distinct:!0},init:{enumerable:!1,value:function(){return this._items=[],this._itemsToAppend=[],this._nextDeserializedItemIx=0,this._itemsToRemove=[],this._deletedItems=[],this}},_contentController:{value:null},contentController:{get:function(){return this._contentController},set:function(e){if(this._contentController===e)return;this._contentController&&(Object.deleteBinding(this,"objects"),Object.deleteBinding(this,"selectedIndexes")),this._contentController=e;if(this._contentController){this._bindingDescriptors&&Object.deleteBinding(this,"objects");var t,n;t={boundObject:this._contentController,boundObjectPropertyPath:"organizedObjects",oneway:!0},n={boundObject:this._contentController,boundObjectPropertyPath:"selectedIndexes"},this._hasBeenDeserialized?(Object.defineBinding(this,"objects",t),Object.defineBinding(this,"selectedIndexes",n)):(this._controllerBindingsToInstall||(this._controllerBindingsToInstall={}),this._controllerBindingsToInstall.objects=t,this._controllerBindingsToInstall.selectedIndexes=n)}}},_objects:{enumerable:!1,value:null},_mappedObjects:{enumerable:!1,value:null},objects:{dependencies:["indexMap","indexMapEnabled"],enumerable:!1,serializable:!0,get:function(){return!this.indexMap||!this.indexMapEnabled?this._objects:(this._objects&&!this._mappedObjects&&(this._mappedObjects=this.indexMap.map(function(e){return isNaN(e)?undefined:this._objects.getProperty(e)},this)),this._mappedObjects)},set:function(e){o.isDebug&&o.debug(this," set objects:",e?e.length:null,e,"same objects?",e===this._objects),this._mappedObjects=null,this._objects=e,this.contentController||(this.selectedIndexes=null)}},_isSelectionEnabled:{enumerable:!1,value:!1},isSelectionEnabled:{get:function(){return this._isSelectionEnabled},set:function(e){if(e===this._isSelectionEnabled)return;this._isSelectionEnabled=e,this._isComponentExpanded&&this._refreshSelectionTracking()}},_childLoadedCount:{enumerable:!1,value:0},_iterationChildComponentsCount:{enumerable:!1,value:null},_expectedChildComponentsCount:{enumerable:!1,value:null},_indexMap:{enumerable:!1,value:null},indexMap:{get:function(){return this._indexMap}},_indexMapEnabled:{enumerable:!1,value:!1},indexMapEnabled:{get:function(){return this._indexMapEnabled},set:function(e){if(e===this._indexMapEnabled)return;!this._indexMap&&e&&(this._indexMap=[]),this._indexMapEnabled=e,this.refreshIndexMap()}},_drawnIndexMap:{enumerable:!1,value:null},drawnIndexMap:{get:function(){return this._drawnIndexMap}},mapIndexToIndex:{value:function(e,t,n){this._indexMap||(this._indexMap=[]);if(t===this._indexMap[e]||!isNaN(t)&&this._indexMap.indexOf(t)>-1)return;this._indexMap[e]=t,this._indexMapAffectedIndexes[e]=!0,this._indexMapChanged=!0,(n||typeof n=="undefined")&&this.refreshIndexMap()}},clearIndexMap:{value:function(){this._indexMap.clear()}},refreshIndexMap:{value:function(){var e=this._mappedObjects;this._mappedObjects=null,this._isComponentExpanded&&(this._updateItems(e,this.objects,0),this.needsDraw=!0)}},_indexMapChanged:{enumerable:!1,value:!1},_indexMapAffectedIndexes:{enumerable:!1,distinct:!0,value:{}},_dirtyIndexes:{enumerable:!1,distinct:!0,value:{}},_items:{enumerable:!1,value:[],distinct:!0},_itemsToAppend:{enumerable:!1,value:[],distinct:!0},_itemsToRemove:{enumerable:!1,value:[],distinct:!0},_deletedItems:{enumerable:!1,value:[],distinct:!0},_updatingItems:{value:!1},_refreshItems:{value:function(){if(this._updatingItems)return;this._updatingItems=!0;var e=this._objects?this._objects.length:0,t=this._items.length+this._itemsToAppend.length,n,r,i=this._addItem,s=this._deleteItem;this._objects&&this.indexMap&&this._indexMapEnabled&&(e=this.indexMap.length),n=e-t,0!==n&&(this.needsDraw=!0);if(n>0){this._expectedChildComponentsCount+=(this._iterationChildComponentsCount||1)*n,this.canDrawGate.setField("iterationLoaded",!1);for(r=0;r<n;r++)i.call(this)}else if(n<0)for(r=n;r<0;r++)s.call(this);this._updatingItems=!1}},_addItems:{value:function(e,t){var n=e.length;if(this._updatingItems)return;this._updatingItems=!0,this._expectedChildComponentsCount+=(this._iterationChildComponentsCount||1)*n,this.canDrawGate.setField("iterationLoaded",!1);for(var r=0;r<n;r++)this._addItem({index:t+r,insertionIndex:t+r});this._updatingItems=!1}},_addItem:{value:function(e){var t=this,n=this._items,r,i,s,o,u=this._itemsToAppend,a,f,l,c=t.canDrawGate,h;e||(e={}),a=u.push(e)-1,o=n.length+a;if("index"in e)for(h=0;h<a;h++){var p=u[h];p.index>=e.index&&p.index++}t._canDraw=!1,s=this._iterationChildComponentsCount,this._iterationTemplate.instantiateWithComponent(this,function(){if(s===0)++t._childLoadedCount===t._expectedChildComponentsCount&&(c.setField("iterationLoaded",!0),t.needsDraw=!0);else{r=t.childComponents,f=o*t._iterationChildComponentsCount,l=f+s;for(h=f;h<l;h++)i=r[h],i.needsDraw=!0,i.loadComponentTree(function(){++t._childLoadedCount===t._expectedChildComponentsCount&&(c.setField("iterationLoaded",!0),t.needsDraw=!0)})}})}},_deleteItem:{value:function(e){var t,n=e,r,i=this.childComponents,s=this._iterationChildComponentsCount,o=this._itemsToAppend,u=o.length,a=!1,f=0;for(var l=0;l<u;l++){var c=o[l];c.index>e?c.index--:c.index<e?f++:a=c.removed=!0}if(!a){if(!(this._items.length>0))throw"BUG: _deleteItem was called on the repetition but no elements exist to be removed";n=e-f,t=this._items.splice(n,1)[0],t.removalIndex=n,this._itemsToRemove.push(t),this._removeIterationChildComponents(t.childComponentsIndex)}this.needsDraw=!0}},_removeIterationChildComponents:{value:function(e){var t=this.childComponents,n=this._iterationChildComponentsCount,r,i,s;if(n>0){r=t.splice(e,n),this._childLoadedCount-=n,this._expectedChildComponentsCount-=n;for(var o=0,u=r.length;o<u;o++)r[o].cleanupDeletedComponentTree(!0);i=this._items;for(var o=0;s=i[o];o++)s.childComponentsIndex>e&&(s.childComponentsIndex-=n);i=this._itemsToAppend;for(var o=0;s=i[o];o++)s.childComponentsIndex>e&&(s.childComponentsIndex-=n)}else this._childLoadedCount--,this._expectedChildComponentsCount--}},_iterationTemplate:{enumerable:!1,value:null},expandComponent:{value:function(e){this._updatingItems||this._setupIterationTemplate(),this._isComponentExpanded=!0,e&&e()}},templateDidDeserializeObject:{value:null},_setupIterationTemplate:{value:function(){var e=this._element,t=this.childComponents,n;this.setupIterationSerialization(),this.setupIterationDeserialization(),this._iterationChildComponentsCount=t.length,this._iterationChildCount=e.childNodes.length,this._iterationChildElementCount=e.children.length,this._iterationChildComponentsCount>0?(this._templateId=t[0]._suuid||t[0].uuid,this._iterationTemplate=s.templateWithComponent(this,this._templateDelegate)):(this._iterationTemplate=s.create(),this._iterationTemplate.delegate=this._templateDelegate,this._iterationTemplate.initWithComponent(this)),this._iterationTemplate.optimize(),this._removeOriginalContent=!0,o.isDebug&&o.debug(this._iterationTemplate.exportToString()),this.removeIterationSerialization();while(n=t.shift())n.needsDraw=!1;this.objects&&this.objects.length!==this._items.length&&this._updateItems([],this.objects,0)}},_templateDelegate:{value:{serializeObjectProperties:function(e,t){e.set("ownerComponent",t.ownerComponent,"reference")}}},templateDidLoad:{value:function(){var e=this._deserializedItem,t;if(e){t=e.element.childNodes,e.fragment=document.createDocumentFragment(),e.childComponentsIndex=this.childComponents.length-this._iterationChildComponentsCount;while(t.length>0)e.fragment.appendChild(t[0]);delete e.element}}},contentWillChange:{value:function(e){this._updatingItems=!0,this.reset()}},contentDidChange:{value:function(){this._updatingItems=!1,this._setupIterationTemplate()}},reset:{value:function(){this._items.clear(),this._itemsToAppend.clear(),this._nextDeserializedItemIx=0,this._itemsToRemove.clear(),this._deletedItems.clear()}},deserializedFromTemplate:{value:function(){this._isComponentExpanded&&this.setupIterationSerialization();var e=this._controllerBindingsToInstall,t;if(e){for(t in e)Object.defineBinding(this,t,e[t]);delete this._controllerBindingsToInstall}this._hasBeenDeserialized=!0}},canDraw:{value:function(){var e=this.canDrawGate.value,t,n,r=this.childComponents.length;if(e)for(n=0;n<r;n++)if(!this.childComponents[n].canDraw()){e=!1;break}return e}},prepareForDraw:{value:function(){this._refreshSelectionTracking()}},_selectedIndexesToDeselectOnDraw:{value:null},_selectedIndexes:{value:null},selectedIndexes:{get:function(){return this._selectedIndexes},set:function(e){this._selectedIndexes=e,this._markIndexesDirty(e),this._isComponentExpanded&&(this.needsDraw=!0)}},_activeIndexes:{value:null},activeIndexes:{get:function(){return this._activeIndexes},set:function(e){this._activeIndexes=e,this._markIndexesDirty(e),this._isComponentExpanded&&(this.needsDraw=!0)}},_markIndexesDirty:{value:function(e){if(e)for(var t=0,n=e.length;t<n;t++)this._dirtyIndexes[this._indexMap?this._indexMap.indexOf(e[t]):e[t]]=!0}},_refreshSelectionTracking:{value:function(){this.isSelectionEnabled?window.Touch?this.element.addEventListener("touchstart",this,!0):this.element.addEventListener("mousedown",this,!0):window.Touch?this.element.removeEventListener("touchstart",this,!0):this.element.removeEventListener("mousedown",this,!0)}},_itemIndexOfElement:{value:function(e){var t=e,n=null,r,i;if(t===this.element)return n;while(t&&t.parentNode!==this.element)t=t.parentNode;return t?(i=this.element.ownerDocument.createRange(),i.setStart(this.element,0),i.setEndAfter(t),r=this._iterationChildCount>1?1:0,n=(i.endOffset+r)/this._iterationChildCount-1,this.indexMap?this.indexMap[n]:n):null}},captureTouchstart:{value:function(e){if(this._selectionPointer||0===this._selectionPointer)return;this._observeSelectionPointer(e.changedTouches[0].identifier);var t=this._itemIndexOfElement(e.target);null!==t?this.activeIndexes=[t]:this._ignoreSelectionPointer()}},handleTouchend:{value:function(e){var t=0,n;while(t<e.changedTouches.length&&e.changedTouches[t].identifier!==this._selectionPointer)t++;t<e.changedTouches.length&&(this.eventManager.isPointerClaimedByComponent(this._selectionPointer,this)&&(n=this._itemIndexOfElement(e.target),null!==n&&(this.selectedIndexes=[n])),this._ignoreSelectionPointer())}},handleTouchcancel:{value:function(){this._ignoreSelectionPointer()}},captureMousedown:{value:function(e){this._observeSelectionPointer("mouse");var t=this._itemIndexOfElement(e.target);null!==t?this.activeIndexes=[t]:this._ignoreSelectionPointer()}},handleMouseup:{value:function(e){var t=this._itemIndexOfElement(e.target);null!==t&&(this.selectedIndexes=[t]),this._ignoreSelectionPointer()}},surrenderPointer:{value:function(e,t){return this._ignoreSelectionPointer(),!0}},_selectionPointer:{value:null},_observeSelectionPointer:{value:function(e){this._selectionPointer=e,this.eventManager.claimPointer(e,this),window.Touch?(document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1)):document.addEventListener("mouseup",this,!1)}},_ignoreSelectionPointer:{value:function(){this.eventManager.forfeitPointer(this._selectionPointer,this),this._selectionPointer=null,this.activeIndexes=[],window.Touch?(document.removeEventListener("touchend",this,!1),document.removeEventListener("touchcancel",this,!1)):document.removeEventListener("mouseup",this,!1)}},_iterationChildCount:{value:null},_iterationChildElementCount:{value:null},draw:{value:function(){var e,t,n,r,i=this._items.length,s,o=this.element,u=o.ownerDocument,a,f,l,c,h,p,d,v,m=this._indexMapChanged,g,y,b=this._iterationChildCount,w;if(!this.canDrawGate.value)return;this._removeOriginalContent&&(this._removeOriginalContent=!1,o.innerHTML="");if(1===this._iterationChildElementCount){l=o.children;for(e=0;e<l.length;e++)d=l.item(e),d&&this._dirtyIndexes[e]&&(v=d.classList,v.remove("active"),v.remove("selected"),v.remove("no-transition"),m&&this._indexMapAffectedIndexes[e]&&(v.add("no-transition"),this._dirtyIndexes[e]=!1))}m&&(this._indexMapAffectedIndexes.clear(),this._indexMapChanged=!1,this.needsDraw=!0);var E;if(this._itemsToRemove.length>0){f=document.createRange();for(e=0;t=this._itemsToRemove[e];e++)E=t.removalIndex,f.setStart(o,E*b),f.setEnd(o,E*b+b),f.extractContents();this._itemsToRemove.clear()}var S;if(this._itemsToAppend.length>0){for(e=0;t=this._itemsToAppend[e];e++){if(t.removed){this._removeIterationChildComponents(t.childComponentsIndex);continue}n=t.fragment,S=t.insertionIndex,delete t.fragment,delete t.insertionIndex,delete t.index,isNaN(S)?o.appendChild(n):o.insertBefore(n,o.childNodes[S*this._iterationChildCount]),this._items.splice(S,0,t)}i=this._items.length,this._itemsToAppend.clear(),this._nextDeserializedItemIx=0}if(null!==this.selectedIndexes&&this.selectedIndexes.length>0&&1===this._iterationChildElementCount){l=o.children,a=this.selectedIndexes.length,c=Math.min(a,l.length);for(e=0;e<c;e++)y=this.indexMap?this.indexMap.indexOf(this.selectedIndexes[e]):this.selectedIndexes[e],d=l.item(y),d&&(d.classList.add("selected"),this._dirtyIndexes[y]=!0)}if(null!==this._activeIndexes&&this._activeIndexes.length>0&&1===this._iterationChildElementCount){l=this.element.children,h=this._activeIndexes.length,p=Math.min(h,l.length);for(e=0;e<p;e++)g=this.indexMap?this.indexMap.indexOf(this._activeIndexes[e]):this._activeIndexes[e],d=l.item(g),d&&(d.classList.add("active"),this._dirtyIndexes[g]=!0)}this._drawnIndexMap=this._indexMap?this.indexMap.slice(0):null}},setupIterationSerialization:{value:function(){r.defineProperty(this,"serializeSelf",{value:this.serializeIteration})}},setupIterationDeserialization:{value:function(){this.deserializeProperties=this.deserializeIteration}},removeIterationSerialization:{value:function(){delete this.serializeSelf}},propertyChangeBindingListener:{value:function(e,t,n,r,i,s,o){var u=o,a=e,f,l,c,h,p,d;if(o&&o.boundObjectPropertyPath.match(/objectAtCurrentIteration/)){if(!this._deserializedItem)return null;l=this._fakeObjects._fakeIndex[this._deserializedItem.index],u={},c=Object.keys(o),h=c.length;for(var v=0;v<h;v++)p=c[v],u[p]=o[p];d=o.boundObjectPropertyPath.replace(/objectAtCurrentIteration/,"_fakeObjects."+l),u.boundObjectPropertyPath=d,a=e.replace(/objectAtCurrentIteration/,"_fakeObjects."+l)}else if(o&&o.boundObjectPropertyPath.match(/selectionAtCurrentIteration/)){if(!this._deserializedItem)return null;l=this._fakeObjects._fakeIndex[this._deserializedItem.index],u={},c=Object.keys(o),h=c.length;for(var v=0;v<h;v++)p=c[v],u[p]=o[p];d=o.boundObjectPropertyPath.replace(/selectionAtCurrentIteration/,"contentController.selections."+l),u.boundObjectPropertyPath=d,a=e.replace(/selectionAtCurrentIteration/,"contentController.selections."+l)}return u.boundObject===this?Object.prototype.propertyChangeBindingListener.call(this,a,t,n,r,i,s,u):u.boundObject.propertyChangeBindingListener(a,t,n,r,i,s,u)}},serializeIteration:{value:function(e){e.setProperty("element",this.element);var t=this.childComponents,n=e.addObject,r,i=t.length;for(r=0;r<i;r++)n.call(e,t[r]);e.setProperty("_isComponentExpanded",!0)}},deserializeIteration:{value:function(e){var t=this._itemsToAppend[this._nextDeserializedItemIx++];t?(this._deserializedItem=t,t.element=e.get("element"),this.eventManager.registerEventHandlerForElement(this,t.element),o.debug&&o.debug(this._montage_metadata.objectName+":deserializeIteration","childNodes: ",t.element)):this._deserializedItem=null}}})}}),montageDefine("120b0c7","ui/composer/translate-composer",{dependencies:["montage","ui/composer/composer","core/event/event-manager"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/composer/composer").Composer,s=e("core/event/event-manager").defaultEventManager,o=t.TranslateComposer=r.create(i,{_NATIVE_ELEMENTS:{value:["A","IFRAME","EMBED","OBJECT","VIDEO","AUDIO","CANVAS","LABEL","INPUT","BUTTON","SELECT","TEXTAREA","KEYGEN","DETAILS","COMMAND"]},_WHEEL_POINTER:{value:"wheel",writable:!1},_externalUpdate:{value:!0},isAnimating:{value:!1},frame:{value:function(e){this.isAnimating&&this._animationInterval(),this._externalUpdate=!1}},_pointerSpeedMultiplier:{value:1},pointerSpeedMultiplier:{get:function(){return this._pointerSpeedMultiplier},set:function(e){this._pointerSpeedMultiplier=e}},pointerStartEventPosition:{value:null},_shouldDispatchTranslate:{value:!1},_isSelfUpdate:{value:!1},_allowFloats:{value:!1},allowFloats:{get:function(){return this._allowFloats},set:function(e){this._allowFloats!==e&&(this._allowFloats=e,this.translateX=this._translateX,this.translateY=this._translateY)}},_translateX:{value:0},translateX:{get:function(){return this._translateX},set:function(e){if(this._axis==="vertical")this._translateX=this._minTranslateX||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;this._minTranslateX!==null&&t<this._minTranslateX&&(t=this._minTranslateX),this._maxTranslateX!==null&&t>this._maxTranslateX&&(t=this._maxTranslateX),this._isSelfUpdate||(this.isAnimating=!1),this._translateX=t}}},_translateY:{value:0},translateY:{get:function(){return this._translateY},set:function(e){if(this._axis==="horizontal")this._translateY=this._minTranslateY||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;this._minTranslateY!==null&&t<this._minTranslateY&&(t=this._minTranslateY),this._maxTranslateY!==null&&t>this._maxTranslateY&&(t=this._maxTranslateY),this._isSelfUpdate||(this.isAnimating=!1),this._translateY=t}}},_minTranslateX:{value:null},minTranslateX:{get:function(){return this._minTranslateX},set:function(e){e!==null&&(e=parseFloat(e)),this._minTranslateX!=e&&(e!==null&&this._translateX<e&&(this.translateX=e),this._minTranslateX=e)}},_maxTranslateX:{value:null},maxTranslateX:{get:function(){return this._maxTranslateX},set:function(e){e!==null&&(e=parseFloat(e)),this._maxTranslateX!=e&&(e!==null&&this._translateX>e&&(this.translateX=e),this._maxTranslateX=e)}},_minTranslateY:{value:null},minTranslateY:{get:function(){return this._minTranslateY},set:function(e){e!==null&&(e=parseFloat(e)),this._minTranslateY!=e&&(e!==null&&this._translateY<e&&(this.translateY=e),this._minTranslateY=e)}},_maxTranslateY:{value:null},maxTranslateY:{get:function(){return this._maxTranslateY},set:function(e){e!==null&&(e=parseFloat(e)),this._maxTranslateY!=e&&(e!==null&&this._translateY>e&&(this.translateY=e),this._maxTranslateY=e)}},_axis:{value:"both"},axis:{get:function(){return this._axis},set:function(e){switch(e){case"vertical":case"horizontal":this._axis=e,this.translateX=this._translateX,this.translateY=this._translateY;break;default:this._axis="both"}}},invertAxis:{depends:["invertXAxis","invertYAxis"],get:function(){return this._invertXAxis===this._invertYAxis?this._invertXAxis:null},set:function(e){this.invertXAxis=e,this.invertYAxis=e}},_invertXAxis:{value:!1},invertXAxis:{get:function(){return this._invertXAxis},set:function(e){this._invertXAxis=!!e}},_invertYAxis:{value:!1},invertYAxis:{get:function(){return this._invertYAxis},set:function(e){this._invertYAxis=!!e}},startTranslateSpeed:{value:500},startTranslateRadius:{value:8},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=e?!0:!1}},__momentumDuration:{value:650},_momentumDuration:{get:function(){return this.__momentumDuration},set:function(e){this.__momentumDuration=isNaN(e)?1:e>>0,this.__momentumDuration<1&&(this.__momentumDuration=1)}},_pointerX:{value:null},_pointerY:{value:null},_touchIdentifier:{value:null},_isFirstMove:{value:!1},_start:{value:function(e,t,n){this.pointerStartEventPosition={pageX:e,pageY:t,target:n},this._pointerX=e,this._pointerY=t,window.Touch?(document.addEventListener("touchend",this,!0),document.addEventListener("touchmove",this,!0)):(document.addEventListener("mouseup",this,!0),document.addEventListener("mousemove",this,!0)),this.isAnimating=!1,this._isFirstMove=!0}},_observedPointer:{value:null},_shouldPreventDefault:{value:function(e){return!!e.target.tagName&&o._NATIVE_ELEMENTS.indexOf(e.target.tagName)===-1&&!e.target.isContentEditable}},captureMousedown:{value:function(e){if(e.button!==0)return;this._shouldPreventDefault(e)&&e.preventDefault(),this._observedPointer="mouse",this._start(e.clientX,e.clientY,e.target)}},handleMousedown:{value:function(e){e.button===0&&!this.eventManager.componentClaimingPointer(this._observedPointer)&&this.eventManager.claimPointer(this._observedPointer,this)}},captureMousemove:{value:function(e){this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(e.preventDefault(),this._move(e.clientX,e.clientY)):this.axis!=="both"?this._analyzeMovement(e):this._stealPointer()&&(e.preventDefault(),this._move(e.clientX,e.clientY))}},captureMouseup:{value:function(e){this._end(e)}},_releaseInterest:{value:function(){window.Touch?(document.removeEventListener("touchend",this,!0),document.removeEventListener("touchmove",this,!0)):(document.removeEventListener("mouseup",this,!0),document.removeEventListener("mousemove",this,!0)),this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null}},captureTouchstart:{value:function(e){this._shouldPreventDefault(e)&&e.preventDefault();if(this._observedPointer!==null&&this.eventManager.isPointerClaimedByComponent(this._observedPointer,this))return;e.targetTouches.length===1&&(this._observedPointer=e.targetTouches[0].identifier,this._start(e.targetTouches[0].clientX,e.targetTouches[0].clientY,e.targetTouches[0].target))}},handleTouchstart:{value:function(e){this.eventManager.componentClaimingPointer(this._observedPointer)||e.targetTouches.length===1&&(this._shouldPreventDefault(e)&&e.preventDefault(),this.eventManager.claimPointer(this._observedPointer,this))}},captureTouchmove:{value:function(e){var t=0,n=e.changedTouches.length;while(t<n&&e.changedTouches[t].identifier!==this._observedPointer)t++;t<n&&(this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(e.preventDefault(),this._move(e.changedTouches[t].clientX,e.changedTouches[t].clientY)):this._analyzeMovement(e.changedTouches[t]))}},captureTouchend:{value:function(e){var t=0,n=e.changedTouches.length;while(t<n&&e.changedTouches[t].identifier!==this._observedPointer)t++;t<n&&this._end(e.changedTouches[t])}},_analyzeMovement:{value:function(e){var t=e.velocity;if(!t)return;var n=.7853981633974483,r=2.356194490192345,i=-2.356194490192345,s=-0.7853981633974483,o,u,a,f,l,c,h,p;c=t.speed;if(0===t.speed||isNaN(t.speed))return;l=t.angle,"horizontal"===this.axis?(a=l<=n&&l>=s,f=l>=r||l<=i,(a||f)&&this._stealPointer()):"vertical"===this.axis?(o=l<=s&&l>=i,u=l>=n&&l<=r,(o||u)&&this._stealPointer()):c>=this.startTranslateSpeed?this._stealPointer():(h=this.pointerStartEventPosition.pageX-e.pageX,p=this.pointerStartEventPosition.pageY-e.pageY,h*h+p*p>this.startTranslateRadius*this.startTranslateRadius&&this._stealPointer())}},_stealPointer:{value:function(){return this.eventManager.claimPointer(this._observedPointer,this)}},_translateEndTimeout:{value:null},captureMousewheel:{value:function(e){this.eventManager.componentClaimingPointer(this._WHEEL_POINTER)||this.eventManager.claimPointer(this._WHEEL_POINTER,this.component)}},handleMousewheel:{value:function(e){var t=this;if(this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this.component)){var n=this._translateY;this._dispatchTranslateStart(),this.translateY=this._translateY-e.wheelDeltaY*20/120,this._dispatchTranslate(),window.clearTimeout(this._translateEndTimeout),this._translateEndTimeout=window.setTimeout(function(){t._dispatchTranslateEnd()},400),n!==this._translateY&&this._shouldPreventDefault(e)&&e.preventDefault(),this.eventManager.forfeitPointer(this._WHEEL_POINTER,this.component)}}},_move:{value:function(e,t){var n;this._isFirstMove&&(this._dispatchTranslateStart(this._translateX,this._translateY),this._isFirstMove=!1),this._isSelfUpdate=!0,this._axis!="vertical"&&(n=this._invertXAxis?this._pointerX-e:e-this._pointerX,this.translateX+=n*this._pointerSpeedMultiplier),this._axis!="horizontal"&&(n=this._invertYAxis?this._pointerY-t:t-this._pointerY,this.translateY+=n*this._pointerSpeedMultiplier),this._isSelfUpdate=!1,this._pointerX=e,this._pointerY=t,this._shouldDispatchTranslate&&this._dispatchTranslate()}},_bezierTValue:{value:function(e,t,n,r,i){var s=1-3*r+3*t,o=3*r-6*t,u=3*t,a=.5,f,l,c,h;for(l=0;l<10;l++)h=a*a,f=3*s*h+2*o*a+u,c=1-a,a-=(3*(c*c*a*t+c*h*r)+h*a-e)/f;return h=a*a,c=1-a,3*(c*c*a*n+c*h*i)+h*a}},_dispatchTranslateStart:{value:function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent("translateStart",!0,!0,null),n.translateX=e,n.translateY=t,this.dispatchEvent(n)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,this.dispatchEvent(e)}},animateBouncingX:{value:!1,enumerable:!1},startTimeBounceX:{value:!1,enumerable:!1},animateBouncingY:{value:!1,enumerable:!1},startTimeBounceY:{value:!1,enumerable:!1},animateMomentum:{value:!1,enumerable:!1},startTime:{value:null,enumerable:!1},startX:{value:null,enumerable:!1},posX:{value:null,enumerable:!1},endX:{value:null,enumerable:!1},startY:{value:null,enumerable:!1},posY:{value:null,enumerable:!1},endY:{value:null,enumerable:!1},translateStrideX:{value:null},translateStrideY:{value:null},translateStrideDuration:{value:330},_animationInterval:{value:function(){var e=Date.now(),t,n,r,i,s=!1;this.animateMomentum&&(t=e-this.startTime,t<this.__momentumDuration?(this.posX=this.startX-(this.momentumX+this.momentumX*(this.__momentumDuration-t)/this.__momentumDuration)*t/1e3/2,this.posY=this.startY-(this.momentumY+this.momentumY*(this.__momentumDuration-t)/this.__momentumDuration)*t/1e3/2,this.translateStrideX&&this.startStrideXTime===null&&(this.__momentumDuration-t<this.translateStrideDuration||Math.abs(this.posX-this.endX)<this.translateStrideX*.75)&&(this.startStrideXTime=e),this.translateStrideY&&this.startStrideYTime===null&&(this.__momentumDuration-t<this.translateStrideDuration||Math.abs(this.posY-this.endY)<this.translateStrideY*.75)&&(this.startStrideYTime=e)):this.animateMomentum=!1),n=Math.round(this.endX/this.translateStrideX),this.startStrideXTime&&e-this.startStrideXTime>0&&(e-this.startStrideXTime<this.translateStrideDuration?(t=this._bezierTValue((e-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),this.posX=this.posX*(1-t)+n*this.translateStrideX*t,s=!0):this.posX=n*this.translateStrideX),n=Math.round(this.endY/this.translateStrideY),this.startStrideYTime&&e-this.startStrideYTime>0&&(e-this.startStrideYTime<this.translateStrideDuration?(t=this._bezierTValue((e-this.startStrideYTime)/this.translateStrideDuration,.275,0,.275,1),this.posY=this.posY*(1-t)+n*this.translateStrideY*t,s=!0):this.posY=n*this.translateStrideY),r=this.posX,i=this.posY,this._isSelfUpdate=!0,this.translateX=r,this.translateY=i,this._isSelfUpdate=!1,this.isAnimating=this.animateMomentum||s,this.isAnimating?this.needsFrame=!0:this._dispatchTranslateEnd()}},_end:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY,this._hasMomentum&&(e.velocity.speed>40||this.translateStrideX||this.translateStrideY)?(this._axis!="vertical"?this.momentumX=e.velocity.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):this.momentumX=0,this._axis!="horizontal"?this.momentumY=e.velocity.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):this.momentumY=0,this.endX=this.startX-this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY-this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||this._dispatchTranslateEnd(),this._releaseInterest()}},surrenderPointer:{value:function(e,t){return!0}},eventManager:{get:function(){return s}},load:{value:function(){window.Touch?(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("touchstart",this,!1)):(this._element.addEventListener("mousedown",this,!0),this._element.addEventListener("mousedown",this,!1),this._element.addEventListener("mousewheel",this,!1),this._element.addEventListener("mousewheel",this,!0)),this.eventManager.isStoringPointerEvents=!0}},addEventListener:{value:function(e,t,n){i.addEventListener.call(this,e,t,n),e==="translate"&&(this._shouldDispatchTranslate=!0)}}})}}),montageDefine("939b613","components/calculator.reel/calculator.html",{text:'<!doctype html>\n\n<html>\n    <head>\n    	<meta charset=utf-8>\n        <link rel=stylesheet href=calculator.css>\n        <script type="text/montage-serialization">{"memoryClearRecallButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_MR_MC"},"identifier":"memoryClearRecall"},"listeners":[{"type":"action","listener":{"@":"owner"}},{"type":"hold","listener":{"@":"owner"}}]},"MemoryAddButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_M_add"},"identifier":"memoryAdd"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"nineButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_9"},"identifier":"nine"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"eightButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_8"},"identifier":"eight"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"sevenButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_7"},"identifier":"seven"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"sixButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_6"},"identifier":"six"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"fiveButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_5"},"identifier":"five"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"fourButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_4"},"identifier":"four"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"threeButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_3"},"identifier":"three"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"twoButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_2"},"identifier":"two"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"oneButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_1"},"identifier":"one"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"zeroButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_0"},"identifier":"zero"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"decimalButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_dot"},"identifier":"decimal"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"clearButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_DEL"},"identifier":"clear"},"listeners":[{"type":"action","listener":{"@":"owner"}},{"type":"hold","listener":{"@":"owner"}}]},"plusButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_plus"},"identifier":"plus"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"divideButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_divide"},"identifier":"divide"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"minusButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_minus"},"identifier":"minus"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"multiplyButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_x"},"identifier":"multiply"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"equalButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_equal"},"identifier":"equal"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"memoryMinusButton":{"prototype":"montage/ui/button.reel","properties":{"element":{"#":"_M_min"},"identifier":"memoryMinus"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"memoryCondition":{"prototype":"montage/ui/condition.reel","properties":{"element":{"#":"MEM-indicator"}},"bindings":{"condition":{"<-":"@owner.memoryHasValue"}}},"owner":{"prototype":"components/calculator.reel","properties":{"element":{"#":"calculator"},"LEDElement":{"#":"led"},"currentNumberElement":{"#":"currentEntry"},"currentResultElement":{"#":"ledRes"}}}}</script>\n    </head>\n    <body>\n        <div data-montage-id=calculator>\n            <div class=calc-container>\n                <div class=cal-display>\n                    <div data-montage-id=MEM-indicator class=memory-value>\n                        M\n                    </div>\n                    <div class=cal-displayfield1 data-montage-id=currentEntry>0</div>\n                    <div class=led-container>\n                        <div class=led-entries data-montage-id=ledRes></div>\n                        <div class=led-entries data-montage-id=led>0</div>\n                    </div>\n                </div>\n                <div class=table-container>\n                    <div class=table-style>\n                        <div class=calc-row>\n                            <div class=calc-cell><div data-montage-id=_M_add class="button MEM cal-button-operators">m+</div></div>\n                            <div class=calc-cell><div data-montage-id=_M_min class="button MEM cal-button-operators">m-</div></div>\n                            <div class=calc-cell><div data-montage-id=_MR_MC class="button MEM cal-button-operators MR-MC"><span class=MR>mr</span><span class=MC>mc</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_divide class="button ARITH cal-button-operators divide">÷</div></div>\n                        </div>\n                        <div class=calc-row>\n                            <div class=calc-cell><div data-montage-id=_1 class="button cal-button-digits"><span class=fontGradient>1</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_2 class="button cal-button-digits"><span class=fontGradient>2</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_3 class="button cal-button-digits"><span class=fontGradient>3</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_x class="button ARITH cal-button-operators">×</div></div>\n                        </div>\n                        <div class=calc-row>\n                            <div class=calc-cell><div data-montage-id=_4 class="button cal-button-digits"><span class=fontGradient>4</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_5 class="button cal-button-digits"><span class=fontGradient>5</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_6 class="button cal-button-digits"><span class=fontGradient>6</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_plus class="button ARITH cal-button-operators">+</div></div>\n                        </div>\n                        <div class=calc-row>\n                            <div class=calc-cell><div data-montage-id=_7 class="button cal-button-digits"><span class=fontGradient>7</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_8 class="button cal-button-digits"><span class=fontGradient>8</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_9 class="button cal-button-digits"><span class=fontGradient>9</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_minus class="button ARITH cal-button-operators">−</div></div>\n                        </div>\n                        <div class=calc-row>\n                            <div class=calc-cell><div data-montage-id=_DEL class="button DEL cal-button-operators"><span class="CLEAR fontGradient">C</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_0 class="button cal-button-digits"><span class=fontGradient>0</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_dot class="button cal-button-digits"><span class=fontGradient>•</span></div></div>\n                            <div class=calc-cell><div data-montage-id=_equal class="button EQUAL cal-button-operators">=</div></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </body>\n</html>'}),montageDefine("120b0c7","ui/composer/press-composer",{dependencies:["montage","ui/composer/composer","core/event/mutable-event"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/composer/composer").Composer,s=e("core/event/mutable-event").MutableEvent,o=t.PressComposer=r.create(i,{load:{value:function(){window.Touch?this._element.addEventListener("touchstart",this,!0):this._element.addEventListener("mousedown",this,!0)}},unload:{value:function(){window.Touch?this._element.removeEventListener("touchstart",this):this._element.removeEventListener("mousedown",this)}},delegate:{value:null},cancelPress:{value:function(){return this._state===o.PRESSED?(this._dispatchPressCancel(),this._endInteraction(),!0):!1}},addEventListener:{value:function(e,t,n){i.addEventListener.call(this,e,t,n),e==="longPress"&&(this._shouldDispatchLongPress=!0)}},UNPRESSED:{value:0},PRESSED:{value:1},CANCELLED:{value:2},_state:{enumerable:!1,value:0},state:{get:function(){return this._state}},_shouldDispatchLongPress:{enumerable:!1,value:!1},_longPressThreshold:{enumerable:!1,value:1e3},longPressThreshold:{get:function(){return this._longPressThreshold},set:function(e){this._longPressThreshold!==e&&(this._longPressThreshold=e)}},_longPressTimeout:{enumberable:!1,value:null},_observedPointer:{enumerable:!1,value:null},_startInteraction:{enumerable:!1,value:function(e){if("disabled"in this.component&&this.component.disabled||this._observedPointer!==null)return!1;var t=0,n;if(e.type==="touchstart"){n=e.changedTouches.length;for(;t<n;t++)if(!this.component.eventManager.componentClaimingPointer(e.changedTouches[t].identifier)){this._observedPointer=e.changedTouches[t].identifier;break}if(this._observedPointer===null)return!1;document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1)}else e.type==="mousedown"&&(this._observedPointer="mouse",document.addEventListener("mouseup",this,!1),document.addEventListener("click",this,!1));this._element.addEventListener("dragstart",this,!1),this.component.eventManager.claimPointer(this._observedPointer,this),this._dispatchPressStart(e)}},_interpretInteraction:{value:function(e){var t,n,r;if(this._observedPointer===null){this._endInteraction(e);return}t=!this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this),n=e.target;while(n!==this._element&&n&&n.parentNode)n=n.parentNode;r=n===this._element;if(t&&e.type==="click"){e.preventDefault(),this._endInteraction(e);return}if(e.type==="mouseup"){if(!t&&r){this._dispatchPress(e),this._endInteraction(e);return}if(!t&&!r){this._dispatchPressCancel(e),this._endInteraction(e);return}t&&!r&&this._endInteraction(e)}}},_endInteraction:{value:function(e){if(!e||e.type==="touchend"||e.type==="touchcancel")document.removeEventListener("touchend",this),document.removeEventListener("touchcancel",this);else if(!e||e.type==="click"||e.type==="mouseup")document.removeEventListener("click",this),document.removeEventListener("mouseup",this);this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.component.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._state=o.UNPRESSED}},_changedTouchisObserved:{value:function(e){if(this._observedPointer===null)return!1;var t=0,n=event.changedTouches.length;for(;t<n;t++)if(event.changedTouches[t].identifier===this._observedPointer)return t;return!1}},surrenderPointer:{value:function(e,t){var n=this.callDelegateMethod("surrenderPointer",e,t);return typeof n!="undefined"&&n===!1?!1:(this._dispatchPressCancel(),!0)}},captureTouchstart:{value:function(e){this._startInteraction(e)}},handleTouchend:{value:function(e){if(this._observedPointer===null){this._endInteraction(e);return}this._changedTouchisObserved(e.changedTouches)!==!1&&(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?this._dispatchPress(e):e.preventDefault(),this._endInteraction(e))}},handleTouchcancel:{value:function(e){if(this._observedPointer===null||this._changedTouchisObserved(e.changedTouches)!==!1)this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this._dispatchPressCancel(e),this._endInteraction(e)}},captureMousedown:{value:function(e){this._startInteraction(e)}},handleClick:{value:function(e){this._interpretInteraction(e)}},handleMouseup:{value:function(e){this._interpretInteraction(e)}},handleDragstart:{value:function(e){this._dispatchPressCancel(e),this._endInteraction()}},_createPressEvent:{enumerable:!1,value:function(e,t){var n,r,i;return t||(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!0,!0,null)),n=u.create(),n.event=t,n.type=e,n.pointer=this._observedPointer,t.changedTouches&&(i=this._changedTouchisObserved(t.changedTouches))!==!1&&(n.touch=t.changedTouches[i]),n}},_dispatchPressStart:{enumerable:!1,value:function(e){this._state=o.PRESSED,this.dispatchEvent(this._createPressEvent("pressStart",e));if(this._shouldDispatchLongPress){var t=this;this._longPressTimeout=setTimeout(function(){t._dispatchLongPress()},this._longPressThreshold)}}},_dispatchPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this.dispatchEvent(this._createPressEvent("press",e)),this._state=o.UNPRESSED}},_dispatchLongPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(this.dispatchEvent(this._createPressEvent("longPress",e)),this._longPressTimeout=null)}},_dispatchPressCancel:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this._state=o.CANCELLED,this.dispatchEvent(this._createPressEvent("pressCancel",e))}}}),u=function(){var e,t,n,i,s,o;e=r.create(r,{type:{value:"press"},_event:{enumerable:!1,value:null},event:{get:function(){return this._event},set:function(e){this._event=e}},_touch:{enumerable:!1,value:null},touch:{get:function(){return this._touch},set:function(e){this._touch=e}}}),t=["altKey","ctrlKey","metaKey","shiftKey","cancelBubble","currentTarget","defaultPrevented","eventPhase","timeStamp","preventDefault","stopImmediatePropagation","stopPropagation"],n=["clientX","clientY","pageX","pageY","screenX","screenY","target"],i=function(e){return{get:function(){return this._event[e]}}},s=function(e){return{get:function(){return this._touch?this._touch[e]:this._event[e]}}};for(o=t.length-1;o>=0;o--)r.defineProperty(e,t[o],i(t[o]));for(o=n.length-1;o>=0;o--)r.defineProperty(e,n[o],s(n[o]));return e}()}}),montageDefine("939b613","components/calculator.reel/calculator",{dependencies:["montage","montage/ui/component","model/expression"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/ui/component").Component,s=e("model/expression").Expression;t.Calculator=r.create(i,{_currentNumberStack:{enumerable:!1,value:[],distinct:!0},_currentNumberString:{value:"0",enumerable:!1},_storedMemoryValue:{enumerable:!1,value:0},memoryHasValue:{value:!1},_previousResultNumber:{enumerable:!1,value:[],distinct:!0},_previousOperator:{enumerable:!1,value:"plus"},_clearAll:{value:!1,enumerable:!1},expression:{enumerable:!1,value:null},MAX_DISPLAY_LENGTH:{value:10,writable:!1},DECIMAL_EXPONENT_LENGTH:{value:5,writable:!1},MAX_EXPRESSION_DISPLAY_LENGTH:{value:37,writable:!1},currentNumberElement:{value:null,serializable:!0},currentResultElement:{value:null,serializable:!0},LEDElement:{value:null,serializable:!0},draw:{value:function(e){var t="";this.currentNumberElement.innerHTML=this.formatNumberString(this._currentNumberString),this.expression===null?(this.currentResultElement.innerHTML="",this.LEDElement.innerHTML=0):(this.expression.rhs!==null&&(t="&nbsp;=&nbsp;"+this.expression.result()),this.currentResultElement.innerHTML=t,this.LEDElement.innerHTML=this.formatExpressionString(this.expression.toString(),(""+t).replace(/&nbsp;/g," ")))}},formatExpressionString:{value:function(e,t){var n=e,r=e.length,i=t.length;return r+i>this.MAX_EXPRESSION_DISPLAY_LENGTH&&(n=e.slice(r+i-this.MAX_EXPRESSION_DISPLAY_LENGTH,r),n="..."+n),n}},formatNumberString:{value:function(e){var t=e,n;return e.length>this.MAX_DISPLAY_LENGTH&&(n=parseFloat(e),t=n.toExponential(this.DECIMAL_EXPONENT_LENGTH)),t}},buildExpression:{value:function(){this.expression==null&&(this.expression=r.create(s));var e=this._currentNumberStack.join("");e.indexOf(".")!=-1?this.expression.build(parseFloat(e)):this.expression.build(parseInt(e,10))}},updateNumber:{value:function(e){this._clearAll=!1,Array.isArray(e)?this._currentNumberStack=this._currentNumberStack.concat(e):this._currentNumberStack.push(e),this._currentNumberString=this._currentNumberStack.join(""),this.buildExpression(),this.needsDraw=!0}},addOperatorToExpression:{value:function(e){this.expression==null&&(this.expression=r.create(s),this.expression.build(0)),this.expression.addOperator(e),this._previousOperator=e,this._currentNumberStack.length>0&&(this._previousResultNumber=this._currentNumberStack.slice(0)),this._currentNumberStack=[],this.needsDraw=!0}},addDecimal:{value:function(){this._currentNumberStack.join("").indexOf(".")==-1&&(this._currentNumberStack.length==0?this.updateNumber(["0","."]):this.updateNumber("."))}},result:{value:function(){var e;this.expression?this.expression.operator!=null&&this.expression.rhs==null?(this._restorePreviousResultToCurrentNumber(),this.buildExpression()):this.expression.operator==null&&this.expression.rhs==null&&(this.expression.addOperator(this._previousOperator),this._restorePreviousResultToCurrentNumber(),this.buildExpression()):(this.expression=r.create(s),this._currentNumberStack=["0"],this.buildExpression(),this.expression.addOperator(this._previousOperator),this._restorePreviousResultToCurrentNumber(),this.buildExpression()),this.dispatchResultEvent(this.expression),e=this.expression.result(),this.resetCalculator(),e!=0&&e!="Error"?this.updateNumber(Array.prototype.slice.call(""+e,"")):this._currentNumberString=e,this._clearAll=!0,this.needsDraw=!0}},_restorePreviousResultToCurrentNumber:{value:function(){this._previousResultNumber.length>0?this._currentNumberStack=this._previousResultNumber.slice(0):this._currentNumberStack=["0"]}},dispatchResultEvent:{value:function(e){var t={expression:e},n=document.createEvent("CustomEvent");n.initCustomEvent("calcResult",!0,!1,t),this.dispatchEvent(n)}},resetCalculator:{value:function(){this.expression=null,this._previousResultNumber=this._currentNumberStack.slice(0),this._currentNumberStack=[],this._currentNumberString="0",this.needsDraw=!0}},backspace:{value:function(){this._currentNumberStack.length>0&&this._currentNumberStack.pop(),this._currentNumberStack.length>0&&(this._currentNumberStack.length!=1||this._currentNumberStack[0]!="-")?(this.buildExpression(),this._currentNumberString=this._currentNumberStack.join("")):(this._previousResultNumber=this._currentNumberStack.slice(0),this._currentNumberStack=[],this._currentNumberString="0",this.expression=null),this.needsDraw=!0}},memoryRecall:{value:function(){this.resetCalculator(),this._storedMemoryValue!=0&&this.updateNumber(Array.prototype.slice.call(""+this._storedMemoryValue,""))}},memoryCalculation:{value:function(e){var t=parseFloat(this._currentNumberStack.join("")),n=this._storedMemoryValue;isNaN(t)&&(t=0),e===s.OP_MINUS&&(t*=-1),this._storedMemoryValue=n+t,this._previousResultNumber=this._currentNumberStack.slice(0),this._currentNumberStack=[],this.memoryHasValue=!0}},memoryClear:{value:function(){this._storedMemoryValue=0,this.memoryHasValue=!1}},handleMemoryClearRecallHold:{value:function(e){this.memoryClear()}},handleClearHold:{value:function(e){this.resetCalculator()}},handleClearAction:{value:function(e){this._clearAll?this._clearAll&&(this.resetCalculator(),this._clearAll=!1):this.backspace()}},handleEqualAction:{value:function(e){this.result()}},handleDecimalAction:{value:function(e){this.addDecimal()}},handlePlusAction:{value:function(e){this.addOperatorToExpression(s.OP_PLUS)}},handleMinusAction:{value:function(e){this.addOperatorToExpression(s.OP_MINUS)}},handleMultiplyAction:{value:function(e){this.addOperatorToExpression(s.OP_MULTIPLY)}},handleDivideAction:{value:function(e){this.addOperatorToExpression(s.OP_DIVIDE)}},handleMemoryClearRecallAction:{value:function(e){this.memoryRecall()}},handleMemoryAddAction:{value:function(e){this.memoryCalculation(s.OP_PLUS)}},handleMemoryMinusAction:{value:function(e){this.memoryCalculation(s.OP_MINUS)}},handleNineAction:{value:function(e){this.updateNumber("9")}},handleEightAction:{value:function(e){this.updateNumber("8")}},handleSevenAction:{value:function(e){this.updateNumber("7")}},handleSixAction:{value:function(e){this.updateNumber("6")}},handleFiveAction:{value:function(e){this.updateNumber("5")}},handleFourAction:{value:function(e){this.updateNumber("4")}},handleThreeAction:{value:function(e){this.updateNumber("3")}},handleTwoAction:{value:function(e){this.updateNumber("2")}},handleOneAction:{value:function(e){this.updateNumber("1")}},handleZeroAction:{value:function(e){this.updateNumber("0")}}})}}),montageDefine("120b0c7","ui/scroll-bars.reel/scroll-bars",{dependencies:["montage","ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component,s=t.ScrollBars=r.create(i,{_verticalScroll:{value:0},_horizontalScroll:{value:0},_verticalLength:{value:0},_horizontalLength:{value:0},verticalScroll:{get:function(){return this._verticalScroll},set:function(e){this._verticalScroll=e,this.needsDraw=!0}},horizontalScroll:{get:function(){return this._horizontalScroll},set:function(e){this._horizontalScroll=e,this.needsDraw=!0}},verticalLength:{get:function(){return this._verticalLength},set:function(e){this._verticalLength=e,this.needsDraw=!0}},horizontalLength:{get:function(){return this._horizontalLength},set:function(e){this._horizontalLength=e,this.needsDraw=!0}},_opacity:{value:0},opacity:{get:function(){return this._opacity},set:function(e){this._opacity=e,this.needsDraw=!0}},_isDisplayUpdated:{value:!1},_displayVertical:{value:!1},displayVertical:{get:function(){return this._displayVertical},set:function(e){this._displayVertical!==e&&(this._displayVertical=e,this._isDisplayUpdated=!0,this.needsDraw=!0)}},_displayHorizontal:{value:!1},displayHorizontal:{get:function(){return this._displayHorizontal},set:function(e){this._displayHorizontal!==e&&(this._displayHorizontal=e,this._isDisplayUpdated=!0,this.needsDraw=!0)}},_top:{value:!1},_bottomClip:{value:!1},_bottom:{value:!1},_left:{value:!1},_rightClip:{value:!1},_right:{value:!1},_hasResizedHorizontal:{value:!1},_hasResizedVertical:{value:!1},willDraw:{value:function(){this._offsetWidth!==this._element.offsetWidth&&(this._offsetWidth=this._element.offsetWidth,this._hasResizedHorizontal=!0),this._offsetHeight!==this._element.offsetHeight&&(this._offsetHeight=this._element.offsetHeight,this._hasResizedVertical=!0)}},draw:{value:function(){var e,t,n,r;if(this._isDisplayUpdated){var i=this._displayVertical?"block":"none",s=this._displayHorizontal?"block":"none";this._top.style.display=this._bottomClip.style.display=i,this._left.style.display=this._rightClip.style.display=s,this._isDisplayUpdated=!1}this._hasResizedHorizontal&&this._displayHorizontal&&(this._rightClip.style.width=this._right.style.width=this._offsetWidth-4+"px",this._rightClip.style.clip="rect(-1px,"+(this._offsetWidth-3)+"px,6px,3px)",this._hasResizedHorizontal=!1),this._hasResizedVertical&&this._displayVertical&&(this._bottomClip.style.height=this._bottom.style.height=this._offsetHeight-4+"px",this._bottomClip.style.clip="rect(3px,6px,"+(this._offsetHeight-3)+"px,-1px)",this._hasResizedVertical=!1);if(this._opacity){if(this._displayHorizontal){n=this._offsetWidth-9-(this._displayVertical?6:0),e=Math.floor(n*this._horizontalLength),r=n-e,1-this._horizontalLength?t=Math.floor(r*this._horizontalScroll/(1-this._horizontalLength)):t=0,t<0&&(e+=t,e<0&&(e=0),t=0),t>r&&(e+=Math.floor(r-t),e<0&&(e=0),t=n-e);var o=e-this._offsetWidth+9+"px,0px",u=t+2+"px,0px";this._right.style.webkitTransform="translate3d("+o+",0)",this._right.style.MozTransform="translate("+o+")",this._right.style.transform="translate("+o+")",this._left.style.webkitTransform=this._rightClip.style.webkitTransform="translate3d("+u+",0)",this._left.style.MozTransform=this._rightClip.style.MozTransform="translate("+u+")",this._left.style.transform=this._rightClip.style.transform="translate("+u+")",this._left.style.webkitTransition=this._right.style.webkitTransition="none",this._left.style.MozTransition=this._right.style.MozTransition="none",this._left.style.transition=this._right.style.transition="none",this._left.style.opacity=this._right.style.opacity=this._opacity}if(this._displayVertical){n=this._offsetHeight-9-(this._displayHorizontal?6:0),e=Math.floor(n*this._verticalLength),r=n-e,1-this._verticalLength?t=Math.floor(r*this._verticalScroll/(1-this._verticalLength)):t=0,t<0&&(e+=t,e<0&&(e=0),t=0),t>r&&(e+=Math.floor(r-t),e<0&&(e=0),t=n-e);var a="0px,"+(e-this._offsetHeight+9)+"px",f="0px,"+(t+2)+"px";this._bottom.style.webkitTransform="translate3d("+a+",0)",this._bottom.style.MozTransform="translate("+a+")",this._bottom.style.transform="translate("+a+")",this._top.style.webkitTransform=this._bottomClip.style.webkitTransform="translate3d("+f+",0)",this._top.style.MozTransform=this._bottomClip.style.MozTransform="translate("+f+")",this._top.style.transform=this._bottomClip.style.transform="translate("+f+")",this._top.style.webkitTransition=this._bottom.style.webkitTransition="none",this._top.style.MozTransition=this._bottom.style.MozTransition="none",this._top.style.transition=this._bottom.style.transition="none",this._top.style.opacity=this._bottom.style.opacity=this._opacity}}else this._displayHorizontal&&(this._left.style.webkitTransition=this._right.style.webkitTransition="300ms opacity",this._left.style.opacity=this._right.style.opacity=0),this._displayVertical&&(this._top.style.webkitTransition=this._bottom.style.webkitTransition="300ms opacity",this._top.style.opacity=this._bottom.style.opacity=0)}}})}}),montageDefine("120b0c7","ui/native/button.reel/button",{dependencies:["montage","ui/component","ui/native-control","ui/composer/press-composer"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component,s=e("ui/native-control").NativeControl,o=e("ui/composer/press-composer").PressComposer,u=t.Button=r.create(s,{_preventFocus:{enumerable:!1,value:!1},preventFocus:{get:function(){return this._preventFocus},set:function(e){e===!0?this._preventFocus=!0:this._preventFocus=!1}},enabled:{dependencies:["disabled"],get:function(){return!this._disabled},set:function(e){this.disabled=!e}},converter:{value:null},_labelNode:{value:undefined,enumerable:!1},_label:{value:undefined,enumerable:!1},label:{get:function(){return this._label},set:function(e){if(e&&e.length>0&&this.converter)try{e=this.converter.convert(e),this.error&&(this.error=null)}catch(t){this.error=t}this._label=e,this._isInputElement&&(this._value=e),this.needsDraw=!0}},setLabelInitialValue:{value:function(e){this._label===undefined&&(this._label=e)}},holdThreshold:{get:function(){return this._pressComposer.longPressThreshold},set:function(e){this._pressComposer.longPressThreshold=e}},_pressComposer:{enumberable:!1,value:null},_active:{enumerable:!1,value:!1},active:{get:function(){return this._active},set:function(e){this._active=e,this.needsDraw=!0}},blur:{value:function(){this._element.blur()}},focus:{value:function(){this._element.focus()}},didCreate:{value:function(){this._pressComposer=o.create(),this.addComposer(this._pressComposer)}},prepareForActivationEvents:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},addEventListener:{value:function(e,t,n){s.addEventListener.call(this,e,t,n),e==="hold"&&this._pressComposer.addEventListener("longPress",this,!1)}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1),this._preventFocus||this._element.focus()}},handlePress:{value:function(e){this.active=!1,this._dispatchActionEvent(),document.removeEventListener("touchmove",this,!1)}},handleKeyup:{value:function(e){e.keyCode===32&&(this.active=!1,this._dispatchActionEvent())}},handleLongPress:{value:function(e){this._pressComposer.cancelPress();var t=document.createEvent("CustomEvent");t.initCustomEvent("hold",!0,!0,null),this.dispatchEvent(t)}},handlePressCancel:{value:function(e){this.active=!1,document.removeEventListener("touchmove",this,!1)}},handleTouchmove:{value:function(e){e.preventDefault()}},_isInputElement:{value:!1,enumerable:!1},willPrepareForDraw:{value:function(){s.willPrepareForDraw.call(this),this._element.setAttribute("role","button"),this._isInputElement=this._element.tagName==="INPUT",this._isInputElement?(Object.defineProperty(this,"value",{get:function(){return this._label},set:function(e){this.label=e}}),this._label===undefined&&(this._label=this._element.value)):(this._element.firstChild||this._element.appendChild(document.createTextNode("")),this._labelNode=this._element.firstChild,this.setLabelInitialValue(this._labelNode.data),this._label===undefined&&(this._label=this._labelNode.data)),this.needsDraw=!0}},prepareForDraw:{value:function(){this._element.addEventListener("keyup",this,!1)}},_drawLabel:{enumerable:!1,value:function(e){this._isInputElement?this._element.setAttribute("value",e):this._labelNode.data=e}},draw:{value:function(){Object.getPrototypeOf(u).draw.call(this),this._disabled?this._element.classList.add("disabled"):this._element.classList.remove("disabled"),this._active?this._element.classList.add("active"):this._element.classList.remove("active"),this._drawLabel(this.label)}},_detail:{value:null},detail:{get:function(){return this._detail===null&&(this._detail=a.create()),this._detail}},createActionEvent:{value:function(){var e=document.createEvent("CustomEvent"),t,n;if(t=this._detail)n=t._data;return e.initCustomEvent("action",!0,!0,n),e}}});u.addAttributes({autofocus:{value:!1,dataType:"boolean"},disabled:{value:!1,dataType:"boolean"},form:null,formaction:null,formenctype:null,formmethod:null,formnovalidate:{dataType:"boolean"},formtarget:null,type:{value:"button"},name:null,value:null});var a=r.create(r,{didCreate:{value:function(){this._data=Object.create(null)}},initWithReservedAndOptions:{value:function(e,t){Map.call(this,e,t)}},get:{value:function(e){return this.undefinedGet(e)}},set:{value:function(e,t){this.undefinedSet(e,t)}},_data:{value:null},_defineProperty:{value:function(e,t){t=typeof t!="undefined"?t:null,r.defineProperty(this,e,{get:function(){return this._data[e]},set:function(t){this._data[e]=t}}),this._data[e]=t}},undefinedGet:{value:function(e){return typeof this._data[e]=="undefined"&&this._defineProperty(e),this._data[e]}},undefinedSet:{value:function(e,t){typeof this._data[e]=="undefined"?this._defineProperty(e,t):this._data[e]=t}}})}}),montageDefine("120b0c7","ui/scroller.reel/scroller",{dependencies:["montage","ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component;t.Scroller=r.create(i,{_scrollX:{value:0},scrollX:{get:function(){return this._scrollX},set:function(e){this._scrollX!==e&&(this._scrollX=e,this.needsDraw=!0)}},_scrollY:{value:0},scrollY:{get:function(){return this._scrollY},set:function(e){this._scrollY!==e&&(this._scrollY=e,this.needsDraw=!0)}},_maxTranslateX:{value:0},_maxTranslateY:{value:0},_axis:{value:"auto"},axis:{get:function(){return this._axis},set:function(e){this._axis=e,this.needsDraw=!0}},_displayScrollbars:{value:"auto"},displayScrollbars:{get:function(){return this._displayScrollbars},set:function(e){switch(e){case"vertical":case"horizontal":case"both":case"auto":this._displayScrollbars=e;break;default:this._displayScrollbars="none"}this.needsDraw=!0}},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=e}},_content:{value:null},_scrollBars:{value:null},handleTranslateStart:{value:function(e){this._scrollBars.opacity=.5}},handleTranslateEnd:{value:function(e){this._scrollBars.opacity=0}},canDraw:{value:function(){return this.needsDraw=!0,i.canDraw.apply(this,arguments)}},willDraw:{value:function(){this._left=this._element.offsetLeft,this._top=this._element.offsetTop,this._width=this._element.offsetWidth,this._height=this._element.offsetHeight,this._maxTranslateX=this._content.scrollWidth-this._width,this._maxTranslateX<0&&(this._maxTranslateX=0),this._maxTranslateY=this._content.offsetHeight-this._height,this._maxTranslateY<0&&(this._maxTranslateY=0);var e=this.callDelegateMethod("didSetMaxScroll",{x:this._maxTranslateX,y:this._maxTranslateY});e&&(this._maxTranslateX=e.x,this._maxTranslateY=e.y),this.scrollX=Math.min(this._scrollX,this._maxTranslateX),this.scrollY=Math.min(this._scrollY,this._maxTranslateY);switch(this._displayScrollbars){case"horizontal":this._scrollBars.displayHorizontal=!0,this._scrollBars.displayVertical=!1;break;case"vertical":this._scrollBars.displayHorizontal=!1,this._scrollBars.displayVertical=!0;break;case"both":this._scrollBars.displayHorizontal=!0,this._scrollBars.displayVertical=!0;break;case"auto":this._scrollBars.displayHorizontal=!!this._maxTranslateX,this._scrollBars.displayVertical=!!this._maxTranslateY;break;case"none":this._scrollBars.displayHorizontal=!1,this._scrollBars.displayVertical=!1}this._scrollBars.displayHorizontal&&(this._content.scrollWidth?(this._scrollBars.horizontalLength=this._width/this._content.scrollWidth,this._scrollBars.horizontalScroll=this._scrollX/this._content.scrollWidth):(this._scrollBars.horizontalLength=1,this._scrollBars.horizontalScroll=0)),this._scrollBars.displayVertical&&(this._content.offsetHeight?(this._scrollBars.verticalLength=this._height/this._content.offsetHeight,this._scrollBars.verticalScroll=this._scrollY/this._content.offsetHeight):(this._scrollBars.verticalLength=1,this._scrollBars.verticalScroll=0))}},draw:{value:function(){var e=-this._scrollX+"px, "+ -this._scrollY+"px";this._content.style.webkitTransform="translate3d("+e+", 0px)",this._content.style.MozTransform="translate("+e+")",this._content.style.transform="translate("+e+")"}}})}}),montageDefine("939b613","model/expression",{dependencies:["montage"],factory:function(e,t,n){var r=e("montage").Montage,i=t.Expression=r.create(r,{OP_MINUS:{writable:!1,value:"minus"},OP_PLUS:{writable:!1,value:"plus"},OP_MULTIPLY:{writable:!1,value:"multiply"},OP_DIVIDE:{writable:!1,value:"divide"},TYPE_COMPOUND:{writable:!1,value:"Compound"},TYPE_NUMBER:{writable:!1,value:"Number"},_lhs:{value:null},_rhs:{value:null},_operator:{value:null},_comment:{value:null},_type:{value:"Number"},lhs:{get:function(){return this._lhs},set:function(e){this._lhs!==e&&(this._lhs=e)}},rhs:{get:function(){return this._rhs},set:function(e){this._rhs!==e&&(this._rhs=e)}},operator:{get:function(){return this._operator},set:function(e){this._operator!==e&&(this._operator=e)}},result:{value:function(){var e;if(this.lhs==null)return"";if(this._type===this.TYPE_NUMBER){var t=""+this.lhs;return t.indexOf(".")==-1?parseInt(this.lhs,10):parseFloat(this.lhs)}if(this._type===this.TYPE_COMPOUND)switch(this.operator){case this.OP_PLUS:e=this.lhs.result()+this.rhs;break;case this.OP_MINUS:e=this.lhs.result()-this.rhs;break;case this.OP_DIVIDE:this.rhs!=0?e=this.lhs.result()/this.rhs:e="Error";break;case this.OP_MULTIPLY:e=this.lhs.result()*this.rhs}return e}},comment:{get:function(){return this._comment},set:function(e){this._comment!==e&&(this._comment=e)}},build:{value:function(e){if(this._type==this.TYPE_NUMBER){var t=r.create(i);t.lhs=e,this.lhs=t}else this._type==this.TYPE_COMPOUND&&(this.rhs=e)}},addOperator:{value:function(e){this._type==this.TYPE_NUMBER?(this.operator=e,this._type=this.TYPE_COMPOUND):this._type==this.TYPE_COMPOUND&&(this.operator==null||this.rhs!=null?(this.lhs=this.clone(),this.operator=e,this.rhs=null):this.operator=e)}},clone:{value:function(){var e=r.create(i);return this._type==this.TYPE_NUMBER?e.lhs=this.lhs:this._type==this.TYPE_COMPOUND&&(e._type=this._type,e.lhs=this.lhs.clone(),e.rhs=this.rhs,e.operator=this.operator),e}},prettyPrint:{value:function(e){var t;switch(e){case this.OP_PLUS:t="+";break;case this.OP_MINUS:t="-";break;case this.OP_DIVIDE:t="÷";break;case this.OP_MULTIPLY:t="×"}return t}},toString:{value:function(){if(this.lhs==null)return"";if(this._type==this.TYPE_NUMBER)return this.lhs.toString();if(this._type==this.TYPE_COMPOUND)return this.lhs.toString()+" "+this.prettyPrint(this.operator)+" "+(this.rhs==null?"":this.rhs.toString())}},displayExpression:{get:function(){return this.toString()}},displayResult:{get:function(){return this.result()}}})}}),montageDefine("120b0c7","ui/scroller.reel/scroller.html",{text:'<!DOCTYPE html>\n\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=scroller.css>\n    <script type="text/montage-serialization">{"scrollbars":{"prototype":"ui/scroll-bars.reel","properties":{"element":{"#":"scrollbars"}}},"translateComposer1":{"prototype":"ui/composer/translate-composer","properties":{"component":{"@":"owner"},"minTranslateX":0,"minTranslateY":0,"invertAxis":true},"bindings":{"translateX":{"<->":"@owner.scrollX"},"translateY":{"<->":"@owner.scrollY"},"maxTranslateX":{"<-":"@owner._maxTranslateX"},"maxTranslateY":{"<-":"@owner._maxTranslateY"},"axis":{"<-":"@owner.axis"},"hasMomentum":{"<-":"@owner.hasMomentum"}},"listeners":[{"type":"translateStart","listener":{"@":"owner"}},{"type":"translateEnd","listener":{"@":"owner"}}]},"slot":{"prototype":"ui/slot.reel","properties":{"element":{"#":"content"}},"bindings":{"domContent":{"<-":"@owner.domContent"}}},"owner":{"prototype":"ui/scroller.reel","properties":{"_content":{"#":"content"},"element":{"#":"montage-scroller"},"_scrollBars":{"@":"scrollbars"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=montage-scroller class=montage-Scroller>\n        <div data-montage-id=scrollbars></div>\n        <div data-montage-id=content class=montage-Scroller-content></div>\n    </div>\n</body>\n</html>'}),montageDefine("939b613","components/tapeentry.reel/tapeentry.html",{text:'<!doctype html>\n\n<html>\n    <head>\n        <link rel=stylesheet href=tapeentry.css>\n        <script type="text/montage-serialization">{"expression":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"lhs"}},"bindings":{"value":{"<-":"@owner.expression.displayExpression"}}},"result":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"rhs"}},"bindings":{"value":{"<-":"@owner.expression.displayResult"}}},"comment":{"prototype":"montage/ui/dynamic-text.reel","properties":{"element":{"#":"comment"}},"bindings":{"value":{"<-":"@owner.expression.comment"}}},"owner":{"prototype":"components/tapeentry.reel[TapeEntry]","properties":{"element":{"#":"tape-entry"}}}}</script>\n	</head>\n	<body>\n        <div data-montage-id=tape-entry class=tape-entry>\n            <div data-montage-id=tape-entry-content class=tape-entry-content>\n                <div class=tape-entry-container>\n                    <span data-montage-id=lhs class=lhs></span>\n                    <span data-montage-id=rhs class=rhs></span>\n                </div>\n                <div data-montage-id=comment class=tape-comment></div>\n            </div>\n        </div>\n	</body>\n</html>'}),montageDefine("939b613","components/tape.reel/tape.html",{text:'<!doctype html>\n\n<html>\n    <head>\n        <link rel=stylesheet href=tape.css>\n        <script type="text/montage-serialization">{"scrollview":{"prototype":"montage/ui/scroller.reel","properties":{"element":{"#":"_scrollview"},"hasMomentum":true,"axis":"vertical"}},"tapeentry":{"prototype":"components/tapeentry.reel[TapeEntry]","properties":{"element":{"#":"tape-entry"}},"bindings":{"expression":{"<-":"@repetition.objectAtCurrentIteration"}}},"repetition":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"tape-content"}},"bindings":{"objects":{"<-":"@owner.tapeData"}}},"owner":{"prototype":"components/tape.reel","properties":{"element":{"#":"tape"}}}}</script>\n    </head>\n    <body>\n        <div data-montage-id=tape>\n            <div style="border-left: 2px gray; height: 100%; width: 100%; float: right">\n                <div data-montage-id=_scrollview style="position: relative; width: 100%; height: 100%; overflow: hidden">\n                    <div data-montage-id=tape-content>\n                        <div class=content data-montage-id=tape-entry></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </body>\n</html>'}),montageDefine("120b0c7","ui/slot.reel/slot",{dependencies:["montage","ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component;t.Slot=r.create(i,{hasTemplate:{enumerable:!1,value:!1},didCreate:{value:function(){this.content=null}},delegate:{value:null},_content:{value:null},prepareForDraw:{value:function(){this.element.classList.add("montage-Slot")}},content:{get:function(){return this._content},set:function(e){var t;e&&typeof e.needsDraw!="undefined"?(e.element?t=e.element:(t=document.createElement("div"),t.id="appendDiv",this.delegate&&typeof this.delegate.slotElementForComponent=="function"&&(t=this.delegate.slotElementForComponent(this,e,t))),Object.getPropertyDescriptor(i,"domContent").set.call(this,t),e.setElementWithParentComponent(t,this),e.needsDraw=!0):Object.getPropertyDescriptor(i,"domContent").set.call(this,e),this._content=e,this.needsDraw=!0}},contentDidChange:{value:function(e,t){this.delegate&&typeof this.delegate.slotDidSwitchContent=="function"&&this.delegate.slotDidSwitchContent(this,e,e?e.controller:null,t,t?t.controller:null)}}})}}),montageDefine("120b0c7","ui/condition.reel/condition",{dependencies:["montage","ui/component","core/logger"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component,s=e("core/logger").logger("condition");t.Condition=r.create(i,{hasTemplate:{value:!1},_condition:{value:null},condition:{set:function(e){if(e===this._condition)return;this._condition=e,this.needsDraw=!0,this.removalStrategy==="remove"&&!this.isDeserializing&&(e?this.domContent=this.originalContent:this.domContent=null)},get:function(){return this._condition}},_removalStrategy:{value:"remove"},removalStrategy:{get:function(){return this._removalStrategy},set:function(e){if(this._removalStrategy===e)return;e==="hide"&&!this.isDeserializing&&(this.domContent=this.originalContent),this._removalStrategy=e,this.needsDraw=!0}},prepareForDraw:{value:function(){this.removalStrategy==="remove"&&!this.condition&&(this.domContent=null)}},draw:{value:function(){this.condition?this.element.classList.remove("montage-invisible"):this.element.classList.add("montage-invisible")}}})}}),montageDefine("120b0c7","ui/scroll-bars.reel/scroll-bars.html",{text:'<!DOCTYPE html>\n\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=scroll-bars.css>\n    <script type="text/montage-serialization">{"owner":{"properties":{"element":{"#":"montage-scroll-bars"},"_top":{"#":"top"},"_bottomClip":{"#":"bottom-clip"},"_bottom":{"#":"bottom"},"_left":{"#":"left"},"_rightClip":{"#":"right-clip"},"_right":{"#":"right"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=montage-scroll-bars class=montage-ScrollBars>\n        <div data-montage-id=top class=montage-ScrollBars-top></div>\n        <div data-montage-id=bottom-clip class=montage-ScrollBars-bottomClip>\n            <div data-montage-id=bottom class=montage-ScrollBars-bottom></div>\n        </div>\n        <div data-montage-id=left class=montage-ScrollBars-left></div>\n        <div data-montage-id=right-clip class=montage-ScrollBars-rightClip>\n            <div data-montage-id=right class=montage-ScrollBars-right></div>\n        </div>\n    </div>\n</body>\n</html>'}),montageDefine("120b0c7","ui/composer/composer",{dependencies:["montage"],factory:function(e,t,n){var r=e("montage").Montage;t.Composer=r.create(r,{_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},lazyLoad:{value:!1},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:function(e){}},_resolveDefaults:{value:function(){this.element==null&&this.component!=null&&(this.element=this.component.element)}},_load:{value:function(){this.element||this._resolveDefaults(),this.load()}},load:{value:function(){}},unload:{value:function(){}},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}})}}),montageDefine("939b613","components/main.reel/main.html",{text:'<!doctype html>\n\n<html>\n    <head>\n        <title>Calculator</title>\n        <link rel=stylesheet href=main.css>\n        <link rel=stylesheet href="../../asset/style/mobile.css">\n        \n        <script type="text/montage-serialization">{"calculator":{"prototype":"components/calculator.reel","properties":{"element":{"#":"calculator"}}},"tape":{"prototype":"components/tape.reel","properties":{"element":{"#":"tape"}}},"owner":{"prototype":"components/main.reel","properties":{"element":{"#":"mainElement"},"calculator":{"@":"calculator"},"tape":{"@":"tape"}}}}</script>\n    </head>\n    <body>\n        <div data-montage-id=mainElement class=main>\n            <div data-montage-id=calculator class=calculator></div>\n            <div data-montage-id=tape class=tape></div>\n        </div>\n    </body>\n</html>'}),montageDefine("939b613","components/main.reel/main",{dependencies:["montage","montage/ui/component","model/expression"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/ui/component").Component,s=e("model/expression").Expression;t.Main=r.create(i,{calculator:{value:null,serializable:!0},tape:{value:null,serializable:!0},prepareForDraw:{value:function(){this.calculator.addEventListener("calcResult",this,!1);var e=navigator.userAgent.toLowerCase(),t=e.indexOf("android")>-1;t&&this._element.classList.add("isAndroid")}},handleCalcResult:{value:function(e){e.detail.expression&&(e.detail.expression.comment="Calculator",this.tape.addTapeEntry(e.detail.expression))}},templateDidLoad:{value:function(){var e=screen.height,t=73,n=parseInt(e/t),i=r.create(s);for(var o=0;o<n;o++)this.tape.addEmptyTapeEntry(i)}}})}}),montageDefine("939b613","components/tape.reel/tape",{dependencies:["montage","montage/ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/ui/component").Component;t.Tape=r.create(i,{tapeData:{enumerable:!1,value:[],distinct:!0},addTapeEntry:{value:function(e){this.tapeData.unshift(e),this.tapeData[this.tapeData.length-1].lhs==null&&this.tapeData.pop()}},removeTapeEntry:{value:function(e){this.tapeData.splice(e,1)}},addEmptyTapeEntry:{value:function(e){this.tapeData.push(e)}}})}}),montageDefine("120b0c7","ui/button.reel/button",{dependencies:["montage","ui/component","ui/native/button.reel"],factory:function(e,t,n){var r=e("montage").Montage,i=e("ui/component").Component,s=e("ui/native/button.reel").Button;t.Button=r.create(s,{hasTemplate:{value:!0},willPrepareForDraw:{value:function(){s.willPrepareForDraw.call(this),this.element.classList.add("montage-Button")}}})}}),montageDefine("939b613","components/tapeentry.reel/tapeentry",{dependencies:["montage","montage/ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/ui/component").Component;t.TapeEntry=r.create(i,{expression:{value:null}})}}),montageDefine("120b0c7","ui/button.reel/button.html",{text:"<!DOCTYPE html>\n\n<html>\n<head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=button.css>\n</head>\n<body>\n</body>\n</html>"})
bundleLoaded(undefined)
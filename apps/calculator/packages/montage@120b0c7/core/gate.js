var Montage=require("montage").Montage,logger=require("core/logger").logger("gate"),Gate=exports.Gate=Montage.create(Montage,{init:{enumerable:!1,value:function(){return this.reset(),this}},initWithDelegate:{enumerable:!1,value:function(e){return this.reset(),this.delegate=e,this}},initWithDescriptor:{enumerable:!1,value:function(e){var t;this.reset();for(t in e)this.setField(t,e[t].value);return this}},count:{value:0},table:{value:null},getField:{enumerable:!1,value:function(e){var t=this.table;return!t||t[e]}},setField:{enumerable:!1,value:function(e,t){var n=this.table,r,i=this.count;n=n?n:this.table={},r=n[e],typeof r=="undefined"&&!t?this.count++:typeof r!="undefined"&&r!==t?t?this.count--:this.count++:t&&logger.error(this,e+" was not set before."),n[e]=!!t,this.count===0&&i>0?this.callDelegateMethod(!0):i===0&&this.count>0&&this.callDelegateMethod(!1)}},removeField:{enumerable:!1,value:function(e){var t=this.table,n=t[e];typeof n!="undefined"&&!n&&this.count--,delete t[e]}},delegate:{enumerable:!1,value:null},callDelegateMethod:{value:function(e){var t;this.delegate&&typeof (t=this.delegate["gateDidBecome"+(e?"True":"False")])=="function"&&t.call(this.delegate,this)},enumerable:!1},value:{enumerable:!1,get:function(){return this.count===0}},reset:{enumerable:!1,value:function(){this.table={},this.count=0}},toString:{value:function(){var e=this._fields,t,n,r="";for(t=0;n=e[t];t++)r+=n+"["+(this._value&e[n])+"], ";return r}}})